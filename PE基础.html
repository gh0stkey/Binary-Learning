<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>PE&#22522;&#30784; - &#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="1015827">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">BinaryLearning</span>
                    <img class="space-logo" src="global.logo" />
                </h1>
                <a href="Binary-Learning.html" class="ht-space-link">
                    <h2>&#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</h2>
                </a>
                <p><br><a href="https://github.com/gh0stkey/Binary-Learning" target="_blank">ᴀᴜᴛʜᴏʀ: ᴋᴇʏ</a><br><br>不积跬步，无以至千里；<br>不积小流，无以成江海。</p>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=1015828"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Binary-Learning.html">&#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</a></li>
                                                                                     <li><a href="%E5%88%9D%E7%BA%A7%E7%AF%87.html">&#21021;&#32423;&#31687;</a></li>
                                                            </ul>
</div>            <h1 id="src-1015828"> <span>PE&#22522;&#30784;</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

    <div class="section section-1" id="src-1015828_safe-id-UEXln7rnoYAtUEXmlofku7bnu5PmnoQ">
        <h1 class="heading "><span> PE&#25991;&#20214;&#32467;&#26500;</span></h1>
<p   
>&#20174;&#26412;&#31456;&#24320;&#22987;&#23601;&#35201;&#23398;&#20064;PE&#30456;&#20851;&#30340;&#20869;&#23481;&#12290;</p>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAt5Y-v5omn6KGM5paH5Lu2">
        <h2 class="heading "><span>&#21487;&#25191;&#34892;&#25991;&#20214;</span></h2>
<p   
>&#22312;&#20102;&#35299;PE&#20043;&#21069;&#65292;&#25105;&#20204;&#38656;&#35201;&#30693;&#36947;&#20160;&#20040;&#26159;&#21487;&#25191;&#34892;&#25991;&#20214;&#65292;&#20174;&#23383;&#38754;&#29702;&#35299;&#21487;&#25191;&#34892;&#25991;&#20214;&#23601;&#26159;&#21487;&#20197;&#30001;&#25805;&#20316;&#31995;&#32479;&#36827;&#34892;&#21152;&#36733;&#25191;&#34892;&#30340;&#25991;&#20214;&#12290;</p>
<p   
><strong class=" ">Windows&#24179;&#21488;&#19979;&#30340;&#21487;&#25191;&#34892;&#25991;&#20214;&#30340;&#26684;&#24335;&#65292;&#25105;&#20204;&#31216;&#20043;&#20026;PE&#65288;Portable Executable&#65289;&#25991;&#20214;&#32467;&#26500;</strong>&#65307;Linux&#24179;&#21488;&#19979;&#30340;&#21487;&#25191;&#34892;&#25991;&#20214;&#26684;&#24335;&#65292;&#25105;&#20204;&#31216;&#20043;&#20026;ELF&#65288;Executable and Linking Format&#65289;&#25991;&#20214;&#32467;&#26500;&#12290;</p>
<p   
>&#20180;&#32454;&#30340;&#20154;&#21487;&#33021;&#20250;&#21457;&#29616;PE&#30340;&#20840;&#31216;&#26159;<strong class=" ">Portable Executable</strong>&#65292;&#20854;&#20013;&#25991;&#24847;&#24605;&#23601;&#26159;&#20415;&#25658;&#30340;&#21487;&#25191;&#34892;&#65292;&#32780;ELF&#30340;&#20840;&#31216;<strong class=" ">Executable and Linking Format</strong>&#23601;&#26159;&#21487;&#25191;&#34892;&#21487;&#38142;&#25509;&#26684;&#24335;&#65292;&#37027;&#20040;&#20004;&#32773;&#20043;&#38388;&#30340;&#24046;&#36317;&#23601;&#20986;&#29616;&#20102;&#65292;Windows&#24179;&#21488;&#19979;&#30340;PE&#25991;&#20214;&#32467;&#26500;&#26159;&#20415;&#25658;&#30340;&#65292;&#20063;&#23601;&#34920;&#31034;&#20854;&#22312;Windows&#19979;&#26159;&#36890;&#29992;&#20860;&#23481;&#30340;&#65292;<strong class=" ">&#20363;&#22914;&#20320;&#22312;Windows7&#19979;&#30340;&#21487;&#25191;&#34892;&#25991;&#20214;&#20063;&#21487;&#20197;&#22312;Windows8&#12289;10&#31995;&#32479;&#19979;&#36816;&#34892;</strong>&#65292;&#32780;Linux&#21017;&#19981;&#19968;&#26679;&#65292;&#19981;&#21516;&#20869;&#26680;&#32534;&#35793;&#30340;&#21487;&#25191;&#34892;&#25991;&#20214;&#22312;&#19981;&#21516;&#20869;&#26680;&#30340;&#29615;&#22659;&#19979;&#26159;&#26080;&#27861;&#20351;&#29992;&#30340;&#12290;</p>
<p   
>&#22312;&#36825;&#20123;&#39046;&#22495;&#19979;&#20250;&#29992;&#21040;PE&#25991;&#20214;&#26684;&#24335;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#30149;&#27602;&#21644;&#21453;&#30149;&#27602;&#65307;</p>
</li><li class=" "><p   
>&#22806;&#25346;&#21644;&#21453;&#22806;&#25346;&#65307;</p>
</li><li class=" "><p   
>&#21152;&#22771;&#21644;&#33073;&#22771;&#65288;&#20445;&#25252;&#19982;&#30772;&#35299;&#65289;&#65307;</p>
</li><li class=" "><p   
>&#26080;&#28304;&#30721;&#30340;&#24773;&#20917;&#19979;&#20462;&#25913;&#21151;&#33021;&#12289;&#27721;&#21270;&#36719;&#20214;...</p>
</li></ol>    </div>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAt6K-G5YirUEXmlofku7Y">
        <h2 class="heading "><span>&#35782;&#21035;PE&#25991;&#20214;</span></h2>
<p   
>&#20320;&#24819;&#35201;&#35782;&#21035;&#19968;&#20010;&#25991;&#20214;&#26159;&#19981;&#26159;PE&#25991;&#20214;&#65292;&#25110;&#32773;&#35828;&#26159;&#19981;&#26159;&#19968;&#20010;&#21487;&#25191;&#34892;&#25991;&#20214;&#65292;&#21487;&#20197;&#26681;&#25454;PE&#25351;&#32441;&#26469;&#35782;&#21035;&#65306;&#39318;&#20808;&#20320;&#38656;&#35201;&#25214;&#21040;&#19968;&#20010;&#21487;&#20197;&#20197;16&#36827;&#21046;&#25171;&#24320;PE&#25991;&#20214;&#30340;&#24037;&#20855;&#65288;010 Editor&#65289;&#65292;&#28982;&#21518;&#25214;&#21040;&#19968;&#20010;PE&#25991;&#20214;&#65292;&#29992;&#35813;&#24037;&#20855;&#25171;&#24320;PE&#25991;&#20214;&#65292;<strong class=" ">&#22312;&#25991;&#20214;&#30340;&#24320;&#22987;&#20301;&#32622;&#26377;&#19968;&#20010;0x5A4D(&#21313;&#36827;&#21046;&#65306;MZ)&#65292;&#25509;&#30528;&#22312;0x003C&#20301;&#32622;&#21521;&#21518;&#26377;&#19968;&#20010;0x100&#65292;&#25509;&#30528;&#25105;&#20204;&#20877;&#21435;&#23547;&#25214;0x100&#20301;&#32622;&#23601;&#20250;&#20986;&#29616;&#19968;&#20010;0x4550(&#21313;&#36827;&#21046;&#65306;PE)</strong>&#65292;&#37027;&#20040;&#24403;&#20320;&#29992;&#36825;&#20010;&#26041;&#27861;&#21487;&#20197;&#39034;&#21033;&#30340;<strong class=" ">&#36208;&#36890;&#25972;&#20010;&#27969;&#31243;&#25214;&#21040;PE</strong>&#65292;&#23601;&#34920;&#31034;&#36825;&#26159;&#19968;&#20010;PE&#25991;&#20214;&#65292;&#21516;&#26679;&#36825;&#20063;&#26159;&#19968;&#20010;<strong class=" ">PE&#25351;&#32441;</strong>&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-12_17-2-27.png" alt="images/download/attachments/1015828/image2021-11-12_17-2-27.png" width="600"  />
    </p>
<p   
>&#22914;&#19978;&#31034;&#20363;&#20013;&#25105;&#20351;&#29992;&#30340;&#26159;exe&#21518;&#32512;&#30340;&#25991;&#20214;&#65292;&#20294;&#21363;&#20351;&#19981;&#26159;exe&#21518;&#32512;&#30340;&#25991;&#20214;&#65292;&#20363;&#22914;.sys&#12289;.dll&#21518;&#32512;&#30340;&#25991;&#20214;&#65292;&#23454;&#38469;&#19978;&#20320;&#36890;&#36807;&#36825;&#31181;&#26041;&#24335;&#20250;&#21457;&#29616;&#23427;&#20204;&#20063;&#26159;PE&#25991;&#20214;&#65292;<strong class=" ">&#25152;&#20197;&#25105;&#20204;&#19981;&#35201;&#21482;&#30475;&#21518;&#32512;&#21517;&#26469;&#35748;&#23450;&#26159;&#19981;&#26159;PE&#25991;&#20214;&#65292;&#32780;&#35201;&#20855;&#20307;&#21435;&#30475;&#25991;&#20214;&#20013;&#30340;&#25351;&#32441;</strong>&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAtUEXmlofku7bnmoTmlbTkvZPnu5PmnoQ">
        <h2 class="heading "><span>PE&#25991;&#20214;&#30340;&#25972;&#20307;&#32467;&#26500;</span></h2>
<p   
>&#22914;&#19978;&#25152;&#36848;&#20013;&#25105;&#20204;&#21487;&#20197;&#20102;&#35299;&#21040;&#36890;&#36807;PE&#25351;&#32441;&#30340;&#26041;&#24335;&#35782;&#21035;PE&#25991;&#20214;&#65292;&#20294;&#26159;&#25105;&#21448;&#26159;&#22914;&#20309;&#30693;&#36947;&#36825;&#26159;&#21542;&#26159;&#19968;&#20010;PE&#25991;&#20214;&#30340;&#21602;&#65311;&#36825;&#26159;&#22240;&#20026;PE&#25991;&#20214;&#32467;&#26500;&#26377;&#19968;&#20010;&#35268;&#33539;&#21644;&#23450;&#20041;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#23601;&#26159;PE&#25991;&#20214;&#30340;&#25972;&#20307;&#32467;&#26500;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-11_23-57-28.png" alt="images/download/attachments/1015828/image2021-11-11_23-57-28.png" width="600"  />
    </p>
<p   
>&#22914;&#19978;&#22270;&#25152;&#31034;&#20247;&#21487;&#20197;&#21457;&#29616;PE&#25991;&#20214;&#26377;&#24456;&#22810;&#32467;&#26500;&#65292;&#20854;&#32467;&#26500;&#26684;&#24335;&#22270;&#21487;&#20197;&#35265;&#38468;&#20214;&#65306; PE&#26684;&#24335;&#22270;.pdf&#65288;&#30475;&#19978;&#21435;&#24456;&#22810;&#65292;&#20294;&#19981;&#38656;&#35201;&#23475;&#24597;&#65292;&#19968;&#27493;&#19968;&#27493;&#23398;&#19979;&#21435;&#36824;&#26159;&#38750;&#24120;&#23481;&#26131;&#29702;&#35299;&#30340;&#65289;</p>
    </div>
    </div>
    <div class="section section-1" id="src-1015828_safe-id-UEXln7rnoYAtUEXmlofku7bnmoTkuKTnp43nirbmgIE">
        <h1 class="heading "><span>PE&#25991;&#20214;&#30340;&#20004;&#31181;&#29366;&#24577;</span></h1>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAt5Li76KaB57uT5p6E5L2T">
        <h2 class="heading "><span>&#20027;&#35201;&#32467;&#26500;&#20307;</span></h2>
<p   
>&#19978;&#25991;&#20013;&#65292;&#25105;&#20204;&#20102;&#35299;&#20102;PE&#25991;&#20214;&#30340;&#25972;&#20307;&#32467;&#26500;&#65292;&#25105;&#20204;&#21487;&#20197;&#30475;&#35265;&#20854;&#20013;&#26377;&#24456;&#22810;&#32467;&#26500;&#20307;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-11_23-57-28.png" alt="images/download/attachments/1015828/image2021-11-11_23-57-28.png" width="600"  />
    </p>
<p   
>&#36825;&#20960;&#20010;&#20027;&#35201;&#32467;&#26500;&#20307;&#20998;&#21035;&#23545;&#24212;&#30340;&#23485;&#24230;&#22914;&#19979;&#25152;&#31034;&#65306;</p>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col />
                                    <col />
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>&#32467;&#26500;&#20307;</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>&#23485;&#24230;&#65288;&#23383;&#33410;&#65289;</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>IMAGE_DOS_HEADER</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>64</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>IMAGE_FILE_HEADER</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>20</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>IMAGE_OPTIONAL_HEADER32</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>224</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>IMAGE_SECTION_HEADER</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>40</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-24_15-29-0.png" alt="images/download/attachments/1015828/image2021-11-24_15-29-0.png" width="600"  />
    </p>
<p   
>&#36825;&#20123;&#32467;&#26500;&#20307;&#20320;&#37117;&#21487;&#20197;&#22312;<u class=" "><strong class=" ">Microsoft Visual Studio\VC98\Include\WINNT.H</strong></u>&#22836;&#25991;&#20214;&#20013;&#30475;&#35265;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAt5paH5Lu25YiG5p6Q">
        <h2 class="heading "><span>&#25991;&#20214;&#20998;&#26512;</span></h2>
<p   
>&#36825;&#20123;&#32467;&#26500;&#20307;&#30340;&#20855;&#20307;&#32454;&#33410;&#65292;&#22312;&#20043;&#21518;&#30340;&#31456;&#33410;&#20250;&#35814;&#32454;&#20102;&#35299;&#65292;&#29616;&#22312;&#25105;&#20204;&#21482;&#38656;&#35201;&#25353;&#29031;PE&#25991;&#20214;&#30340;&#25972;&#20307;&#32467;&#26500;&#26469;&#30475;&#19968;&#20010;PE&#25991;&#20214;&#65288;&#20351;&#29992;010 Editor&#25171;&#24320;&#25991;&#20214;&#65289;&#12290;</p>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAtRE9T6YOo5YiG">
        <h3 class="heading "><span>DOS&#37096;&#20998;</span></h3>
<p   
>&#39318;&#20808;&#26469;&#30475;&#19968;&#19979;DOS&#37096;&#20998;&#65292;&#39318;&#20808;&#26159;DOS MZ&#25991;&#20214;&#22836;<strong class=" ">IMAGE_DOS_HEADER&#32467;&#26500;</strong>&#65292;&#36825;&#20010;&#32467;&#26500;&#21344;64&#23383;&#33410;&#65292;&#25991;&#20214;&#21069;&#22235;&#34892;&#23601;&#26159;&#20102;&#65288;&#31867;&#20284;010 Editor&#36825;&#31181;&#32534;&#36753;&#22120;&#65292;<strong class=" ">&#21333;&#34892;&#37117;&#26159;16&#23383;&#33410;</strong>&#65289;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-23_16-48-7.png" alt="images/download/attachments/1015828/image2021-11-23_16-48-7.png" width="600"  />
    </p>
<p   
>&#25509;&#30528;&#26159;DOS&#22359;&#65292;&#36825;&#20010;&#22823;&#23567;&#26159;&#19981;&#22266;&#23450;&#30340;&#65292;&#20294;&#26159;&#22312;&#19978;&#25991;&#20013;&#65292;&#25105;&#20204;&#20102;&#35299;&#21040;&#21487;&#20197;&#26681;&#25454;&#26576;&#20010;&#20540;&#23450;&#20301;&#21040;PE&#25991;&#20214;&#22836;&#65292;&#25105;&#20204;&#21487;&#20197;&#20808;&#25214;&#21040;PE&#25991;&#20214;&#22836;&#65292;<strong class=" ">&#36825;&#26679;&#22841;&#22312;&#20182;&#20204;&#20043;&#38388;&#30340;&#23601;&#26159;DOS&#22359;&#20102;</strong>&#65292;&#22312;&#36825;&#37324;&#23601;&#26159;<strong class=" ">IMAGE_DOS_HEADER&#32467;&#26500;&#20307;&#30340;e_lfanew&#25104;&#21592;</strong>&#65292;&#22914;&#19978;&#22270;&#25152;&#31034;&#36825;&#37324;&#23545;&#24212;&#30340;&#20540;&#26159;0xF8&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-23_15-53-55.png" alt="images/download/attachments/1015828/image2021-11-23_15-53-55.png" width="600"  />
    </p>
<p   
>&#25152;&#20197;&#22914;&#19979;&#22270;&#25152;&#31034;&#20013;&#65292;&#32511;&#33394;&#26694;&#26631;&#35760;&#30340;&#37096;&#20998;&#23601;&#26159;DOS&#22359;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-23_16-53-14.png" alt="images/download/attachments/1015828/image2021-11-23_16-53-14.png" width="600"  />
    </p>
    </div>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAtUEXmlofku7blpLQ">
        <h3 class="heading "><span>PE&#25991;&#20214;&#22836;</span></h3>
<p   
>&#25509;&#30528;&#26469;&#30475;PE&#25991;&#20214;&#22836;&#65292;&#20854;&#31532;&#19968;&#20010;&#26159;PE&#25991;&#20214;&#22836;&#26631;&#24535;&#65292;&#36825;&#37324;&#21344;4&#23383;&#33410;&#65292;&#20063;&#23601;&#26159;&#19978;&#25991;&#22270;&#20013;&#25152;&#31034;&#30340;0x4550&#65288;<strong class=" ">PE&#26631;&#35782;&#26159;&#19981;&#33021;&#20462;&#25913;&#30340;</strong>&#65289;&#65292;&#25152;&#20197;&#22312;&#36825;&#19981;&#36184;&#36848;&#20102;&#65307;PE&#25991;&#20214;&#22836;&#31532;&#20108;&#37096;&#20998;&#23601;&#26159;<strong class=" ">PE&#25991;&#20214;&#34920;&#22836;IMAGE_FILE_HEADER&#32467;&#26500;</strong>&#65292;&#36825;&#20010;&#32467;&#26500;&#21344;20&#23383;&#33410;&#65292;&#25105;&#20204;&#20063;&#31216;&#20043;&#20026;<strong class=" ">&#26631;&#20934;PE&#22836;</strong>&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-23_16-58-31.png" alt="images/download/attachments/1015828/image2021-11-23_16-58-31.png" width="600"  />
    </p>
<p   
>&#32487;&#32493;&#30475;PE&#25991;&#20214;&#22836;&#30340;&#31532;&#19977;&#20010;&#37096;&#20998;PE&#25991;&#20214;&#34920;&#22836;&#21487;&#36873;&#37096;&#20998;&#65292;&#25105;&#20204;&#20063;&#31216;&#20043;&#20026;&#25193;&#23637;PE&#22836;&#65292;&#20854;&#23601;&#26159;<strong class=" ">IMAGE_OPTIONAL_HEADER32&#32467;&#26500;</strong>&#65292;&#40664;&#35748;&#24773;&#20917;&#19979;<strong class=" ">&#23427;&#22312;32&#20301;&#19979;&#26159;224&#23383;&#33410;&#65292;&#22312;64&#20301;&#19979;&#26159;240&#23383;&#33410;</strong>&#65292;&#20320;&#20063;&#21487;&#20197;&#36890;&#36807;<strong class=" ">IMAGE_FILE_HEADER&#32467;&#26500;&#30340;&#25104;&#21592;&#21435;&#33719;&#21462;/&#20462;&#25913;</strong>&#25193;&#23637;PE&#22836;&#30340;&#23485;&#24230;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-23_17-9-45.png" alt="images/download/attachments/1015828/image2021-11-23_17-9-45.png" width="600"  />
    </p>
<p   
>&#22312;&#36825;&#37324;&#20063;&#23601;&#23545;&#24212;&#30528;&#22914;&#19979;&#22270;&#20013;&#30340;0xF0&#65288;&#22240;&#20026;&#24403;&#21069;&#31995;&#32479;&#21644;&#25991;&#20214;&#37117;&#26159;64&#20301;&#30340;&#65289;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-23_17-10-21.png" alt="images/download/attachments/1015828/image2021-11-23_17-10-21.png" width="600"  />
    </p>
<p   
>&#20063;&#23601;&#34920;&#31034;&#22312;&#36825;&#37324;&#25193;&#23637;PE&#22836;&#30340;&#23485;&#24230;&#23601;&#26159;240&#23383;&#33410;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-23_17-11-58.png" alt="images/download/attachments/1015828/image2021-11-23_17-11-58.png" width="600"  />
    </p>
<p   
>&#25193;&#23637;PE&#22836;&#20043;&#25152;&#20197;&#25968;&#25454;&#23485;&#24230;&#36739;&#22823;&#65292;&#26159;&#22240;&#20026;&#20854;&#26377;&#19968;&#20010;&#25104;&#21592;&#26159;&#32467;&#26500;&#20307;&#25968;&#32452;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-23_17-14-29.png" alt="images/download/attachments/1015828/image2021-11-23_17-14-29.png" width="600"  />
    </p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#define IMAGE_NUMBEROF_DIRECTORY_ENTRIES </code><code class="value">16</code></div>
</div>
    </div>
<p   
>&#36825;&#20010;&#25104;&#21592;&#30340;&#23485;&#24230;&#23601;&#26159;16&#20010;<strong class=" ">IMAGE_DATA_DIRECTORY</strong>&#32467;&#26500;&#20307;&#30340;&#23485;&#24230;&#12290;</p>
    </div>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAt6IqC6KGo44CB6IqC5pWw5o2u">
        <h3 class="heading "><span>&#33410;&#34920;&#12289;&#33410;&#25968;&#25454;</span></h3>
<p   
>&#33410;&#34920;&#24456;&#37325;&#35201;&#65292;&#20854;&#20915;&#23450;&#33410;&#25968;&#25454;&#30340;&#30456;&#20851;&#23646;&#24615;&#65292;&#32780;&#33410;&#25968;&#25454;&#26159;&#25105;&#20204;&#30495;&#27491;&#23384;&#20648;&#25968;&#25454;&#30340;&#22320;&#26041;&#65292;&#20854;&#25968;&#37327;&#21644;&#33410;&#34920;&#26159;&#23545;&#24212;&#30340;&#12290;</p>
<p   
>&#33410;&#34920;&#23601;&#26159;N&#20010;<strong class=" ">IMAGE_SECTION_HEADER&#32467;&#26500;&#20307;</strong>&#32452;&#25104;&#30340;&#65292;&#35813;&#32467;&#26500;&#20307;&#25968;&#25454;&#23485;&#24230;&#26159;40&#23383;&#33410;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-23_17-23-58.png" alt="images/download/attachments/1015828/image2021-11-23_17-23-58.png" width="600"  />
    </p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#22312;&#35813;PE&#25991;&#20214;&#20013;&#30475;&#19968;&#19979;&#26377;&#22810;&#23569;&#20010;<strong class=" ">IMAGE_SECTION_HEADER&#32467;&#26500;&#20307;</strong>&#65292;&#22914;&#19979;&#22270;&#29992;&#19981;&#21516;&#39068;&#33394;&#26631;&#35760;&#30340;&#23601;&#26159;&#27599;&#20010;&#33410;&#65292;&#20854;&#23454;&#36890;&#36807;&#32534;&#36753;&#22120;&#21491;&#36793;&#30340;&#20869;&#23481;&#20320;&#23601;&#21487;&#20197;&#22823;&#33268;&#30693;&#36947;&#27599;&#20010;&#33410;&#30340;&#34920;&#31034;&#20160;&#20040;&#31867;&#22411;&#20102;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-23_17-31-41.png" alt="images/download/attachments/1015828/image2021-11-23_17-31-41.png" width="600"  />
    </p>
<p   
>&#22312;&#24403;&#21069;PE&#25991;&#20214;&#20013;&#25105;&#20204;&#21487;&#20197;&#30693;&#36947;&#26377;6&#20010;&#33410;&#34920;&#65292;&#37027;&#20063;&#23601;&#34920;&#31034;&#22312;&#25991;&#20214;&#20013;&#23384;&#20648;&#25968;&#25454;&#30340;&#20063;&#23601;&#26377;6&#20010;&#37096;&#20998;&#65292;&#22312;&#33410;&#34920;&#20043;&#21518;&#30340;&#23601;&#26159;&#32534;&#35793;&#22120;&#30340;&#25554;&#20837;&#30340;&#25968;&#25454;&#65292;&#32780;&#32534;&#35793;&#22120;&#21448;&#26159;&#22914;&#20309;&#30693;&#36947;&#20174;&#21738;&#24320;&#22987;&#25554;&#20837;&#25968;&#25454;&#21602;&#65311;&#36825;&#23454;&#38469;&#19978;&#21462;&#20915;&#20110;&#19968;&#20010;&#25193;&#23637;PE&#22836;&#30340;&#19968;&#20010;&#25104;&#21592;<strong class=" ">SizeOfHeaders</strong>&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-23_17-40-15.png" alt="images/download/attachments/1015828/image2021-11-23_17-40-15.png" width="600"  />
    </p>
<p   
>&#35813;&#25104;&#21592;&#29992;&#26469;&#34920;&#31034;<strong class=" ">DOS&#22836;&#12289;PE&#22836;&#19982;&#33410;&#34920;&#21152;&#36215;&#26469;&#25353;&#29031;&#25991;&#20214;&#23545;&#40784;&#20197;&#21518;&#30340;&#22823;&#23567;</strong>&#12290;&#36825;&#20010;&#30495;&#27491;&#30340;&#22823;&#23567;&#23454;&#38469;&#19978;&#21462;&#20915;&#20110;&#21478;&#22806;&#19968;&#20010;&#25104;&#21592;<strong class=" ">FileAlignment</strong>&#65292;<strong class=" ">SizeOfHeaders</strong>&#23384;&#20648;&#30340;&#25968;&#20540;&#19968;&#23450;&#26159;<strong class=" ">FileAlignment</strong>&#30340;&#25972;&#25968;&#20493;&#65292;&#40664;&#35748;&#24773;&#20917;&#19979;&#35813;&#25104;&#21592;&#30340;&#20540;&#20026;0x200&#12290;</p>
<p   
>&#20551;&#35774;&#24403;&#21069;<strong class=" ">DOS&#22836;&#12289;PE&#22836;&#19982;&#33410;&#34920;&#21152;&#36215;&#26469;&#30340;&#23485;&#24230;&#20026;302&#65292;&#32780;&#25104;&#21592;FileAlignment&#30340;&#20540;&#20026;200&#65292;&#36825;&#26102;&#20505;&#25104;&#21592;SizeOfHeaders&#30340;&#20540;&#25353;FileAlignment&#30340;&#20540;&#36827;&#34892;&#25991;&#20214;&#23545;&#40784;&#23601;&#24212;&#35813;&#26159;400&#65292;</strong>&#32780;&#20043;&#25152;&#20197;&#38656;&#35201;&#25991;&#20214;&#23545;&#40784;&#26159;&#20026;&#20102;&#25552;&#39640;&#25191;&#34892;&#25928;&#29575;&#65292;&#36825;&#26159;&#19968;&#20010;<strong class=" ">&#29306;&#29298;&#31354;&#38388;&#25442;&#26102;&#38388;</strong>&#30340;&#19968;&#31181;&#31574;&#30053;&#65292;&#25105;&#20204;&#21487;&#20197;&#22312;&#24403;&#21069;PE&#25991;&#20214;&#20013;&#26597;&#30475;&#36825;&#20004;&#20010;&#25104;&#21592;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-23_20-48-0.png" alt="images/download/attachments/1015828/image2021-11-23_20-48-0.png" width="600"  />
    </p>
<p   
>&#36825;&#20004;&#20010;&#25104;&#21592;&#21018;&#22909;&#19982;&#25105;&#20204;&#20551;&#35774;&#30340;&#20540;&#26159;&#19968;&#26679;&#30340;&#65292;&#25152;&#20197;&#36825;&#37324;<strong class=" ">DOS&#22836;&#12289;PE&#22836;&#19982;&#33410;&#34920;&#21152;&#36215;&#26469;&#25353;&#29031;&#25991;&#20214;&#23545;&#40784;&#20197;&#21518;&#30340;&#22823;&#23567;</strong>&#23601;&#26159;400&#65292;&#20294;&#36825;&#26679;&#30830;&#23454;&#27604;&#23454;&#38469;&#22823;&#23567;&#35201;&#22810;&#20986;&#19968;&#20123;&#31354;&#38388;&#65292;&#36825;&#20123;&#31354;&#38388;&#40664;&#35748;&#20250;&#29992;0x00&#22635;&#20805;&#65292;&#20294;&#20063;&#26377;&#21487;&#33021;&#36825;&#20123;&#31354;&#38388;&#20250;&#34987;&#32534;&#35793;&#22120;&#25554;&#20837;&#19968;&#20123;&#20449;&#24687;&#65292;&#25509;&#30528;<strong class=" ">&#22312;400&#22320;&#22336;&#20043;&#21518;&#30340;&#23601;&#26159;&#33410;&#25968;&#25454;&#20102;</strong>&#12290;</p>
    </div>
    </div>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAt6Z2Z5Yqo5oCB5beu5byC">
        <h2 class="heading "><span>&#38745;&#21160;&#24577;&#24046;&#24322;</span></h2>
<p   
>PE&#25991;&#20214;&#22312;&#36816;&#34892;&#21069;&#65288;&#38745;&#24577;&#65292;&#23384;&#20648;&#22312;&#30913;&#30424;&#19978;&#65289;&#21644;&#36816;&#34892;&#26102;&#65288;&#21160;&#24577;&#65292;&#36816;&#34892;&#22312;&#20869;&#23384;&#20013;&#65289;&#30340;&#26684;&#24335;&#26159;&#26377;&#24046;&#24322;&#30340;&#65292;<strong class=" ">&#36825;&#31181;&#24046;&#24322;&#23545;&#20110;&#25105;&#20204;&#29702;&#35299;PE&#25991;&#20214;&#26159;&#22914;&#20309;&#25191;&#34892;&#30340;&#26469;&#35828;&#24456;&#37325;&#35201;</strong>&#12290;</p>
<p   
>&#25105;&#20204;&#22312;&#20043;&#21069;&#30340;&#25991;&#20214;&#20998;&#26512;&#36807;&#31243;&#20013;&#23454;&#38469;&#19978;&#25152;&#30475;&#21040;&#30340;&#26159;&#38745;&#24577;&#30340;&#20869;&#23481;&#65292;&#20854;&#22823;&#23567;&#26159;&#35201;&#26681;&#25454;<strong class=" ">FileAlignment&#30340;&#20540;</strong>&#36827;&#34892;&#25991;&#20214;&#23545;&#40784;&#30340;&#65292;&#20294;&#26159;&#22312;&#36816;&#34892;&#26102;&#21017;&#25972;&#20307;&#25353;&#29031;&#25193;&#23637;PE&#22836;&#30340;<strong class=" ">&#25104;&#21592;</strong><strong class=" ">SectionAlignment&#30340;&#20540;</strong>&#36827;&#34892;&#20869;&#23384;&#23545;&#40784;&#65292;&#40664;&#35748;&#24773;&#20917;&#19979;&#35813;&#20540;&#20026;0x100&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-23_22-0-33.png" alt="images/download/attachments/1015828/image2021-11-23_22-0-33.png" width="600"  />
    </p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#23454;&#38469;&#35266;&#23519;&#19968;&#19979;&#22312;&#20869;&#23384;&#20013;&#30340;PE&#25991;&#20214;&#65292;&#39318;&#20808;&#25171;&#24320;&#35760;&#20107;&#26412;&#65292;&#28982;&#21518;&#22312;Winhex&#20013;&#36825;&#26679;&#36873;&#25321;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-23_22-38-50.png" alt="images/download/attachments/1015828/image2021-11-23_22-38-50.png" width="600"  />
    </p>
<p   
>&#28982;&#21518;&#25214;&#21040;&#23545;&#24212;&#30340;&#25193;&#23637;PE&#22836;&#30340;&#25104;&#21592;<strong class=" ">SectionAlignment&#30340;&#20540;</strong>&#65292;&#36825;&#37324;&#23601;&#26159;&#40664;&#35748;&#30340;0x1000&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-23_22-49-52.png" alt="images/download/attachments/1015828/image2021-11-23_22-49-52.png" width="600"  />
    </p>
    </div>
    </div>
    <div class="section section-1" id="src-1015828_safe-id-UEXln7rnoYAtUEXmlofku7bmlbTkvZPnu5PmnoTop6PmnpA">
        <h1 class="heading "><span>PE&#25991;&#20214;&#25972;&#20307;&#32467;&#26500;&#35299;&#26512;</span></h1>
<p   
>&#20043;&#21069;&#25105;&#20204;&#24050;&#32463;&#25353;&#29031;PE&#25991;&#20214;&#30340;&#25972;&#20307;&#32467;&#26500;&#23545;&#23454;&#38469;&#30340;PE&#25991;&#20214;&#36827;&#34892;&#20102;&#22823;&#33268;&#19978;&#30340;&#20102;&#35299;&#20102;&#65292;&#29616;&#22312;&#25105;&#20204;&#38656;&#35201;&#26469;&#30475;&#30475;&#27599;&#20010;&#32467;&#26500;&#30340;&#24847;&#20041;&#21644;&#20316;&#29992;&#12290;</p>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAtRE9T5aS0">
        <h2 class="heading "><span>DOS&#22836;</span></h2>
<p   
>&#22312;&#20043;&#21069;&#65292;&#25105;&#20204;&#24050;&#32463;&#20102;&#35299;&#36807;PE&#25991;&#20214;&#30340;&#25972;&#20307;&#32467;&#26500;&#20102;&#65292;&#24182;&#19988;&#25105;&#20204;&#36827;&#34892;&#20102;&#38745;&#21160;&#24577;&#24046;&#24322;&#30340;&#25991;&#20214;&#20998;&#26512;&#65292;&#20854;&#24320;&#22836;&#37096;&#20998;&#23601;&#26159;DOS&#37096;&#20998;&#65292;&#21253;&#21547;&#20102;DOS MZ&#25991;&#20214;&#22836;&#21644;DOS&#22359;&#65292;&#37027;&#20040;&#25105;&#20204;&#26469;&#20102;&#35299;&#19968;&#20123;DOS&#37096;&#20998;&#30340;&#32467;&#26500;&#21644;&#20854;&#30456;&#20851;&#24847;&#20041;&#12290;</p>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAtRE9TTVrmlofku7blpLQ">
        <h3 class="heading "><span>DOS MZ&#25991;&#20214;&#22836;</span></h3>
<p   
>DOS MZ&#25991;&#20214;&#22836;&#23601;&#26159;&#19968;&#20010;&#32467;&#26500;&#20307;IMAGE_DOS_HEADER&#65292;&#20854;&#23450;&#20041;&#22914;&#19979;&#25152;&#31034;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">typedef struct _IMAGE_DOS_HEADER {      </code><code class="comments">// DOS .EXE header</code></div>
<div class="line"><code class="plain">    WORD   e_magic;                     </code><code class="comments">// Magic number</code></div>
<div class="line"><code class="plain">    WORD   e_cblp;                      </code><code class="comments">// Bytes on last page of file</code></div>
<div class="line"><code class="plain">    WORD   e_cp;                        </code><code class="comments">// Pages in file</code></div>
<div class="line"><code class="plain">    WORD   e_crlc;                      </code><code class="comments">// Relocations</code></div>
<div class="line"><code class="plain">    WORD   e_cparhdr;                   </code><code class="comments">// Size of header in paragraphs</code></div>
<div class="line"><code class="plain">    WORD   e_minalloc;                  </code><code class="comments">// Minimum extra paragraphs needed</code></div>
<div class="line"><code class="plain">    WORD   e_maxalloc;                  </code><code class="comments">// Maximum extra paragraphs needed</code></div>
<div class="line"><code class="plain">    WORD   e_ss;                        </code><code class="comments">// Initial (relative) SS value</code></div>
<div class="line"><code class="plain">    WORD   e_sp;                        </code><code class="comments">// Initial SP value</code></div>
<div class="line"><code class="plain">    WORD   e_csum;                      </code><code class="comments">// Checksum</code></div>
<div class="line"><code class="plain">    WORD   e_ip;                        </code><code class="comments">// Initial IP value</code></div>
<div class="line"><code class="plain">    WORD   e_cs;                        </code><code class="comments">// Initial (relative) CS value</code></div>
<div class="line"><code class="plain">    WORD   e_lfarlc;                    </code><code class="comments">// File address of relocation table</code></div>
<div class="line"><code class="plain">    WORD   e_ovno;                      </code><code class="comments">// Overlay number</code></div>
<div class="line"><code class="plain">    WORD   e_res[</code><code class="value">4</code><code class="plain">];                    </code><code class="comments">// Reserved words</code></div>
<div class="line"><code class="plain">    WORD   e_oemid;                     </code><code class="comments">// OEM identifier (for e_oeminfo)</code></div>
<div class="line"><code class="plain">    WORD   e_oeminfo;                   </code><code class="comments">// OEM information; e_oemid specific</code></div>
<div class="line"><code class="plain">    WORD   e_res2[</code><code class="value">10</code><code class="plain">];                  </code><code class="comments">// Reserved words</code></div>
<div class="line"><code class="plain">    LONG   e_lfanew;                    </code><code class="comments">// File address of new exe header</code></div>
<div class="line"><code class="plain">  } IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER;</code></div>
</div>
    </div>
<p   
>&#23427;&#26377;&#24456;&#22810;&#25104;&#21592;&#65292;&#20294;&#25105;&#20204;&#24182;&#19981;&#38656;&#35201;&#21435;&#28145;&#20837;&#30340;&#29702;&#35299;&#27599;&#20010;&#25104;&#21592;&#30340;&#21547;&#20041;&#21644;&#20316;&#29992;&#65292;&#36825;&#26159;&#22240;&#20026;&#36825;&#20010;&#32467;&#26500;&#20307;&#26159;&#32473;16&#20301;&#24179;&#21488;&#30475;&#30340;&#65292;&#32780;&#25105;&#20204;&#29616;&#22312;&#30340;&#29615;&#22659;&#22823;&#37096;&#20998;&#37117;&#26159;32&#20301;&#21644;64&#20301;&#30340;&#65292;&#25152;&#20197;&#29616;&#22312;&#30340;&#24179;&#21488;&#19981;&#20877;&#38656;&#35201;&#36825;&#20010;&#23436;&#25972;&#30340;&#32467;&#26500;&#20307;&#20102;&#65292;&#21482;&#38656;&#35201;&#20854;&#20013;&#30340;&#20004;&#20010;&#25104;&#21592;e_magic&#21644;e_lfanew&#12290;</p>
<p   
>&#20320;&#21487;&#20197;&#23581;&#35797;&#22312;16&#36827;&#21046;&#30340;&#32534;&#36753;&#22120;&#20013;&#21435;&#32534;&#36753;&#26576;&#20010;EXE&#25991;&#20214;&#20445;&#30041;&#20004;&#20010;&#25104;&#21592;e_magic&#21644;e_lfanew&#65292;&#20854;&#20182;&#30340;&#20197;0x00&#22635;&#20805;&#65292;&#28982;&#21518;&#20445;&#23384;&#25991;&#20214;&#65292;&#20320;&#20250;&#21457;&#29616;&#20462;&#25913;&#21518;&#30340;&#25991;&#20214;&#36824;&#26159;&#21487;&#20197;&#27491;&#24120;&#36816;&#34892;&#30340;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-23_23-4-14.png" alt="images/download/attachments/1015828/image2021-11-23_23-4-14.png" width="600"  />
    </p>
<p   
>&#20445;&#30041;&#36825;&#20004;&#20010;&#25104;&#21592;&#30340;&#21407;&#22240;&#26159;&#22240;&#20026;&#23427;&#20204;&#20195;&#34920;&#30528;&#25105;&#20204;&#20043;&#21069;&#25152;&#35828;&#30340;PE&#25351;&#32441;&#65292;&#25805;&#20316;&#31995;&#32479;&#20063;&#26159;&#26681;&#25454;&#36825;&#20010;&#26469;&#35782;&#21035;&#26159;&#21542;&#26159;PE&#25991;&#20214;&#30340;&#65292;&#25152;&#20197;&#19981;&#33021;&#22815;&#26356;&#25913;&#12289;&#21024;&#38500;&#65288;<strong class=" ">e_magic&#26159;&#19968;&#31181;&#26631;&#35782;&#65292;e_lfanew&#21017;&#34920;&#31034;PE&#25991;&#20214;&#22836;&#30340;&#20301;&#32622;</strong>&#65289;&#12290;</p>
    </div>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAtRE9T5Z2X">
        <h3 class="heading "><span>DOS&#22359;</span></h3>
<p   
>DOS&#22359;&#23601;&#26159;&#22841;&#22312;DOS MZ&#25991;&#20214;&#22836;&#21644;PE&#25991;&#20214;&#22836;&#20043;&#38388;&#30340;&#20869;&#23481;&#65292;&#36825;&#37324;&#38754;&#30340;&#20869;&#23481;&#21487;&#20197;&#26681;&#25454;&#33258;&#24049;&#30340;&#38656;&#35201;&#38543;&#24847;&#30340;&#20462;&#25913;&#21644;&#28155;&#21152;&#65292;&#24182;&#19981;&#20250;&#24433;&#21709;&#25991;&#20214;&#30340;&#27491;&#24120;&#36816;&#34892;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-23_23-9-26.png" alt="images/download/attachments/1015828/image2021-11-23_23-9-26.png" width="600"  />
    </p>
    </div>
    </div>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAtUEXlpLQ">
        <h2 class="heading "><span>PE&#22836;</span></h2>
<p   
>PE&#22836;&#25972;&#20307;&#23601;&#26159;&#22914;&#19979;&#36825;&#20010;&#32467;&#26500;&#20307;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">typedef struct _IMAGE_NT_HEADERS {</code></div>
<div class="line"><code class="plain">    DWORD Signature; </code><code class="comments">// PE标识</code></div>
<div class="line"><code class="plain">    IMAGE_FILE_HEADER FileHeader; </code><code class="comments">// 标准PE头</code></div>
<div class="line"><code class="plain">    IMAGE_OPTIONAL_HEADER32 OptionalHeader; </code><code class="comments">// 扩展PE头</code></div>
<div class="line"><code class="plain">} IMAGE_NT_HEADERS32, *PIMAGE_NT_HEADERS32;</code></div>
</div>
    </div>
<p   
>&#31532;&#19968;&#20010;&#25104;&#21592;&#23601;&#26159;PE&#26631;&#35782;&#65292;&#35813;&#26631;&#35782;&#19981;&#33021;&#30772;&#22351;&#65292;&#22240;&#20026;&#25805;&#20316;&#31995;&#32479;&#22312;&#21551;&#21160;&#19968;&#20010;&#31243;&#24207;&#30340;&#26102;&#20505;&#20250;&#26816;&#27979;&#36825;&#20010;&#26631;&#35782;&#12290;</p>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAt5qCH5YeGUEXlpLQ">
        <h3 class="heading "><span>&#26631;&#20934;PE&#22836;</span></h3>
<p   
>&#26631;&#20934;PE&#22836;&#26159;PE&#22836;&#30340;&#31532;&#20108;&#20010;&#25104;&#21592;&#65292;&#23427;&#26159;&#22914;&#19979;&#25152;&#31034;&#30340;&#32467;&#26500;&#20307;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">typedef struct _IMAGE_FILE_HEADER {</code></div>
<div class="line"><code class="plain">    WORD    Machine; </code><code class="comments">// 可以运行在什么样的CPU上</code></div>
<div class="line"><code class="plain">    WORD    NumberOfSections; </code><code class="comments">// 表示节的数量</code></div>
<div class="line"><code class="plain">    DWORD   TimeDateStamp; </code><code class="comments">// 编译器填写的时间戳</code></div>
<div class="line"><code class="plain">    DWORD   PointerToSymbolTable; </code><code class="comments">// 调试相关</code></div>
<div class="line"><code class="plain">    DWORD   NumberOfSymbols; </code><code class="comments">// 调试相关</code></div>
<div class="line"><code class="plain">    WORD    SizeOfOptionalHeader; </code><code class="comments">// 扩展PE头的大小</code></div>
<div class="line"><code class="plain">    WORD    Characteristics; </code><code class="comments">// 文件属性</code></div>
<div class="line"><code class="plain">} IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;</code></div>
</div>
    </div>
<p   
>&#20854;&#31532;&#19968;&#20010;&#25104;&#21592;Machine&#34920;&#31034;&#21487;&#20197;&#36816;&#34892;&#22312;&#20160;&#20040;&#26679;&#30340;CPU&#19978;&#65292;<strong class=" ">&#22914;&#26524;&#23427;&#30340;&#20540;&#20026;0x0&#21017;&#34920;&#31034;&#21487;&#20197;&#36816;&#34892;&#22312;&#20219;&#24847;&#30340;CPU&#19978;&#65292;&#25903;&#25345;&#22312;Intel 386&#20197;&#21450;&#21518;&#32493;&#30340;&#22411;&#21495;CPU&#36816;&#34892;&#21017;&#20540;&#20026;0x14c&#65292;&#25903;&#25345;64&#20301;&#30340;CPU&#22411;&#21495;&#21017;&#20540;&#20026;0x8664</strong>&#12290;</p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#20998;&#21035;&#22312;32&#20301;&#12289;64&#20301;&#31995;&#32479;&#19978;&#25552;&#21462;notepad.exe&#36827;&#34892;&#23545;&#27604;&#26469;&#30475;&#30475;&#36825;&#20010;&#25104;&#21592;&#65288;010 Editor &rarr; Tools &rarr; Compare Files...&#65289;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-24_10-59-51.png" alt="images/download/attachments/1015828/image2021-11-24_10-59-51.png" width="600"  />
    </p>
<p   
>&#31532;&#20108;&#20010;&#25104;&#21592;<strong class=" ">NumberOfSections&#34920;&#31034;&#24403;&#21069;PE&#25991;&#20214;&#20013;&#33410;&#30340;&#25968;&#37327;</strong>&#65292;&#20063;&#23601;&#26159;&#33410;&#34920;&#20013;&#26377;&#20960;&#20010;&#32467;&#26500;&#20307;&#65307;&#31532;&#19977;&#20010;&#25104;&#21592;<strong class=" ">TimeDateStamp&#34920;&#31034;&#32534;&#35793;&#22120;&#32534;&#35793;&#30340;&#26102;&#20505;&#25554;&#20837;&#30340;&#26102;&#38388;&#25139;</strong>&#65292;&#19982;&#25991;&#20214;&#23646;&#24615;&#37324;&#38754;&#30340;&#21019;&#24314;&#26102;&#38388;&#21644;&#20462;&#25913;&#26102;&#38388;&#26159;&#26080;&#20851;&#30340;&#12290;</p>
<p   
>&#31532;&#22235;&#12289;&#31532;&#20116;&#20010;&#25104;&#21592;&#26159;&#35843;&#35797;&#30456;&#20851;&#30340;&#65292;&#25105;&#20204;&#26242;&#26102;&#19981;&#29992;&#21435;&#20102;&#35299;&#65307;&#31532;&#20845;&#20010;&#25104;<strong class=" ">&#21592;SizeOfOptionalHeader&#34920;&#31034;&#25193;&#23637;PE&#22836;&#30340;&#22823;&#23567;</strong>&#65292;<strong class=" ">&#40664;&#35748;&#24773;&#20917;&#19979;32&#20301;PE&#25991;&#20214;&#23545;&#24212;&#20540;&#20301;0xE0&#65292;64&#20301;PE&#25991;&#20214;&#23545;&#24212;&#20540;&#20026;0xF0</strong>&#12290;</p>
<p   
>&#31532;&#19971;&#20010;&#25104;&#21592;<strong class=" ">Characteristics&#29992;&#26469;&#35760;&#24405;&#24403;&#21069;PE&#25991;&#20214;&#30340;&#19968;&#20123;&#23646;&#24615;</strong>&#65292;&#35813;&#25104;&#21592;&#26159;16&#20301;&#65288;2&#23383;&#33410;&#65289;&#22823;&#23567;&#65292;&#20854;&#27599;&#19968;&#25968;&#25454;&#20301;&#23545;&#24212;&#30340;&#23646;&#24615;&#22914;&#19979;&#25152;&#31034;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-24_14-52-7.png" alt="images/download/attachments/1015828/image2021-11-24_14-52-7.png" width="600"  />
    </p>
    </div>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAt5omp5bGVUEXlpLQ">
        <h3 class="heading "><span>&#25193;&#23637;PE&#22836;</span></h3>
<p   
>&#25193;&#23637;PE&#22836;&#22312;32&#20301;&#21644;64&#20301;&#29615;&#22659;&#19979;&#26159;&#19981;&#19968;&#26679;&#30340;&#65292;&#22312;&#26412;&#31456;&#33410;&#20013;&#21482;&#20171;&#32461;32&#20301;&#25193;&#23637;PE&#22836;&#12290;&#22914;&#19979;&#32467;&#26500;&#20307;&#23601;&#26159;32&#20301;&#30340;&#25193;&#23637;PE&#22836;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">typedef struct _IMAGE_OPTIONAL_HEADER {</code></div>
<div class="line"><code class="plain">    WORD    Magic; </code><code class="comments">// PE32：10B PE32+：20B</code></div>
<div class="line"><code class="plain">    BYTE    MajorLinkerVersion; </code><code class="comments">// 链接器版本号</code></div>
<div class="line"><code class="plain">    BYTE    MinorLinkerVersion; </code><code class="comments">// 链接器版本号</code></div>
<div class="line"><code class="plain">    DWORD   SizeOfCode; </code><code class="comments">// 所有代码节的总和（文件对齐后的大小），编译器填的（没用）</code></div>
<div class="line"><code class="plain">    DWORD   SizeOfInitializedData; </code><code class="comments">// 包含所有已经初始化数据的节的总大小（文件对齐后的大小），编译器填的（没用）</code></div>
<div class="line"><code class="plain">    DWORD   SizeOfUninitializedData; </code><code class="comments">// 包含未初始化数据的节的总大小（文件对齐后的大小），编译器填的（没用）</code></div>
<div class="line"><code class="plain">    DWORD   AddressOfEntryPoint; </code><code class="comments">// 程序入口</code></div>
<div class="line"><code class="plain">    DWORD   BaseOfCode; </code><code class="comments">// 代码开始的基址，编译器填的（没用）</code></div>
<div class="line"><code class="plain">    DWORD   BaseOfData; </code><code class="comments">// 数据开始的基址，编译器填的（没用）</code></div>
<div class="line"><code class="plain">    DWORD   ImageBase; </code><code class="comments">// 内存镜像基址</code></div>
<div class="line"><code class="plain">    DWORD   SectionAlignment; </code><code class="comments">// 内存对齐</code></div>
<div class="line"><code class="plain">    DWORD   FileAlignment; </code><code class="comments">// 文件对齐</code></div>
<div class="line"><code class="plain">    WORD    MajorOperatingSystemVersion; </code><code class="comments">// 标识操作系统版本号，主版本号</code></div>
<div class="line"><code class="plain">    WORD    MinorOperatingSystemVersion; </code><code class="comments">// 标识操作系统版本号，次版本号</code></div>
<div class="line"><code class="plain">    WORD    MajorImageVersion; </code><code class="comments">// PE文件自身的版本号 </code></div>
<div class="line"><code class="plain">    WORD    MinorImageVersion; </code><code class="comments">// PE文件自身的版本号</code></div>
<div class="line"><code class="plain">    WORD    MajorSubsystemVersion; </code><code class="comments">// 运行所需子系统版本号</code></div>
<div class="line"><code class="plain">    WORD    MinorSubsystemVersion; </code><code class="comments">// 运行所需子系统版本号</code></div>
<div class="line"><code class="plain">    DWORD   Win32VersionValue; </code><code class="comments">// 子系统版本的值，必须为0</code></div>
<div class="line"><code class="plain">    DWORD   SizeOfImage; </code><code class="comments">// 内存中整个PE文件的映射的尺寸</code></div>
<div class="line"><code class="plain">    DWORD   SizeOfHeaders; </code><code class="comments">// 所有头加节表按照文件对齐后的大小，否则加载会出错</code></div>
<div class="line"><code class="plain">    DWORD   CheckSum; </code><code class="comments">// 校验和</code></div>
<div class="line"><code class="plain">    WORD    Subsystem; </code><code class="comments">// 子系统，驱动程序(1)、图形界面(2) 、控制台/DLL(3)</code></div>
<div class="line"><code class="plain">    WORD    DllCharacteristics; </code><code class="comments">// 文件特性</code></div>
<div class="line"><code class="plain">    DWORD   SizeOfStackReserve; </code><code class="comments">// 初始化时保留的栈大小 </code></div>
<div class="line"><code class="plain">    DWORD   SizeOfStackCommit; </code><code class="comments">// 初始化时实际提交的大小 </code></div>
<div class="line"><code class="plain">    DWORD   SizeOfHeapReserve; </code><code class="comments">// 初始化时保留的堆大小</code></div>
<div class="line"><code class="plain">    DWORD   SizeOfHeapCommit; </code><code class="comments">// 初始化时实践提交的大小 </code></div>
<div class="line"><code class="plain">    DWORD   LoaderFlags; </code><code class="comments">// 调试相关</code></div>
<div class="line"><code class="plain">    DWORD   NumberOfRvaAndSizes; </code><code class="comments">// 目录项数目</code></div>
<div class="line"><code class="plain">    IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES]; </code><code class="comments">// 表，结构体数组</code></div>
<div class="line"><code class="plain">} IMAGE_OPTIONAL_HEADER32, *PIMAGE_OPTIONAL_HEADER32;</code></div>
</div>
    </div>
<p   
>&#25193;&#23637;PE&#22836;&#30340;&#25104;&#21592;&#26377;&#24456;&#22810;&#65292;&#20294;&#25105;&#20204;&#19981;&#38656;&#35201;&#27599;&#20010;&#37117;&#35760;&#20303;&#65292;&#22823;&#27010;&#30340;&#20102;&#35299;&#19968;&#19979;&#21363;&#21487;&#65292;&#37325;&#28857;&#20851;&#27880;&#22914;&#19979;&#36825;&#20960;&#20010;&#25104;&#21592;&#65306;</p>
<p   
>&#25104;&#21592;<strong class=" ">Magic&#34920;&#31034;&#24403;&#21069;PE&#25991;&#20214;&#26159;32&#20301;&#36824;&#26159;64&#20301;</strong>&#65292;32&#20301;&#26102;&#35813;&#20540;&#23545;&#24212;0x10B&#65292;64&#20301;&#26102;&#35813;&#20540;&#23545;&#24212;0x20B&#12290;</p>
<p   
>&#25104;&#21592;<strong class=" ">AddressOfEntryPoint&#34920;&#31034;&#24403;&#21069;&#31243;&#24207;&#20837;&#21475;&#30340;&#22320;&#22336;</strong>&#65292;&#36825;&#20010;&#25104;&#21592;&#35201;&#19982;&#25104;&#21592;ImageBase&#30456;&#21152;&#25165;&#33021;&#24471;&#20986;&#30495;&#27491;&#30340;&#20837;&#21475;&#22320;&#22336;&#65292;&#25104;&#21592;<strong class=" ">ImageBase&#29992;&#26469;&#34920;&#31034;&#20869;&#23384;&#38236;&#20687;&#22522;&#22336;</strong>&#65292;&#20063;&#23601;&#26159;<strong class=" ">PE&#25991;&#20214;&#22312;&#20869;&#23384;&#20013;&#25353;&#20869;&#23384;&#23545;&#40784;&#23637;&#24320;&#21518;&#30340;&#39318;&#22320;&#22336;</strong>&#65292;&#25105;&#20204;&#21487;&#20197;&#22312;&#23454;&#38469;PE&#25991;&#20214;&#20013;&#30475;&#19979;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#23601;&#26159;PE&#25991;&#20214;&#38745;&#24577;&#29366;&#24577;&#19979;&#30340;&#20004;&#20010;&#25104;&#21592;&#20540;&#65292;<strong class=" ">AddressOfEntryPoint</strong>&#20026;0x739D&#65292;<strong class=" ">ImageBase</strong>&#20026;0x1000000&#65292;&#37027;&#20040;&#26368;&#32456;&#30340;&#31243;&#24207;&#22312;&#20869;&#23384;&#20013;&#30340;&#20837;&#21475;&#22320;&#22336;&#23601;&#26159;0x100739D&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-24_16-28-5.png" alt="images/download/attachments/1015828/image2021-11-24_16-28-5.png" width="600"  />
    </p>
<p   
>&#37027;&#20040;&#22914;&#20309;&#35777;&#23454;&#25512;&#26029;&#30340;&#32467;&#26524;&#26159;&#27491;&#30830;&#30340;&#21602;&#65292;&#25105;&#20204;&#21487;&#20197;&#30452;&#25509;&#20351;&#29992;DTDebug&#20043;&#31867;&#30340;&#35843;&#35797;&#22120;&#25171;&#24320;&#36825;&#20010;PE&#25991;&#20214;&#65292;&#35843;&#35797;&#22120;&#20250;&#33258;&#21160;&#22312;&#31243;&#24207;&#20837;&#21475;&#26029;&#28857;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#21017;&#34920;&#31034;&#25105;&#20204;&#30340;&#25512;&#27979;&#26159;&#27491;&#30830;&#30340;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-24_16-50-43.png" alt="images/download/attachments/1015828/image2021-11-24_16-50-43.png" width="600"  />
    </p>
<p   
>&#25104;&#21592;FileAlignment&#12289;SectionAlignment&#21644;SizeOfHeader&#22312;&#20043;&#21069;&#30340;&#31456;&#33410;&#20013;&#24050;&#32463;&#20102;&#35299;&#36807;&#20102;&#65292;&#36825;&#37324;&#19981;&#20877;&#36184;&#36848;&#12290;</p>
<p   
>&#25104;&#21592;<strong class=" ">SizeOfImage&#34920;&#31034;&#22312;&#20869;&#23384;&#20013;&#25972;&#20010;PE&#25991;&#20214;&#26144;&#23556;&#30340;&#22823;&#23567;</strong>&#65292;&#21487;&#27604;&#23454;&#38469;&#30340;&#20540;&#22823;&#65288;&#20869;&#23384;&#23545;&#40784;&#20043;&#21518;&#30340;&#22823;&#23567;&#65292;&#20063;&#23601;&#34920;&#31034;&#24517;&#39035;&#26159;SectionAlignment&#30340;&#25972;&#25968;&#20493;&#65289;&#12290;</p>
<p   
>&#25104;&#21592;<strong class=" ">CheckSum&#34920;&#31034;&#26657;&#39564;&#21644;&#65292;&#26159;&#29992;&#26469;&#21028;&#26029;&#25991;&#20214;&#26159;&#21542;&#34987;&#20462;&#25913;&#30340;</strong>&#65292;&#23427;&#30340;&#35745;&#31639;&#26041;&#27861;&#23601;&#26159;&#25991;&#20214;&#30340;&#20004;&#20010;&#23383;&#33410;&#19982;&#20004;&#20010;&#23383;&#33410;&#30456;&#21152;&#65292;&#26368;&#32456;&#30340;&#20540;&#65288;&#19981;&#32771;&#34385;&#28322;&#20986;&#24773;&#20917;&#65289;&#23601;&#26159;&#26657;&#39564;&#21644;&#12290;</p>
<p   
>&#26368;&#21518;&#19968;&#20010;&#38656;&#35201;&#25105;&#20204;&#20102;&#35299;&#30340;&#25104;&#21592;&#26159;DllCharacteristics&#65292;&#23427;&#29992;&#26469;<strong class=" ">&#34920;&#31034;PE&#25991;&#20214;&#30340;&#29305;&#24615;</strong>&#65292;&#20294;&#19981;&#35201;&#34987;&#21517;&#23383;&#25152;&#36855;&#24785;&#65292;&#23427;&#19981;&#26159;&#38024;&#23545;DLL&#25991;&#20214;&#30340;&#65307;&#23427;&#30340;&#25968;&#25454;&#23485;&#24230;&#26159;16&#20301;&#65288;4&#23383;&#33410;&#65289;&#65292;&#20854;&#27599;&#19968;&#25968;&#25454;&#20301;&#23545;&#24212;&#30340;&#23646;&#24615;&#22914;&#19979;&#25152;&#31034;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-24_17-11-3.png" alt="images/download/attachments/1015828/image2021-11-24_17-11-3.png" width="600"  />
    </p>
    </div>
    </div>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAtUEXoioLooag">
        <h2 class="heading "><span>PE&#33410;&#34920;</span></h2>
<p   
>&#22312;PE&#20013;&#65292;&#33410;&#25968;&#25454;&#26377;&#20960;&#20010;&#65292;&#20998;&#21035;&#23545;&#24212;&#30528;&#20160;&#20040;&#31867;&#22411;&#20197;&#21450;&#20854;&#20182;&#30456;&#20851;&#30340;&#23646;&#24615;&#37117;&#26159;&#30001;PE&#33410;&#34920;&#26469;&#20915;&#23450;&#30340;&#65292;PE&#33410;&#34920;&#26159;&#19968;&#20010;&#32467;&#26500;&#20307;&#25968;&#32452;&#65292;&#32467;&#26500;&#20307;&#30340;&#23450;&#20041;&#22914;&#19979;&#25152;&#31034;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#define IMAGE_SIZEOF_SHORT_NAME </code><code class="value">8</code></div>
<div class="line"><code class="plain">typedef struct _IMAGE_SECTION_HEADER {</code></div>
<div class="line"><code class="plain">    BYTE    Name[IMAGE_SIZEOF_SHORT_NAME]; </code><code class="comments">// ASCII字符串（节名），可自定义，只截取8个字节，可以8个字节都是名字</code></div>
<div class="line"><code class="plain">    union { </code><code class="comments">// Misc，双字，是该节在没有对齐前的真实尺寸，该值可以不准确</code></div>
<div class="line"><code class="plain">        DWORD   PhysicalAddress; </code><code class="comments">// 真实宽度，这两个值是一个联合结构，可以使用其中的任何一个</code></div>
<div class="line"><code class="plain">        DWORD   VirtualSize; </code><code class="comments">// 一般是取后一个</code></div>
<div class="line"><code class="plain">    } Misc;					</code></div>
<div class="line"><code class="plain">    DWORD   VirtualAddress; </code><code class="comments">// 在内存中的偏移地址，加上ImageBase才是在内存中的真正地址</code></div>
<div class="line"><code class="plain">    DWORD   SizeOfRawData; </code><code class="comments">// 节在文件中对齐后的尺寸</code></div>
<div class="line"><code class="plain">    DWORD   PointerToRawData; </code><code class="comments">// 节区在文件中的偏移</code></div>
<div class="line"><code class="plain">    DWORD   PointerToRelocations; </code><code class="comments">// 调试相关</code></div>
<div class="line"><code class="plain">    DWORD   PointerToLinenumbers; </code><code class="comments">// 调试相关 </code></div>
<div class="line"><code class="plain">    WORD    NumberOfRelocations; </code><code class="comments">// 调试相关 </code></div>
<div class="line"><code class="plain">    WORD    NumberOfLinenumbers; </code><code class="comments">// 调试相关 </code></div>
<div class="line"><code class="plain">    DWORD   Characteristics; </code><code class="comments">// 节的属性</code></div>
<div class="line"><code class="plain">} IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;</code></div>
</div>
    </div>
<p   
>&#20195;&#30721;&#20013;&#30340;&#27880;&#37322;&#21487;&#20197;&#22823;&#33268;&#20102;&#35299;&#21040;&#27599;&#20010;&#25104;&#21592;&#30340;&#20316;&#29992;&#65292;&#20854;&#20013;&#26377;2&#20010;&#25104;&#21592;&#26469;&#25551;&#36848;&#33410;&#30340;&#22823;&#23567;&#65292;&#20998;&#21035;&#26159;&#27809;&#26377;&#23545;&#40784;&#21069;&#30340;&#30495;&#23454;&#23610;&#23544;&#21644;&#23545;&#40784;&#21518;&#30340;&#23485;&#24230;&#65292;&#36825;&#26102;&#20505;&#20250;&#20986;&#29616;&#19968;&#31181;&#24773;&#20917;&#23601;&#26159;&#23545;&#40784;&#21069;&#30340;&#30495;&#23454;&#23610;&#23544;&#22823;&#20110;&#23545;&#40784;&#21518;&#30340;&#23485;&#24230;&#65292;<strong class=" ">&#36825;&#23601;&#26159;&#23384;&#22312;&#20840;&#23616;&#21464;&#37327;&#27809;&#26377;&#36171;&#20104;&#21021;&#22987;&#20540;&#23548;&#33268;&#30340;&#65292;&#22312;&#25991;&#20214;&#23384;&#20648;&#20013;&#20840;&#23616;&#21464;&#37327;&#27809;&#26377;&#36171;&#20104;&#21021;&#22987;&#20540;&#20063;&#23601;&#19981;&#21344;&#31354;&#38388;&#65292;&#20294;&#26159;&#22312;&#20869;&#23384;&#20013;&#26159;&#24517;&#39035;&#35201;&#36171;&#20104;&#21021;&#22987;&#20540;&#30340;&#65292;&#36825;&#26102;&#20505;&#23485;&#24230;&#23601;&#22823;&#20102;&#19968;&#20123;</strong>&#65292;&#25152;&#20197;&#22312;&#20869;&#23384;&#20013;&#33410;&#26159;&#35841;&#22823;&#23601;&#25353;&#29031;&#35841;&#21435;&#23637;&#24320;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-24_22-17-31.png" alt="images/download/attachments/1015828/image2021-11-24_22-17-31.png" width="600"  />
    </p>
<p   
>&#19982;&#20854;&#20182;&#32467;&#26500;&#20307;&#19968;&#26679;&#65292;PE&#33410;&#20063;&#26377;&#23646;&#24615;&#65292;&#36825;&#23601;&#26159;&#25104;&#21592;Characteristics&#65292;&#20854;&#25968;&#25454;&#23485;&#24230;&#26159;16&#20301;&#65288;4&#23383;&#33410;&#65289;&#65292;&#20854;&#27599;&#19968;&#25968;&#25454;&#20301;&#23545;&#24212;&#30340;&#23646;&#24615;&#22914;&#19979;&#25152;&#31034;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-11-24_22-19-0.png" alt="images/download/attachments/1015828/image2021-11-24_22-19-0.png" width="600"  />
    </p>
<p   
>&#26356;&#22810;&#21487;&#20197;&#21442;&#32771;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="comments">//</code></div>
<div class="line"><code class="comments">// Section characteristics.</code></div>
<div class="line"><code class="comments">//</code></div>
<div class="line"><code class="comments">//      IMAGE_SCN_TYPE_REG                   0x00000000  // Reserved.</code></div>
<div class="line"><code class="comments">//      IMAGE_SCN_TYPE_DSECT                 0x00000001  // Reserved.</code></div>
<div class="line"><code class="comments">//      IMAGE_SCN_TYPE_NOLOAD                0x00000002  // Reserved.</code></div>
<div class="line"><code class="comments">//      IMAGE_SCN_TYPE_GROUP                 0x00000004  // Reserved.</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_TYPE_NO_PAD                </code><code class="value">0x00000008</code><code class="plain">  </code><code class="comments">// Reserved.</code></div>
<div class="line"><code class="comments">//      IMAGE_SCN_TYPE_COPY                  0x00000010  // Reserved.</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">#define IMAGE_SCN_CNT_CODE                   </code><code class="value">0x00000020</code><code class="plain">  </code><code class="comments">// Section contains code.</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_CNT_INITIALIZED_DATA       </code><code class="value">0x00000040</code><code class="plain">  </code><code class="comments">// Section contains initialized data.</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_CNT_UNINITIALIZED_DATA     </code><code class="value">0x00000080</code><code class="plain">  </code><code class="comments">// Section contains uninitialized data.</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">#define IMAGE_SCN_LNK_OTHER                  </code><code class="value">0x00000100</code><code class="plain">  </code><code class="comments">// Reserved.</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_LNK_INFO                   </code><code class="value">0x00000200</code><code class="plain">  </code><code class="comments">// Section contains comments or some other type of information.</code></div>
<div class="line"><code class="comments">//      IMAGE_SCN_TYPE_OVER                  0x00000400  // Reserved.</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_LNK_REMOVE                 </code><code class="value">0x00000800</code><code class="plain">  </code><code class="comments">// Section contents will not become part of image.</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_LNK_COMDAT                 </code><code class="value">0x00001000</code><code class="plain">  </code><code class="comments">// Section contents comdat.</code></div>
<div class="line"><code class="comments">//                                           0x00002000  // Reserved.</code></div>
<div class="line"><code class="comments">//      IMAGE_SCN_MEM_PROTECTED - Obsolete   0x00004000</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_NO_DEFER_SPEC_EXC          </code><code class="value">0x00004000</code><code class="plain">  </code><code class="comments">// Reset speculative exceptions handling bits in the TLB entries for this section.</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_GPREL                      </code><code class="value">0x00008000</code><code class="plain">  </code><code class="comments">// Section content can be accessed relative to GP</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_MEM_FARDATA                </code><code class="value">0x00008000</code></div>
<div class="line"><code class="comments">//      IMAGE_SCN_MEM_SYSHEAP  - Obsolete    0x00010000</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_MEM_PURGEABLE              </code><code class="value">0x00020000</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_MEM_16BIT                  </code><code class="value">0x00020000</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_MEM_LOCKED                 </code><code class="value">0x00040000</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_MEM_PRELOAD                </code><code class="value">0x00080000</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">#define IMAGE_SCN_ALIGN_1BYTES               </code><code class="value">0x00100000</code><code class="plain">  </code><code class="comments">//</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_ALIGN_2BYTES               </code><code class="value">0x00200000</code><code class="plain">  </code><code class="comments">//</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_ALIGN_4BYTES               </code><code class="value">0x00300000</code><code class="plain">  </code><code class="comments">//</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_ALIGN_8BYTES               </code><code class="value">0x00400000</code><code class="plain">  </code><code class="comments">//</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_ALIGN_16BYTES              </code><code class="value">0x00500000</code><code class="plain">  </code><code class="comments">// Default alignment if no others are specified.</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_ALIGN_32BYTES              </code><code class="value">0x00600000</code><code class="plain">  </code><code class="comments">//</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_ALIGN_64BYTES              </code><code class="value">0x00700000</code><code class="plain">  </code><code class="comments">//</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_ALIGN_128BYTES             </code><code class="value">0x00800000</code><code class="plain">  </code><code class="comments">//</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_ALIGN_256BYTES             </code><code class="value">0x00900000</code><code class="plain">  </code><code class="comments">//</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_ALIGN_512BYTES             </code><code class="value">0x00A00000</code><code class="plain">  </code><code class="comments">//</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_ALIGN_1024BYTES            </code><code class="value">0x00B00000</code><code class="plain">  </code><code class="comments">//</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_ALIGN_2048BYTES            </code><code class="value">0x00C00000</code><code class="plain">  </code><code class="comments">//</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_ALIGN_4096BYTES            </code><code class="value">0x00D00000</code><code class="plain">  </code><code class="comments">//</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_ALIGN_8192BYTES            </code><code class="value">0x00E00000</code><code class="plain">  </code><code class="comments">//</code></div>
<div class="line"><code class="comments">// Unused                                    0x00F00000</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">#define IMAGE_SCN_LNK_NRELOC_OVFL            </code><code class="value">0x01000000</code><code class="plain">  </code><code class="comments">// Section contains extended relocations.</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_MEM_DISCARDABLE            </code><code class="value">0x02000000</code><code class="plain">  </code><code class="comments">// Section can be discarded.</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_MEM_NOT_CACHED             </code><code class="value">0x04000000</code><code class="plain">  </code><code class="comments">// Section is not cachable.</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_MEM_NOT_PAGED              </code><code class="value">0x08000000</code><code class="plain">  </code><code class="comments">// Section is not pageable.</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_MEM_SHARED                 </code><code class="value">0x10000000</code><code class="plain">  </code><code class="comments">// Section is shareable.</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_MEM_EXECUTE                </code><code class="value">0x20000000</code><code class="plain">  </code><code class="comments">// Section is executable.</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_MEM_READ                   </code><code class="value">0x40000000</code><code class="plain">  </code><code class="comments">// Section is readable.</code></div>
<div class="line"><code class="plain">#define IMAGE_SCN_MEM_WRITE                  </code><code class="value">0x80000000</code><code class="plain">  </code><code class="comments">// Section is writeable.</code></div>
</div>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-1015828_safe-id-UEXln7rnoYAtUlZB5LiORk9B55qE6L2s5o2i">
        <h1 class="heading "><span>RVA&#19982;FOA&#30340;&#36716;&#25442;</span></h1>
<p   
>&#24819;&#35937;&#19968;&#19979;&#65292;&#22914;&#26524;&#20320;&#24819;&#36890;&#36807;&#36870;&#21521;&#30340;&#26041;&#24335;&#25913;&#21464;&#19968;&#20010;&#20840;&#23616;&#21464;&#37327;&#30340;&#21021;&#22987;&#20540;&#65292;&#35813;&#24590;&#20040;&#20570;&#65311;&#39318;&#20808;&#25105;&#20204;&#21487;&#20197;&#20889;&#19968;&#20010;&#31243;&#24207;&#65292;&#36755;&#20986;&#19968;&#20010;&#20840;&#23616;&#21464;&#37327;&#30340;&#22320;&#22336;&#21644;&#20540;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> a = </code><code class="value">0x12345678</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> main() {</code></div>
<div class="line"><code class="plain">	printf(</code><code class="string">"Address: 0x%x \n"</code><code class="plain">, &amp;a);</code></div>
<div class="line"><code class="plain">	printf(</code><code class="string">"Value: 0x%x \n"</code><code class="plain">, a);</code></div>
<div class="line"><code class="plain">	getchar();</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-6_21-20-44.png" alt="images/download/attachments/1015828/image2021-12-6_21-20-44.png" width="600"  />
    </p>
<p   
>&#25105;&#20204;&#36816;&#34892;&#31243;&#24207;&#21487;&#20197;&#30475;&#35265;&#30456;&#24212;&#30340;&#20540;&#65292;&#37027;&#20040;&#25105;&#20204;&#21487;&#20197;&#26159;&#21542;&#21487;&#20197;&#22312;&#25991;&#20214;&#20013;&#30452;&#25509;&#25628;&#32034;&#23545;&#24212;&#30340;&#20540;&#28982;&#21518;&#20462;&#25913;&#21602;&#65311;&#36825;&#31181;&#26041;&#27861;&#27809;&#26377;&#27611;&#30149;&#65292;&#20294;&#26159;&#25991;&#20214;&#20013;&#20063;&#35768;&#20250;&#23384;&#22312;&#24456;&#22810;&#20010;0x12345678&#65292;&#20320;&#26080;&#27861;&#20934;&#30830;&#30340;&#30693;&#36947;&#21738;&#19968;&#20010;&#25165;&#26159;&#20840;&#23616;&#21464;&#37327;&#65307;&#37027;&#20040;&#65292;&#21448;&#26159;&#21542;&#21487;&#20197;&#36890;&#36807;&#24050;&#32463;&#32473;&#20986;&#30340;&#36825;&#20010;&#22320;&#22336;0x42ba30&#30452;&#25509;&#21435;&#23547;&#25214;&#21602;&#65311;&#24403;&#28982;&#20063;&#26159;&#19981;&#34892;&#30340;&#65292;&#22240;&#20026;&#22312;&#20043;&#21069;&#31456;&#33410;&#30340;&#23398;&#20064;&#20013;&#25105;&#20204;&#20102;&#35299;&#21040;&#65292;PE&#25991;&#20214;&#26377;2&#31181;&#29366;&#24577;&#65288;&#21160;&#38745;&#24577;&#65289;&#65292;<strong class=" ">&#22312;&#36825;2&#31181;&#29366;&#24577;&#19979;&#65292;&#25991;&#20214;&#30340;&#23545;&#40784;&#26041;&#24335;&#20250;&#21457;&#29983;&#21464;&#21270;&#65292;&#25152;&#20197;&#24403;&#21069;&#30340;&#22320;&#22336;&#26159;PE&#25991;&#20214;&#36816;&#34892;&#26102;&#65288;&#21160;&#24577;&#65289;&#30340;&#22320;&#22336;&#65292;&#20320;&#38656;&#35201;&#36716;&#25442;&#25104;&#22312;&#30913;&#30424;&#19978;&#65288;&#38745;&#24577;&#65289;&#30340;&#22320;&#22336;</strong>&#12290;<br/><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-6_21-35-26.png" alt="images/download/attachments/1015828/image2021-12-6_21-35-26.png" width="600"  />
    </p>
<p   
>&#36825;&#20004;&#31181;&#29366;&#24577;&#30340;&#22320;&#22336;&#30456;&#20114;&#36716;&#25442;&#65292;&#25105;&#20204;&#21487;&#20197;&#31216;&#20043;&#20026;RVA&#19982;FOA&#30340;&#36716;&#25442;&#65292;<strong class=" ">RVA&#23601;&#26159;&#30456;&#23545;&#34394;&#25311;&#22320;&#22336;&#65292;FOA&#23601;&#26159;&#25991;&#20214;&#20559;&#31227;&#22320;&#22336;</strong>&#65307;&#20174;RVA&#36716;&#25442;&#21040;FOA&#65292;&#23601;&#26159;&#20174;<strong class=" ">&#25991;&#20214;&#36816;&#34892;&#26102;&#65288;&#21160;&#24577;&#65289;&#30340;&#22320;&#22336;&#36716;&#25442;&#25104;&#22312;&#30913;&#30424;&#19978;&#65288;&#38745;&#24577;&#65289;&#30340;&#22320;&#22336;</strong>&#65292;&#25353;&#22914;&#19979;&#20844;&#24335;&#21487;&#20197;&#36827;&#34892;&#36716;&#25442;&#65306;</p>
<ol class=" "><li class=" "><p   
>RVA&#22320;&#22336;&#30001;&#20869;&#23384;&#22320;&#22336;&#20943;&#21435;ImageBase&#22320;&#22336;&#65288;PE&#25991;&#20214;&#22312;&#20869;&#23384;&#20013;&#30340;&#24320;&#22987;&#20301;&#32622;&#26159;&#30001;&#25193;&#23637;PE&#22836;&#20013;&#30340;ImageBase&#20915;&#23450;&#65289;&#65307;</p>
</li><li class=" "><p   
>&#21028;&#26029;RVA&#22320;&#22336;&#26159;&#21542;&#20301;&#20110;PE&#22836;&#20013;&#65306;</p>
<ol class=" "><li class=" "><p   
><strong class=" ">&#22914;&#26524;&#26159;&#65292;&#37027;&#20040;RVA&#31561;&#20110;FOA</strong>&#65307;</p>
</li><li class=" "><p   
><strong class=" ">&#22914;&#26524;&#19981;&#26159;&#65292;&#21028;&#26029;RVA&#20301;&#20110;&#21738;&#20010;&#33410;&#65306;</strong></p>
<ol class=" "><li class=" "><p   
>&#24403;&#28385;&#36275;<strong class=" ">RVA&#22320;&#22336;&#22823;&#20110;&#31561;&#20110;&#33410;.VirtualAddress&#21644;RVA&#22320;&#22336;&#23567;&#38632;&#31561;&#20110;&#33410;.VirtualAddress&#21152;&#19978;&#24403;&#21069;&#33410;&#20869;&#23384;&#23545;&#40784;&#21518;&#30340;&#22823;&#23567;</strong>&#26102;&#65292;&#23601;&#34920;&#31034;RVA&#22320;&#22336;&#22312;&#35813;&#33410;&#20013;&#12290;</p>
</li><li class=" "><p   
>RVA&#22320;&#22336;&#20943;&#21435;&#33410;.VirtualAddress&#31561;&#20110;&#24046;&#20540;&#65292;<strong class=" ">FOA&#22320;&#22336;&#23601;&#26159;&#26681;&#25454;&#33410;.PointerToRawData&#21152;&#19978;&#24046;&#20540;</strong>&#12290;</p>
</li></ol></li></ol></li></ol><p   
>&#22312;&#19968;&#20123;&#36739;&#32769;&#30340;&#32534;&#35793;&#22120;&#20013;&#65292;&#32534;&#35793;&#20986;&#26469;&#30340;&#25991;&#20214;&#20250;&#21306;&#20998;&#25991;&#20214;&#23545;&#40784;&#12289;&#20869;&#23384;&#23545;&#40784;&#65292;&#20294;&#26159;&#22312;&#29616;&#22312;&#30340;&#32534;&#35793;&#22120;&#32534;&#35793;&#20986;&#26469;&#30340;&#31243;&#24207;&#65292;&#25991;&#20214;&#23545;&#40784;&#19982;&#20869;&#23384;&#23545;&#40784;&#26102;&#23436;&#20840;&#19968;&#26679;&#30340;&#65292;&#25152;&#20197;&#25105;&#20204;&#19981;&#29992;&#36153;&#36825;&#20040;&#22823;&#30340;&#21608;&#25240;&#65292;&#25105;&#20204;&#21482;&#38656;&#35201;&#31639;&#20986;RVA&#30340;&#20540;&#23601;&#21487;&#20197;&#24471;&#20986;FOA&#30340;&#20540;&#12290;</p>
<p   
>&#20363;&#22914;&#65292;&#22312;&#24403;&#21069;&#31243;&#24207;&#20013;&#23601;&#26159;&#36825;&#26679;&#65292;&#26681;&#25454;0x42BA30-0x400000&#65288;ImageBase&#65289;&#24471;&#20986;0x2BA30&#65292;&#20854;&#26159;RVA&#65292;&#20063;&#26159;FOA&#65292;&#30452;&#25509;&#20351;&#29992;Winhex&#25171;&#24320;&#25214;&#21040;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-6_22-4-37.png" alt="images/download/attachments/1015828/image2021-12-6_22-4-37.png" width="600"  />
    </p>
<p   
>&#21487;&#20197;&#30452;&#25509;&#20462;&#25913;&#23427;&#28982;&#21518;&#20445;&#23384;&#36816;&#34892;&#65292;&#36825;&#26102;&#20505;&#20320;&#23601;&#20250;&#21457;&#29616;&#20840;&#23616;&#21464;&#37327;&#30340;&#20540;&#24050;&#32463;&#21457;&#29983;&#20102;&#25913;&#21464;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-6_22-7-35.png" alt="images/download/attachments/1015828/image2021-12-6_22-7-35.png" width="600"  />
    </p>
    </div>
    <div class="section section-1" id="src-1015828_safe-id-UEXln7rnoYAtUEXnqbrnmb3ljLrmt7vliqDku6PnoIE">
        <h1 class="heading "><span>PE&#31354;&#30333;&#21306;&#28155;&#21152;&#20195;&#30721;</span></h1>
<p   
>&#29616;&#22312;&#25105;&#20204;&#26377;&#19968;&#20010;&#20219;&#21153;&#65292;&#38656;&#35201;&#22312;&#31354;&#30333;&#21306;&#28155;&#21152;&#19968;&#27573;&#20195;&#30721;&#65288;<strong class=" ">&#20320;&#20063;&#21487;&#20197;&#31216;&#20043;&#20026;Shellcode</strong>&#65289;&#65292;&#24182;&#19988;&#22312;&#31243;&#24207;&#36816;&#34892;&#20043;&#21069;&#25191;&#34892;&#36825;&#27573;&#20195;&#30721;&#65307;&#39318;&#20808;&#25105;&#20204;&#35201;&#30693;&#36947;PE&#31354;&#30333;&#21306;&#26159;&#20160;&#20040;&#65292;PE&#31354;&#30333;&#21306;&#34920;&#31034;PE&#25991;&#20214;&#25353;&#29031;&#23545;&#40784;&#26041;&#24335;&#20043;&#21518;&#22810;&#20986;&#26469;&#30340;&#37096;&#20998;&#65292;&#21487;&#20197;&#26159;&#33410;&#19982;&#33410;&#20043;&#38388;&#30340;&#31354;&#30333;&#21306;&#20063;&#21487;&#20197;&#26159;&#33410;&#34920;&#19982;&#33410;&#20043;&#38388;&#30340;&#31354;&#30333;&#21306;&#12290;</p>
<p   
>&#22522;&#26412;&#27010;&#24565;&#20102;&#35299;&#20043;&#21518;&#65292;&#25105;&#20204;&#26469;&#30475;&#19979;&#25554;&#20837;&#30340;&#20195;&#30721;&#65292;&#23601;&#26159;&#22914;&#19979;&#36825;&#20010;&#24377;&#31383;&#21151;&#33021;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">::MessageBoxA(</code><code class="value">0</code><code class="plain">,</code><code class="value">0</code><code class="plain">,</code><code class="value">0</code><code class="plain">,</code><code class="value">0</code><code class="plain">);</code></div>
</div>
    </div>
<p   
>&#37027;&#20040;&#22914;&#20309;&#35753;&#36825;&#27573;&#20195;&#30721;&#25554;&#20837;&#21040;&#31354;&#30333;&#21306;&#21602;&#65311;&#30452;&#25509;&#25554;&#20837;&#20195;&#30721;&#24456;&#26126;&#26174;&#19981;&#21487;&#21462;&#65292;&#22240;&#20026;&#25105;&#20204;&#27809;&#26377;&#28304;&#25991;&#20214;&#65292;&#25152;&#20197;&#25105;&#20204;&#35201;&#25554;&#20837;&#30340;&#26159;&#20043;&#21069;&#25152;&#23398;&#20064;&#30340;&#30828;&#32534;&#30721;&#65292;&#25105;&#20204;&#21487;&#20197;&#22312;VC6&#20013;&#19979;&#26029;&#28857;&#21453;&#32534;&#35793;&#26597;&#30475;&#36825;&#27573;&#20195;&#30721;&#23545;&#24212;&#30340;&#30828;&#32534;&#30721;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-7_16-48-28.png" alt="images/download/attachments/1015828/image2021-12-7_16-48-28.png" width="600"  />
    </p>
<p   
>&#39318;&#20808;&#25105;&#20204;&#21487;&#20197;&#30475;&#35265;&#26377;4&#20010;&#20256;&#21442;&#65306;6A 00&#65292;&#25509;&#30528;&#23601;&#26159;&#35843;&#29992;&#20989;&#25968;MessageBox&#20102;&#65292;<strong class=" ">&#20294;&#26159;&#22312;&#36825;&#37324;&#30340;&#35843;&#29992;&#26159;&#38656;&#35201;&#36981;&#24490;&#23548;&#20837;&#34920;&#30340;&#65288;&#21518;&#38754;&#31456;&#33410;&#20250;&#20102;&#35299;&#23548;&#20837;&#34920;&#20869;&#23481;&#65289;&#65292;&#26159;&#19968;&#20010;&#38388;&#25509;&#35843;&#29992;</strong>&#65292;&#25105;&#20204;&#25554;&#20837;&#30340;&#26102;&#20505;&#38656;&#35201;&#20462;&#25913;&#25104;&#30452;&#25509;&#35843;&#29992;&#30340;&#24418;&#24335;&#65292;&#20063;&#23601;&#26159;&#65306;E8 00 00 00 00&#65292;E8&#21518;&#38754;&#30340;4&#23383;&#33410;&#34920;&#31034;&#19968;&#20010;&#20559;&#31227;&#20540;&#65292;&#34920;&#31034;&#24403;&#21069;&#25351;&#20196;&#22320;&#22336;&#19982;&#38656;&#35201;&#35843;&#29992;&#25351;&#20196;&#22320;&#22336;&#20043;&#38388;&#30340;&#20559;&#31227;&#65292;<strong class=" ">&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;&#38656;&#35201;&#35843;&#29992;&#25351;&#20196;&#22320;&#22336;&#20943;&#21435;&#24403;&#21069;&#25351;&#20196;&#22320;&#22336;&#65288;&#21253;&#21547;&#26412;&#36523;&#30340;&#23485;&#24230;&#65289;&#23601;&#24471;&#20986;&#36825;&#20010;&#20559;&#31227;&#20540;</strong>&#12290;</p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#20808;&#25214;&#21040;MessageBoxA&#36825;&#20010;&#20989;&#25968;&#22320;&#22336;&#65292;&#22312;Win32&#30340;&#26102;&#20505;&#20063;&#20102;&#35299;&#36807;&#36825;&#20010;&#20989;&#25968;&#26159;&#25216;&#26415;&#26159;Windows&#25805;&#20316;&#31995;&#32479;&#30340;USER32.DLL&#25552;&#20379;&#30340;&#65292;&#25105;&#20204;&#21487;&#20197;&#22312;DTDebug&#20013;&#25171;&#24320;&#19968;&#20010;&#25991;&#20214;&#25353;&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#25214;&#21040;&#23545;&#24212;&#30340;DLL&#25991;&#20214;&#65292;&#21452;&#20987;&#36827;&#21435;&#25353;Ctrl+N&#24555;&#25463;&#38190;&#25214;&#21040;MessageBoxA&#20989;&#25968;&#30340;&#22320;&#22336;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-7_17-6-46.png" alt="images/download/attachments/1015828/image2021-12-7_17-6-46.png" width="600"  />
    </p>
<p   
>&#22914;&#26524;&#20320;&#35273;&#24471;&#36825;&#26679;&#40635;&#28902;&#20063;&#21487;&#20197;&#32771;&#34385;&#22312;VC6&#19979;&#38754;&#19979;&#26029;&#28857;&#36319;&#36827;&#36825;&#20010;&#20989;&#25968;&#22320;&#22336;&#21363;&#21487;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-7_17-7-23.png" alt="images/download/attachments/1015828/image2021-12-7_17-7-23.png" width="600"  />
    </p>
<p   
>&#24471;&#21040;&#20102;&#25152;&#38656;&#35201;&#35843;&#29992;&#30340;&#25351;&#20196;&#22320;&#22336;0x77D5050B&#65292;&#25105;&#20204;&#36824;&#38656;&#35201;&#30693;&#36947;&#35201;&#22635;&#20805;&#20195;&#30721;&#20301;&#32622;&#30340;&#22320;&#22336;&#65292;&#20063;&#23601;&#26159;ImageBase&#21152;&#19978;&#24403;&#21069;&#22320;&#22336;&#65288;&#30001;&#20110;&#29616;&#20195;&#32534;&#35793;&#22120;&#32534;&#35793;&#30340;&#25991;&#20214;&#19981;&#21306;&#20998;&#25991;&#20214;&#12289;&#20869;&#23384;&#23545;&#40784;&#65292;&#25152;&#20197;&#19981;&#32771;&#34385;&#36825;&#20123;&#65289;&#65292;&#26681;&#25454;&#25193;&#23637;PE&#22836;&#21487;&#20197;&#30693;&#36947;&#24403;&#21069;ImageBase&#20026;0x400000&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-7_17-46-0.png" alt="images/download/attachments/1015828/image2021-12-7_17-46-0.png" width="600"  />
    </p>
<p   
>&#36825;&#20010;&#22320;&#22336;&#25105;&#36873;&#25321;&#20026;0xFE0&#65292;&#20808;&#22635;&#20805;8&#23383;&#33410;&#30340;6A 00&#65292;Call&#25351;&#20196;&#24320;&#22987;&#30340;&#20301;&#32622;&#23601;&#26159;0xFE8&#65292;&#21152;&#19978;ImageBase&#23601;&#26159;0x400FE8&#65292;0x77D5050B&#20943;&#21435;(<strong class=" ">0x400FE8+5</strong>)<strong class=" ">&#65288;&#21253;&#25324;&#25351;&#20196;&#26412;&#36523;&#30340;&#23485;&#24230;&#65289;</strong>&#31561;&#20110;0x7794F51E&#65292;<strong class=" ">&#20877;&#25340;&#25509;&#25351;&#20196;&#23601;&#26159;&#65306;E8 1E F5 94 77</strong>&#65292;<strong class=" ">&#36825;&#36793;&#27880;&#24847;&#25105;&#20204;&#26159;&#25353;&#23567;&#31471;&#23384;&#20648;&#27169;&#24335;&#21435;&#20889;&#20837;&#30340;</strong>&#12290;</p>
<p   
>&#33267;&#27492;&#65292;&#25105;&#20204;&#30340;&#24037;&#20316;&#36824;&#27809;&#26377;&#23436;&#25104;&#65292;&#36824;&#38656;&#35201;&#22312;&#25554;&#20837;&#30340;&#20195;&#30721;&#32467;&#26463;&#20043;&#21518;&#36339;&#36716;&#22238;&#31243;&#24207;&#30340;&#20837;&#21475;&#65292;&#31243;&#24207;&#30340;&#20837;&#21475;&#22320;&#22336;&#21487;&#20197;&#26681;&#25454;&#25193;&#23637;PE&#22836;&#30340;AddressOfEntryPoint&#25104;&#21592;&#65288;&#21152;&#19978;ImageBase&#65289;&#33719;&#24471;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#31243;&#24207;&#20837;&#21475;&#22320;&#22336;&#23601;&#26159;0x4010B0&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-7_17-42-39.png" alt="images/download/attachments/1015828/image2021-12-7_17-42-39.png" width="600"  />
    </p>
<p   
>&#36339;&#22238;&#21487;&#20197;&#20351;&#29992;JMP&#25351;&#20196;&#65306;E9 00 00 00 00&#65292;&#21516;&#26679;&#36825;&#21518;&#38754;&#30340;4&#23383;&#33410;&#20063;&#26159;&#20559;&#31227;&#20540;&#65292;&#29992;&#31243;&#24207;&#20837;&#21475;&#22320;&#22336;&#20943;&#21435;&#24403;&#21069;&#22320;&#22336;&#21363;&#21487;&#65306;0x4010B0 - <strong class=" ">(0x400FE8+5+5)</strong>&#65292;&#26368;&#32456;&#24471;&#20986;&#65306;0xBE&#65292;<strong class=" ">&#37027;&#20040;&#25351;&#20196;&#23601;&#21464;&#25104;&#20102;&#65306;E9 BE 00 00 00</strong>&#12290;</p>
<p   
>&#36825;&#26679;&#65292;&#25105;&#20204;&#25554;&#20837;&#30340;&#20195;&#30721;&#37117;&#24050;&#32463;&#20934;&#22791;&#23436;&#27605;&#65292;&#22635;&#20805;&#21040;&#31354;&#30333;&#21306;&#21363;&#21487;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-7_18-27-47.png" alt="images/download/attachments/1015828/image2021-12-7_18-27-47.png" width="600"  />
    </p>
<p   
>&#25509;&#30528;&#65292;&#25105;&#20204;&#36824;&#38656;&#35201;&#20462;&#25913;&#20837;&#21475;&#20989;&#25968;&#30340;&#22320;&#22336;&#20026;&#24403;&#21069;&#22320;&#22336;&#65292;&#36825;&#26679;&#24403;&#21069;&#31243;&#24207;&#36816;&#34892;&#30340;&#26102;&#20505;&#25165;&#20250;&#20808;&#25191;&#34892;&#25105;&#20204;&#30340;&#20195;&#30721;&#65292;&#25191;&#34892;&#23436;&#25104;&#25105;&#20204;&#25554;&#20837;&#30340;&#20195;&#30721;&#21518;&#23601;&#20250;JMP&#22238;&#20837;&#21475;&#20989;&#25968;&#12290;</p>
<p   
>&#25105;&#20204;&#21482;&#38656;&#35201;&#22312;&#25193;&#23637;PE&#22836;&#20013;&#20462;&#25913;AddressOfEntryPoint&#25104;&#21592;&#20026;0xFE0&#21363;&#21487;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-7_18-5-44.png" alt="images/download/attachments/1015828/image2021-12-7_18-5-44.png" width="600"  />
    </p>
<p   
>&#20462;&#25913;&#23436;&#25104;&#20043;&#21518;&#20445;&#23384;&#36816;&#34892;&#23601;&#20250;&#21457;&#29616;&#20854;&#20808;&#36816;&#34892;&#20102;&#25105;&#20204;&#25554;&#20837;&#30340;&#20195;&#30721;&#32780;&#21518;&#20877;&#36827;&#20837;&#31243;&#24207;&#30495;&#27491;&#30340;&#20837;&#21475;&#20989;&#25968;&#20195;&#30721;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-7_18-29-1.png" alt="images/download/attachments/1015828/image2021-12-7_18-29-1.png" width="600"  />
    </p>
<p   
>&#33267;&#27492;&#65292;&#25105;&#20204;&#23601;&#23436;&#25104;&#20102;&#22312;&#31354;&#30333;&#21306;&#28155;&#21152;&#20195;&#30721;&#24182;&#25191;&#34892;&#30340;&#20219;&#21153;&#20102;&#65292;&#26368;&#21518;&#38656;&#35201;&#27880;&#24847;&#30340;&#26159;&#25105;&#20204;&#36825;&#37324;&#25152;&#25554;&#20837;&#30340;&#20195;&#30721;&#21482;&#33021;&#22312;&#26412;&#26426;&#21435;&#36816;&#34892;&#65292;&#19981;&#33021;&#22312;&#20854;&#20182;&#26426;&#22120;&#19978;&#20351;&#29992;&#65292;&#22240;&#20026;&#36825;&#19981;&#26159;&#19968;&#20010;&#26631;&#20934;&#30340;Shellcode&#65288;&#21518;&#32493;&#31456;&#33410;&#20250;&#20102;&#35299;Shellcode&#65289;&#12290;</p>
    </div>
    <div class="section section-1" id="src-1015828_safe-id-UEXln7rnoYAt6IqC5pON5L2c">
        <h1 class="heading "><span>&#33410;&#25805;&#20316;</span></h1>
<p   
>&#20197;&#19979;&#25805;&#20316;&#20013;&#29992;&#30340;PE&#25991;&#20214;&#24314;&#35758;&#33258;&#34892;&#23547;&#25214;&#19968;&#20010;&#20877;&#21435;&#23454;&#39564;&#12290;</p>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAt5omp5aSn6IqC">
        <h2 class="heading "><span>&#25193;&#22823;&#33410;</span></h2>
<p   
>&#22312;&#19978;&#19968;&#31456;&#33410;&#20013;&#25105;&#20204;&#21487;&#20197;&#22312;&#20219;&#24847;&#31354;&#30333;&#21306;&#28155;&#21152;&#33258;&#24049;&#30340;&#20195;&#30721;&#65292;&#20294;&#22914;&#26524;&#28155;&#21152;&#30340;&#20195;&#30721;&#27604;&#36739;&#22810;&#65292;&#31354;&#30333;&#21306;&#19981;&#22815;&#24590;&#20040;&#21150;&#65311;&#36825;&#26102;&#20505;&#23601;&#38656;&#35201;&#25193;&#22823;&#33410;&#65292;&#33410;&#26377;&#24456;&#22810;&#20010;&#65292;&#25105;&#20204;&#24212;&#35813;&#25193;&#22823;&#21738;&#19968;&#20010;&#33410;&#21602;&#65311;&#24819;&#35937;&#19968;&#19979;&#22914;&#26524;&#20320;&#29616;&#22312;&#25193;&#22823;&#31532;&#19968;&#20010;&#33410;&#65292;&#37027;&#20040;&#20854;&#20182;&#33410;&#30340;&#20559;&#31227;&#37327;&#20043;&#31867;&#30340;&#23646;&#24615;&#37117;&#38656;&#35201;&#20462;&#25913;&#65292;&#36825;&#26679;&#24456;&#40635;&#28902;&#65292;&#25152;&#20197;&#25105;&#20204;&#21487;&#20197;&#36873;&#25321;&#25193;&#22823;&#26368;&#21518;&#19968;&#20010;&#33410;&#65292;&#36825;&#26679;&#23601;&#19981;&#29992;&#20462;&#25913;&#20854;&#20182;&#33410;&#30340;&#23646;&#24615;&#20102;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-6_21-35-26.png" alt="images/download/attachments/1015828/image2021-12-6_21-35-26.png" width="600"  />
    </p>
<p   
>&#22914;&#19979;&#26159;&#33410;&#34920;&#25104;&#21592;&#30340;&#25968;&#25454;&#32467;&#26500;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#define IMAGE_SIZEOF_SHORT_NAME </code><code class="value">8</code></div>
<div class="line"><code class="plain">typedef struct _IMAGE_SECTION_HEADER {</code></div>
<div class="line"><code class="plain">    BYTE    Name[IMAGE_SIZEOF_SHORT_NAME]; </code><code class="comments">// ASCII字符串（节名），可自定义，只截取8个字节，可以8个字节都是名字</code></div>
<div class="line"><code class="plain">    union { </code><code class="comments">// Misc，双字，是该节在没有对齐前的真实尺寸，该值可以不准确</code></div>
<div class="line"><code class="plain">        DWORD   PhysicalAddress; </code><code class="comments">// 真实宽度，这两个值是一个联合结构，可以使用其中的任何一个</code></div>
<div class="line"><code class="plain">        DWORD   VirtualSize; </code><code class="comments">// 一般是取后一个</code></div>
<div class="line"><code class="plain">    } Misc;					</code></div>
<div class="line"><code class="plain">    DWORD   VirtualAddress; </code><code class="comments">// 在内存中的偏移地址，加上ImageBase才是在内存中的真正地址</code></div>
<div class="line"><code class="plain">    DWORD   SizeOfRawData; </code><code class="comments">// 节在文件中对齐后的尺寸</code></div>
<div class="line"><code class="plain">    DWORD   PointerToRawData; </code><code class="comments">// 节区在文件中的偏移</code></div>
<div class="line"><code class="plain">    DWORD   PointerToRelocations; </code><code class="comments">// 调试相关</code></div>
<div class="line"><code class="plain">    DWORD   PointerToLinenumbers; </code><code class="comments">// 调试相关 </code></div>
<div class="line"><code class="plain">    WORD    NumberOfRelocations; </code><code class="comments">// 调试相关 </code></div>
<div class="line"><code class="plain">    WORD    NumberOfLinenumbers; </code><code class="comments">// 调试相关 </code></div>
<div class="line"><code class="plain">    DWORD   Characteristics; </code><code class="comments">// 节的属性</code></div>
<div class="line"><code class="plain">} IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;</code></div>
</div>
    </div>
<p   
>&#25105;&#20204;&#24819;&#35201;&#25193;&#22823;&#33410;&#23601;&#38656;&#35201;&#20462;&#25913;&#36825;&#20960;&#20010;&#37096;&#20998;&#65306;SizeOfRawData&#12289;VirtualSize&#12290;&#25509;&#19979;&#26469;&#25105;&#20204;&#23601;&#26469;&#25193;&#22823;&#33410;&#65292;&#39318;&#20808;&#38656;&#35201;&#20998;&#37197;&#19968;&#22359;&#26032;&#30340;&#31354;&#38388;&#65292;&#36825;&#22359;&#31354;&#38388;&#30340;&#22823;&#23567;&#21462;&#20915;&#20320;&#25152;&#38656;&#35201;&#30340;&#20195;&#30721;&#22823;&#23567;&#65292;&#22312;&#36825;&#37324;&#23601;&#23450;&#20301;0x1000&#65292;&#20063;&#23601;&#26159;4096&#23383;&#33410;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#20351;&#29992;010 Editor&#22312;&#25991;&#20214;&#26411;&#23614;&#25554;&#20837;&#23383;&#33410;&#65288;<strong class=" ">&#36825;&#26679;&#20063;&#23601;&#19981;&#20250;&#25171;&#20081;&#20854;&#20182;&#32467;&#26500;&#30340;&#20559;&#31227;</strong>&#65289;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-8_14-3-54.png" alt="images/download/attachments/1015828/image2021-12-8_14-3-54.png" width="600"  />
    </p>
<p   
>&#28982;&#21518;&#25214;&#21040;&#26368;&#21518;&#19968;&#20010;&#33410;&#34920;&#25104;&#21592;&#65292;&#20462;&#25913;SizeOfRawData&#21644;VirtualSize&#25104;&#21592;&#30340;&#20540;&#65292;&#36825;&#20010;&#20540;&#26159;&#35201;<strong class=" ">&#21462;SizeOfRawData&#21644;VirtualSize&#25104;&#21592;&#24403;&#21069;&#20540;&#30340;&#26368;&#22823;&#20540;&#36827;&#34892;&#20869;&#23384;&#23545;&#40784;&#20043;&#21518;&#30340;&#20540;</strong>&#21152;&#19978;&#25105;&#20204;&#25554;&#20837;&#23485;&#24230;0x1000&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-8_14-17-4.png" alt="images/download/attachments/1015828/image2021-12-8_14-17-4.png" width="600"  />
    </p>
<p   
>&#22914;&#19978;&#22270;&#25152;&#31034;&#20004;&#20010;&#25104;&#21592;&#20013;&#20540;&#26368;&#22823;&#30340;&#20026;SizeOfRawData&#65292;SizeOfRawData&#26159;&#25353;&#29031;&#25991;&#20214;&#23545;&#40784;&#30340;&#65292;&#22312;&#36825;&#37324;&#25105;&#20204;&#36824;&#38656;&#35201;&#23558;SizeOfRawData&#30340;&#20540;&#25353;&#20869;&#23384;&#23545;&#40784;&#65292;&#39318;&#20808;&#26469;&#30475;&#19979;&#20869;&#23384;&#23545;&#40784;&#65288;SectionAlignment&#65289;&#21644;&#25991;&#20214;&#23545;&#40784;&#65288;FileAlignment&#65289;&#30340;&#20540;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-9_10-48-54.png" alt="images/download/attachments/1015828/image2021-12-9_10-48-54.png" width="600"  />
    </p>
<p   
>&#21487;&#20197;&#30475;&#35265;&#65292;&#22312;&#36825;&#37324;&#20004;&#20010;&#20540;&#19981;&#19968;&#26679;&#65292;&#25152;&#20197;&#24403;&#21069;SizeOfRawData&#26159;&#25353;&#25991;&#20214;&#23545;&#40784;&#30340;&#20540;&#30452;&#25509;&#28155;&#21152;&#26159;&#19981;&#21487;&#21462;&#30340;&#65292;&#25105;&#20204;&#36824;&#38656;&#35201;&#25353;&#20869;&#23384;&#23545;&#40784;&#65292;&#21487;&#20197;&#20351;&#29992;&#22914;&#19979;&#20844;&#24335;&#36827;&#34892;&#35745;&#31639;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">⌈⌉(SizeOfRawData(</code><code class="value">0x8000</code><code class="plain">) / SectionAlignment(</code><code class="value">0x1000</code><code class="plain">)) = ResultA(</code><code class="value">0x8</code><code class="plain">) </code><code class="comments">// 0x8000除以0x1000向上取整(符号⌈⌉)</code></div>
<div class="line"><code class="plain">ResultA(</code><code class="value">0x8</code><code class="plain">) * SectionAlignment(</code><code class="value">0x1000</code><code class="plain">) = ResultB(</code><code class="value">0x8000</code><code class="plain">)</code></div>
</div>
    </div>
<p   
>&#26368;&#32456;&#25105;&#20204;&#24471;&#20986;&#25353;&#20869;&#23384;&#23545;&#40784;&#30340;&#20540;&#20026;0x8000&#65292;&#28982;&#21518;&#25105;&#20204;&#35201;&#23558;SizeOfRawData&#21644;VirtualSize&#25104;&#21592;&#30340;&#20540;&#20462;&#25913;&#20026;0x9000&#65288;0x8000+0x1000&#65289;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-8_14-18-17.png" alt="images/download/attachments/1015828/image2021-12-8_14-18-17.png" width="600"  />
    </p>
<p   
>&#25509;&#30528;&#65292;&#22914;&#26524;&#20320;&#35201;&#35753;&#36825;&#20010;&#33410;&#20013;&#23384;&#25918;&#20195;&#30721;&#24182;&#19988;&#38656;&#35201;&#25191;&#34892;&#30340;&#35805;&#65292;&#23601;&#38656;&#35201;&#20462;&#25913;&#33410;&#30340;&#23646;&#24615;&#65307;&#28982;&#21518;&#25105;&#20204;&#38656;&#35201;&#21435;&#20462;&#25913;&#25193;&#23637;PE&#22836;&#20013;&#30340;SizeOfImage&#25104;&#21592;&#65292;&#35813;&#25104;&#21592;&#34920;&#31034;<strong class=" ">&#22312;&#20869;&#23384;&#20013;&#25972;&#20010;PE&#25991;&#20214;&#26144;&#23556;&#30340;&#22823;&#23567;</strong>&#65292;&#22914;&#19979;&#22270;&#26159;&#24403;&#21069;&#30340;&#20540;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-8_14-24-2.png" alt="images/download/attachments/1015828/image2021-12-8_14-24-2.png" width="600"  />
    </p>
<p   
>&#22312;&#20043;&#21069;&#30340;&#31456;&#33410;&#37324;&#19968;&#23478;&#20102;&#35299;&#36807;&#20102;SizeOfImage&#21487;&#20197;&#27604;&#23454;&#38469;&#20540;&#35201;&#22823;&#24182;&#19988;&#36825;&#20010;&#20540;&#40664;&#35748;&#24773;&#20917;&#19979;&#26412;&#36523;&#23601;&#26159;&#19982;&#20869;&#23384;&#23545;&#40784;&#20043;&#21518;&#30340;&#32467;&#26524;&#65292;&#25152;&#20197;&#20320;&#22312;&#21407;&#22522;&#30784;&#19978;&#21152;0x1000&#21363;&#21487;&#65292;&#36825;&#26679;&#25105;&#20204;&#23601;&#23436;&#25104;&#20102;&#25193;&#22823;&#33410;&#30340;&#25805;&#20316;&#12290;</p>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAt5o-S5YWl5Luj56CB5omn6KGM">
        <h3 class="heading "><span>&#25554;&#20837;&#20195;&#30721;&#25191;&#34892;</span></h3>
<p   
>&#37027;&#20040;&#65292;&#22312;&#25193;&#22823;&#33410;&#20043;&#21518;&#21448;&#35813;&#22914;&#20309;&#21435;&#25554;&#20837;&#33258;&#24049;&#30340;&#20195;&#30721;&#35843;&#29992;&#21602;&#65311;&#22914;&#26524;&#25353;&#29031;&#20043;&#21069;&#25554;&#20837;&#31354;&#30333;&#21306;&#30340;&#26041;&#27861;&#65292;&#26681;&#25454;&#24403;&#21069;&#30340;&#25351;&#20196;&#22320;&#22336;&#20877;&#21152;&#19978;ImageBase&#21435;&#35843;&#29992;&#65292;&#24456;&#26126;&#26174;&#36825;&#26159;&#19981;&#21487;&#21462;&#30340;&#65292;&#22240;&#20026;&#24403;&#21069;&#25991;&#20214;&#19982;&#20869;&#23384;&#23545;&#40784;&#26159;&#19981;&#19968;&#33268;&#30340;&#65292;&#25105;&#20204;&#24819;&#35201;&#21435;&#25481;&#29992;&#23601;&#35201;&#30693;&#36947;&#22312;&#20869;&#23384;&#20013;&#24403;&#21069;&#25351;&#20196;&#30340;&#22320;&#22336;&#12290;</p>
<p   
>&#32780;&#36825;&#20010;&#65292;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;&#21407;SizeOfImage&#30340;&#20540;&#33719;&#24471;&#65292;&#22240;&#20026;&#21407;SizeOfImage&#30340;&#20540;&#34920;&#31034;PE&#25991;&#20214;&#22312;&#20869;&#23384;&#20013;&#23637;&#24320;&#30340;&#22823;&#23567;&#65292;&#25105;&#20204;&#21333;&#29420;&#28155;&#21152;&#30340;&#31354;&#38388;&#23601;&#22312;PE&#25991;&#20214;&#30340;&#26411;&#23614;&#65292;&#25152;&#20197;&#21487;&#20197;&#26681;&#25454;SizeOfImage&#26469;&#30693;&#36947;&#22312;&#28155;&#21152;&#31354;&#38388;&#20013;&#30340;&#25351;&#20196;&#22320;&#22336;&#65307;&#20363;&#22914;&#22914;&#19979;&#22270;&#25152;&#31034;&#20247;&#26631;&#32418;&#37096;&#20998;&#22312;&#20869;&#23384;&#20013;&#30340;&#22320;&#22336;&#33539;&#22260;&#24212;&#20026;ImageBase&#21152;&#21407;SizeOfImage&#19982;&#25351;&#20196;&#30340;&#23485;&#24230;&#65292;&#26368;&#32456;&#30340;&#22320;&#22336;&#33539;&#22260;&#23601;&#26159;&#65306;0x1013000 - 0x1013003</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-9_16-18-18.png" alt="images/download/attachments/1015828/image2021-12-9_16-18-18.png" width="600"  />
    </p>
<p   
>&#25509;&#30528;&#65292;&#25105;&#20204;&#21482;&#38656;&#35201;&#28155;&#21152;&#33258;&#24049;&#30340;&#25351;&#20196;&#36827;&#21435;&#21363;&#21487;&#65292;&#36825;&#36793;&#36824;&#26159;&#22871;&#29992;&#22312;&#31354;&#30333;&#21306;&#26102;&#25152;&#20351;&#29992;&#30340;&#25351;&#20196;MessageBoxA&#65288;0x77D5050B&#65289;&#65292;&#24182;&#35745;&#31639;&#20986;&#20559;&#31227;&#37327;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">0x77D5050B</code><code class="plain">（MessageBoxA） - </code><code class="value">0x1013000</code><code class="plain">（指令开始地址） - </code><code class="value">13</code><code class="plain">（指令本身长度） = </code><code class="value">0x76D3D4F8</code></div>
</div>
    </div>
<p   
>&#20877;&#25340;&#25509;&#19978;&#25351;&#20196;&#65288;<strong class=" ">&#21035;&#24536;&#20102;&#23567;&#31471;&#23384;&#20648;&#27169;&#24335;</strong>&#65289;&#25554;&#20837;&#21363;&#21487;&#65288;&#36825;&#37324;&#30340;&#25351;&#20196;&#36827;&#34892;&#20102;&#31616;&#21270;&#65292;&#30465;&#30053;&#20102;JMP&#36339;&#22238;&#21407;AddressOfEntryPoint&#22320;&#22336;&#37096;&#20998;&#65289;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">6A </code><code class="value">00</code><code class="plain"> 6A </code><code class="value">00</code><code class="plain"> 6A </code><code class="value">00</code><code class="plain"> 6A </code><code class="value">00</code><code class="plain"> E8 F8 D4 D3 </code><code class="value">76</code></div>
</div>
    </div>
<p   
>&#26368;&#21518;&#25105;&#20204;&#38656;&#35201;&#20462;&#25913;&#19968;&#19979;OEP&#65288;<strong class=" ">&#36825;&#37324;&#30340;OEP&#26159;Original EntryPoint&#65292;&#20063;&#23601;&#26159;&#21407;&#22987;&#20837;&#21475;&#28857;&#65292;&#27809;&#26377;&#21152;&#22771;&#20197;&#21450;&#20854;&#20182;&#20462;&#25913;&#30340;&#24773;&#20917;&#19979;&#65292;AddressOfEntryPoint&#23601;&#26159;OEP&#65292;&#20294;&#26159;&#22914;&#26524;&#23384;&#22312;&#20462;&#25913;/&#21152;&#22771;&#30340;&#24773;&#20917;&#65292;AddressOfEntryPoint&#21482;&#33021;&#31216;&#20026;&#26159;EP&#65292;&#22240;&#20026;&#19981;&#26159;&#21407;&#22987;&#20837;&#21475;&#28857;&#65292;&#20320;&#38656;&#35201;&#33258;&#24049;&#21435;&#23547;&#25214;&#20102;</strong>&#65289;&#36825;&#37324;&#20462;&#25913;&#20063;&#25353;&#29031;&#20043;&#21069;&#24471;&#20986;&#30340;&#25351;&#20196;&#22320;&#22336;&#21435;&#38500;ImageBase&#30340;&#20540;&#36827;&#34892;&#20462;&#25913;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-9_16-42-36.png" alt="images/download/attachments/1015828/image2021-12-9_16-42-36.png" width="600"  />
    </p>
<p   
>&#25509;&#30528;&#20445;&#23384;&#36816;&#34892;&#21363;&#21487;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-9_20-5-9.png" alt="images/download/attachments/1015828/image2021-12-9_20-5-9.png" width="600"  />
    </p>
    </div>
    </div>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAt5paw5aKe6IqC">
        <h2 class="heading "><span>&#26032;&#22686;&#33410;</span></h2>
<p   
>&#19978;&#19968;&#31456;&#33410;&#20013;&#25105;&#20204;&#30693;&#36947;&#24403;&#24819;&#25554;&#20837;&#30340;&#20195;&#30721;&#36807;&#22810;&#30340;&#26102;&#20505;&#65292;&#31354;&#30333;&#21306;&#19981;&#22815;&#29992;&#30340;&#24773;&#20917;&#19979;&#65292;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;&#25193;&#22823;&#33410;&#30340;&#26041;&#27861;&#25193;&#22823;&#26368;&#21518;&#19968;&#20010;&#33410;&#65292;&#28982;&#21518;&#22312;&#37324;&#38754;&#25554;&#20837;&#33258;&#24049;&#30340;&#20195;&#30721;&#65307;&#36825;&#26679;&#30340;&#26041;&#27861;&#34429;&#28982;&#26377;&#25928;&#65292;&#20294;&#36824;&#26159;&#26377;&#19968;&#20123;&#24330;&#31471;&#65292;&#27604;&#22914;&#26368;&#21518;&#19968;&#20010;&#33410;&#30340;&#23646;&#24615;&#20250;&#34987;&#20462;&#25913;&#65292;&#25554;&#20837;&#30340;&#20195;&#30721;&#20250;&#19982;&#21407;&#33410;&#30340;&#25968;&#25454;&#28151;&#21512;&#22312;&#19968;&#22359;&#12290;&#25152;&#20197;&#65292;&#25105;&#20204;&#21487;&#20197;&#26032;&#22686;&#33410;&#65292;<strong class=" ">&#22312;&#26032;&#22686;&#30340;&#33410;&#37324;&#28155;&#21152;&#33258;&#24049;&#30340;&#25968;&#25454;</strong>&#12290;</p>
<p   
>&#26032;&#22686;&#33410;&#65292;&#39318;&#20808;&#21028;&#26029;&#26159;&#21542;&#26377;&#36275;&#22815;&#30340;&#31354;&#38388;&#21487;&#20197;&#28155;&#21152;&#19968;&#20010;&#33410;&#34920;&#25104;&#21592;&#65288;40&#23383;&#33410;&#65289;&#65292;&#25105;&#20204;&#21487;&#20197;&#25214;&#21040;&#19968;&#20010;PE&#25991;&#20214;&#26469;&#30475;&#19968;&#19979;&#23427;&#30340;&#33410;&#34920;&#37096;&#20998;&#26159;&#21542;&#26377;&#36275;&#22815;&#22810;&#30340;&#31354;&#30333;&#21306;&#65292;&#39318;&#20808;&#25105;&#20204;&#26681;&#25454;&#26631;&#20934;PE&#22836;&#30340;&#31532;&#20108;&#20010;&#25104;&#21592;&#65288;NumberOfSections&#65289;&#30693;&#36947;&#26377;4&#20010;&#33410;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-27_0-19-12.png" alt="images/download/attachments/1015828/image2021-12-27_0-19-12.png" width="600"  />
    </p>
<p   
>&#25509;&#30528;&#25105;&#20204;&#22312;&#25193;&#23637;PE&#22836;&#20043;&#21518;&#25214;&#21040;&#33410;&#34920;&#65292;&#25105;&#20204;&#21487;&#20197;&#30475;&#35265;&#22312;&#36825;&#20010;&#33410;&#34920;&#20043;&#21518;&#26377;40&#23383;&#33410;&#30340;&#31354;&#30333;&#21306;&#35753;&#25105;&#20204;&#28155;&#21152;&#26032;&#30340;&#33410;&#34920;&#25104;&#21592;&#65292;&#25105;&#20204;<strong class=" ">&#21487;&#20197;&#36873;&#25321;&#22797;&#21046;&#19968;&#20221;&quot;.text&quot;&#33410;&#34920;&#25104;&#21592;&#20316;&#20026;&#26032;&#22686;&#30340;&#25104;&#21592;</strong>&#65292;&#36825;&#26159;&#22240;&#20026;&#25105;&#20204;&#35201;&#22312;&#33410;&#25968;&#25454;&#20013;&#28155;&#21152;&#20195;&#30721;&#65292;&#32780;<strong class=" ">&quot;.text&quot;</strong>&#23601;&#26159;&#23384;&#25918;&#20195;&#30721;&#30340;&#65292;&#25152;&#20197;&#25105;&#20204;&#30452;&#25509;&#22797;&#21046;&#36807;&#26469;&#23601;&#19981;&#38656;&#35201;&#20462;&#25913;&#33410;&#23646;&#24615;&#20102;<strong class=" ">&#65306;</strong></p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-27_0-19-55.png" alt="images/download/attachments/1015828/image2021-12-27_0-19-55.png" width="600"  />
    </p>
<p   
>&#22240;&#20026;&#25105;&#20204;&#22686;&#21152;&#20102;&#19968;&#20010;&#33410;&#65292;&#25152;&#20197;&#38656;&#35201;<strong class=" ">&#22312;&#26631;&#20934;PE&#22836;&#30340;&#31532;&#20108;&#20010;&#25104;&#21592;&#65288;NumberOfSections&#65289;&#20013;&#21152;1</strong>&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-27_0-20-20.png" alt="images/download/attachments/1015828/image2021-12-27_0-20-20.png" width="600"  />
    </p>
<p   
>&#20026;&#20102;&#26041;&#20415;&#28155;&#21152;&#33410;&#25105;&#20204;&#36824;&#38656;&#35201;&#20462;&#25913;&#19979;&#26368;&#21518;&#19968;&#20010;&#33410;&#34920;&#25104;&#21592;&#30340;&#23646;&#24615;&#65292;&#23558;&#20854;&#30495;&#23454;&#22823;&#23567;&#65288;VirtualSize&#65289;&#20462;&#25913;&#25104;&#25991;&#20214;&#23545;&#40784;&#20043;&#21518;&#30340;&#22823;&#23567;&#65288;SizeOfRawData&#65289;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-27_0-20-50.png" alt="images/download/attachments/1015828/image2021-12-27_0-20-50.png" width="600"  />
    </p>
<p   
>&#25509;&#30528;&#20462;&#25913;&#28155;&#21152;&#30340;&#33410;&#34920;&#25104;&#21592;&#30340;&#23646;&#24615;&#65306;&#21517;&#23383;&#12289;&#30495;&#23454;&#22823;&#23567;&#65288;0x1000&#65289;&#12289;&#25991;&#20214;&#23545;&#40784;&#20043;&#21518;&#30340;&#22823;&#23567;&#65288;0x1000&#65289;&#12289;&#20869;&#23384;&#20013;&#30340;&#20559;&#31227;&#65288;&#31532;4&#20010;&#33410;&#30340;&#20559;&#31227;&#22320;&#22336;0x23000+&#20854;&#25968;&#25454;&#22823;&#23567;0x4000&#65289;&#12289;&#25991;&#20214;&#20013;&#30340;&#20559;&#31227;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-27_0-25-8.png" alt="images/download/attachments/1015828/image2021-12-27_0-25-8.png" width="600"  />
    </p>
<p   
>&#28982;&#21518;&#38656;&#35201;&#20462;&#25913;&#19968;&#19979;SizeOfImage&#30340;&#22823;&#23567;&#65292;&#21152;&#19978;0x1000&#21363;&#21487;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-27_0-22-33.png" alt="images/download/attachments/1015828/image2021-12-27_0-22-33.png" width="600"  />
    </p>
<p   
>&#26368;&#21518;&#22312;&#25991;&#20214;&#26411;&#23614;&#28155;&#21152;&#23545;&#24212;&#33410;&#30340;&#25968;&#25454;&#65288;0x1000 &rarr; 4096&#20010;&#23383;&#33410;&#65289;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-27_0-23-46.png" alt="images/download/attachments/1015828/image2021-12-27_0-23-46.png" width="600"  />
    </p>
<p   
>&#36825;&#26679;&#25105;&#20204;&#23601;&#23436;&#25104;&#20102;&#26032;&#22686;&#33410;&#30340;&#25152;&#26377;&#27493;&#39588;&#65292;&#20320;&#21487;&#20197;&#22522;&#20110;&#36825;&#20010;&#22522;&#30784;&#20877;&#21435;&#25554;&#20837;&#20195;&#30721;&#25191;&#34892;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAt5ZCI5bm26IqC">
        <h2 class="heading "><span>&#21512;&#24182;&#33410;</span></h2>
<p   
>&#19978;&#19968;&#31456;&#20013;&#20102;&#35299;&#21040;&#26032;&#22686;&#33410;&#38656;&#35201;&#22312;&#33410;&#34920;&#20043;&#21518;&#33267;&#23569;&#26377;40&#20010;&#23383;&#33410;&#30340;&#31354;&#30333;&#21306;&#32473;&#25105;&#20204;&#21435;&#26032;&#22686;&#65292;&#20294;&#24182;&#19981;&#26159;&#25152;&#26377;&#30340;&#31243;&#24207;&#37117;&#21487;&#20197;&#28385;&#36275;&#36825;&#20010;&#26465;&#20214;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#30340;&#31243;&#24207;&#22312;&#33410;&#34920;&#20043;&#21518;&#30340;&#25968;&#25454;&#26159;&#32534;&#35793;&#22120;&#22635;&#20805;&#30340;&#65292;&#36825;&#20123;&#25968;&#25454;&#25105;&#20204;&#24182;&#19981;&#33021;&#35206;&#30422;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-28_15-44-45.png" alt="images/download/attachments/1015828/image2021-12-28_15-44-45.png" width="600"  />
    </p>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAt5oyJ5YaF5a2Y5a-56b2Q5bGV5byA">
        <h3 class="heading "><span>&#25353;&#20869;&#23384;&#23545;&#40784;&#23637;&#24320;</span></h3>
<p   
>&#37027;&#20040;&#36825;&#26679;&#25105;&#20204;&#22914;&#20309;&#26032;&#22686;&#33410;&#21602;&#65311;&#22914;&#26524;PE&#30340;DOS&#22359;&#27809;&#26377;&#34987;&#21344;&#29992;&#30340;&#24773;&#20917;&#19979;&#65292;&#25105;&#20204;&#23436;&#20840;&#21487;&#20197;&#23558;PE&#22836;&#21521;&#19978;&#25552;&#21319;&#65292;&#26367;&#25442;DOS&#22359;&#30340;&#37096;&#20998;&#65292;&#36825;&#26679;&#23601;&#21487;&#20197;&#22810;&#20986;&#19968;&#22359;&#31354;&#38388;&#20986;&#26469;&#65292;&#20294;&#26159;&#22914;&#26524;&#24403;&#21069;PE&#25991;&#20214;&#30340;DOS&#22359;&#34987;&#21344;&#29992;&#65292;&#36825;&#31181;&#26041;&#27861;&#26174;&#28982;&#23601;&#19981;&#21487;&#21462;&#20102;&#12290;&#25152;&#20197;&#65292;&#25105;&#20204;&#24819;&#35201;&#23454;&#29616;&#26032;&#22686;&#33410;&#21487;&#20197;&#37319;&#29992;&#21512;&#24182;&#20854;&#20182;&#33410;&#30340;&#26041;&#27861;&#65292;&#32473;&#25105;&#20204;&#26032;&#22686;&#30340;&#33410;&#34920;&#25104;&#21592;&#30041;&#20986;&#31354;&#38388;&#12290;</p>
<p   
>&#25105;&#20204;&#24819;&#35201;&#21512;&#24182;&#33410;&#65292;&#39318;&#20808;&#35201;&#32771;&#34385;&#21040;&#24403;&#21069;PE&#25991;&#20214;&#30340;&#25991;&#20214;&#23545;&#40784;&#21644;&#20869;&#23384;&#23545;&#40784;&#26159;&#21542;&#19968;&#33268;&#65292;&#22312;&#24403;&#21069;PE&#25991;&#20214;&#26469;&#30475;&#26159;&#19981;&#19968;&#33268;&#30340;&#65292;&#25152;&#20197;&#30452;&#25509;&#21512;&#24182;&#32943;&#23450;&#26159;&#19981;&#34892;&#30340;&#65292;&#25105;&#20204;&#38656;&#35201;&#20808;&#23558;&#33410;&#36827;&#34892;&#20869;&#23384;&#23545;&#40784;&#23637;&#24320;&#12290;&#39318;&#20808;&#65292;&#38656;&#35201;&#30693;&#36947;&#24403;&#21069;PE&#25991;&#20214;&#30340;&#20869;&#23384;&#23545;&#40784;&#30340;&#20540;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-28_16-10-22.png" alt="images/download/attachments/1015828/image2021-12-28_16-10-22.png" width="600"  />
    </p>
<p   
>&#22914;&#19978;&#22270;&#25152;&#31034;&#20869;&#23384;&#23545;&#40784;&#23601;&#26159;0x1000&#65292;&#25509;&#30528;&#25214;&#21040;&#33410;&#34920;&#25104;&#21592;&#65292;&#23558;&#20854;&#23545;&#24212;&#25104;&#21592;&#23646;&#24615;&#25353;&#22914;&#19979;&#20844;&#24335;&#20195;&#20837;&#35745;&#31639;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-30_15-30-35.png" alt="images/download/attachments/1015828/image2021-12-30_15-30-35.png" width="600"  />
    </p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">⌈⌉(max(SizeOfRawData, Misc) / SectionAlignment) = ResultA </code><code class="comments">// 取SizeOfRawData和Misc之间的最大值除以内存对齐的值，最后的结果向上取整(符号⌈⌉)</code></div>
<div class="line"><code class="plain">ResultA * SectionAlignment = ResultB </code><code class="comments">// ResultA乘以内存对齐的值</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 代入公式计算</code></div>
<div class="line"><code class="plain">max(</code><code class="value">0x7800</code><code class="plain">, </code><code class="value">0x7748</code><code class="plain">) = </code><code class="value">0x7800</code></div>
<div class="line"><code class="plain">⌈⌉(</code><code class="value">0x7800</code><code class="plain"> / </code><code class="value">0x1000</code><code class="plain">) = ⌈⌉(</code><code class="value">0x7</code><code class="plain"> 余 </code><code class="value">0.8</code><code class="plain">) = </code><code class="value">0x8</code></div>
<div class="line"><code class="value">0x8</code><code class="plain"> x </code><code class="value">0x1000</code><code class="plain"> = </code><code class="value">0x8000</code></div>
</div>
    </div>
<p   
>&#25353;&#20844;&#24335;&#24471;&#20986;&#30340;&#32467;&#26524;&#26367;&#25442;&#21407;&#20808;&#30340;SizeOfRawData&#12289;Misc&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-30_15-35-4.png" alt="images/download/attachments/1015828/image2021-12-30_15-35-4.png" width="600"  />
    </p>
<p   
>&#25509;&#30528;&#25105;&#20204;&#38656;&#35201;&#23558;&#20869;&#23384;&#23545;&#40784;&#21518;&#30340;&#20540;&#20943;&#21435;&#21407;SizeOfRawData&#30340;&#20540;&#65292;&#24471;&#20986;&#19968;&#20010;&#24046;&#20540;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">0x8000</code><code class="plain"> - </code><code class="value">0x7800</code><code class="plain"> = </code><code class="value">0x800</code></div>
</div>
    </div>
<p   
>&#36825;&#20010;&#20540;&#21017;&#29992;&#20110;&#22686;&#21152;&#33410;&#30340;&#31354;&#38388;&#65292;&#25214;&#21040;&#35813;&#33410;&#30340;&#26411;&#23614;&#65292;&#20063;&#23601;&#26159;PointerToRawData&#30340;&#20540;&#21152;&#19978;&#21407;SizeOfRawData&#30340;&#20540;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">0x400</code><code class="plain"> + </code><code class="value">0x7800</code><code class="plain"> = </code><code class="value">0x7C00</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-30_15-39-11.png" alt="images/download/attachments/1015828/image2021-12-30_15-39-11.png" width="600"  />
    </p>
<p   
>&#22312;&#36825;&#24320;&#22987;&#28155;&#21152;0x800&#23383;&#33410;&#30340;&#31354;&#38388;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-30_17-15-28.png" alt="images/download/attachments/1015828/image2021-12-30_17-15-28.png" width="600"  />
    </p>
<p   
>&#30001;&#20110;&#25105;&#20204;&#36825;&#37324;&#20462;&#25913;&#20102;&#31532;&#19968;&#20010;&#33410;&#30340;&#22823;&#23567;&#24182;&#28155;&#21152;&#20102;&#31354;&#38388;&#65292;&#25152;&#20197;&#20043;&#21518;&#30340;&#33410;&#30340;&#25991;&#20214;&#20559;&#31227;&#65288;PointerToRawData&#65289;&#35201;&#23545;&#24212;&#28155;&#21152;&#19978;&#22686;&#21152;&#30340;&#24046;&#20540;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-30_17-16-22.png" alt="images/download/attachments/1015828/image2021-12-30_17-16-22.png" width="600"  />
    </p>
<p   
>&#25353;&#29031;&#36825;&#26679;&#30340;&#27493;&#39588;&#20197;&#27492;&#31867;&#25512;&#23558;&#25152;&#26377;&#30340;&#33410;&#20840;&#37096;&#25353;&#29031;&#20869;&#23384;&#23545;&#40784;&#30340;&#26041;&#24335;&#36827;&#34892;&#20462;&#27491;&#65288;&#30001;&#20110;SizeOfImage&#26412;&#36523;&#23601;&#26159;&#25353;&#20869;&#23384;&#23545;&#40784;&#20043;&#21518;&#30340;&#22823;&#23567;&#65292;&#25152;&#20197;&#20854;&#30340;&#20540;&#20250;&#27604;&#23454;&#38469;&#20540;&#22823;&#65292;<strong class=" ">&#25105;&#20204;&#36825;&#37324;&#28155;&#21152;&#30340;&#31354;&#38388;&#20174;&#29702;&#35770;&#19978;&#26469;&#35828;&#20063;&#19981;&#20250;&#36229;&#20986;&#36825;&#20010;&#20540;&#65292;&#29978;&#33267;&#25105;&#20204;&#25152;&#28155;&#21152;&#20043;&#21518;&#30340;&#22823;&#23567;&#26159;&#31561;&#20110;&#36825;&#20010;&#20540;&#30340;</strong>&#65292;&#20063;&#23601;&#26080;&#38656;&#26356;&#25913;&#65289;&#12290;</p>
    </div>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAt5omL5Yqo5ZCI5bm26IqC">
        <h3 class="heading "><span>&#25163;&#21160;&#21512;&#24182;&#33410;</span></h3>
<p   
>&#25509;&#19979;&#26469;&#25105;&#20204;&#38656;&#35201;&#35745;&#31639;&#20986;&#25152;&#26377;&#33410;&#30340;&#22823;&#23567;&#65292;&#36825;&#37324;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;SizeOfImage&#20943;&#21435;SizeOfHeaders&#20869;&#23384;&#23545;&#40784;&#20043;&#21518;&#30340;&#22823;&#23567;&#65292;&#24471;&#20986;&#30340;&#32467;&#26524;0x12000&#23601;&#26159;&#25152;&#26377;&#33410;&#30340;&#22823;&#23567;&#65288;&#20320;&#20063;&#21487;&#20197;&#36873;&#25321;&#35745;&#31639;&#25152;&#26377;&#33410;&#23637;&#24320;&#21518;&#30340;&#22823;&#23567;&#21644;&#65292;&#36825;&#26102;&#20505;&#20320;&#23601;&#20250;&#21457;&#29616;&#36825;&#37324;&#30340;&#22823;&#23567;&#26159;&#19968;&#27169;&#19968;&#26679;&#30340;&#65289;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-28_16-43-17.png" alt="images/download/attachments/1015828/image2021-12-28_16-43-17.png" width="900"  />
    </p>
<p   
>&#37027;&#20040;&#36825;&#20010;&#20540;&#25105;&#20204;&#23601;&#23545;&#24212;&#32473;&#21040;&#31532;&#19968;&#20010;&#33410;&#34920;&#25104;&#21592;&#20013;&#30340;SizeOfRawData&#12289;Misc&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-30_17-19-57.png" alt="images/download/attachments/1015828/image2021-12-30_17-19-57.png" width="600"  />
    </p>
<p   
>&#28982;&#21518;&#30001;&#20110;&#25105;&#20204;&#21512;&#24182;&#20102;&#20854;&#20182;&#30340;&#33410;&#65292;&#20294;&#26159;&#20854;&#20182;&#33410;&#30340;Characteristics&#65288;&#23646;&#24615;&#65289;&#26159;&#19981;&#19968;&#26679;&#30340;&#65292;&#25105;&#20204;&#21512;&#24182;&#20102;&#20063;&#35201;&#23558;&#20854;&#20182;&#33410;&#30340;&#23646;&#24615;&#28155;&#21152;&#36827;&#26469;&#65292;&#36825;&#37324;&#21487;&#20197;&#36873;&#25321;&#20351;&#29992;&#25110;&#36816;&#31639;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#23601;&#26159;&#36827;&#34892;&#25110;&#36816;&#31639;&#20043;&#21518;&#30340;&#32467;&#26524;0xE0000060&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-28_16-56-10.png" alt="images/download/attachments/1015828/image2021-12-28_16-56-10.png" width="600"  />
    </p>
<p   
>&#23558;&#36825;&#20010;&#32467;&#26524;&#32473;&#21040;&#31532;&#19968;&#20010;&#33410;&#34920;&#25104;&#21592;&#30340;Characteristics&#21363;&#21487;&#12290;&#26368;&#21518;&#22240;&#20026;&#25152;&#26377;&#33410;&#21512;&#24182;&#20026;&#19968;&#20102;&#65292;&#25152;&#20197;&#25105;&#20204;&#35201;&#20462;&#25913;NumberOfSections&#30340;&#20540;&#20026;1&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-28_16-58-26.png" alt="images/download/attachments/1015828/image2021-12-28_16-58-26.png" width="600"  />
    </p>
<p   
>&#20854;&#20182;&#30340;&#33410;&#34920;&#25104;&#21592;&#21487;&#20197;&#29992;00&#22635;&#20805;&#65292;&#36825;&#19968;&#22359;&#31354;&#38388;&#23601;&#21487;&#20197;&#32473;&#25105;&#20204;&#28155;&#21152;&#33258;&#24049;&#30340;&#33410;&#34920;&#25104;&#21592;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2021-12-30_17-22-7.png" alt="images/download/attachments/1015828/image2021-12-30_17-22-7.png" width="600"  />
    </p>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-1015828_safe-id-UEXln7rnoYAt5a-85Ye66KGo">
        <h1 class="heading "><span>&#23548;&#20986;&#34920;</span></h1>
<p   
>&#19968;&#20010;&#21487;&#25191;&#34892;&#31243;&#24207;&#26159;&#30001;&#22810;&#20010;PE&#25991;&#20214;&#32452;&#25104;&#65292;&#36825;&#20123;PE&#25991;&#20214;&#20381;&#38752;&#20498;&#20837;&#34920;&#12289;&#23548;&#20986;&#34920;&#36827;&#34892;&#32852;&#31995;&#65292;&#23548;&#20986;&#34920;&#23384;&#20648;&#30528;PE&#25991;&#20214;&#25552;&#20379;&#32473;&#20854;&#20182;&#20154;&#20351;&#29992;&#30340;&#20989;&#25968;&#21015;&#34920;&#65292;&#23548;&#20837;&#34920;&#21017;&#23384;&#20648;&#30528;PE&#25991;&#20214;&#25152;&#38656;&#35201;&#29992;&#21040;&#30340;PE&#25991;&#20214;&#21015;&#34920;&#12290;&#20174;PE&#25991;&#20214;&#30340;&#35282;&#24230;&#21435;&#30475;&#65292;&#20219;&#20309;PE&#25991;&#20214;&#37117;&#21487;&#20197;&#26377;&#23548;&#20837;&#12289;&#23548;&#20986;&#34920;&#65292;&#20174;&#19968;&#33324;&#24773;&#20917;&#19979;&#26469;&#30475;&#65292;EXE&#25991;&#20214;&#19981;&#20250;&#25552;&#20379;&#23548;&#20986;&#34920;&#65292;&#20063;&#23601;&#26159;&#19981;&#20250;&#25552;&#20379;&#32473;&#20182;&#20154;&#20351;&#29992;&#30340;&#20989;&#25968;&#65292;&#20294;&#36825;&#24182;&#19981;&#20195;&#34920;&#19981;&#21487;&#20197;&#25552;&#20379;&#12290;</p>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAt5a6a5L2N5a-85Ye66KGo">
        <h2 class="heading "><span>&#23450;&#20301;&#23548;&#20986;&#34920;</span></h2>
<p   
>&#22312;PE&#26684;&#24335;&#22270;&#20013;&#65292;&#25193;&#23637;PE&#22836;&#26368;&#21518;&#19968;&#20010;&#25104;&#21592;&#26159;&#32467;&#26500;&#20307;&#25968;&#32452;&#65292;&#22312;&#36825;&#20010;&#32467;&#26500;&#20307;&#25968;&#32452;&#37324;&#38754;&#26377;16&#20010;&#32467;&#26500;&#20307;&#65292;&#31532;&#19968;&#20010;&#32467;&#26500;&#20307;&#23601;&#26159;&#23548;&#20986;&#34920;&#30456;&#20851;&#30340;&#20449;&#24687;&#65292;&#23427;&#26377;2&#20010;&#25104;&#21592;&#65292;&#19968;&#20010;&#34920;&#31034;&#23548;&#20986;&#34920;&#30340;&#22320;&#22336;&#65292;&#19968;&#20010;&#34920;&#31034;&#23548;&#20986;&#34920;&#30340;&#22823;&#23567;&#12290;&#22914;&#19979;&#22270;&#25152;&#31034;&#20013;&#30340;<strong class=" ">_IMAGE_EXPORT_DIRECTORY</strong>&#65292;&#23601;&#26159;PE&#23548;&#20986;&#34920;&#30340;&#32467;&#26500;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-4_14-29-15.png" alt="images/download/attachments/1015828/image2022-1-4_14-29-15.png" width="600"  />
    </p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#33258;&#24049;&#32534;&#20889;&#12289;&#21457;&#24067;&#19968;&#20010;DLL&#65292;&#23548;&#20986;&#34920;&#36825;&#26679;&#20889;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">EXPORTS</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">Add </code><code class="color1">@10</code></div>
<div class="line"><code class="plain">Sub </code><code class="color1">@12</code></div>
<div class="line"><code class="plain">Div </code><code class="color1">@13</code><code class="plain"> NONAME</code></div>
<div class="line"><code class="plain">Mul </code><code class="color1">@15</code></div>
</div>
    </div>
<p   
>&#25509;&#30528;&#25105;&#20204;&#21487;&#20197;&#25163;&#21160;&#21435;&#23450;&#20301;&#19968;&#19979;&#23548;&#20986;&#34920;&#30340;&#20301;&#32622;&#65292;&#20808;&#25214;&#21040;&#25193;&#23637;PE&#22836;&#30340;&#26368;&#21518;&#19968;&#20010;&#25104;&#21592;&#32467;&#26500;&#20307;&#25968;&#32452;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-4_16-48-22.png" alt="images/download/attachments/1015828/image2022-1-4_16-48-22.png" width="600"  />
    </p>
<p   
>&#28982;&#21518;&#25214;&#21040;&#35813;&#32467;&#26500;&#20307;&#25968;&#32452;&#30340;&#31532;&#19968;&#20010;&#32467;&#26500;&#20307;&#65292;&#37324;&#38754;&#23601;&#21253;&#21547;&#20102;&#23548;&#20986;&#34920;&#30340;&#22320;&#22336;&#21644;&#22823;&#23567;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">VirtualAddress: </code><code class="value">0x0002AD80</code></div>
<div class="line"><code class="plain">Size: </code><code class="value">0x0000017F</code></div>
</div>
    </div>
<p   
>&#36825;&#20010;&#22320;&#22336;&#26159;RVA&#65292;&#23427;&#23454;&#38469;&#19978;&#34920;&#31034;&#30340;&#26159;&#30456;&#23545;&#34394;&#25311;&#22320;&#22336;&#65292;&#25105;&#20204;&#38656;&#35201;&#23558;&#20854;&#36716;&#20026;FOA&#65292;&#20063;&#23601;&#22312;&#25991;&#20214;&#20013;&#30340;&#20559;&#31227;&#22320;&#22336;&#65292;&#30001;&#20110;&#22312;&#24403;&#21069;PE&#25991;&#20214;&#20013;&#25991;&#20214;&#23545;&#40784;&#21644;&#20869;&#23384;&#23545;&#40784;&#26159;&#19968;&#26679;&#30340;&#65292;&#21363;RVA&#31561;&#20110;FOA&#65292;&#25152;&#20197;&#25105;&#20204;&#20063;&#19981;&#38656;&#35201;&#36827;&#34892;&#36716;&#25442;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-4_15-27-2.png" alt="images/download/attachments/1015828/image2022-1-4_15-27-2.png" width="600"  />
    </p>
<p   
>&#25509;&#30528;&#36319;&#36827;&#36825;&#20010;&#22320;&#22336;&#23601;&#21487;&#20197;&#25214;&#21040;&#23548;&#20986;&#34920;&#20102;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-4_16-49-26.png" alt="images/download/attachments/1015828/image2022-1-4_16-49-26.png" width="600"  />
    </p>
<p   
>&#25509;&#30528;&#25105;&#20204;&#26469;&#30475;&#19979;&#23548;&#20986;&#34920;&#30340;&#32467;&#26500;&#65292;&#20320;&#20250;&#21457;&#29616;&#25105;&#20204;&#23454;&#38469;&#19978;&#25214;&#21040;&#30340;&#23548;&#20986;&#34920;&#65292;&#20854;&#25972;&#20307;&#22823;&#23567;&#26159;&#22823;&#20110;&#22914;&#19979;&#32467;&#26500;&#65288;40&#23383;&#33410;&#65289;&#65292;&#36825;&#26159;&#22240;&#20026;&#22312;&#36825;&#24352;&#34920;&#20013;&#36824;&#21253;&#21547;&#20102;3&#20010;&#23376;&#34920;&#65292;&#20063;&#23601;&#26159;&#22914;&#19979;&#32467;&#26500;&#20307;&#30340;&#26368;&#21518;&#19977;&#20010;&#25104;&#21592;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">typedef struct _IMAGE_EXPORT_DIRECTORY {</code></div>
<div class="line"><code class="plain">    DWORD   Characteristics; </code><code class="comments">// 未使用</code></div>
<div class="line"><code class="plain">    DWORD   TimeDateStamp; </code><code class="comments">// 时间戳，表示当前PE文件（DLL）编译时的时间</code></div>
<div class="line"><code class="plain">    WORD    MajorVersion; </code><code class="comments">// 未使用</code></div>
<div class="line"><code class="plain">    WORD    MinorVersion; </code><code class="comments">// 未使用</code></div>
<div class="line"><code class="plain">    DWORD   Name; </code><code class="comments">// 当前导出表文件名字符串的地址</code></div>
<div class="line"><code class="plain">    DWORD   Base; </code><code class="comments">// 导出函数起始序号</code></div>
<div class="line"><code class="plain">    DWORD   NumberOfFunctions; </code><code class="comments">// 所有导出函数的个数</code></div>
<div class="line"><code class="plain">    DWORD   NumberOfNames; </code><code class="comments">// 以函数名字导出的函数个数</code></div>
<div class="line"><code class="plain">    DWORD   AddressOfFunctions;</code><code class="comments">// RVA，导出函数地址表</code></div>
<div class="line"><code class="plain">    DWORD   AddressOfNames; </code><code class="comments">// 导出函数名称表RVA</code></div>
<div class="line"><code class="plain">    DWORD   AddressOfNameOrdinals; </code><code class="comments">// 导出函数序号表RVA</code></div>
<div class="line"><code class="plain">} IMAGE_EXPORT_DIRECTORY, *PIMAGE_EXPORT_DIRECTORY;</code></div>
</div>
    </div>
<p   
>&#25152;&#20197;&#25490;&#38500;&#23376;&#34920;&#65292;&#25105;&#20204;&#30340;&#32467;&#26500;&#20307;&#23601;&#21482;&#26377;40&#23383;&#33410;&#65292;&#25509;&#30528;&#25105;&#20204;&#20174;&#31532;4&#20010;&#25104;&#21592;&#65292;&#36880;&#27493;&#35299;&#26512;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAt6Kej5p6Q5a-85Ye66KGo5oiQ5ZGY">
        <h2 class="heading "><span>&#35299;&#26512;&#23548;&#20986;&#34920;&#25104;&#21592;</span></h2>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAtTmFtZQ">
        <h3 class="heading auto-cursor-target"><span>Name</span></h3>
<p  class="auto-cursor-target" 
>&#29992;&#20110;&#34920;&#31034;&#24403;&#21069;&#23548;&#20986;&#34920;&#25991;&#20214;&#21517;&#65292;&#36825;&#26159;&#19968;&#20010;&#23383;&#31526;&#20018;&#65292;&#25152;&#20197;&#25105;&#20204;&#21482;&#38656;&#35201;&#25214;&#21040;00&#21363;&#20572;&#27490;&#23547;&#25214;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">0x0002ADD2</code><code class="plain"> -&gt; DLLDemo.dll</code></div>
</div>
    </div>
<p  class="auto-cursor-target" 
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-4_16-49-59.png" alt="images/download/attachments/1015828/image2022-1-4_16-49-59.png" width="600"  />
    </p>
    </div>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAtQmFzZQ">
        <h3 class="heading auto-cursor-target"><span>Base</span></h3>
<p  class="auto-cursor-target" 
>&#29992;&#20110;&#34920;&#31034;&#24403;&#21069;&#23548;&#20986;&#20989;&#25968;&#30340;&#36215;&#22987;&#24207;&#21495;&#65292;&#20063;&#23601;&#26159;&#20320;&#23450;&#20041;&#30340;.DEF&#20013;&#26368;&#23567;&#30340;&#37027;&#20010;&#24207;&#21495;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">0x0000000A</code><code class="plain"> -&gt; </code><code class="value">10</code></div>
</div>
    </div>
    </div>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAtTnVtYmVyT2ZGdW5jdGlvbnM">
        <h3 class="heading auto-cursor-target"><span>NumberOfFunctions</span></h3>
<p  class="auto-cursor-target" 
>&#29992;&#20110;&#34920;&#31034;&#25152;&#26377;&#23548;&#20986;&#20989;&#25968;&#30340;&#20010;&#25968;&#65292;&#36825;&#20010;&#25968;&#26159;&#25353;&#29031;&#20320;&#23450;&#20041;&#30340;.DEF&#20013;&#30340;&#24207;&#21495;&#31639;&#30340;&#65292;<strong class=" ">&#22914;&#26524;&#22312;&#23548;&#20986;&#26102;&#19981;&#25353;&#24207;&#21495;&#39034;&#24207;&#23548;&#20986;&#65292;&#21017;&#31354;&#20313;&#20301;&#20063;&#35745;&#20837;&#24635;&#21644;</strong>&#65292;&#20363;&#22914;&#22914;&#19979;&#25152;&#31034;&#65292;&#25105;&#20204;&#23454;&#38469;&#19978;&#21482;&#26377;4&#20010;&#23548;&#20986;&#20989;&#25968;&#65292;&#20294;&#26159;&#22240;&#20026;&#23548;&#20986;&#20989;&#25968;&#30340;&#24207;&#21495;&#27809;&#26377;&#25353;&#29031;&#39034;&#24207;&#26469;&#36827;&#34892;&#23548;&#20986;&#65292;&#23548;&#33268;&#35745;&#31639;&#30340;&#26102;&#20505;&#23558;&#31354;&#32570;&#30340;&#20063;&#31639;&#20837;&#36827;&#21435;&#20102;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">0x00000006</code><code class="plain"> -&gt; </code><code class="value">6</code></div>
</div>
    </div>
    </div>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAtTnVtYmVyT2ZOYW1lcw">
        <h3 class="heading auto-cursor-target"><span>NumberOfNames</span></h3>
<p  class="auto-cursor-target" 
>&#29992;&#20110;&#34920;&#31034;&#20197;&#20989;&#25968;&#21517;&#23383;&#23548;&#20986;&#30340;&#20989;&#25968;&#20010;&#25968;&#65292;&#22914;&#26524;&#20320;&#22312;&#23450;&#20041;&#30340;.DEF&#20013;&#35774;&#32622;&#20102;&#23548;&#20986;&#20989;&#25968;&#30340;&#23646;&#24615;&#20026;NONAME&#21017;&#23601;&#26159;&#20197;&#24207;&#21495;&#30340;&#26041;&#24335;&#23548;&#20986;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">0x00000003</code><code class="plain"> -&gt; </code><code class="value">3</code></div>
</div>
    </div>
    </div>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAtQWRkcmVzc09mRnVuY3Rpb25z">
        <h3 class="heading auto-cursor-target"><span>AddressOfFunctions</span></h3>
<p  class="auto-cursor-target" 
>&#29992;&#20110;&#34920;&#31034;&#23548;&#20986;&#20989;&#25968;&#22320;&#22336;&#34920;&#30340;&#22320;&#22336;&#65292;&#36825;&#37324;&#30340;&#22320;&#22336;&#26159;RVA&#65292;&#22914;&#26524;&#24403;&#21069;PE&#25991;&#20214;&#30340;&#25991;&#20214;&#23545;&#40784;&#19982;&#20869;&#23384;&#23545;&#40784;&#19981;&#19968;&#33268;&#65292;&#38656;&#35201;&#36716;&#25442;&#20026;FOA&#65292;&#25105;&#20204;&#36825;&#36793;&#26159;&#19968;&#26679;&#30340;&#65292;&#25152;&#20197;&#19981;&#38656;&#35201;&#36827;&#34892;&#36716;&#25442;&#65307;&#36890;&#36807;NumberOfFunctions&#30693;&#36947;&#26377;6&#20010;&#23548;&#20986;&#20989;&#25968;&#65292;&#25152;&#20197;&#20174;&#35813;&#22320;&#22336;&#24320;&#22987;&#20381;&#27425;&#23547;&#25214;6&#20010;4&#23383;&#33410;&#30340;&#22320;&#22336;&#21363;&#21487;&#65292;<strong class=" ">&#25105;&#20204;&#21487;&#20197;&#24456;&#28165;&#26970;&#30340;&#30475;&#35265;&#36825;&#37324;&#30340;&#22320;&#22336;&#26377;&#20123;&#23601;&#26159;00&#22635;&#20805;&#30340;</strong>&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">0x0002ADA8</code><code class="plain"> -&gt; </code></div>
<div class="line"><code class="value">0x0000100A</code></div>
<div class="line"><code class="value">0x0000100F</code></div>
<div class="line"><code class="value">0x00000000</code></div>
<div class="line"><code class="value">0x00001019</code></div>
<div class="line"><code class="value">0x00000000</code></div>
<div class="line"><code class="value">0x00001014</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-4_16-55-55.png" alt="images/download/attachments/1015828/image2022-1-4_16-55-55.png" width="600"  />
    </p>
<p  class="auto-cursor-target" 
>&#22914;&#26524;&#20320;&#24819;&#30475;&#35265;&#20855;&#20307;&#30340;&#36825;&#20123;&#20989;&#25968;&#23545;&#24212;&#30340;&#20195;&#30721;&#65292;&#21487;&#20197;&#26681;&#25454;&#20559;&#31227;&#22320;&#22336;&#25214;&#21040;&#23545;&#24212;&#30340;&#23383;&#33410;&#30721;&#65292;&#32780;&#21518;&#23558;&#20854;&#25918;&#20837;DTDebug&#20043;&#31867;&#30340;&#35843;&#35797;&#24037;&#20855;&#21363;&#21487;&#30475;&#35265;&#23436;&#25972;&#30340;&#20195;&#30721;&#65292;&#20294;&#26159;&#22312;&#36825;&#37324;&#32534;&#35793;&#22120;&#20570;&#20102;&#19968;&#19979;&#20248;&#21270;&#65292;&#21152;&#20102;&#19968;&#23618;JMP&#36339;&#36716;&#65292;&#20855;&#20307;&#30340;&#23601;&#35201;&#36319;&#19979;&#21435;&#20102;&#65306;</p>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col />
                                    <col />
                                    <col />
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>&#20989;&#25968;&#21517;</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>&#22320;&#22336;</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>&#23383;&#33410;&#30721;</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Add</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0x0000100A</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>E9 61 00 00 00</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Sub</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0x0000100F</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>E9 8C 00 00 00</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Div</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0x00001019</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>E9 E7 00 00 00</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Mul</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0x00001014</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>E9 B2 00 00 00</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAtQWRkcmVzc09mTmFtZXM">
        <h3 class="heading "><span>AddressOfNames</span></h3>
<p   
>&#29992;&#20110;&#34920;&#31034;&#23548;&#20986;&#20989;&#25968;&#21517;&#31216;&#34920;&#30340;&#22320;&#22336;&#65292;&#36825;&#24352;&#34920;&#26159;&#25353;&#29031;&#39318;&#23383;&#27597;A-Za-z&#25490;&#24207;&#30340;&#65292;&#21516;&#26679;&#36825;&#37324;&#30340;&#22320;&#22336;&#26159;RVA&#65292;&#38656;&#35201;&#36716;&#25442;&#20026;FOA&#65307;&#36890;&#36807;NumberOfNames&#30693;&#36947;&#26377;3&#20010;&#26159;&#20197;&#20989;&#25968;&#21517;&#23383;&#23548;&#20986;&#30340;&#20989;&#25968;&#65292;&#25152;&#20197;&#20174;&#35813;&#22320;&#22336;&#24320;&#22987;&#20381;&#27425;&#23547;&#25214;3&#20010;4&#23383;&#33410;&#30340;&#22320;&#22336;&#21363;&#21487;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">0x0002ADC0</code><code class="plain"> -&gt;</code></div>
<div class="line"><code class="value">0x0002ADDE</code></div>
<div class="line"><code class="value">0x0002ADE2</code></div>
<div class="line"><code class="value">0x0002ADE6</code></div>
</div>
    </div>
<p   
>&#26681;&#25454;&#22320;&#22336;&#23601;&#21487;&#20197;&#25214;&#21040;&#23545;&#24212;&#30340;&#20989;&#25968;&#21517;&#65288;&#23383;&#31526;&#20018;&#35265;0x00&#21363;&#27490;&#65289;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-4_17-25-6.png" alt="images/download/attachments/1015828/image2022-1-4_17-25-6.png" width="600"  />
    </p>
    </div>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAtQWRkcmVzc09mTmFtZU9yZGluYWxz">
        <h3 class="heading "><span>AddressOfNameOrdinals</span></h3>
<p   
>&#29992;&#20110;&#34920;&#31034;&#23548;&#20986;&#20989;&#25968;&#24207;&#21495;&#34920;&#30340;&#22320;&#22336;&#65292;&#21516;&#26679;&#36825;&#37324;&#30340;&#22320;&#22336;&#26159;RVA&#65292;&#38656;&#35201;&#36716;&#25442;&#20026;FOA&#65307;&#36825;&#37324;&#34920;&#20013;&#30340;&#25104;&#21592;&#25968;&#19982;AddressOfNames&#26159;&#19968;&#33268;&#30340;&#65292;&#20294;&#38656;&#35201;&#27880;&#24847;&#65292;&#24207;&#21495;&#34920;&#20013;&#30340;&#27599;&#20010;&#25104;&#21592;&#20026;2&#23383;&#33410;&#65292;&#37027;&#20063;&#23601;&#26159;&#20174;&#35813;&#22320;&#22336;&#24320;&#22987;&#20381;&#27425;&#23547;&#25214;3&#20010;2&#23383;&#33410;&#25968;&#25454;&#21363;&#21487;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">0x0002ADCC</code><code class="plain"> -&gt;</code></div>
<div class="line"><code class="value">0x0000</code></div>
<div class="line"><code class="value">0x0005</code></div>
<div class="line"><code class="value">0x0002</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-4_17-39-15.png" alt="images/download/attachments/1015828/image2022-1-4_17-39-15.png" width="600"  />
    </p>
<p   
>&#33267;&#27492;&#65292;&#25105;&#20204;&#23601;&#35299;&#26512;&#23436;&#25152;&#26377;&#30340;&#23548;&#20986;&#34920;&#25104;&#21592;&#20102;&#12290;</p>
    </div>
    </div>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAt5a2Q6KGo5LmL6Ze055qE5YWz57O7">
        <h2 class="heading "><span>&#23376;&#34920;&#20043;&#38388;&#30340;&#20851;&#31995;</span></h2>
<p   
>&#24403;&#25105;&#20204;&#21435;&#35843;&#29992;&#19968;&#20010;DLL&#25991;&#20214;&#65292;&#20351;&#29992;&#20854;&#20013;&#30340;&#26041;&#27861;&#65292;&#38656;&#35201;&#20351;&#29992;&#21040;GetProcAddress&#20989;&#25968;&#21435;&#33719;&#21462;&#20989;&#25968;&#30340;&#22320;&#22336;&#28982;&#21518;&#35843;&#29992;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">FARPROC GetProcAddress(</code></div>
<div class="line"><code class="plain">    HMODULE hModule, </code><code class="comments">// DLL模块句柄</code></div>
<div class="line"><code class="plain">    LPCSTR lpProcName </code><code class="comments">// 函数名/序号</code></div>
<div class="line"><code class="plain">);</code></div>
</div>
    </div>
<p   
>&#23427;&#30340;&#31532;&#20108;&#20010;&#21442;&#25968;lpProcName&#21487;&#20197;&#26159;&#20989;&#25968;&#21517;&#20063;&#21487;&#20197;&#26159;&#24207;&#21495;&#65292;&#32780;&#23427;&#30340;&#21407;&#29702;&#20063;&#27491;&#21487;&#20197;&#34920;&#31034;&#23548;&#20986;&#34920;&#20013;&#30340;&#19977;&#24352;&#23376;&#34920;&#20043;&#38388;&#30340;&#20851;&#31995;&#12290;</p>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAtR2V0UHJvY0FkZHJlc3MoaE1vZHVsZSwiTXVsIik">
        <h3 class="heading "><span>GetProcAddress(hModule, &quot;Mul&quot;)</span></h3>
<p   
>&#24403;&#30452;&#25509;&#20351;&#29992;&#20989;&#25968;&#21517;&#21435;&#23547;&#25214;&#26102;&#65292;&#23427;&#30340;&#27493;&#39588;&#26159;&#36825;&#26679;&#30340;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#20808;&#29992;&#20989;&#25968;&#21517;&#23383;&#21435;&#26597;&#35810;&#20989;&#25968;&#21517;&#31216;&#34920;&#30340;&#32034;&#24341;&#65288;&#27599;&#24352;&#34920;&#37117;&#26377;&#19968;&#20010;&#20174;0&#24320;&#22987;&#30340;&#32034;&#24341;&#65289;&#65307;</p>
</li><li class=" "><p   
>&#26681;&#25454;&#20989;&#25968;&#21517;&#31216;&#34920;&#23545;&#24212;&#30340;&#32034;&#24341;&#21435;&#26597;&#20989;&#25968;&#24207;&#21495;&#34920;&#23545;&#24212;&#32034;&#24341;&#30340;&#24207;&#21495;&#65307;</p>
</li><li class=" "><p   
>&#26681;&#25454;&#20989;&#25968;&#24207;&#21495;&#34920;&#23545;&#24212;&#32034;&#24341;&#30340;&#24207;&#21495;&#26597;&#35810;&#20989;&#25968;&#22320;&#22336;&#34920;&#23545;&#24212;&#32034;&#24341;&#30340;&#22320;&#22336;&#12290;</p>
</li></ol><p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-4_17-58-7.png" alt="images/download/attachments/1015828/image2022-1-4_17-58-7.png" width="600"  />
    </p>
    </div>
    <div class="section section-3" id="src-1015828_safe-id-UEXln7rnoYAtR2V0UHJvY0FkZHJlc3MoaE1vZHVsZSwxMyk">
        <h3 class="heading "><span>GetProcAddress(hModule, 13)</span></h3>
<p   
>&#24403;&#30452;&#25509;&#20351;&#29992;&#24207;&#21495;&#21435;&#23547;&#25214;&#26102;&#65292;&#23427;&#30340;&#27493;&#39588;&#26159;&#36825;&#26679;&#30340;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#20351;&#29992;&#24207;&#21495;&#20943;&#21435;Base&#65288;&#36215;&#22987;&#24207;&#21495;&#65289;&#24471;&#21040;&#30340;&#20540;&#65307;</p>
</li><li class=" "><p   
>&#23558;&#35813;&#20540;&#20195;&#20837;&#20989;&#25968;&#22320;&#22336;&#34920;&#23545;&#24212;&#32034;&#24341;&#65292;&#33719;&#24471;&#20989;&#25968;&#22320;&#22336;&#12290;</p>
</li></ol><p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-4_18-9-58.png" alt="images/download/attachments/1015828/image2022-1-4_18-9-58.png" width="600"  />
    </p>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-1015828_safe-id-UEXln7rnoYAt5a-85YWl6KGo">
        <h1 class="heading "><span>&#23548;&#20837;&#34920;</span></h1>
<p   
>PE&#25991;&#20214;&#25152;&#20381;&#36182;&#30340;&#27169;&#22359;&#20197;&#21450;&#28041;&#21450;&#21040;&#20381;&#36182;&#27169;&#22359;&#20013;&#30340;&#20855;&#20307;&#20989;&#25968;&#37117;&#23384;&#20648;&#22312;&#23548;&#20837;&#34920;&#20013;&#65292;&#25105;&#20204;&#21487;&#20197;&#22312;PE&#26684;&#24335;&#22270;&#30340;&#25193;&#23637;PE&#22836;&#26368;&#21518;&#19968;&#20010;&#25104;&#21592;&#32467;&#26500;&#20307;&#25968;&#32452;&#20013;&#30340;&#31532;&#20108;&#20010;&#32467;&#26500;&#20307;&#25214;&#21040;&#23548;&#20986;&#34920;&#30456;&#20851;&#30340;&#20449;&#24687;&#65292;&#23427;&#26377;2&#20010;&#25104;&#21592;&#65292;&#19968;&#20010;&#34920;&#31034;&#23548;&#20837;&#34920;&#30340;&#22320;&#22336;&#65292;&#19968;&#20010;&#34920;&#31034;&#23548;&#20837;&#34920;&#30340;&#22823;&#23567;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-5_10-24-25.png" alt="images/download/attachments/1015828/image2022-1-5_10-24-25.png" width="600"  />
    </p>
<p   
>&#23548;&#20837;&#34920;&#19982;&#23548;&#20986;&#34920;&#19981;&#21516;&#65292;&#23548;&#20986;&#34920;&#21482;&#26377;&#19968;&#24352;&#65292;&#32780;&#23548;&#20837;&#34920;&#26377;&#24456;&#22810;&#24352;&#65292;&#27599;&#19968;&#24352;&#34920;&#23545;&#24212;&#30528;&#19981;&#21516;&#30340;&#20381;&#36182;&#27169;&#22359;&#65292;&#23548;&#20837;&#34920;&#30340;&#32467;&#26500;&#22914;&#19979;&#65292;&#23427;&#19968;&#20849;&#26377;20&#23383;&#33410;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">typedef struct _IMAGE_IMPORT_DESCRIPTOR {</code></div>
<div class="line"><code class="plain">    union {</code></div>
<div class="line"><code class="plain">        DWORD   Characteristics;</code></div>
<div class="line"><code class="plain">        DWORD   OriginalFirstThunk; </code><code class="comments">// RVA，指向IMAGE_THUNK_DATA结构数组</code></div>
<div class="line"><code class="plain">    };</code></div>
<div class="line"><code class="plain">    DWORD   TimeDateStamp; </code><code class="comments">// 时间戳</code></div>
<div class="line"><code class="plain">    DWORD   ForwarderChain;</code></div>
<div class="line"><code class="plain">    DWORD   Name; </code><code class="comments">// RVA，表示依赖模块名字的地址，这是一串字符串</code></div>
<div class="line"><code class="plain">    DWORD   FirstThunk; </code><code class="comments">// RVA，指向IMAGE_THUNK_DATA结构数组</code></div>
<div class="line"><code class="plain">} IMAGE_IMPORT_DESCRIPTOR;</code></div>
</div>
    </div>
<p   
>&#25105;&#20204;&#21487;&#20197;&#26681;&#25454;&#25193;&#23637;PE&#22836;&#20808;&#25214;&#21040;&#23548;&#20837;&#34920;&#30340;&#30456;&#20851;&#20449;&#24687;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-5_15-43-35.png" alt="images/download/attachments/1015828/image2022-1-5_15-43-35.png" width="600"  />
    </p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">VirtualAddress: </code><code class="value">0x0001CE80</code></div>
<div class="line"><code class="plain">Size: </code><code class="value">0x000000DC</code></div>
</div>
    </div>
<p   
>&#26681;&#25454;VirtualAddress&#25214;&#21040;&#31532;&#19968;&#24352;&#23548;&#20837;&#34920;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-5_16-6-55.png" alt="images/download/attachments/1015828/image2022-1-5_16-6-55.png" width="600"  />
    </p>
<p   
>&#23548;&#20837;&#34920;&#30340;&#27599;&#24352;&#34920;&#20043;&#21518;&#37117;&#36319;&#30528;&#21478;&#22806;&#19968;&#24352;&#34920;&#65292;&#30452;&#21040;&#36935;&#35265;20&#20010;0x00&#32467;&#26463;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#19968;&#20849;&#26377;10&#24352;&#34920;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-5_16-21-40.png" alt="images/download/attachments/1015828/image2022-1-5_16-21-40.png" width="600"  />
    </p>
<p   
><strong class=" ">&#27880;&#24847;</strong>&#65306;&#19979;&#25991;&#20013;&#20986;&#29616;&#30340;PE&#25991;&#20214;<strong class=" ">&#25991;&#20214;&#23545;&#40784;&#19982;&#20869;&#23384;&#23545;&#40784;&#19968;&#33268;&#65292;&#21363;RVA&#31561;&#20110;FOA&#65292;&#26080;&#38656;&#36716;&#25442;</strong>&#12290;</p>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAt56Gu5a6a5L6d6LWW5qih5Z2X">
        <h2 class="heading "><span>&#30830;&#23450;&#20381;&#36182;&#27169;&#22359;</span></h2>
<p   
>&#25214;&#21040;&#23548;&#20837;&#34920;&#20043;&#21518;&#65292;&#25105;&#20204;&#21487;&#20197;&#26681;&#25454;&#23427;&#30340;&#31532;&#22235;&#20010;&#25104;&#21592;Name&#30693;&#36947;&#24403;&#21069;PE&#25991;&#20214;&#25152;&#20381;&#36182;&#30340;&#27169;&#22359;&#21517;&#23383;&#65292;&#20808;&#30475;&#31532;&#19968;&#24352;&#34920;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-5_16-6-55.png" alt="images/download/attachments/1015828/image2022-1-5_16-6-55.png" width="600"  />
    </p>
<p   
>&#23427;&#30340;Name&#25104;&#21592;&#23601;&#26159;&#65306;0x0001D5D8&#65292;&#25509;&#30528;&#25214;&#21040;&#36825;&#20010;&#22320;&#22336;&#26597;&#30475;&#27169;&#22359;&#21517;&#23383;&#65292;&#36825;&#37324;&#20063;&#26159;&#19968;&#20010;ASCII&#23383;&#31526;&#20018;&#65292;&#25152;&#20197;&#20174;&#36825;&#20010;&#22320;&#22336;&#24320;&#22987;&#65292;&#36935;&#35265;0x00&#20572;&#27490;&#23547;&#25214;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-5_16-25-45.png" alt="images/download/attachments/1015828/image2022-1-5_16-25-45.png" width="600"  />
    </p>
<p   
>&#37027;&#20040;&#23427;&#30340;&#21517;&#23383;&#23601;&#26159;KERNEL32.dll&#65292;&#21487;&#20197;&#29992;&#36825;&#24352;&#26041;&#24335;&#20381;&#27425;&#23547;&#25214;&#12290;</p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#23581;&#35797;&#20351;&#29992;&#24037;&#20855;DTDebug&#21435;&#26597;&#30475;PE&#25991;&#20214;&#36816;&#34892;&#26102;&#25152;&#35201;&#20381;&#36182;&#30340;&#27169;&#22359;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-5_16-29-25.png" alt="images/download/attachments/1015828/image2022-1-5_16-29-25.png" width="600"  />
    </p>
<p   
>&#36825;&#26102;&#20505;&#20320;&#20250;&#21457;&#29616;&#36825;&#37324;&#20381;&#36182;&#30340;&#27169;&#22359;&#25968;&#37327;&#36828;&#36828;&#22823;&#20110;10&#65292;&#36825;&#26159;&#22240;&#20026;&#38500;&#20102;&#24403;&#21069;PE&#25991;&#20214;&#26412;&#36523;&#38656;&#35201;&#20381;&#36182;&#30340;&#27169;&#22359;&#20197;&#22806;&#65292;&#20854;&#25152;&#20381;&#36182;&#30340;&#27169;&#22359;&#20063;&#20381;&#36182;&#20102;&#20854;&#20182;&#27169;&#22359;&#65292;&#36825;&#37324;&#23601;&#19968;&#24182;&#23637;&#31034;&#36827;&#26469;&#20102;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAt56Gu5a6a5L6d6LWW5Ye95pWw">
        <h2 class="heading "><span>&#30830;&#23450;&#20381;&#36182;&#20989;&#25968;</span></h2>
<p   
>&#22312;&#19978;&#25991;&#20013;&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;&#23548;&#20837;&#34920;&#30830;&#23450;&#20381;&#36182;&#30340;&#27169;&#22359;&#21517;&#65288;&#23548;&#20837;&#34920;&#32467;&#26500;&#20307;&#30340;&#31532;&#22235;&#20010;&#25104;&#21592;Name&#65289;&#65292;&#25509;&#30528;&#25105;&#20204;&#36824;&#38656;&#35201;&#30830;&#23450;&#20855;&#20307;&#20381;&#36182;&#30340;&#20989;&#25968;&#26159;&#20160;&#20040;&#12290;</p>
<p   
>&#25105;&#20204;&#38656;&#35201;&#20851;&#27880;&#19968;&#19979;&#23548;&#20837;&#34920;&#32467;&#26500;&#20307;&#30340;&#20854;&#20182;&#25104;&#21592;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#31532;&#22235;&#20010;&#25104;&#21592;&#24456;&#22909;&#29702;&#35299;&#23601;&#26159;&#25351;&#21521;&#30340;&#20381;&#36182;&#30340;&#27169;&#22359;&#21517;&#65292;<strong class=" ">&#32780;&#31532;&#19968;&#20010;&#25104;&#21592;&#19982;&#31532;&#20108;&#25104;&#21592;&#37117;&#20998;&#21035;&#25351;&#21521;&#20102;&#19981;&#21516;&#30340;&#34920;&#65292;&#20998;&#21035;&#26159;INT&#65288;Import Name Table&#65292;&#23548;&#20837;&#21517;&#31216;&#34920;&#65289;&#21644;IAT&#65288;Import Address Table&#65292;&#23548;&#20837;&#22320;&#22336;&#34920;&#65289;</strong>&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-7_10-59-44.png" alt="images/download/attachments/1015828/image2022-1-7_10-59-44.png" width="600"  />
    </p>
<p   
>&#20180;&#32454;&#35266;&#23519;&#19978;&#22270;&#65292;&#20320;&#20250;&#21457;&#29616;&#65292;&#34429;&#28982;&#36825;&#20004;&#20010;&#25104;&#21592;&#25351;&#21521;&#26159;&#19981;&#21516;&#30340;&#34920;&#65288;&#22320;&#22336;&#19981;&#19968;&#26679;&#65289;&#20294;&#26159;&#20869;&#23481;&#21364;&#26159;&#19968;&#26679;&#30340;&#65292;&#25105;&#20204;&#36890;&#36807;&#20004;&#20010;&#25104;&#21592;&#37117;&#21487;&#20197;&#25214;&#21040;&#24403;&#21069;&#25152;&#20381;&#36182;&#27169;&#22359;&#20013;&#30340;&#20989;&#25968;&#12290;&#22240;&#27492;&#65292;&#25105;&#20204;&#23601;&#36873;&#25321;&#19968;&#20010;&#25104;&#21592;&#21435;&#23547;&#25214;&#21040;&#20381;&#36182;&#20989;&#25968;&#21363;&#21487;&#65292;&#25105;&#22312;&#36825;&#37324;&#36873;&#25321;&#20102;&#31532;&#19968;&#20010;&#25104;&#21592;OriginalFirstThunk&#12290;</p>
<p   
>&#31532;&#19968;&#20010;&#25104;&#21592;&#25351;&#21521;&#30340;&#23601;&#26159;&#19968;&#20010;INT&#65292;&#36825;&#24352;&#34920;&#20013;&#30340;&#25104;&#21592;&#23601;&#26159;&#22914;&#19979;&#32467;&#26500;&#20307;&#65292;&#36825;&#20010;&#32467;&#26500;&#20307;&#20013;&#23601;&#21482;&#26377;&#19968;&#20010;&#32852;&#21512;&#20307;&#65292;&#23427;&#30340;&#23485;&#24230;&#23601;&#26159;4&#23383;&#33410;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">typedef struct _IMAGE_THUNK_DATA32 {</code></div>
<div class="line"><code class="plain">    union {</code></div>
<div class="line"><code class="plain">        PBYTE  ForwarderString;</code></div>
<div class="line"><code class="plain">        PDWORD Function;</code></div>
<div class="line"><code class="plain">        DWORD Ordinal; </code><code class="comments">// 序号</code></div>
<div class="line"><code class="plain">        PIMAGE_IMPORT_BY_NAME  AddressOfData; </code><code class="comments">// 指向IMAGE_IMPORT_BY_NAME</code></div>
<div class="line"><code class="plain">    } u1;</code></div>
<div class="line"><code class="plain">} IMAGE_THUNK_DATA32;</code></div>
</div>
    </div>
<p   
>INT&#37324;&#26377;&#24456;&#22810;&#20010;&#36825;&#31181;&#32467;&#26500;&#20307;&#65292;&#23427;&#19982;&#20498;&#20837;&#34920;&#19968;&#26679;&#65292;<strong class=" ">&#24403;&#20320;&#36935;&#35265;&#19982;&#35813;&#32467;&#26500;&#20307;&#30456;&#21516;&#23485;&#24230;&#30340;&#19968;&#27573;0x00&#22635;&#20805;&#30340;&#25968;&#25454;&#21017;&#35813;&#34920;&#23601;&#32467;&#26463;&#20102;</strong>&#12290;&#21516;&#26679;&#65292;&#20320;&#22312;&#36825;&#24352;&#34920;&#20013;&#21457;&#29616;&#32467;&#26500;&#20307;&#30340;&#25968;&#37327;&#65292;&#23601;&#34920;&#31034;&#20320;&#20381;&#36182;&#35813;&#27169;&#22359;&#30340;&#20989;&#25968;&#25968;&#37327;&#12290;</p>
<p   
>&#26681;&#25454;&#19978;&#19968;&#31456;&#20013;&#25214;&#21040;&#30340;&#31532;&#19968;&#24352;&#23548;&#20837;&#34920;&#20449;&#24687;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">OriginalFirstThunk：B0 CF </code><code class="value">01</code><code class="plain"> </code><code class="value">00</code><code class="plain"> </code></div>
<div class="line"><code class="plain">Name：D8 D5 </code><code class="value">01</code><code class="plain"> </code><code class="value">00</code><code class="plain"> -&gt; KERNEL32.dll</code></div>
</div>
    </div>
<p   
>&#36319;&#36827;&#22320;&#22336;0x0001CFB0&#65292;&#25214;&#21040;INT&#65292;&#25105;&#20204;&#21487;&#20197;&#30475;&#35265;&#36825;&#37324;&#26377;&#24456;&#22810;&#20010;&#25104;&#21592;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-7_11-27-11.png" alt="images/download/attachments/1015828/image2022-1-7_11-27-11.png" width="600"  />
    </p>
<p   
>&#36825;&#20123;&#25104;&#21592;&#20063;&#26377;&#19968;&#20123;&#31934;&#22937;&#20043;&#22788;&#65292;&#20320;&#38656;&#35201;&#21028;&#26029;&#27599;&#19968;&#20010;&#25104;&#21592;&#30340;&#26368;&#39640;&#20301;&#26159;&#21542;&#26159;1&#65292;&#22914;&#26524;&#26159;&#65292;&#21017;&#21435;&#38500;&#26368;&#39640;&#20301;&#30340;&#20540;&#65292;&#24471;&#20986;&#30340;&#20043;&#30340;&#23601;&#19981;&#26159;&#19968;&#20010;&#22320;&#22336;&#20102;&#65292;&#32780;&#26159;&#20989;&#25968;&#30340;&#23548;&#20986;&#24207;&#21495;&#65292;<strong class=" ">&#21453;&#20043;&#23601;&#26159;&#19968;&#20010;RVA&#65292;&#25351;&#21521;&#20102;&#22914;&#19979;&#32467;&#26500;&#20307;</strong>&#65292;&#36825;&#20010;&#32467;&#26500;&#20307;&#19968;&#20849;&#21482;&#26377;&#19977;&#20010;&#23383;&#33410;&#65292;<strong class=" ">&#31532;&#19968;&#20010;&#25104;&#21592;Hint&#21487;&#33021;&#20026;&#31354;&#65292;&#22914;&#26524;&#19981;&#20026;&#31354;&#65292;&#37027;&#20040;&#23427;&#23601;&#26159;&#20989;&#25968;&#22312;&#23548;&#20986;&#34920;&#20013;&#30340;&#32034;&#24341;&#65292;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;&#36825;&#20010;&#32034;&#24341;&#30452;&#25509;&#21435;&#23548;&#20986;&#34920;&#25214;&#21040;&#20989;&#25968;&#30340;&#22320;&#22336;</strong>&#65307;<strong class=" ">&#31532;&#20108;&#20010;&#25104;&#21592;Name&#65292;&#20063;&#23601;&#26159;&#20989;&#25968;&#30340;&#21517;&#23383;&#65292;&#21482;&#26377;&#19968;&#20010;&#23383;&#33410;&#65292;&#36825;&#26159;&#22240;&#20026;&#20989;&#25968;&#21517;&#23383;&#30340;&#38271;&#24230;&#26080;&#27861;&#30830;&#23450;&#65292;&#25152;&#20197;&#21482;&#21462;&#21517;&#23383;&#30340;&#31532;&#19968;&#20010;&#65292;&#22914;&#26524;&#20320;&#35201;&#23436;&#25972;&#23547;&#25214;&#30340;&#35805;&#65292;&#21517;&#23383;&#26159;&#19968;&#20010;ASCII&#23383;&#31526;&#20018;&#65292;&#20174;&#31532;&#19968;&#20010;&#21517;&#23383;&#24320;&#22987;&#25214;&#65292;&#30452;&#33267;&#36935;&#35265;0x00&#32467;&#26463;</strong>&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">typedef struct _IMAGE_IMPORT_BY_NAME {</code></div>
<div class="line"><code class="plain">    WORD    Hint;</code></div>
<div class="line"><code class="plain">    BYTE    Name[</code><code class="value">1</code><code class="plain">];</code></div>
<div class="line"><code class="plain">} IMAGE_IMPORT_BY_NAME</code></div>
</div>
    </div>
<p   
>&#37027;&#20040;&#25105;&#20204;&#26469;&#30475;&#19968;&#19979;INT&#20013;&#30340;&#31532;&#19968;&#20010;&#25104;&#21592;&#65288;&#22320;&#22336;&#65306;0x0001D45E&#65289;&#25351;&#21521;&#30340;&#32467;&#26500;&#20307;&#65292;&#22914;&#19979;&#25152;&#31034;&#65292;&#36825;&#37324;&#30340;&#31532;&#19968;&#20010;&#25104;&#21592;Hint&#19981;&#20026;&#31354;&#25152;&#20197;&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;&#23427;&#21435;&#23548;&#20837;&#34920;&#20013;&#25214;&#20989;&#25968;&#22320;&#22336;&#65292;&#31532;&#20108;&#20010;&#25104;&#21592;0x45&#65292;&#20174;&#23427;&#24320;&#22987;&#24448;&#21518;&#30452;&#21040;0x00&#23601;&#26159;&#23436;&#25972;&#30340;&#20989;&#25968;&#21517;&#23383;<strong class=" ">ExitThread</strong>&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-7_11-40-55.png" alt="images/download/attachments/1015828/image2022-1-7_11-40-55.png" width="600"  />
    </p>
    </div>
    <div class="section section-2" id="src-1015828_safe-id-UEXln7rnoYAt56Gu5a6a5Ye95pWw5Zyw5Z2A">
        <h2 class="heading "><span>&#30830;&#23450;&#20989;&#25968;&#22320;&#22336;</span></h2>
<p   
>&#20043;&#21069;&#25105;&#20204;&#25152;&#20102;&#35299;&#30340;&#20004;&#24352;&#34920;INT&#12289;IAT&#65292;&#22312;PE&#25991;&#20214;&#21152;&#36733;&#21069;&#20854;&#32467;&#26500;&#20869;&#23481;&#37117;&#26159;&#19968;&#26679;&#30340;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-7_10-59-44.png" alt="images/download/attachments/1015828/image2022-1-7_10-59-44.png" width="600"  />
    </p>
<p   
>&#20294;&#26159;&#65292;&#24403;PE&#25991;&#20214;&#21152;&#36733;&#20043;&#21518;&#65292;IAT&#23601;&#21457;&#29983;&#20102;&#21464;&#21270;&#65292;&#23427;&#37324;&#38754;&#23601;&#30452;&#25509;&#23384;&#20648;&#20102;&#20989;&#25968;&#30340;&#22320;&#22336;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-7_11-52-0.png" alt="images/download/attachments/1015828/image2022-1-7_11-52-0.png" width="600"  />
    <br/>&#25105;&#20204;&#22312;&#20351;&#29992;&#20381;&#36182;&#27169;&#22359;&#30340;&#20989;&#25968;&#26102;&#65292;&#23454;&#38469;&#19978;&#26159;&#38388;&#25509;&#35843;&#29992;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#35843;&#29992;MessageBox&#65292;&#27719;&#32534;&#25351;&#20196;&#21435;&#35843;&#29992;&#24182;&#19981;&#26159;&#30452;&#25509;call&#22320;&#22336;&#65292;&#32780;&#26159;&#38388;&#25509;&#30340;&#65292;&#20174;&#20869;&#23384;&#20013;&#25214;&#21040;&#22320;&#22336;&#20877;&#21435;call&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-7_14-4-14.png" alt="images/download/attachments/1015828/image2022-1-7_14-4-14.png" width="600"  />
    </p>
<p   
>&#32780;&#36825;&#19968;&#22359;&#20869;&#23384;&#23601;&#26159;IAT&#20013;&#23384;&#20648;&#30340;&#20989;&#25968;&#22320;&#22336;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-7_14-7-22.png" alt="images/download/attachments/1015828/image2022-1-7_14-7-22.png" width="600"  />
    </p>
<p   
>&#37027;&#20040;&#20026;&#20160;&#20040;&#19981;&#21482;&#30041;&#19968;&#24352;&#34920;&#21602;&#65311;&#36825;&#26159;&#22240;&#20026;IAT&#30340;&#20989;&#25968;&#22320;&#22336;&#24456;&#26377;&#21487;&#33021;&#20250;&#34987;&#20462;&#25913;&#25481;&#65292;&#23548;&#33268;&#22320;&#22336;&#19981;&#27491;&#30830;&#65292;&#22914;&#26524;&#20320;&#21482;&#26377;&#19968;&#24352;&#34920;&#65292;&#23601;&#27809;&#26377;&#19968;&#20010;&#27491;&#30830;&#30340;&#21442;&#29031;&#29289;&#20102;&#12290;</p>
    </div>
    </div>
    <div class="section section-1" id="src-1015828_safe-id-UEXln7rnoYAt6YeN5a6a5L2N6KGo">
        <h1 class="heading "><span>&#37325;&#23450;&#20301;&#34920;</span></h1>
<p   
>&#22312;PE&#20013;&#26368;&#37325;&#35201;&#30340;&#19977;&#24352;&#34920;&#23601;&#26159;&#23548;&#20986;&#12289;&#23548;&#20837;&#21644;&#37325;&#23450;&#20301;&#34920;&#65292;&#26412;&#31456;&#26469;&#20102;&#35299;&#19968;&#19979;&#37325;&#23450;&#20301;&#34920;&#12290;</p>
<p   
>&#37325;&#23450;&#20301;&#34920;&#26159;&#20160;&#20040;&#65311;&#20551;&#35774;&#26576;&#19968;PE&#25991;&#20214;&#20351;&#29992;&#20102;&#19968;&#20123;&#27169;&#22359;&#65292;&#36825;&#20123;&#27169;&#22359;&#37117;&#26377;&#33258;&#24049;&#30340;ImageBase&#65288;&#22312;&#20869;&#23384;&#20013;&#24320;&#22987;&#30340;&#22320;&#22336;&#65289;&#65292;&#20294;&#26159;&#23454;&#38469;&#19978;&#22312;&#20869;&#23384;&#20013;&#27169;&#22359;&#30340;ImageBase&#34987;&#21035;&#20154;&#21344;&#29992;&#20102;&#65292;<strong class=" ">&#36825;&#26102;&#20505;&#27169;&#22359;&#23601;&#38656;&#35201;&#20559;&#31227;&#65292;&#25442;&#19968;&#20010;&#26032;&#30340;&#20869;&#23384;&#22320;&#22336;&#21435;&#23637;&#24320;</strong>&#65292;&#20551;&#35774;&#22312;&#36825;&#27169;&#22359;&#20013;&#26377;&#24456;&#22810;&#24050;&#32463;&#20889;&#22909;&#20102;&#22320;&#22336;&#30340;&#30828;&#32534;&#30721;&#65288;<strong class=" ">&#20294;&#20961;&#28041;&#21450;&#21040;&#30452;&#25509;&#23547;&#22336;&#30340;&#25351;&#20196;&#37117;&#38656;&#35201;&#36827;&#34892;&#37325;&#23450;&#20301;&#22788;&#29702;</strong>&#65289;&#65292;&#24403;&#25442;&#20102;&#22320;&#22336;&#20043;&#21518;&#23601;&#25214;&#19981;&#21040;&#20102;&#65292;&#29978;&#33267;&#20250;&#20986;&#29616;&#23433;&#20840;&#38544;&#24739;&#65292;&#25152;&#20197;&#30828;&#32534;&#30721;&#30340;&#22320;&#22336;&#26159;&#38656;&#35201;&#38543;&#30528;&#20559;&#31227;&#32780;&#21435;&#20462;&#25913;&#30340;&#65292;<strong class=" ">&#36825;&#26102;&#20505;&#23601;&#38656;&#35201;&#19968;&#24352;&#34920;&#21435;&#35760;&#24405;&#38656;&#35201;&#20462;&#27491;&#30340;&#20301;&#32622;&#65292;&#20415;&#20110;&#21435;&#26681;&#25454;&#23545;&#24212;&#20559;&#31227;&#20462;&#27491;&#65292;&#36825;&#24352;&#34920;&#25105;&#20204;&#23601;&#31216;&#20043;&#20026;&#37325;&#23450;&#20301;&#34920;</strong>&#65307;&#19968;&#33324;&#26469;&#35828;&#65292;<strong class=" ">EXE&#25991;&#20214;&#26159;&#27809;&#26377;&#37325;&#23450;&#20301;&#34920;&#30340;</strong>&#65292;&#22240;&#20026;&#23427;&#19981;&#20250;&#25552;&#20379;&#20989;&#25968;&#32473;&#20854;&#20182;&#20154;&#29992;&#65288;&#23548;&#20986;&#34920;&#65289;&#65292;&#25152;&#20197;&#36816;&#34892;&#26102;&#23427;&#29702;&#24212;&#26159;&#31532;&#19968;&#20010;&#36733;&#20837;&#20869;&#23384;&#20013;&#30340;&#65292;&#32780;DLL&#20043;&#31867;&#30340;PE&#25991;&#20214;&#21017;&#19968;&#23450;&#26159;&#38656;&#35201;&#37325;&#23450;&#20301;&#34920;&#30340;&#65292;&#22240;&#20026;&#23427;&#24182;&#19981;&#19968;&#23450;&#20250;&#21152;&#36733;&#22312;ImageBase&#19978;&#12290;</p>
<p   
>&#37325;&#23450;&#20301;&#34920;&#30340;&#20301;&#32622;&#20449;&#24687;&#19982;&#23548;&#20837;&#12289;&#23548;&#20986;&#34920;&#19968;&#26679;&#65292;&#22312;&#25193;&#23637;PE&#22836;&#30340;&#26368;&#21518;&#19968;&#20010;&#25104;&#21592;&#20013;&#30340;&#31532;6&#20010;&#32467;&#26500;&#20307;&#65292;&#32467;&#26500;&#20307;&#30340;&#25104;&#21592;&#19982;&#23548;&#20837;&#12289;&#23548;&#20986;&#34920;&#19968;&#26679;&#65292;&#20998;&#21035;&#34920;&#31034;&#37325;&#23450;&#20301;&#34920;&#30340;&#36215;&#22987;&#20301;&#32622;&#21644;&#22823;&#23567;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015828/image2022-1-7_14-55-37.png" alt="images/download/attachments/1015828/image2022-1-7_14-55-37.png" width="600"  />
    </p>
<p   
>&#37325;&#23450;&#20301;&#34920;&#20013;&#26377;&#19968;&#20010;&#32467;&#26500;&#20307;&#65292;&#23427;&#19968;&#20849;&#26377;8&#23383;&#33410;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">typedef struct _IMAGE_BASE_RELOCATION {                     </code></div>
<div class="line"><code class="plain">    DWORD   VirtualAddress; </code><code class="comments">// RVA</code></div>
<div class="line"><code class="plain">    DWORD   SizeOfBlock;</code></div>
<div class="line"><code class="plain">} IMAGE_BASE_RELOCATION;</code></div>
<div class="line"><code class="plain">typedef IMAGE_BASE_RELOCATION ，* PIMAGE_BASE_RELOCATION;</code></div>
</div>
    </div>
<p   
>&#20294;&#26159;&#23436;&#25972;&#30340;&#37325;&#23450;&#20301;&#34920;&#36824;&#21253;&#21547;&#20102;&#24456;&#22810;&#37325;&#23450;&#20301;&#39033;&#65292;&#25152;&#20197;&#25972;&#20307;&#22823;&#23567;&#26159;&#27809;&#26377;&#19968;&#20010;&#32479;&#19968;&#26631;&#20934;&#30340;&#65292;&#38656;&#35201;&#26681;&#25454;&#23454;&#38469;&#24773;&#20917;&#12290;&#35813;&#32467;&#26500;&#20307;&#30340;&#31532;&#19968;&#20010;&#25104;&#21592;VirtualAddress&#34920;&#31034;&#22522;&#22320;&#22336;&#65292;<strong class=" ">&#31532;&#20108;&#20010;&#25104;&#21592;SizeOfBlock&#20063;&#23601;&#26159;&#20943;&#21435;&#24403;&#21069;&#32467;&#26500;&#20307;&#30340;&#22823;&#23567;&#20043;&#21518;&#20854;&#20182;&#30340;&#25152;&#26377;&#37325;&#23450;&#20301;&#39033;&#21152;&#36215;&#26469;&#30340;&#22823;&#23567;</strong>&#12290;</p>
<p   
>&#36825;&#20063;&#23601;&#34920;&#31034;&#27599;&#19968;&#20010;&#37325;&#23450;&#20301;&#34920;&#26159;IMAGE_BASE_RELOCATION&#32467;&#26500;&#20307;&#24320;&#22987;&#65292;&#36319;&#30528;&#30340;&#23601;&#26159;&#37325;&#23450;&#20301;&#39033;&#12290;</p>
<p   
>&#20174;&#29702;&#35770;&#19978;&#26469;&#35828;&#65292;&#37325;&#23450;&#20301;&#34920;&#20013;&#23384;&#20648;&#30340;&#39033;&#24212;&#35813;&#37117;&#26159;4&#23383;&#33410;&#22823;&#23567;&#30340;&#22320;&#22336;&#65292;&#20294;&#26159;&#36825;&#26679;&#19968;&#26086;&#38656;&#35201;&#20462;&#25913;&#30340;&#22320;&#22336;&#22810;&#20102;&#65292;&#23601;&#20250;&#21344;&#29992;&#22823;&#37327;&#30340;&#31354;&#38388;&#65292;&#25152;&#20197;&#37325;&#23450;&#20301;&#34920;&#23601;&#20570;&#20102;&#19968;&#20123;&#20248;&#21270;&#65292;&#20551;&#35774;&#20320;&#29616;&#22312;&#26377;&#36825;&#20960;&#20010;&#22320;&#22336;&#38656;&#35201;&#20462;&#27491;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">0x800123</code></div>
<div class="line"><code class="value">0x800456</code></div>
<div class="line"><code class="value">0x800789</code></div>
</div>
    </div>
<p   
>&#37027;&#20040;&#20248;&#21270;&#20043;&#21518;&#65292;IMAGE_BASE_RELOCATION&#32467;&#26500;&#20307;&#30340;&#31532;&#19968;&#20010;&#25104;&#21592;&#23384;&#20648;&#30340;&#23601;&#26159;0x800000&#65292;&#32780;&#36825;&#20010;&#32467;&#26500;&#20307;&#20043;&#21518;&#30340;&#27599;2&#23383;&#33410;&#23384;&#20648;<strong class=" ">&#23601;&#21253;&#21547;</strong>0x123&#12289;0x456&#12289;0x789&#65292;&#36825;&#26679;&#23601;&#22823;&#22823;&#30340;&#33410;&#30465;&#20102;&#31354;&#38388;&#12290;&#21516;&#26102;&#65292;&#36825;&#20063;&#23601;&#35828;&#26126;&#37325;&#23450;&#20301;&#34920;&#30340;&#23454;&#38469;&#22823;&#23567;&#20026;IMAGE_BASE_RELOCATION&#32467;&#26500;&#20307;&#65288;8&#23383;&#33410;&#65289;+N*2&#23383;&#33410;&#12290;</p>
<p   
>&#37325;&#23450;&#20301;&#34920;&#26159;&#25353;&#29031;&#19968;&#20010;&#29289;&#29702;&#39029;&#65288;4KB&#65289;&#36827;&#34892;&#23384;&#20648;&#30340;&#65292;&#20063;&#23601;&#34920;&#31034;&#19968;&#20010;4KB&#20869;&#23384;&#26377;&#38656;&#35201;&#20462;&#27491;&#30340;&#20301;&#32622;&#65292;&#23601;&#20250;&#26377;&#19968;&#20010;&#37325;&#23450;&#20301;&#22359;&#65292;&#19968;&#20010;&#37325;&#23450;&#20301;&#34920;&#21482;&#31649;&#33258;&#24049;&#24403;&#21069;&#30340;&#29289;&#29702;&#39029;&#30340;&#37325;&#23450;&#20301;&#12290;</p>
<p   
>&#20294;&#38656;&#35201;&#27880;&#24847;&#30340;&#26159;&#30001;&#20110;&#20869;&#23384;&#23545;&#40784;&#30340;&#32536;&#25925;&#65292;&#22312;&#37325;&#23450;&#20301;&#34920;&#20013;&#36824;&#26159;&#26377;&#24456;&#22810;&#30340;&#26080;&#29992;&#39033;&#30340;&#65292;<strong class=" ">&#25152;&#20197;&#20320;&#38656;&#35201;&#21028;&#26029;&#24403;&#21069;&#37325;&#23450;&#20301;&#39033;&#65288;2&#23383;&#33410;&#65289;&#30340;&#39640;&#22235;&#20301;&#26159;&#21542;&#20026;3&#65292;&#22914;&#26524;&#26159;&#37027;&#20040;&#20302;12&#20301;&#23601;&#26159;&#20559;&#31227;&#37327;&#65292;&#26368;&#21518;&#30340;&#22320;&#22336;&#20063;&#23601;&#26159;<u class=" ">VirtualAddress+&#20302;12&#20301;</u>&#65292;&#22914;&#26524;&#19981;&#26159;&#23601;&#34920;&#31034;&#36825;&#26159;&#26080;&#25152;&#35859;&#30340;&#20540;</strong>&#12290;</p>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="%E7%A1%AC%E7%BC%96%E7%A0%81.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>&#30828;&#32534;&#30721;</span>
        </a>
                <a href="%E4%B8%AD%E7%BA%A7%E7%AF%87.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>&#20013;&#32423;&#31687;</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
