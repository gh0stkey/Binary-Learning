<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>API&#20989;&#25968;&#30340;&#35843;&#29992;&#36807;&#31243; - &#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="1015827">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">BinaryLearning</span>
                    <img class="space-logo" src="global.logo" />
                </h1>
                <a href="Binary-Learning.html" class="ht-space-link">
                    <h2>&#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</h2>
                </a>
                <p><br><a href="https://github.com/gh0stkey/Binary-Learning" target="_blank">ᴀᴜᴛʜᴏʀ: ᴋᴇʏ</a><br><br>不积跬步，无以至千里；<br>不积小流，无以成江海。</p>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=1015846"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Binary-Learning.html">&#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</a></li>
                                                                                     <li><a href="%E4%B8%AD%E7%BA%A7%E7%AF%87.html">&#20013;&#32423;&#31687;</a></li>
                                                            </ul>
</div>            <h1 id="src-1015846"> <span>API&#20989;&#25968;&#30340;&#35843;&#29992;&#36807;&#31243;</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

    <div class="section section-1" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLTPnjq_pg6jliIY">
        <h1 class="heading "><span>3&#29615;&#37096;&#20998;</span></h1>
<p   
>API&#20989;&#25968;&#21363;&#24212;&#29992;&#31243;&#24207;&#25509;&#21475;&#65288;Application Programming Interface&#65289;&#65292;Windows API&#20027;&#35201;&#22312;C:\Windows\System32\&#30446;&#24405;&#19979;&#30340;&#25152;&#26377;DLL&#37324;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-9-17_16-12-10.png" alt="images/download/attachments/1015846/image2022-9-17_16-12-10.png" width="600"  />
    </p>
<p   
>&#35813;&#30446;&#24405;&#19979;&#26377;&#20960;&#20010;&#37325;&#35201;&#30340;DLL&#65306;</p>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col />
                                    <col />
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>DLL&#21517;&#31216;</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>&#20316;&#29992;</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>kernel32.dll</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&#26368;&#26680;&#24515;&#30340;&#21151;&#33021;&#27169;&#22359;&#65292;&#22914;&#31649;&#29702;&#20869;&#23384;&#12289;&#36827;&#31243;&#21644;&#32447;&#31243;</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>user32.dll</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Windows&#29992;&#25143;&#30028;&#38754;&#30456;&#20851;API&#65292;&#22914;&#21019;&#24314;&#31383;&#21475;&#12289;&#21457;&#36865;&#28040;&#24687;</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>gdi32.dll</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&#22270;&#24418;&#35774;&#22791;&#25509;&#21475;&#65292;&#22914;&#30011;&#22270;&#12289;&#26174;&#31034;&#25991;&#26412;</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>ntdll.dll</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&#22823;&#22810;&#25968;API&#36890;&#36807;&#35813;DLL&#36827;&#20837;&#20869;&#26680;&#65288;0&#29615;&#65289;</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
    <div class="section section-2" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLeWIhuaekFJlYWRQcm9jZXNzTWVtb3J55Ye95pWw">
        <h2 class="heading auto-cursor-target"><span>&#20998;&#26512;ReadProcessMemory&#20989;&#25968;</span></h2>
<p   
>&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;IDA&#26469;&#30475;&#19968;&#19979;ReadProcessMemory&#22312;DLL&#25991;&#20214;&#20013;&#30340;&#20307;&#29616;&#12290;&#25214;&#21040;kernel32.dll&#25991;&#20214;&#65292;&#29992;IDA&#25171;&#24320;&#65292;&#22312;Functions&#31383;&#21475;&#20351;&#29992;Ctrl+F&#24555;&#25463;&#38190;&#25628;&#32034;&#20989;&#25968;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-9-18_13-26-27.png" alt="images/download/attachments/1015846/image2022-9-18_13-26-27.png" width="400"  />
    </p>
<p   
>&#21452;&#20987;&#20989;&#25968;&#21517;&#65292;&#22312;IDA&#30340;&#21453;&#27719;&#32534;&#31383;&#21475;&#25105;&#20204;&#21487;&#20197;&#30475;&#21040;&#35813;&#20989;&#25968;&#30340;&#21453;&#27719;&#32534;&#25351;&#20196;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-9-18_14-12-7.png" alt="images/download/attachments/1015846/image2022-9-18_14-12-7.png" width="600"  />
    </p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#30475;&#35265;&#23427;&#30340;&#20027;&#35201;&#20316;&#29992;&#23601;&#26159;&#35843;&#29992;&#23548;&#20837;&#34920;&#30340;NtReadVirtualMemory&#20989;&#25968;&#65292;&#25105;&#20204;&#21487;&#20197;&#22312;IDA&#30340;Imports&#31383;&#21475;&#37324;&#25214;&#21040;&#35813;&#20989;&#25968;&#65288;Ctrl+F&#25628;&#32034;&#65289;&#65292;&#24182;&#19988;&#33021;&#30693;&#36947;&#23427;&#26469;&#33258;ntdll.dll&#27169;&#22359;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-9-18_14-58-59.png" alt="images/download/attachments/1015846/image2022-9-18_14-58-59.png" width="600"  />
    </p>
<p   
>&#25105;&#20204;&#25509;&#30528;&#20351;&#29992;IDA&#25171;&#24320;ntdll.dll&#26469;&#30475;&#19968;&#19979;&#35813;&#20989;&#25968;&#65292;&#23427;&#32473;&#20102;EAX&#19968;&#20010;&#20540;&#65288;&#25105;&#20204;&#21487;&#20197;&#29702;&#35299;&#20026;&#26159;&#19968;&#20010;&#32534;&#21495;&#65292;&#20063;&#21487;&#20197;&#31216;&#20043;&#20026;&#31995;&#32479;&#35843;&#29992;&#21495;&#65289;&#65292;&#24182;&#19988;&#32473;&#20102;EDX&#19968;&#20010;&#20869;&#23384;&#22320;&#22336;&#65292;&#35813;&#20869;&#23384;&#22320;&#22336;&#23601;&#26159;&#19968;&#20010;&#20989;&#25968;&#65292;&#20063;&#23601;&#26159;&#36827;&#20837;0&#29615;&#30340;&#20851;&#38190;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-9-18_15-3-35.png" alt="images/download/attachments/1015846/image2022-9-18_15-3-35.png" width="400"  />
    </p>
<p   
>&#25152;&#20197;&#33267;&#27492;&#25105;&#20204;&#20063;&#21487;&#20197;&#24471;&#20986;&#32467;&#35770;&#65292;&#22823;&#37096;&#20998;Windows API&#30340;&#30495;&#27491;&#23454;&#29616;&#26159;&#22312;0&#29615;&#30340;&#65292;3&#29615;&#21482;&#26159;&#19968;&#20010;&#23553;&#35013;&#35843;&#29992;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLeWunueOsFJlYWRQcm9jZXNzTWVtb3J55Ye95pWw">
        <h2 class="heading "><span>&#23454;&#29616;ReadProcessMemory&#20989;&#25968;</span></h2>
<p   
>&#25105;&#20204;&#24050;&#32463;&#30693;&#36947;Windows API&#22312;3&#29615;&#30340;&#34920;&#29616;&#24418;&#24335;&#65292;&#25152;&#20197;&#25105;&#20204;&#21487;&#20197;&#33258;&#24049;&#19981;&#35843;&#29992;DLL&#30340;&#24773;&#20917;&#19979;&#20889;&#19968;&#20010;&#33258;&#24049;&#30340;ReadProcessMemory&#20989;&#25968;&#12290;</p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#30452;&#25509;&#25353;&#29031;IDA&#23558;kernel32&#21644;ntdll&#30340;&#21453;&#27719;&#32534;&#20195;&#30721;&#25972;&#21512;&#19968;&#19979;&#65292;&#22914;&#19979;&#20195;&#30721;&#65292;<strong class=" ">&#20854;&#20013;&#25552;&#21319;&#26632;&#39030;&#30340;SUB&#25351;&#20196;&#26159;&#22240;&#20026;&#22312;Windows API&#26412;&#36523;&#30340;&#35843;&#29992;&#20013;&#26159;&#26377;&#20004;&#27425;CALL&#25351;&#20196;&#30340;&#65292;&#31532;&#19968;&#27425;CALL&#25351;&#20196;&#20250;&#23558;&#26632;&#39030;&#25552;&#21319;0x4&#65292;&#24182;&#19988;&#23384;&#20837;&#19979;&#19968;&#34892;&#25351;&#20196;&#22320;&#22336;&#65292;&#25152;&#20197;&#22312;&#26368;&#21518;&#19968;&#27425;&#30340;CALL&#35843;&#29992;&#26102;&#65292;&#25105;&#20204;&#35201;&#20445;&#35777;hProcess&#22312;ESP+4&#30340;&#20301;&#32622;&#65292;&#32780;&#19981;&#26159;ESP&#30340;&#20301;&#32622;</strong>&#65292;&#22312;&#26368;&#21518;&#30340;&#27719;&#32534;&#25351;&#20196;&#20013;&#25105;&#20204;&#20063;&#35201;&#25163;&#21160;&#24674;&#22797;&#21040;&#21407;&#26469;&#30340;&#26632;&#39030;&#20301;&#32622;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">void</code><code class="plain"> MyReadProcessMemory(HANDLE hProcess, LPCVOID lpBaseAddress, LPVOID lpBuffer, SIZE_T nSize, SIZE_T *lpNumberOfBytesRead)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    _asm</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// ReadProcessMemory</code></div>
<div class="line"><code class="plain">        lea eax, [ebp+</code><code class="value">0x14</code><code class="plain">]</code></div>
<div class="line"><code class="plain">        push eax</code></div>
<div class="line"><code class="plain">        push [ebp+</code><code class="value">0x14</code><code class="plain">]</code></div>
<div class="line"><code class="plain">        push [ebp+</code><code class="value">0x10</code><code class="plain">]</code></div>
<div class="line"><code class="plain">        push [ebp+</code><code class="value">0xC</code><code class="plain">]</code></div>
<div class="line"><code class="plain">        push [ebp+</code><code class="value">0x8</code><code class="plain">]</code></div>
<div class="line"><code class="plain">            </code></div>
<div class="line"><code class="plain">        </code><code class="comments">// NtReadVirtualMemory</code></div>
<div class="line"><code class="plain">        sub esp, </code><code class="value">0x4</code></div>
<div class="line"><code class="plain">        mov eax, </code><code class="value">0xBA</code></div>
<div class="line"><code class="plain">        mov edx, </code><code class="value">0x7FFE0300</code></div>
<div class="line"><code class="plain">        call dword ptr [edx]</code></div>
<div class="line"><code class="plain">        add esp, </code><code class="value">0x18</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>&#22312;&#20195;&#30721;&#20013;&#21435;&#35843;&#29992;&#65292;&#25104;&#21151;&#25191;&#34892;&#65292;&#32467;&#26524;&#22914;&#19979;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-9-18_19-46-11.png" alt="images/download/attachments/1015846/image2022-9-18_19-46-11.png" width="600"  />
    </p>
    </div>
    </div>
    <div class="section section-1" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLTPnjq_ov5sw546v6YOo5YiG">
        <h1 class="heading "><span>3&#29615;&#36827;0&#29615;&#37096;&#20998;</span></h1>
<p   
>&#25105;&#20204;&#24050;&#32463;&#20102;&#35299;API&#22312;3&#29615;&#30340;&#20307;&#29616;&#65292;&#24182;&#19988;&#21487;&#20197;&#25163;&#21160;&#30340;&#21435;&#23553;&#35013;&#19968;&#20010;&#22312;3&#29615;&#30340;&#24212;&#29992;API&#12290;&#20294;&#25105;&#20204;&#24182;&#19981;&#30693;&#36947;3&#29615;&#36827;0&#29615;&#30340;&#20855;&#20307;&#32454;&#33410;&#65292;&#26412;&#31456;&#33410;&#23601;&#26469;&#19968;&#25506;&#31350;&#31455;&#12290;</p>
    <div class="section section-2" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLV9LVVNFUl9TSEFSRURfREFUQQ">
        <h2 class="heading "><span>_KUSER_SHARED_DATA</span></h2>
<p   
>&#22312;&#24212;&#29992;&#21644;&#20869;&#26680;&#23618;&#20998;&#21035;&#23450;&#20041;&#20102;&#19968;&#20010;_KUSER_SHARED_DATA&#32467;&#26500;&#20307;&#65292;&#29992;&#20110;&#24212;&#29992;&#21644;&#20869;&#26680;&#38388;&#30340;&#19968;&#20123;&#25968;&#25454;&#20849;&#20139;&#12290;&#23427;&#20204;&#20351;&#29992;&#30340;&#26159;&#22266;&#23450;&#30340;&#22320;&#22336;&#20540;&#26144;&#23556;&#65292;&#35813;&#32467;&#26500;&#21306;&#22495;&#22312;&#29992;&#25143;&#21644;&#20869;&#26680;&#23618;&#30340;&#22320;&#22336;&#20998;&#21035;&#20026;&#65306;0x7FFE0000&#12289;0xFFDF0000&#12290;&#20174;&#22320;&#22336;&#26469;&#30475;&#65292;<strong class=" ">&#23427;&#20204;&#19981;&#26159;&#19968;&#20010;&#32447;&#24615;&#22320;&#22336;&#65292;&#20294;&#26412;&#36136;&#19978;&#25351;&#21521;&#30340;&#37117;&#26159;&#21516;&#19968;&#20010;&#29289;&#29702;&#39029;</strong>&#65292;&#22312;&#29992;&#25143;&#23618;&#23545;&#35813;&#29289;&#29702;&#39029;&#26377;&#21482;&#35835;&#26435;&#38480;&#65292;&#20294;&#22312;&#20869;&#26680;&#23618;&#26377;&#35835;&#12289;&#20889;&#26435;&#38480;&#12290;</p>
<p   
>&#22312;&#19978;&#19968;&#31456;&#33410;&#20013;&#25105;&#20204;&#30475;&#21040;Windows API&#20351;&#29992;&#30340;&#22320;&#22336;&#20026;0x7FFE0300&#65292;&#23427;&#23601;&#23646;&#20110;_KUSER_SHARED_DATA&#32467;&#26500;&#20307;&#30340;&#19968;&#37096;&#20998;&#65292;&#25105;&#20204;&#21487;&#20197;&#22312;Windbg&#20013;&#26597;&#30475;&#35813;&#32467;&#26500;&#20307;&#25214;&#21040;0x300&#20559;&#31227;&#30340;&#25104;&#21592;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-9-18_20-32-45.png" alt="images/download/attachments/1015846/image2022-9-18_20-32-45.png" width="600"  />
    </p>
    <div class="section section-3" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLVN5c3RlbUNhbGw">
        <h3 class="heading "><span>SystemCall</span></h3>
<p   
>0x7FFE0300&#23601;&#26159;_KUSER_SHARED_DATA&#32467;&#26500;&#20307;&#30340;&#25104;&#21592;SystemCall&#65292;&#23427;&#30340;&#20316;&#29992;&#23601;&#26159;&#36827;&#20837;0&#29615;&#65292;&#32780;&#20855;&#20307;&#36827;&#20837;0&#29615;&#30340;&#26041;&#24335;&#21017;&#30001;CPU&#20915;&#23450;&#65292;<strong class=" ">&#24403;CPU&#25903;&#25345;SYSENTER&#12289;SYSEXIT&#25351;&#20196;&#21017;&#20351;&#29992;&#30340;&#26159;ntdll!KiFastSystemCall&#26041;&#24335;&#65292;&#21542;&#21017;&#21017;&#26159;ntdll!KiIntSystemCall&#26041;&#24335;</strong>&#12290;</p>
<p   
>&#22914;&#26524;&#25105;&#20204;&#33258;&#24049;&#24819;&#35201;&#21028;&#26029;&#26159;&#20160;&#20040;&#26041;&#24335;&#65292;&#21487;&#20197;&#36873;&#25321;&#20351;&#29992;CPUID&#25351;&#20196;&#65292;&#24403;EAX=1&#26102;&#25351;&#21521;CPUID&#25351;&#20196;&#65292;&#22788;&#29702;&#22120;&#30340;&#29305;&#24449;&#20449;&#24687;&#23601;&#20250;&#23384;&#25918;&#22312;ECX&#21644;EDX&#23492;&#23384;&#22120;&#20013;&#65292;&#20854;&#20013;EDX&#21253;&#21547;&#20102;&#19968;&#20010;SEP&#20301;&#65288;&#31532;11&#20301;&#65289;&#65292;<strong class=" ">&#35813;&#20301;&#20026;1&#21017;&#34920;&#31034;CPU&#25903;&#25345;SYSENTER&#12289;SYSEXIT&#25351;&#20196;&#65292;&#20026;0&#21017;&#34920;&#31034;&#19981;&#25903;&#25345;</strong>&#12290;</p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#22312;OD&#37324;&#25191;&#34892;&#19968;&#19979;CPUID&#25351;&#20196;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-9-18_22-3-16.png" alt="images/download/attachments/1015846/image2022-9-18_22-3-16.png" width="600"  />
    </p>
<p   
>&#25191;&#34892;&#20043;&#21518;&#25105;&#20204;&#21487;&#20197;&#30475;&#19979;EDX&#30340;&#31532;11&#20301;&#65292;&#23427;&#30830;&#23454;&#20026;1&#65292;&#20063;&#23601;<strong class=" ">&#34920;&#31034;CPU&#25903;&#25345;SYSENTER&#12289;SYSEXIT&#25351;&#20196;</strong>&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-9-18_22-9-43.png" alt="images/download/attachments/1015846/image2022-9-18_22-9-43.png" width="600"  />
    </p>
<p   
>&#25152;&#20197;&#22312;&#24403;&#21069;CPU&#19979;&#65292;_KUSER_SHARED_DATA&#32467;&#26500;&#20307;&#30340;0x300&#20559;&#31227;&#20301;&#23384;&#20648;&#30340;&#23601;&#26159;ntdll!KiFastSystemCall&#20989;&#25968;&#30340;&#22320;&#22336;&#12290;</p>
    </div>
    </div>
    <div class="section section-2" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLei_m-WFpTDnjq_nmoTmlrnlvI8">
        <h2 class="heading "><span>&#36827;&#20837;0&#29615;&#30340;&#26041;&#24335;</span></h2>
<p   
>&#22312;&#20043;&#21069;&#21508;&#31181;&ldquo;&#38376;&rdquo;&#30340;&#23398;&#20064;&#21518;&#65292;&#25105;&#20204;&#30693;&#36947;&#24403;&#36827;&#34892;&#26435;&#38480;&#20999;&#25442;&#26102;&#65288;3&#29615;&#36827;0&#29615;&#65289;&#65292;CS&#12289;SS&#12289;ESP&#12289;EIP&#23492;&#23384;&#22120;&#37117;&#20250;&#21457;&#29983;&#21464;&#21270;&#12290;&#26377;&#20102;&#36825;&#20123;&#21069;&#32622;&#30340;&#30693;&#35782;&#20102;&#35299;&#65292;&#25105;&#20204;&#26469;&#30475;&#19968;&#19979;KiIntSystemCall&#21644;KiFastSystemCall&#36825;&#20004;&#20010;&#36827;&#20837;0&#29615;&#30340;&#26041;&#24335;&#12290;</p>
    <div class="section section-3" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLUtpSW50U3lzdGVtQ2FsbA">
        <h3 class="heading "><span>KiIntSystemCall</span></h3>
<p   
>&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;Windbg&#25171;&#24320;&#20219;&#24847;&#19968;&#20010;PE&#25991;&#20214;&#65292;&#28982;&#21518;&#25214;&#21040;KiIntSystemCall&#20989;&#25968;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-9-21_10-3-48.png" alt="images/download/attachments/1015846/image2022-9-21_10-3-48.png" width="400"  />
    </p>
<p   
>&#25105;&#20204;&#21457;&#29616;&#23427;&#30340;&#20195;&#30721;&#24456;&#31616;&#21333;&#65292;&#39318;&#20808;&#23558;&#24403;&#21069;&#21442;&#25968;&#30340;&#25351;&#38024;&#23384;&#20648;&#21040;EDX&#23492;&#23384;&#22120;&#20013;&#65288;&#31995;&#32479;&#35843;&#29992;&#21495;&#22312;EAX&#23492;&#23384;&#22120;&#20013;&#65289;&#65292;&#28982;&#21518;&#20351;&#29992;&#20013;&#26029;&#38376;&#36827;&#20837;0&#29615;&#65288;<strong class=" ">&#25152;&#26377;&#30340;API&#20351;&#29992;&#20013;&#26029;&#38376;&#36827;&#20869;&#26680;&#26102;&#65292;&#20351;&#29992;&#30340;&#20013;&#26029;&#21495;&#65288;IDT&#34920;&#20013;&#32034;&#24341;&#20540;&#65289;&#37117;&#26159;0x2E</strong>&#65289;&#12290;</p>
    <div class="section section-4" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLeiwg-eUqOi_h-eoi-WIhuaekA">
        <h4 class="heading "><span>&#35843;&#29992;&#36807;&#31243;&#20998;&#26512;</span></h4>
<p   
>&#25105;&#20204;&#26469;&#25163;&#21160;&#20998;&#26512;&#19968;&#19979;INT 0x2E&#36827;0&#29615;&#30340;&#36807;&#31243;&#65292;&#39318;&#20808;&#25214;&#21040;IDT&#34920;&#65292;&#28982;&#21518;&#26681;&#25454;0x2E&#32034;&#24341;&#25214;&#21040;&#23545;&#24212;&#30340;&#38376;&#25551;&#36848;&#31526;&#20301;&#32622;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-9_10-45-25.png" alt="images/download/attachments/1015846/image2022-10-9_10-45-25.png" width="400"  />
    </p>
<p   
>&#35813;&#38376;&#25551;&#36848;&#31526;&#30340;&#39640;32&#20301;&#30340;&#31532;8&#20301;&#20026;0&#65292;&#20063;&#23601;&#34920;&#31034;&#35813;&#25551;&#36848;&#31526;&#20026;    <span style="color: #172b4d;">
&#20013;&#26029;&#38376;&#25551;&#36848;&#31526;&#12290;<strong class=" ">&#36890;&#36807;&#20013;&#26029;&#38376;&#25551;&#36848;&#31526;&#25105;&#20204;&#30693;&#36947;&#20102;CS&#65288;&#20302;32&#20301;&#30340;&#31532;16&#33267;31&#20301;&#65292;&#20063;&#23601;&#26159;&#27573;&#36873;&#25321;&#23376;&#65289;&#21644;EIP&#23492;&#23384;&#22120;&#65288;&#39640;32&#20301;&#30340;&#31532;16&#33267;31&#20301;&#21152;&#19978;&#20302;32&#20301;&#30340;&#31532;0&#33267;15&#20301;&#65292;&#20063;&#23601;&#26159;&#27573;&#20869;&#20559;&#31227;&#65289;</strong>&#65292;SS&#21644;ESP&#23492;&#23384;&#22120;&#20063;&#23601;&#26159;&#22522;&#20110;TSS&#33719;&#21462;&#30340;&#12290;    </span>
</p>
<p   
>    <span style="color: #172b4d;">
&#25105;&#20204;&#36319;&#36827;EIP&#65292;&#23601;&#20250;&#21457;&#29616;&#23427;&#26159;&#19968;&#20010;&#20869;&#26680;&#27169;&#22359;&#30340;&#20989;&#25968;<strong class=" ">KiSystemService</strong>&#65292;&#33267;&#27492;&#25105;&#20204;&#23601;&#22823;&#33268;&#20102;&#35299;&#20102;&#20013;&#26029;&#38376;&#36827;0&#29615;&#30340;&#31616;&#21333;&#27969;&#31243;&#65306;    </span>
</p>
<p   
>    <span style="color: #172b4d;">
<img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-9_11-28-35.png" alt="images/download/attachments/1015846/image2022-10-9_11-28-35.png" width="400"  />
    </span>
</p>
    </div>
    </div>
    <div class="section section-3" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLUtpRmFzdFN5c3RlbUNhbGw">
        <h3 class="heading "><span>KiFastSystemCall</span></h3>
<p   
>&#22914;&#19979;&#26159;KiFastSystemCall&#20989;&#25968;&#65292;&#25105;&#20204;&#21487;&#20197;&#30475;&#21040;&#23427;&#36319;KiIntSystemCall&#27809;&#30561;&#30496;&#21306;&#21035;&#65292;&#21482;&#26159;&#23427;&#36827;&#20837;0&#29615;&#30340;&#26041;&#24335;&#19981;&#26159;&#22522;&#20110;&#20013;&#26029;&#38376;&#65292;&#32780;&#26159;&#20351;&#29992;&#20102;SYSENTER&#25351;&#20196;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-9-29_15-33-45.png" alt="images/download/attachments/1015846/image2022-9-29_15-33-45.png" width="600"  />
    </p>
<p   
>&#25105;&#20204;&#37117;&#30693;&#36947;&#20013;&#26029;&#38376;&#36827;0&#29615;&#38656;&#35201;&#25552;&#20379;&#26032;&#30340;CS&#12289;SS&#12289;ESP&#12289;EIP&#65292;CS&#21644;EIP&#22312;IDT&#34920;&#20013;&#65292;&#32780;SS&#21644;ESP&#37117;&#22312;TSS&#20013;&#65292;&#36825;&#23601;&#38656;&#35201;&#21435;&#26597;&#20869;&#23384;&#20102;&#65292;&#36895;&#24230;&#30456;&#23545;&#26469;&#35828;&#20250;&#24456;&#24930;&#12290;&#25152;&#20197;&#22312;&#36825;&#37324;CPU&#25552;&#20379;&#20102;SYSENTER&#25351;&#20196;&#65292;&#22312;&#25191;&#34892;&#35813;&#25351;&#20196;&#21069;&#25805;&#20316;&#31995;&#32479;&#20250;&#25552;&#21069;&#23558;CS&#12289;SS&#12289;ESP&#12289;EIP&#30340;&#20540;&#23384;&#20648;&#22312;MSR&#23492;&#23384;&#22120;&#20013;&#65292;<strong class=" ">&#35813;&#25351;&#20196;&#25191;&#34892;&#26102;CPU&#20250;&#23558;MSR&#23492;&#23384;&#22120;&#20013;&#30340;&#20540;&#30452;&#25509;&#20889;&#20837;&#21040;&#30456;&#20851;&#23492;&#23384;&#22120;&#65292;&#23601;&#20943;&#21435;&#20102;&#35835;&#21462;&#20869;&#23384;&#30340;&#36807;&#31243;&#65292;&#25552;&#21319;&#20102;&#35843;&#29992;&#30340;&#36895;&#24230;&#65292;&#22240;&#27492;&#25105;&#20204;&#21487;&#20197;&#31216;&#20043;&#20026;&#24555;&#36895;&#35843;&#29992;</strong>&#12290;</p>
    <div class="section section-4" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLeiwg-eUqOi_h-eoi-WIhuaekC4x">
        <h4 class="heading "><span>&#35843;&#29992;&#36807;&#31243;&#20998;&#26512;</span></h4>
<p   
>&#22312;MSR&#23492;&#23384;&#22120;&#20013;&#26377;&#19977;&#20010;&#20540;&#21363;CS&#27573;&#36873;&#25321;&#23376;&#12289;ESP&#21644;EIP&#23492;&#23384;&#22120;&#65292;&#24403;&#25105;&#20204;&#25214;&#21040;CS&#36873;&#25321;&#23376;&#26102;&#20505;&#65292;&#23558;&#20854;&#22320;&#22336;&#21152;0x8&#21363;&#21487;&#33719;&#24471;SS&#36873;&#25321;&#23376;&#12290;&#24403;&#28982;&#36825;&#20123;&#25805;&#20316;&#37117;&#26159;&#30828;&#20214;&#21435;&#23436;&#25104;&#30340;&#65292;&#20855;&#20307;&#30340;&#32454;&#33410;&#21487;&#20197;&#21442;&#32771;Intel&#30333;&#30382;&#20070;&#31532;&#20108;&#21367;&#20013;SYSENTER&#25351;&#20196;&#30340;&#20869;&#23481;&#12290;</p>
    <div  class="tablewrap">
        <table class="confluenceTable">
                    <colgroup>
                                    <col />
                                    <col />
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>MSR</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>&#22320;&#22336;</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>IA32_SYSENTER_CS</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0x174</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>IA32_SYSENTER_ESP</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0x175</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>IA32_SYSENTER_EIP</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0x176</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p   
>&#22312;&#25805;&#20316;&#31995;&#32479;&#19978;&#65292;&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;RDMSR/WRMST&#26469;&#23545;MSR&#23492;&#23384;&#22120;&#36827;&#34892;&#35835;&#20889;&#65306;</p>
<p   
><img  class="confluence-embedded-image confluence-thumbnail"  src="images/download/thumbnails/1015846/image2022-10-9_11-47-15.png" alt="images/download/thumbnails/1015846/image2022-10-9_11-47-15.png" width="300"  />
    </p>
<p   
>&#24182;&#19988;&#25105;&#20204;&#21487;&#20197;&#36319;&#36827;EIP&#65292;&#20320;&#23601;&#20250;&#21457;&#29616;SYSENTER&#25351;&#20196;&#36827;&#20837;0&#29615;&#25191;&#34892;&#30340;&#23601;&#26159;&#20869;&#26680;&#27169;&#22359;&#30340;KiFastCallEntry&#20989;&#25968;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-9_11-48-15.png" alt="images/download/attachments/1015846/image2022-10-9_11-48-15.png" width="400"  />
    </p>
    </div>
    </div>
    <div class="section section-3" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLeaAu-e7kw">
        <h3 class="heading "><span>&#24635;&#32467;</span></h3>
<p   
>API&#36890;&#36807;&#20013;&#26029;&#38376;&#36827;&#20837;0&#29615;&#26377;&#19968;&#20010;&#22266;&#23450;&#30340;&#20013;&#26029;&#21495;&#21363;0x2E&#65292;CS&#12289;EIP&#30001;&#20013;&#26029;&#38376;&#25551;&#36848;&#31526;&#25552;&#20379;&#65292;ESP&#12289;SS&#30001;TSS&#25552;&#20379;&#65292;&#36827;&#20837;0&#29615;&#20043;&#21518;&#25191;&#34892;&#30340;&#20869;&#26680;&#20989;&#25968;&#26159;nt!KiSystemService&#12290;</p>
<p   
>API&#36890;&#36807;SYSENTER&#25351;&#20196;&#36827;&#20837;&#65296;&#29615;&#65292;CS&#12289;ESP&#12289;EIP&#30001;MSR&#23492;&#23384;&#22120;&#25552;&#20379;&#65292;SS&#30001;CS&#30340;&#20540;&#21152;0x8&#35745;&#31639;&#24471;&#20986;&#65292;&#36827;&#20837;0&#29615;&#20043;&#21518;&#25191;&#34892;&#30340;&#20869;&#26680;&#20989;&#25968;&#26159;nt!KiFastCallEntry&#12290;</p>
<p   
>&#20869;&#26680;&#20989;&#25968;&#25152;&#22312;&#27169;&#22359;&#20026;&#65306;ntoskrnl.exe&#65288;10-10-12&#20998;&#39029;&#27169;&#24335;&#19979;&#20351;&#29992;&#65289;&#12289;ntkrnlpa.exe&#65288;2-9-9-12&#20998;&#39029;&#27169;&#24335;&#19979;&#20351;&#29992;&#65289;&#12290;</p>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLeS_neWtmOeOsOWcug">
        <h1 class="heading "><span>&#20445;&#23384;&#29616;&#22330;</span></h1>
<p   
>API&#36827;&#20837;0&#29615;&#20043;&#21069;&#26159;&#38656;&#35201;&#23558;&#22312;3&#29615;&#26102;&#30340;&#23492;&#23384;&#22120;&#20540;&#20445;&#23384;&#65292;&#36825;&#26679;&#22312;0&#29615;&#25191;&#34892;&#20999;&#25442;&#21040;&#26032;&#30340;&#23492;&#23384;&#22120;&#25191;&#34892;&#23436;&#25104;&#21518;&#22238;&#21040;3&#29615;&#26102;&#25165;&#33021;&#24674;&#22797;&#21407;&#20808;&#30340;&#23492;&#23384;&#22120;&#36824;&#21407;&#29616;&#22330;&#65292;&#37027;&#20040;3&#29615;&#23492;&#23384;&#22120;&#30340;&#20540;&#26159;&#20445;&#23384;&#22312;&#21738;&#37324;&#30340;&#65292;&#23601;&#26159;&#26412;&#31456;&#25105;&#20204;&#38656;&#35201;&#23398;&#20064;&#30340;&#20445;&#23384;&#29616;&#22330;&#12290;</p>
    <div class="section section-2" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLee7k-aehOS9kw">
        <h2 class="heading "><span>&#32467;&#26500;&#20307;</span></h2>
<p   
>&#22312;&#27491;&#24335;&#30340;&#23398;&#20064;&#20043;&#21069;&#25105;&#20204;&#38656;&#35201;&#20808;&#20102;&#35299;&#36825;&#19977;&#20010;&#32467;&#26500;&#20307;&#65306;_Trap_Frame&#65292;_ETHREAD&#65292;_KPCR&#12290;</p>
    <div class="section section-3" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLV9UcmFwX0ZyYW1l">
        <h3 class="heading "><span>_Trap_Frame</span></h3>
<p   
>&#22312;Windbg&#20013;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;&#22914;&#19979;&#21629;&#20196;&#26597;&#30475;_Trap_Frame&#32467;&#26500;&#20307;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">dt _KTrap_Frame</code></div>
</div>
    </div>
<p   
>&#32467;&#26500;&#20307;&#20013;&#30340;&#25104;&#21592;&#23545;&#24212;&#30340;&#20316;&#29992;&#35265;&#19979;&#22270;&#20013;&#30340;&#25991;&#23383;&#27880;&#37322;&#65292;<strong class=" ">&#35813;&#32467;&#26500;&#20307;&#23601;&#26159;&#20445;&#23384;&#29616;&#22330;&#25152;&#38656;&#35201;&#29992;&#21040;&#30340;&#32467;&#26500;&#20307;</strong>&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-9_22-54-55.png" alt="images/download/attachments/1015846/image2022-10-9_22-54-55.png" width="600"  />
    </p>
    </div>
    <div class="section section-3" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLV9FVEhSRUFE">
        <h3 class="heading "><span>_ETHREAD</span></h3>
<p   
>&#19982;&#32447;&#31243;&#30456;&#20851;&#30340;&#32467;&#26500;&#20307;&#23601;&#26159;_ETHREAD&#65292;&#22312;Windows&#20869;&#26680;&#20013;&#27599;&#19968;&#20010;&#36827;&#31243;&#30340;&#27599;&#19968;&#20010;&#32447;&#31243;&#37117;&#26377;&#30528;&#19968;&#20010;_ETHREAD&#32467;&#26500;&#20307;&#65292;&#23427;&#23384;&#20648;&#30528;&#32447;&#31243;&#30456;&#20851;&#30340;&#20449;&#24687;&#65292;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;&#22914;&#19979;&#21629;&#20196;&#22312;Windbg&#20013;&#26597;&#30475;&#35813;&#32467;&#26500;&#20307;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">dt _ETHREAD</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-10_14-17-41.png" alt="images/download/attachments/1015846/image2022-10-10_14-17-41.png" width="400"  />
    </p>
<p   
>&#23427;&#30340;&#31532;&#19968;&#20010;&#25104;&#21592;&#20063;&#26159;&#19968;&#20010;&#32467;&#26500;&#20307;_KTHREAD&#65292;&#25105;&#20204;&#21516;&#26679;&#21487;&#20197;&#22312;Windbg&#20013;&#26597;&#30475;&#35813;&#32467;&#26500;&#20307;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-10_14-19-14.png" alt="images/download/attachments/1015846/image2022-10-10_14-19-14.png" width="200"  />
    </p>
    </div>
    <div class="section section-3" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLV9LUENS">
        <h3 class="heading "><span>_KPCR</span></h3>
<p   
>&#27599;&#20010;CPU&#37117;&#26377;&#33258;&#24049;&#30340;&#25511;&#21046;&#21306;&#65292;&#36825;&#22359;&#25511;&#21046;&#21306;&#25105;&#20204;&#31216;&#20043;&#20026;KPCR&#12290;&#20320;&#30340;CPU&#26377;&#20960;&#26680;&#23601;&#26377;&#20960;&#20010;&#23545;&#24212;&#30340;KPCR&#12290;</p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;&#22914;&#19979;&#25351;&#20196;&#22312;Windbg&#20013;&#26597;&#30475;KPCR&#30456;&#20851;&#30340;&#20449;&#24687;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">dt _KPCR </code><code class="comments">// 查看KPCR结构体</code></div>
<div class="line"><code class="plain">dd KeNumberProcessors </code><code class="comments">// 查看KPCR数量</code></div>
<div class="line"><code class="plain">dd KiProcessorBlock </code><code class="comments">// 查看KPCR位置</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-10_14-28-11.png" alt="images/download/attachments/1015846/image2022-10-10_14-28-11.png" width="400"  />
    </p>
<p   
>&#36890;&#36807;KiProcessorBlock&#25105;&#20204;&#26597;&#30475;&#21040;&#30340;KPCR&#20301;&#32622;&#23454;&#38469;&#19978;&#26159;&#25351;&#21521;KPCR&#32467;&#26500;&#20307;0x120&#30340;&#20559;&#31227;&#20301;&#65292;&#25152;&#20197;&#22914;&#26524;&#25105;&#20204;&#24819;&#23436;&#25972;&#30340;&#21435;&#26597;&#30475;&#36825;&#20010;&#32467;&#26500;&#20307;&#23601;&#38656;&#35201;&#22312;&#36825;&#20010;&#22320;&#22336;&#19978;&#20943;&#21435;0x120&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-10_14-48-34.png" alt="images/download/attachments/1015846/image2022-10-10_14-48-34.png" width="400"  />
    </p>
<p   
>&#23427;&#30340;0x120&#20559;&#31227;&#20301;&#25351;&#21521;&#30340;&#26159;&#21478;&#22806;&#19968;&#20010;&#32467;&#26500;&#20307;_KPRCB&#65292;&#25105;&#20204;&#21487;&#20197;&#29702;&#35299;&#20026;&#23427;&#26159;&#19968;&#20010;&#25193;&#23637;&#30340;KPCR&#12290;</p>
    </div>
    </div>
    <div class="section section-2" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLUtpU3lzdGVtU2VydmljZeS_neWtmOeOsOWcug">
        <h2 class="heading "><span>KiSystemService&#20445;&#23384;&#29616;&#22330;</span></h2>
<p   
>&#22312;&#20102;&#35299;&#23436;&#22522;&#26412;&#30340;&#32467;&#26500;&#20307;&#20043;&#21518;&#65292;&#25105;&#20204;&#21487;&#20197;&#25163;&#21160;&#26469;&#20998;&#26512;&#19968;&#19979;&#22312;0&#29615;&#20989;&#25968;KiSystemService&#65292;&#30475;&#19968;&#19979;&#23427;&#21040;&#24213;&#26159;&#22914;&#20309;&#20445;&#23384;&#29616;&#22330;&#30340;&#12290;<strong class=" ">&#35813;&#20989;&#25968;&#20445;&#23384;&#29616;&#22330;&#30340;&#36807;&#31243;&#23454;&#38469;&#19978;&#23601;&#26159;&#22635;&#20805;Trap_Frame&#32467;&#26500;&#20307;&#30340;&#36807;&#31243;</strong>&#12290;</p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;IDA&#25171;&#24320;C:/Windows/System32/ntoskrnl.exe&#25991;&#20214;&#65292;&#22312;&#20989;&#25968;&#21015;&#34920;&#20013;&#25214;&#21040;_KiSystemService&#20989;&#25968;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-10_15-0-19.png" alt="images/download/attachments/1015846/image2022-10-10_15-0-19.png" width="600"  />
    </p>
<p   
>&#25105;&#20204;&#30693;&#36947;&#22312;&#20013;&#26029;&#38376;&#36827;&#20837;0&#29615;&#26102;&#20250;&#20808;&#21387;&#20837;SS&#12289;ESP&#12289;EFlags&#12289;CS&#12289;EIP&#65292;&#20063;&#23601;&#26159;&#23558;&#36825;&#20123;&#20540;&#22635;&#20805;&#21040;<strong class=" ">Trap_Frame&#32467;&#26500;&#20307;</strong>&#65292;&#25152;&#20197;&#22312;_KiSystemService&#20989;&#25968;&#25191;&#34892;&#31532;&#19968;&#34892;&#25351;&#20196;&#20043;&#21069;&#26159;&#22312;<strong class=" ">Trap_Frame&#32467;&#26500;&#20307;</strong>&#30340;0x68&#20559;&#31227;&#20301;&#65292;&#20294;&#26159;&#26576;&#20123;&#20013;&#26029;&#24773;&#20917;&#19979;&#22914;&#32570;&#39029;&#24322;&#24120;&#23601;&#20250;&#38500;&#20102;&#36825;5&#20010;&#20540;&#20197;&#22806;&#21387;&#20837;&#31532;6&#20010;&#20540;&#65292;&#21363;<strong class=" ">Trap_Frame&#32467;&#26500;&#20307;</strong>&#20013;&#30340;ErrCode&#65292;&#25152;&#20197;&#20026;&#20102;&#20351;&#24471;&#22534;&#26632;&#24179;&#34913;&#65292;&#22312;_KiSystemService&#20989;&#25968;&#31532;&#19968;&#34892;&#25351;&#20196;&#23601;&#21387;&#20837;&#20102;&#19968;&#20010;0x0&#26469;&#23545;&#40784;&#65292;&#36825;&#26102;&#20505;&#25105;&#20204;&#23601;&#22788;&#20110;0x64&#20559;&#31227;&#20301;&#65292;&#25509;&#30528;&#23601;&#26159;&#20381;&#27425;&#21387;&#20837;EBP&#12289;EBX&#12289;ESI&#12289;EDI&#12289;FS&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-11_10-23-44.png" alt="images/download/attachments/1015846/image2022-10-11_10-23-44.png" width="600"  />
    <br/>&#32487;&#32493;&#35835;&#20195;&#30721;&#65292;&#20808;&#26159;&#21521;EBX&#23384;&#20837;&#19968;&#20010;0x30&#65292;&#25509;&#30528;&#20197;0x30&#20026;&#27573;&#36873;&#25321;&#23376;&#22312;GDT&#34920;&#20013;&#25214;&#21040;&#27573;&#25551;&#36848;&#31526;&#21152;&#36733;&#21040;FS&#27573;&#23492;&#23384;&#22120;&#20013;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-11_10-50-7.png" alt="images/download/attachments/1015846/image2022-10-11_10-50-7.png" width="600"  />
    </p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#25163;&#21160;&#26469;&#30475;&#19968;&#19979;&#21152;&#36733;&#30340;&#27573;&#25551;&#36848;&#31526;&#21040;&#24213;&#26159;&#35841;&#65292;&#39318;&#20808;&#25286;&#20998;&#27573;&#36873;&#25321;&#23376;&#21462;&#31532;3&#33267;&#31532;15&#20301;&#20316;&#20026;&#32034;&#24341;&#65292;&#25509;&#30528;&#25353;&#32034;&#24341;&#22312;GDT&#34920;&#20013;&#25214;&#21040;&#27573;&#25551;&#36848;&#31526;&#12290;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="comments">// 0x30 拆分</code></div>
<div class="line"><code class="value">0000</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="value">0011</code><code class="plain"> </code><code class="value">0000</code></div>
<div class="line"><code class="plain">索引: </code><code class="value">0110</code><code class="plain"> -&gt; </code><code class="value">0x6</code></div>
<div class="line"><code class="plain">段描述符: ffc093df`f0000001</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-11_10-55-1.png" alt="images/download/attachments/1015846/image2022-10-11_10-55-1.png" width="400"  />
    </p>
<p   
>&#25509;&#30528;&#25105;&#20204;&#26681;&#25454;&#27573;&#25551;&#36848;&#31526;&#30340;Base&#65292;&#21363;0xffdff000&#65292;&#23427;&#25351;&#21521;&#30340;&#23601;&#26159;&#24403;&#21069;CPU&#30340;KPCR&#32467;&#26500;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-11_11-1-7.png" alt="images/download/attachments/1015846/image2022-10-11_11-1-7.png" width="400"  />
    </p>
<p   
>&#28982;&#21518;&#23601;&#26159;&#21387;&#20837;FS&#27573;&#30340;0x0&#20559;&#31227;&#20301;&#30340;&#20869;&#23481;&#65292;&#20063;&#23601;&#26159;&#25351;&#21521;&#30340;KPCR&#32467;&#26500;0x0&#20559;&#31227;&#20301;&#25104;&#21592;_NT_TIB-&gt;ExceptionList&#65292;&#25509;&#30528;&#20877;&#23558;&#24403;&#21069;&#30340;ExceptionList&#35774;&#20026;-1&#65292;&#21363;&#28165;&#31354;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-11_11-26-49.png" alt="images/download/attachments/1015846/image2022-10-11_11-26-49.png" width="600"  />
    </p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-11_11-29-57.png" alt="images/download/attachments/1015846/image2022-10-11_11-29-57.png" width="600"  />
    </p>
<p   
>&#20877;&#32487;&#32493;&#21521;&#19979;&#30475;&#65292;&#23558;&#24403;&#21069;CPU&#25191;&#34892;&#30340;&#32447;&#31243;&#20449;&#24687;&#32473;&#21040;&#20102;ESI&#23492;&#23384;&#22120;&#65292;&#21363;FS&#27573;&#30340;0x124&#20559;&#31227;&#20301;&#30340;&#20869;&#23481;&#65292;&#20063;&#23601;&#26159;_KPRCB&#32467;&#26500;&#20307;&#30340;0x4&#20559;&#31227;&#20301;&#25104;&#21592;CurrentThread&#65307;&#23427;&#26159;&#19968;&#20010;&#32467;&#26500;&#20307;_KTHREAD&#65292;<strong class=" ">&#25509;&#30528;&#21387;&#20837;&#35813;&#32467;&#26500;&#20307;&#30340;0x140&#20559;&#31227;&#20301;&#25104;&#21592;&#65292;&#20063;&#23601;&#26159;&#20808;&#21069;&#27169;&#24335;PreviousMode</strong>&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-11_18-30-3.png" alt="images/download/attachments/1015846/image2022-10-11_18-30-3.png" width="600"  />
    </p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-11_18-30-20.png" alt="images/download/attachments/1015846/image2022-10-11_18-30-20.png" width="400"  />
    </p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-11_18-31-43.png" alt="images/download/attachments/1015846/image2022-10-11_18-31-43.png" width="400"  />
    </p>
<p   
>&#25509;&#30528;&#30475;&#19979;&#38754;&#30340;&#20195;&#30721;&#65292;&#39318;&#20808;&#25552;&#21319;&#22534;&#26632;&#33267;Trap_Frame&#32467;&#26500;&#20307;&#39030;&#37096;&#65292;&#20063;&#23601;&#26159;&#25351;&#21521;&#20102;&#32467;&#26500;&#20307;&#30340;&#31532;&#19968;&#20010;&#25104;&#21592;&#65292;&#28982;&#21518;&#23558;3&#29615;&#21407;&#26469;CS&#30340;&#20540;&#21363;Trap_Frame+0x6C+arg_0(0x4)&#32473;&#21040;EBX&#65292;&#22312;&#23558;CS&#21644;1&#36827;&#34892;&#19982;&#36816;&#31639;&#21028;&#26029;&#35843;&#29992;0&#29615;&#20989;&#25968;&#30340;&#26469;&#28304;&#26435;&#38480;&#65292;&#20063;&#23601;&#26159;CPL&#65292;&#28982;&#21518;&#23558;&#19982;&#36816;&#31639;&#30340;&#32467;&#26524;&#32473;&#21040;&#32467;&#26500;&#20307;_KTHREAD&#30340;&#20808;&#21069;&#27169;&#24335;PreviousMode&#65292;<strong class=" ">&#36825;&#26679;&#20570;&#30340;&#24847;&#20041;&#26159;&#22240;&#20026;&#26377;&#20123;&#20869;&#26680;&#20989;&#25968;&#21487;&#20197;&#34987;3&#29615;&#12289;0&#29615;&#35843;&#29992;&#65292;&#20294;&#30001;&#20110;&#26435;&#38480;&#30340;&#19981;&#21516;&#25152;&#20197;&#25191;&#34892;&#30340;&#20869;&#23481;&#20063;&#19981;&#19968;&#26679;&#65292;&#22240;&#27492;&#38656;&#35201;&#36890;&#36807;&#20808;&#21069;&#27169;&#24335;&#26469;&#20915;&#23450;&#25191;&#34892;&#30340;&#20869;&#23481;</strong>&#12290;&#20877;&#25509;&#19979;&#26469;&#23601;&#26159;&#23558;&#26632;&#24213;&#25351;&#21521;&#26632;&#39030;&#30340;&#20301;&#32622;&#65292;&#20063;&#23601;&#26159;&#37117;&#25351;&#21521;Trap_Frame&#32467;&#26500;&#20307;&#30340;&#31532;&#19968;&#20010;&#25104;&#21592;&#20301;&#32622;&#65292;&#20877;&#23558;_KTHREAD&#20013;&#30340;Trap_Frame&#32467;&#26500;&#20307;&#22320;&#22336;&#21462;&#20986;&#65292;&#20020;&#26102;&#23384;&#25918;&#33267;&#24403;&#21069;Trap_Frame&#32467;&#26500;&#20307;&#30340;0x3C&#20559;&#31227;&#20301;&#65292;<strong class=" ">&#30001;&#20110;Trap_Frame&#30340;&#20869;&#23481;&#21457;&#29983;&#20102;&#21464;&#21270;&#65292;&#26368;&#21518;&#20877;&#25226;&#24403;&#21069;&#26368;&#26032;&#30340;Trap_Frame&#32467;&#26500;&#20307;&#22320;&#22336;&#23384;&#20837;_KTHREAD&#20013;&#30340;Trap_Frame&#32467;&#26500;&#20307;&#20301;&#32622;&#65288;&#21363;0x134&#20559;&#31227;&#20301;&#65289;</strong>&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-11_18-45-20.png" alt="images/download/attachments/1015846/image2022-10-11_18-45-20.png" width="600"  />
    </p>
<p   
>&#22914;&#19979;&#20195;&#30721;&#23601;&#27604;&#36739;&#31616;&#21333;&#20102;&#65292;&#23558;3&#29615;&#30340;EBP&#12289;EIP&#12289;3&#29615;&#20256;&#21442;&#25351;&#38024;&#23384;&#20837;Trap_Frame&#32467;&#26500;&#20307;&#35843;&#35797;&#30456;&#20851;&#30340;&#25104;&#21592;&#24403;&#20013;&#65292;&#21028;&#26029;&#24403;&#21069;&#32447;&#31243;&#26159;&#21542;&#24320;&#21551;&#20102;&#35843;&#35797;&#29366;&#24577;&#65292;&#22914;&#26524;&#24320;&#21551;&#21017;&#36827;&#34892;&#36339;&#36716;&#65292;&#36339;&#36716;&#36807;&#21435;&#20043;&#21518;&#23454;&#38469;&#19978;&#20063;&#26159;&#22635;&#20805;Trap_Frame&#32467;&#26500;&#20307;&#20013;&#30340;&#35843;&#35797;&#30456;&#20851;&#30340;&#25104;&#21592;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-11_19-10-28.png" alt="images/download/attachments/1015846/image2022-10-11_19-10-28.png" width="600"  />
    </p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-11_19-11-3.png" alt="images/download/attachments/1015846/image2022-10-11_19-11-3.png" width="600"  />
    </p>
<p   
>&#20877;&#25509;&#30528;&#23601;&#26159;&#36339;&#21040;&#26576;&#20010;&#20195;&#30721;&#27573;&#65292;&#20294;&#26159;&#36825;&#20010;&#20195;&#30721;&#27573;&#26159;&#23646;&#20110;_KiFastCallEntry&#20989;&#25968;&#30340;&#65292;<strong class=" ">&#25152;&#20197;&#20174;&#26412;&#36136;&#19978;&#26469;&#35828;&#20004;&#20010;&#20989;&#25968;&#26368;&#32456;&#37117;&#26159;&#36208;&#21521;&#21516;&#19968;&#20010;&#22320;&#26041;&#65292;&#26080;&#38750;&#23601;&#26159;&#20013;&#26029;&#38376;&#35843;&#29992;&#20250;&#20256;&#20837;5&#20010;&#20540;&#38656;&#35201;&#20445;&#23384;&#32780;&#24555;&#36895;&#35843;&#29992;&#19981;&#20250;&#20256;&#20837;&#36825;5&#20010;&#20540;</strong>&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-11_19-15-55.png" alt="images/download/attachments/1015846/image2022-10-11_19-15-55.png" width="600"  />
    </p>
<p   
>&#33267;&#27492;&#65292;&#25105;&#20204;&#23601;&#20102;&#35299;&#20102;&#20445;&#23384;&#29616;&#22330;&#30340;&#36807;&#31243;&#12290;</p>
    </div>
    </div>
    <div class="section section-1" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLeezu-e7n-acjeWKoeihqA">
        <h1 class="heading "><span>&#31995;&#32479;&#26381;&#21153;&#34920;</span></h1>
<p   
>&#25105;&#20204;&#30693;&#36947;3&#29615;API&#30340;&#26412;&#36136;&#23601;&#26159;&#35843;&#29992;0&#29615;&#30340;&#20989;&#25968;&#65292;&#37027;&#20040;&#25805;&#20316;&#31995;&#32479;&#26159;&#22914;&#20309;&#26681;&#25454;&#31995;&#32479;&#35843;&#29992;&#21495;&#25214;&#21040;&#35201;&#25191;&#34892;&#30340;&#20869;&#26680;&#20989;&#25968;&#30340;&#65292;&#36825;&#23601;&#38656;&#35201;&#25105;&#20204;&#26469;&#20102;&#35299;&#19968;&#19979;&#31995;&#32479;&#26381;&#21153;&#34920;&#12290;</p>
    <div class="section section-2" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLVN5c3RlbVNlcnZpY2VUYWJsZQ">
        <h2 class="heading "><span>SystemServiceTable</span></h2>
<p   
>&#22914;&#19979;&#22270;&#26159;&#31995;&#32479;&#26381;&#21153;&#34920;&#30340;&#32467;&#26500;&#65292;&#23427;&#26377;&#22235;&#20010;&#25104;&#21592;&#20998;&#21035;&#26159;ServiceTable&#12289;Count&#12289;ServiceLimit&#12289;ArgmentTable&#12290;ServiceTable&#37324;&#23384;&#20648;&#30340;&#26159;&#19968;&#20010;&#25351;&#38024;&#65292;&#25351;&#21521;&#20102;&#19968;&#24352;&#20989;&#25968;&#22320;&#22336;&#34920;&#65292;<strong class=" ">&#34920;&#20869;&#23384;&#20648;&#30340;&#26159;&#20989;&#25968;&#22320;&#22336;&#65292;&#34920;&#20869;&#30340;&#27599;&#20010;&#25104;&#21592;&#22823;&#23567;&#20026;4&#23383;&#33410;</strong>&#65307;Count&#37324;&#23384;&#20648;&#30340;&#26159;&#24403;&#21069;&#31995;&#32479;&#26381;&#21153;&#34920;&#34987;&#35843;&#29992;&#30340;&#27425;&#25968;&#65307;ServiceLimit&#37324;&#23384;&#20648;&#36825;&#24403;&#21069;&#31995;&#32479;&#26381;&#21153;&#34920;&#20869;&#23384;&#20648;&#20989;&#25968;&#30340;&#20010;&#25968;&#65307;ArgmentTablee&#37324;&#23384;&#20648;&#30340;&#26159;&#19968;&#20010;&#25351;&#38024;&#65292;&#25351;&#21521;&#20102;&#20989;&#25968;&#21442;&#25968;&#34920;&#65292;&#34920;&#20869;&#23384;&#20648;&#30340;&#26159;&#20989;&#25968;&#21442;&#25968;&#30340;&#20010;&#25968;&#65292;<strong class=" ">&#23427;&#30340;&#21333;&#20301;&#26159;&#23383;&#33410;&#65292;&#34920;&#20869;&#30340;&#27599;&#20010;&#25104;&#21592;&#22823;&#23567;&#20026;1&#23383;&#33410;</strong>&#12290;</p>
<p   
>&#22312;&#20989;&#25968;&#22320;&#22336;&#34920;&#20869;&#23384;&#20648;&#30340;&#24182;&#19981;&#26159;&#25152;&#26377;&#30340;&#20869;&#26680;&#20989;&#25968;&#65292;&#32780;&#26159;&#22312;3&#29615;&#32463;&#24120;&#20351;&#29992;&#30340;&#20869;&#26680;&#20989;&#25968;&#65292;<strong class=" ">&#20989;&#25968;&#22320;&#22336;&#34920;&#21644;&#20989;&#25968;&#21442;&#25968;&#34920;&#26159;&#23545;&#24212;&#20851;&#31995;&#65292;&#21363;&#20989;&#25968;&#22320;&#22336;&#34920;&#25104;&#21592;1&#30340;&#21442;&#25968;&#20010;&#25968;&#23601;&#26159;&#20989;&#25968;&#21442;&#25968;&#34920;&#25104;&#21592;1</strong>&#12290;</p>
<p   
>&#22312;Windows XP&#31995;&#32479;&#20013;&#65292;&#31995;&#32479;&#26381;&#21153;&#34920;&#26377;&#20004;&#24352;&#65292;&#19979;&#22270;&#20013;&#32511;&#33394;&#12289;&#40644;&#33394;&#34920;&#21363;&#20307;&#29616;&#12290;&#23427;&#20204;&#30340;&#32467;&#26500;&#37117;&#26159;&#19968;&#26679;&#30340;&#65292;&#21482;&#26159;&#23384;&#20648;&#30340;&#20989;&#25968;&#12289;&#21442;&#25968;&#19981;&#19968;&#26679;&#65292;<strong class=" ">&#21069;&#32773;&#23384;&#20648;&#30340;&#26159;&#24120;&#29992;&#30340;&#20869;&#26680;&#20989;&#25968;&#65288;Ntoskrl.exe&#65289;&#65292;&#21518;&#32773;&#23384;&#20648;&#30340;&#26159;&#19982;&#22270;&#20687;&#26174;&#31034;&#29992;&#25143;&#30028;&#38754;&#30456;&#20851;&#30340;&#20989;&#25968;&#65288;Win32k.sys&#65289;</strong>&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-12_9-53-27.png" alt="images/download/attachments/1015846/image2022-10-12_9-53-27.png" width="600"  />
    </p>
    <div class="section section-3" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLeihqOS9jee9rg">
        <h3 class="heading "><span>&#34920;&#20301;&#32622;</span></h3>
<p   
>&#22312;&#20102;&#35299;&#20445;&#23384;&#29616;&#22330;&#20869;&#23481;&#26102;&#65292;&#25105;&#20204;&#30693;&#36947;&#22312;Windows&#20869;&#26680;&#20013;&#27599;&#19968;&#20010;&#36827;&#31243;&#30340;&#27599;&#19968;&#20010;&#32447;&#31243;&#37117;&#26377;&#30528;&#19968;&#20010;_ETHREAD&#32467;&#26500;&#20307;&#65292;&#23427;&#23384;&#20648;&#30528;&#32447;&#31243;&#30456;&#20851;&#30340;&#20449;&#24687;&#65292;&#22312;&#36825;&#20010;&#32467;&#26500;&#20307;&#37324;&#26377;&#21478;&#22806;&#19968;&#20010;&#32467;&#26500;&#20307;_KTHREAD&#65292;&#35813;&#32467;&#26500;&#20307;&#30340;0xE0&#20559;&#31227;&#20301;&#25104;&#21592;&#23601;&#23384;&#20648;&#30528;&#31995;&#32479;&#26381;&#21153;&#34920;&#30340;&#22320;&#22336;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-12_10-8-56.png" alt="images/download/attachments/1015846/image2022-10-12_10-8-56.png" width="400"  />
    </p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-12_10-5-4.png" alt="images/download/attachments/1015846/image2022-10-12_10-5-4.png" width="600"  />
    </p>
    </div>
    </div>
    <div class="section section-2" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLeezu-e7n-iwg-eUqOWPt-afpeaJvuWHveaVsA">
        <h2 class="heading "><span>&#31995;&#32479;&#35843;&#29992;&#21495;&#26597;&#25214;&#20989;&#25968;</span></h2>
<p   
>3&#29615;&#30340;API&#35843;&#29992;&#23601;&#26159;&#26681;&#25454;&#31995;&#32479;&#35843;&#29992;&#21495;&#25214;&#21040;&#20989;&#25968;&#20877;&#21435;&#20351;&#29992;&#65292;<strong class=" ">&#34429;&#28982;&#31995;&#32479;&#35843;&#29992;&#21495;&#26377;32&#20301;&#65288;4&#23383;&#33410;&#65289;&#20294;&#26159;&#30495;&#27491;&#20351;&#29992;&#30340;&#21482;&#26377;&#20302;13&#20301;</strong>&#65292;&#36825;13&#20301;&#20063;&#20998;&#25104;&#20004;&#37096;&#20998;&#65306;<strong class=" ">&#31532;12&#20301;&#20540;&#20026;0&#21017;&#20026;&#31532;&#19968;&#24352;&#34920;&#65288;Ntoskrl.exe&#65289;&#65292;&#20540;&#20026;1&#21017;&#20026;&#31532;&#20108;&#24352;&#34920;&#65288;Win32k.sys&#65289;</strong>&#65307;<strong class=" ">&#20302;12&#20301;&#65288;&#31532;0&#33267;&#31532;11&#20301;&#65289;&#23601;&#26159;&#23545;&#24212;&#30340;&#20989;&#25968;&#22320;&#22336;&#12289;&#21442;&#25968;&#34920;&#32034;&#24341;</strong>&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-12_10-43-46.png" alt="images/download/attachments/1015846/image2022-10-12_10-43-46.png" width="600"  />
 <img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-12_10-39-35.png" alt="images/download/attachments/1015846/image2022-10-12_10-39-35.png" width="600"  />
</p>
<p   
><br/></p>
    <div class="section section-3" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLeS7o-eggeWIhuaekA">
        <h3 class="heading "><span>&#20195;&#30721;&#20998;&#26512;</span></h3>
<p   
>&#22312;&#20445;&#23384;&#29616;&#22330;&#30340;&#23398;&#20064;&#26102;&#25105;&#20204;&#30693;&#36947;&#26080;&#35770;&#26159;KiSystemService&#36824;&#26159;KiFastCallEntry&#26041;&#27861;&#26368;&#32456;&#37117;&#20250;&#36208;&#21040;KiFastCallEntry&#20989;&#25968;&#20869;&#30340;&#26576;&#22359;&#12290;&#36825;&#19968;&#22359;&#20195;&#30721;&#23601;&#26159;&#31995;&#32479;&#35843;&#29992;&#21495;&#26597;&#25214;&#20989;&#25968;&#30340;&#36807;&#31243;&#65292;&#25105;&#20204;&#26469;&#20998;&#26512;&#19968;&#19979;&#12290;</p>
<p   
>&#39318;&#20808;&#26159;&#21462;3&#29615;&#20256;&#20837;&#30340;&#31995;&#32479;&#35843;&#29992;&#21495;&#32473;&#21040;EDI&#65292;&#28982;&#21518;&#22240;&#20026;&#31995;&#32479;&#35843;&#29992;&#21495;&#25105;&#20204;&#23454;&#38469;&#20351;&#29992;&#30340;&#21482;&#26377;13&#20301;&#65292;&#20854;&#20182;&#20301;&#37117;&#26159;0&#65292;&#25152;&#20197;&#23558;EDI&#21491;&#31227;8&#20301;&#20043;&#21518;&#23601;&#36824;&#21097;&#19979;5&#20301;&#65292;&#25509;&#30528;&#36825;5&#20301;&#21448;&#21644;0x30&#36827;&#34892;&#19982;&#36816;&#31639;&#65292;&#20063;&#23601;&#34920;&#31034;&#36816;&#31639;&#32467;&#26524;&#21482;&#26377;&#20004;&#31181;&#65292;&#21363;0x10&#25110;0x0&#12290;&#32487;&#32493;&#23558;&#36816;&#31639;&#21518;&#30340;&#32467;&#26524;&#32473;&#21040;ECX&#65292;<strong class=" ">&#22240;&#20026;&#22312;&#20043;&#21069;&#30340;KiSystemService&#20989;&#25968;&#20013;ESI&#25351;&#21521;&#30340;&#26159;_KTHREAD&#32467;&#26500;&#20307;&#65292;&#25152;&#20197;ESI+0xE0&#25351;&#21521;&#30340;&#23601;&#26159;&#31995;&#32479;&#26381;&#21153;&#34920;&#22320;&#22336;&#65292;&#21448;&#23558;&#19982;&#36816;&#31639;&#32467;&#26524;&#21644;&#31995;&#32479;&#26381;&#21153;&#34920;&#22320;&#22336;&#30456;&#21152;&#65292;&#21363;&#34920;&#31034;&#21462;&#30340;&#31995;&#32479;&#26381;&#21153;&#34920;&#26159;&#31532;&#19968;&#24352;&#36824;&#26159;&#31532;&#20108;&#24352;&#65288;&#31995;&#32479;&#26381;&#21153;&#34920;&#30340;&#23485;&#24230;&#23601;&#26159;16&#23383;&#33410;&#65292;&#21363;0x10&#65289;</strong>&#65292;&#22240;&#27492;&#25105;&#20204;&#21487;&#20197;&#30693;&#36947;&#36825;&#37324;&#30340;&#35745;&#31639;&#26041;&#24335;&#26159;&#24456;&#31934;&#24039;&#30340;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-12_11-40-14.png" alt="images/download/attachments/1015846/image2022-10-12_11-40-14.png" width="600"  />
    </p>
<p   
>&#20854;&#27425;&#20877;&#21462;&#31995;&#32479;&#35843;&#29992;&#21495;&#32473;&#21040;EBX&#65292;&#28982;&#21518;&#30001;&#20110;&#20043;&#21069;&#24050;&#32463;&#36890;&#36807;&#19979;&#26631;&#20026;12&#30340;&#20301;&#25214;&#21040;&#20102;&#23545;&#24212;&#30340;&#34920;&#65292;&#25152;&#20197;&#23558;&#31995;&#32479;&#35843;&#29992;&#21495;&#21644;0xFFF&#36827;&#34892;&#19982;&#36816;&#31639;&#65292;&#20063;&#23601;&#26159;&#25226;&#19979;&#26631;&#20026;12&#30340;&#20301;&#35774;&#20026;0&#65292;&#25509;&#30528;EDI+8&#19982;EAX&#36827;&#34892;&#27604;&#36739;&#65292;&#21363;&#31995;&#32479;&#26381;&#21153;&#34920;&#30340;ServiceLimit&#25104;&#21592;&#19982;&#31995;&#32479;&#35843;&#29992;&#21495;&#65292;&#20197;&#27492;&#26469;&#21028;&#26029;&#20256;&#36882;&#30340;&#20989;&#25968;&#32034;&#24341;&#26159;&#21542;&#36234;&#30028;&#65292;&#22914;&#26524;&#36234;&#30028;&#21017;&#36339;&#36716;&#24322;&#24120;&#22788;&#29702;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-12_11-42-39.png" alt="images/download/attachments/1015846/image2022-10-12_11-42-39.png" width="600"  />
    </p>
<p   
>&#20877;&#25509;&#30528;&#23601;&#26159;&#23558;&#20043;&#21069;&#30340;&#19982;&#36816;&#31639;&#32467;&#26524;&#21644;0x10&#36827;&#34892;&#27604;&#36739;&#65292;&#20063;&#23601;&#26159;&#21028;&#26029;&#31995;&#32479;&#35843;&#29992;&#21495;&#23545;&#24212;&#30340;&#34920;&#65292;&#22914;&#26524;&#19982;&#36816;&#31639;&#32467;&#26524;&#26159;0x10&#21017;&#21521;&#19979;&#20250;&#35843;&#29992;&#21040;_KeGdiFlushUserBatch&#20989;&#25968;&#65288;<strong class=" ">&#33258;&#34892;&#26597;&#38405;&#25163;&#20876;</strong>&#65289;&#65292;&#22914;&#26524;&#19982;&#36816;&#31639;&#30340;&#32467;&#26524;&#26159;0x0&#21017;&#36339;&#36716;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-12_14-30-16.png" alt="images/download/attachments/1015846/image2022-10-12_14-30-16.png" width="600"  />
    </p>
<p   
>&#32487;&#32493;&#21521;&#19979;&#30475;&#65292;&#23558;_KPCR&#30340;0x638&#20559;&#31227;&#20301;&#30340;&#25104;&#21592;&#20540;&#21152;1&#65292;&#20063;&#23601;&#26159;_KPRCB&#30340;0x518&#20559;&#31227;&#30340;&#25104;&#21592;KeSystemCalls&#65292;&#28982;&#21518;&#23558;EDX&#65288;&#21363;3&#29615;&#21442;&#25968;&#30340;&#25351;&#38024;&#65289;&#32473;&#21040;ESI&#65292;&#25509;&#30528;&#23558;&#31995;&#32479;&#26381;&#21153;&#34920;&#25351;&#21521;&#30340;&#20989;&#25968;&#21442;&#25968;&#34920;ArgmentTable&#30340;&#22320;&#22336;&#32473;&#21040;EBX&#65292;&#28982;&#21518;XOR&#28165;&#31354;ECX&#12290;&#32039;&#25509;&#30528;&#23601;&#26159;&#26681;&#25454;&#31995;&#32479;&#35843;&#29992;&#21495;&#30340;&#32034;&#24341;&#33719;&#21462;&#24819;&#35201;&#35843;&#29992;&#30340;&#20989;&#25968;&#21442;&#25968;&#30340;&#23383;&#33410;&#25968;&#32473;&#21040;CL&#65292;&#20877;&#23558;&#31995;&#32479;&#26381;&#21153;&#34920;&#25351;&#21521;&#30340;&#20989;&#25968;&#22320;&#22336;&#34920;ServiceTable&#30340;&#22320;&#22336;&#32473;&#21040;EDI&#65292;&#28982;&#21518;&#20877;&#26681;&#25454;&#31995;&#32479;&#35843;&#29992;&#21495;&#30340;&#32034;&#24341;&#33719;&#21462;&#38656;&#35201;&#35843;&#29992;&#30340;&#20989;&#25968;&#65288;<strong class=" ">&#36825;&#37324;&#20056;&#20197;4&#26159;&#22240;&#20026;&#23384;&#20648;&#30340;&#20989;&#25968;&#22320;&#22336;&#23485;&#24230;&#20026;4&#23383;&#33410;</strong>&#65289;&#32473;&#21040;EBX&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-12_15-5-47.png" alt="images/download/attachments/1015846/image2022-10-12_15-5-47.png" width="600"  />
    </p>
<p   
>&#28982;&#21518;&#23558;&#22534;&#26632;<strong class=" ">&#25353;ECX&#21363;&#20989;&#25968;&#21442;&#25968;&#23383;&#33410;&#25968;</strong>&#36827;&#34892;&#25552;&#21319;&#65292;&#36825;&#26679;&#26159;&#20026;&#20102;&#22312;0&#29615;&#23558;3&#29615;&#30340;&#21442;&#25968;&#22797;&#21046;&#36827;&#26469;&#65292;&#25509;&#30528;&#23558;<strong class=" ">ECX&#21363;&#20989;&#25968;&#21442;&#25968;&#23383;&#33410;&#25968;</strong>&#21491;&#31227;2&#20301;&#20063;&#23601;&#26159;&#38500;&#20197;4&#33719;&#24471;&#21442;&#25968;&#30340;&#20010;&#25968;&#65292;&#22240;&#20026;&#22312;&#19979;&#38754;&#30340;REP&#25351;&#20196;&#20013;&#27599;&#27425;&#22797;&#21046;&#26159;4&#23383;&#33410;&#30340;&#65292;&#24182;&#19988;&#35813;&#25351;&#20196;&#30340;&#24490;&#29615;&#27425;&#25968;&#26159;ECX&#30340;&#20540;&#65292;&#25152;&#20197;&#25105;&#20204;&#35201;&#38500;&#20197;4&#12290;&#25509;&#30528;&#23558;ESP&#32473;EDI&#26159;&#20026;&#35774;&#32622;&#35201;&#24490;&#29615;&#22797;&#21046;&#30340;&#30446;&#30340;&#22320;&#22336;&#65292;&#28982;&#21518;&#21028;&#26029;3&#29615;&#21442;&#25968;&#22320;&#22336;&#33539;&#22260;&#26377;&#27809;&#26377;&#36234;&#30028;&#65292;&#20063;&#23601;&#26159;&#26377;&#27809;&#26377;&#22823;&#20110;_MmUserProbeAddress&#65292;&#22914;&#26524;&#36234;&#30028;&#20102;&#21017;&#36827;&#34892;&#36339;&#36716;&#12290;&#26368;&#21518;&#65292;&#25191;&#34892;&#23436;REP&#25351;&#20196;&#23601;&#35843;&#29992;EBX&#20063;&#23601;&#26159;&#20869;&#26680;&#20989;&#25968;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-12_15-56-59.png" alt="images/download/attachments/1015846/image2022-10-12_15-56-59.png" width="600"  />
    </p>
    </div>
    </div>
    <div class="section section-2" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLVNTRFQ">
        <h2 class="heading "><span>SSDT</span></h2>
<p   
>&#22312;&#19978;&#38754;&#30340;&#23398;&#20064;&#20013;&#25105;&#20204;&#30693;&#36947;&#21487;&#20197;&#36890;&#36807;_KTHREAD&#32467;&#26500;&#20307;&#30340;0xE0&#20559;&#31227;&#26469;&#20250;&#25214;&#21040;&#31995;&#32479;&#26381;&#21153;&#34920;&#65292;&#38500;&#20102;&#36825;&#20010;&#26041;&#24335;&#20197;&#22806;&#25105;&#20204;&#36824;&#21487;&#20197;&#36890;&#36807;&#21478;&#22806;&#19968;&#31181;&#26041;&#24335;&#26469;&#35775;&#38382;&#65292;&#37027;&#23601;&#26159;SSDT&#65288;System Service Descriptor Table&#65292;&#31995;&#32479;&#26381;&#21153;&#25551;&#36848;&#31526;&#34920;&#65289;&#12290;</p>
<p   
>SSDT&#20063;&#26377;&#20004;&#24352;&#34920;&#65306;KeServiceDescriptorTable&#12289;KeServiceDescriptorTableShadow&#12290;KeServiceDescriptorTable&#26159;&#20869;&#26680;&#25991;&#20214;&#23548;&#20986;&#30340;&#65292;&#25105;&#20204;&#21487;&#20197;&#22312;&#20869;&#26680;&#25991;&#20214;Ntoskrnl.exe&#30340;&#23548;&#20986;&#34920;&#20013;&#25214;&#21040;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-12_19-27-19.png" alt="images/download/attachments/1015846/image2022-10-12_19-27-19.png" width="600"  />
    </p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#22312;Windbg&#19979;&#30452;&#25509;&#26597;&#30475;&#36825;&#24352;&#34920;&#65292;&#36825;&#24352;&#34920;&#37324;&#19968;&#20849;&#26377;4&#20010;&#25104;&#21592;&#65292;&#27599;&#20010;&#25104;&#21592;&#37117;&#26159;&#19968;&#20010;&#31995;&#32479;&#26381;&#21153;&#34920;&#65292;&#25152;&#20197;SSDT&#30340;&#25968;&#25454;&#23485;&#24230;&#20026;64&#23383;&#33410;&#65292;&#20294;&#26159;&#25105;&#20204;&#30693;&#36947;Windows XP&#31995;&#32479;&#20351;&#29992;&#20102;&#20004;&#24352;&#31995;&#32479;&#26381;&#21153;&#34920;&#65292;&#30446;&#21069;&#21482;&#33021;&#30475;&#21040;&#19968;&#24352;&#31995;&#32479;&#26381;&#21153;&#34920;&#65292;&#31532;&#20108;&#24352;&#34920;&#21364;&#26080;&#27861;&#30475;&#35265;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-12_19-29-21.png" alt="images/download/attachments/1015846/image2022-10-12_19-29-21.png" width="400"  />
    </p>
<p   
>&#36825;&#26159;&#22240;&#20026;&#31532;&#20108;&#24352;&#31995;&#32479;&#26381;&#21153;&#34920;&#27809;&#26377;&#25918;&#22312;SSDT&#20013;&#65292;&#32780;&#26159;&#25918;&#22312;&#20102;SSDT Shadow&#65288;&#21363;KeServiceDescriptorTableShadow&#65289;&#37324;&#65292;&#25105;<strong class=" ">&#20204;&#21487;&#20197;&#36890;&#36807;Windbg&#26597;&#30475;&#36825;&#24352;&#34920;&#24182;&#19988;&#33021;&#30475;&#21040;&#37324;&#38754;&#26377;2&#24352;&#31995;&#32479;&#26381;&#21153;&#34920;&#65292;&#20294;&#26159;&#36825;&#24352;&#34920;&#26159;&#26410;&#23548;&#20986;&#30340;&#25105;&#20204;&#24819;&#35201;&#20351;&#29992;&#30340;&#35805;&#65292;&#36890;&#24120;&#37319;&#29992;&#20869;&#23384;&#25628;&#32034;&#30340;&#26041;&#24335;&#26469;&#25214;&#21040;</strong>&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-12_19-36-52.png" alt="images/download/attachments/1015846/image2022-10-12_19-36-52.png" width="400"  />
    </p>
    <div class="section section-3" id="src-1015846_safe-id-aWQt57O757uf6LCD55SoLeWunuaImOWIhuaekA">
        <h3 class="heading "><span>&#23454;&#25112;&#20998;&#26512;</span></h3>
<p   
>&#25105;&#20204;&#20102;&#35299;&#20102;SSTD&#34920;&#21518;&#65292;&#20063;&#23601;&#30693;&#36947;&#20102;&#31995;&#32479;&#26381;&#21153;&#34920;&#30340;&#20855;&#20307;&#25104;&#21592;&#20540;&#65292;&#21487;&#20197;&#26681;&#25454;&#31995;&#32479;&#35843;&#29992;&#21495;&#33258;&#24049;&#26469;&#25214;&#19968;&#19979;&#20869;&#26680;&#20989;&#25968;&#12290;&#22914;&#25105;&#20204;&#20043;&#21069;&#20998;&#26512;&#30340;ReadProcessMemory&#20989;&#25968;&#65292;&#23427;&#30340;&#31995;&#32479;&#35843;&#29992;&#21495;&#23601;&#26159;0xBA&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-9-18_15-3-35.png" alt="images/download/attachments/1015846/image2022-9-18_15-3-35.png" width="400"  />
    </p>
<p   
>&#25105;&#20204;&#26469;&#25163;&#21160;&#20998;&#26512;&#19968;&#19979;&#65292;&#20808;&#23558;&#31532;&#19968;&#24352;&#31995;&#32479;&#26381;&#21153;&#34920;&#25353;&#25104;&#21592;&#32467;&#26500;&#36827;&#34892;&#25286;&#20998;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">ServiceTable（函数地址表地址）：</code><code class="value">80504734</code></div>
<div class="line"><code class="plain">Count（系统服务表调用次数）：</code><code class="value">00000000</code></div>
<div class="line"><code class="plain">ServiceLimit（系统服务表内存储函数的个数）：0000011c</code></div>
<div class="line"><code class="plain">ArgmentTable（函数参数表地址）：80504ba8</code></div>
</div>
    </div>
<p   
>&#25509;&#30528;&#26681;&#25454;&#20989;&#25968;&#22320;&#22336;&#34920;&#22320;&#22336;&#24102;&#20837;&#31995;&#32479;&#35843;&#29992;&#21495;&#25214;&#21040;&#20869;&#26680;&#20989;&#25968;&#30340;&#22320;&#22336;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#25105;&#20204;&#23601;&#25214;&#21040;&#20102;ReadProcessMemory&#26368;&#32456;&#35843;&#29992;&#30340;&#20869;&#26680;&#20989;&#25968;NtReadVirtualMemory&#65292;&#23427;&#30340;&#27719;&#32534;&#20195;&#30721;&#25105;&#20204;&#20063;&#19968;&#28165;&#20108;&#26970;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-12_19-48-28.png" alt="images/download/attachments/1015846/image2022-10-12_19-48-28.png" width="600"  />
    </p>
<p   
>&#21516;&#26679;&#25105;&#20204;&#20063;&#21487;&#20197;&#26597;&#30475;&#35813;&#20989;&#25968;&#30340;&#21442;&#25968;&#24635;&#23383;&#33410;&#25968;&#65292;&#20063;&#23601;&#26159;0x14&#65288;20&#65289;&#20010;&#23383;&#33410;&#65292;&#25353;&#27599;&#20010;&#21442;&#25968;4&#23383;&#33410;&#31639;&#65292;&#21363;&#26377;5&#20010;&#21442;&#25968;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015846/image2022-10-12_19-50-55.png" alt="images/download/attachments/1015846/image2022-10-12_19-50-55.png" width="600"  />
    </p>
<p   
><br/></p>
    </div>
    </div>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>&#20445;&#25252;&#27169;&#24335;</span>
        </a>
                <a href="%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>&#36827;&#31243;&#19982;&#32447;&#31243;</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
