<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>&#20445;&#25252;&#27169;&#24335; - &#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="1015827">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">BinaryLearning</span>
                    <img class="space-logo" src="global.logo" />
                </h1>
                <a href="Binary-Learning.html" class="ht-space-link">
                    <h2>&#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</h2>
                </a>
                <p><br><a href="https://github.com/gh0stkey/Binary-Learning" target="_blank">ᴀᴜᴛʜᴏʀ: ᴋᴇʏ</a><br><br>不积跬步，无以至千里；<br>不积小流，无以成江海。</p>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=1015831"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Binary-Learning.html">&#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</a></li>
                                                                                     <li><a href="%E4%B8%AD%E7%BA%A7%E7%AF%87.html">&#20013;&#32423;&#31687;</a></li>
                                                            </ul>
</div>            <h1 id="src-1015831"> <span>&#20445;&#25252;&#27169;&#24335;</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

    <div class="section section-1" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeS_neaKpOaooeW8jw">
        <h1 class="heading "><span>&#20445;&#25252;&#27169;&#24335;</span></h1>
<p   
>&#29616;&#22312;&#25805;&#20316;&#31995;&#32479;&#22823;&#22810;&#26159;&#36816;&#34892;&#22312;&#20445;&#25252;&#27169;&#24335;&#19979;&#30340;&#65292;&#22914;&#26524;&#25105;&#20204;&#35201;&#23398;&#22909;&#25805;&#20316;&#31995;&#32479;&#65292;&#20445;&#25252;&#27169;&#24335;&#26159;&#19968;&#23450;&#35201;&#20102;&#35299;&#30340;&#65307;&#26412;&#31456;&#33410;&#20027;&#35201;&#35762;&#35299;x86&#30340;&#20445;&#25252;&#27169;&#24335;&#65292;&#30001;&#20110;x64&#26159;&#22522;&#20110;x86&#25299;&#23637;&#30340;&#25351;&#20196;&#38598;&#65292;&#25152;&#20197;&#24403;&#20320;&#20855;&#22791;x86&#30340;&#22522;&#30784;&#20043;&#21518;&#20877;&#21435;&#23398;&#20064;x64&#20063;&#23601;&#24456;&#31616;&#21333;&#20102;&#12290;</p>
<p   
>&#20445;&#25252;&#27169;&#24335;&#30340;&#29305;&#28857;&#23601;&#26159;&#27573;&#12289;&#39029;&#30340;&#26426;&#21046;&#65292;&#36825;&#20063;&#26159;&#20445;&#25252;&#27169;&#24335;&#25152;&#38656;&#35201;&#23398;&#20064;&#30340;&#20869;&#23481;&#12290;&#23398;&#20064;&#20445;&#25252;&#27169;&#24335;&#25165;&#33021;&#30495;&#27491;&#30340;&#29702;&#35299;&#20869;&#26680;&#26159;&#22914;&#20309;&#36816;&#20316;&#30340;&#12290;</p>
    </div>
    <div class="section section-1" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeautQ">
        <h1 class="heading "><span>&#27573;</span></h1>
    <div class="section section-2" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeauteWvhOWtmOWZqA">
        <h2 class="heading "><span>&#27573;&#23492;&#23384;&#22120;</span></h2>
<p   
>&#22914;&#26524;&#20320;&#23398;&#20064;&#36807;&#21021;&#32423;&#31687;&#30340;&#35838;&#31243;&#65292;&#23454;&#38469;&#20320;&#23601;&#24050;&#32463;&#20351;&#29992;&#36807;&#27573;&#23492;&#23384;&#22120;&#20102;&#65292;&#22914;&#19979;&#27719;&#32534;&#20195;&#30721;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">mov dword ptr ds:[</code><code class="value">0x123456</code><code class="plain">], eax</code></div>
</div>
    </div>
<p   
>&#36825;&#26159;&#21521;&#26576;&#19968;&#22320;&#22336;&#20889;&#20837;&#20869;&#23481;&#65292;&#27719;&#32534;&#20195;&#30721;&#20013;&#30340;DS&#23454;&#38469;&#19978;&#23601;&#26159;&#27573;&#23492;&#23384;&#22120;&#65292;&#30495;&#27491;&#20889;&#20837;&#30340;&#22320;&#22336;&#23454;&#38469;&#19978;&#26159;<strong class=" ">DS.base+0x123456</strong>&#65292;base&#23601;&#26159;DS&#27573;&#23492;&#23384;&#22120;&#30340;&#19968;&#20010;&#23646;&#24615;&#12290;&#65288;&#20854;&#20182;&#27573;&#23492;&#23384;&#22120;&#30340;&#24418;&#24335;&#20063;&#26159;&#22914;&#27492;&#12290;&#65289;</p>
<p   
>&#27573;&#23492;&#23384;&#22120;&#19968;&#20849;&#26377;8&#20010;&#65306;ES&#12289;CS&#12289;SS&#12289;DS&#12289;FS&#12289;GS&#12289;LDTR&#12289;TR&#12290;</p>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLee7k-aehA">
        <h3 class="heading "><span>&#32467;&#26500;</span></h3>
<p   
>&#27573;&#23492;&#23384;&#22120;&#30340;&#32467;&#26500;&#19982;&#25105;&#20204;&#20043;&#21069;&#25152;&#20102;&#35299;&#30340;&#36890;&#29992;&#23492;&#23384;&#22120;&#32467;&#26500;&#26159;&#19981;&#19968;&#26679;&#30340;&#65292;&#36890;&#29992;&#23492;&#23384;&#22120;&#26377;32&#20301;&#65288;4&#23383;&#33410;&#65289;&#23485;&#24230;&#65292;&#20294;&#26159;&#27573;&#23492;&#23384;&#22120;&#21364;&#26377;96&#20301;&#65288;12&#23383;&#33410;&#65289;&#23485;&#24230;&#12290;</p>
<p   
>&#27573;&#23492;&#23384;&#22120;&#30340;&#32467;&#26500;&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#34429;&#28982;&#23427;&#26377;96&#20301;&#23485;&#24230;&#65292;&#20294;&#25105;&#20204;&#21487;&#35265;&#30340;&#37096;&#20998;&#21482;&#26377;16&#20301;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-9_17-11-19.png" alt="images/download/attachments/1015831/image2022-6-9_17-11-19.png" width="600"  />
    </p>
<p   
>&#22914;&#19979;&#29992;&#32467;&#26500;&#20307;&#26469;&#34920;&#31034;&#65292;&#26377;16&#20301;&#21487;&#35265;&#37096;&#20998;&#65288;Selecter&#65289;&#65292;16&#20301;&#23646;&#24615;&#65292;32&#20301;Base&#21644;32&#20301;Limit&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">struct SegMent {</code></div>
<div class="line"><code class="plain">    WORD Selector;</code></div>
<div class="line"><code class="plain">    WORD Atrributes;</code></div>
<div class="line"><code class="plain">    DWORD Base;</code></div>
<div class="line"><code class="plain">    DWORD Limit;</code></div>
<div class="line"><code class="plain">};</code></div>
</div>
    </div>
<p   
>16&#20301;&#23646;&#24615;&#25351;&#30340;&#30340;&#26159;&#24403;&#21069;&#27573;&#23492;&#23384;&#22120;&#30340;&#21487;&#35835;&#12289;&#21487;&#20889;&#30340;&#23646;&#24615;&#65307;32&#20301;Base&#34920;&#31034;&#24403;&#21069;&#27573;&#26159;&#20174;&#21738;&#37324;&#24320;&#22987;&#30340;&#65307;32&#20301;Limit&#34920;&#31034;&#24403;&#21069;&#27573;&#30340;&#25972;&#20010;&#38271;&#24230;&#12290;</p>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeivu-WGmQ">
        <h3 class="heading "><span>&#35835;&#20889;</span></h3>
<p   
>&#30001;&#20110;&#25105;&#20204;&#21482;&#33021;&#30475;&#35265;&#27573;&#23492;&#23384;&#22120;&#30340;16&#20301;&#65292;&#25152;&#20197;&#25105;&#20204;&#20063;&#21482;&#33021;&#23545;&#27573;&#23492;&#23384;&#22120;&#30340;&#36825;&#21487;&#35265;&#37096;&#20998;&#36827;&#34892;&#35835;&#21462;&#65292;&#20294;&#20889;&#20837;&#30340;&#35805;&#26159;&#25353;&#29031;96&#20301;&#21435;&#20889;&#20837;&#30340;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-9_17-53-36.png" alt="images/download/attachments/1015831/image2022-6-9_17-53-36.png" width="600"  />
    </p>
<p   
>&#22914;&#19978;&#22270;&#25152;&#31034;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;MOV&#25351;&#20196;&#23545;&#27573;&#23492;&#23384;&#22120;&#36827;&#34892;&#35835;&#20889;&#65292;&#20294;&#26159;&#36825;2&#20010;&#27573;&#23492;&#23384;&#22120;&#65306;LDTR&#12289;TR&#65292;<strong class=" ">&#23427;&#20204;&#26159;&#19981;&#21487;&#20197;&#20351;&#29992;MOV&#25351;&#20196;&#36827;&#34892;&#35835;&#20889;&#30340;</strong>&#12290;</p>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeWxnuaAp-aOoua1iw">
        <h3 class="heading "><span>&#23646;&#24615;&#25506;&#27979;</span></h3>
<p   
>&#19978;&#25991;&#20013;&#25105;&#20204;&#30693;&#36947;&#27573;&#23492;&#23384;&#22120;&#30340;&#32467;&#26500;&#20013;&#26159;&#26377;&#20960;&#20010;&#25104;&#21592;&#65288;&#23646;&#24615;&#65289;&#30340;&#65292;&#25105;&#20204;&#21487;&#35265;&#30340;&#37096;&#20998;&#26159;16&#20301;&#30340;Selecter&#65292;&#20854;&#20313;&#30340;&#37117;&#26080;&#27861;&#30475;&#35265;&#65292;&#37027;&#20040;&#36825;&#20123;&#23646;&#24615;&#37117;&#26159;&#30495;&#23454;&#23384;&#22312;&#30340;&#36824;&#26159;&#19968;&#20010;&#34394;&#26080;&#32549;&#32520;&#30340;&#27010;&#24565;&#21602;&#65292;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;&#20195;&#30721;&#26469;&#35777;&#23454;&#36825;&#20123;&#23646;&#24615;&#30340;&#23384;&#22312;&#12290;</p>
<p   
>&#22914;&#19979;&#34920;&#25152;&#31034;&#65292;&#26159;&#25105;&#24403;&#21069;Windows XP&#34394;&#25311;&#26426;&#29615;&#22659;&#20013;&#30340;&#27573;&#23492;&#23384;&#22120;&#30456;&#20851;&#30340;&#23646;&#24615;&#65292;&#26631;&#32418;&#37096;&#20998;&#21363;&#34920;&#31034;&#36825;&#20123;&#23646;&#24615;&#23545;&#24212;&#30340;&#20540;&#26159;&#19981;&#22266;&#23450;&#30340;&#65306;</p>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col />
                                    <col />
                                    <col />
                                    <col />
                                    <col />
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>&#27573;&#23492;&#23384;&#22120;</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Selector</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Attribute</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Base</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Limit</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>ES</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>    <span style="color: #ff0000;">
0023    </span>
</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&#21487;&#35835;&#12289;&#21487;&#20889;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0xFFFFFFFF</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>CS</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>    <span style="color: #ff0000;">
001B    </span>
</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&#21487;&#35835;&#12289;&#21487;&#25191;&#34892;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0xFFFFFFFF</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>SS</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>    <span style="color: #ff0000;">
0023    </span>
</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&#21487;&#35835;&#12289;&#21487;&#20889;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0xFFFFFFFF</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>DS</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>    <span style="color: #ff0000;">
0023    </span>
</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&#21487;&#35835;&#12289;&#21487;&#20889;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0xFFFFFFFF</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>FS</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>    <span style="color: #ff0000;">
003B    </span>
</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&#21487;&#35835;&#12289;&#21487;&#20889;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>    <span style="color: #ff0000;">
0x7FFDF000    </span>
</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0xFFF</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>GS</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>-</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>-</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>-</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>-</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p   
>&#22914;&#19978;&#34920;&#26684;&#36825;&#20123;&#23646;&#24615;&#20540;&#37117;&#21487;&#20197;&#22312;&#35843;&#35797;&#22120;&#30340;&#23492;&#23384;&#22120;&#31383;&#21475;&#20013;&#25214;&#21040;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-10_11-5-4.png" alt="images/download/attachments/1015831/image2022-6-10_11-5-4.png" width="600"  />
    </p>
<p   
>&#27880;&#65306;GS&#27573;&#23492;&#23384;&#22120;&#27809;&#26377;&#23646;&#24615;&#20540;&#26159;&#22240;&#20026;Windows XP&#20013;&#24182;&#27809;&#26377;&#20351;&#29992;&#21040;&#23427;&#12290;</p>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeaOoua1i0F0dHJpYnV0ZQ">
        <h4 class="heading "><span>&#25506;&#27979;Attribute</span></h4>
<p  class="auto-cursor-target" 
>&#39318;&#20808;&#25105;&#20204;&#26469;&#25506;&#27979;Attribute&#23646;&#24615;&#65292;&#22914;&#19978;&#34920;&#20013;&#65292;&#27573;&#23492;&#23384;&#22120;CS&#30340;Attribute&#26159;&#21487;&#35835;&#12289;&#21487;&#25191;&#34892;&#65292;&#20063;&#23601;&#34920;&#31034;&#25105;&#20204;&#27809;&#27861;&#23545;&#35813;&#27573;&#23492;&#23384;&#22120;&#36827;&#34892;&#20889;&#20837;&#65292;&#25152;&#20197;&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;&#22914;&#19979;&#20195;&#30721;&#21435;&#25506;&#27979;&#23427;&#65292;&#35813;&#20195;&#30721;&#30340;&#24847;&#20041;&#23601;&#26159;&#23558;&#27573;&#23492;&#23384;&#22120;CS&#30340;&#20540;&#35835;&#21040;AX&#23492;&#23384;&#22120;&#20013;&#65292;&#20877;&#23558;AX&#23492;&#23384;&#22120;&#30340;&#20540;&#35835;&#21306;&#21040;DS&#27573;&#23492;&#23384;&#22120;&#20013;&#65292;&#26368;&#21518;&#36890;&#36807;DS&#27573;&#23492;&#23384;&#22120;&#21435;&#20889;&#20837;&#20869;&#23481;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">void</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> var = </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    __asm {</code></div>
<div class="line"><code class="plain">        MOV AX,CS</code></div>
<div class="line"><code class="plain">        MOV DS,AX</code></div>
<div class="line"><code class="plain">        MOV DWORD PTR DS:[var], eax</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p  class="auto-cursor-target" 
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-10_10-59-45.png" alt="images/download/attachments/1015831/image2022-6-10_10-59-45.png" width="600"  />
    </p>
<p  class="auto-cursor-target" 
>&#22914;&#26524;&#36825;&#27573;&#20195;&#30721;&#21487;&#20197;&#25191;&#34892;&#21017;&#34920;&#31034;&#25105;&#20204;&#21487;&#20197;&#23545;&#27573;&#23492;&#23384;&#22120;CS&#36827;&#34892;&#20889;&#20837;&#20869;&#23481;&#65292;&#21453;&#20043;&#21017;&#35777;&#26126;&#20854;Attribute&#23646;&#24615;&#30340;&#30495;&#23454;&#24615;&#12290;</p>
<p  class="auto-cursor-target" 
>&#32534;&#35793;&#20195;&#30721;&#24182;&#36816;&#34892;&#21487;&#25191;&#34892;&#25991;&#20214;&#65292;&#26368;&#32456;&#25552;&#31034;&#25105;&#20204;&#20986;&#20102;&#38382;&#39064;&#65292;&#30001;&#27492;&#25105;&#20204;&#20415;&#25506;&#27979;&#20986;&#20102;&#27573;&#23492;&#23384;&#22120;CS&#30340;Attribute&#23646;&#24615;&#65306;</p>
<p  class="auto-cursor-target" 
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-10_11-1-54.png" alt="images/download/attachments/1015831/image2022-6-10_11-1-54.png" width="600"  />
    </p>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeaOoua1i0Jhc2U">
        <h4 class="heading auto-cursor-target"><span>&#25506;&#27979;Base</span></h4>
<p   
>&#25105;&#20204;&#20043;&#21069;&#22312;&#20102;&#35299;&#27573;&#23492;&#23384;&#22120;&#30340;&#26102;&#20505;&#25552;&#21040;&#65292;&#24403;&#20320;&#20197;&#22914;&#19979;&#36825;&#31181;&#27719;&#32534;&#25351;&#20196;&#21435;&#21521;&#22320;&#22336;&#20889;&#20540;&#26102;&#65292;&#23454;&#38469;&#19978;&#20889;&#20837;&#30340;&#22320;&#22336;&#26159;&#27573;&#23492;&#23384;&#22120;&#30340;Base&#23646;&#24615;&#21152;&#19978;0x123456&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">mov dword ptr ds:[</code><code class="value">0x123456</code><code class="plain">], eax</code></div>
</div>
    </div>
<p  class="auto-cursor-target" 
>&#22240;&#27492;&#65292;&#25105;&#20204;&#24819;&#35201;&#21435;&#25506;&#27979;&#27573;&#23492;&#23384;&#22120;&#30340;Base&#23646;&#24615;&#65292;&#21487;&#20197;&#20351;&#29992;&#21521;0x0&#22320;&#22336;&#20889;&#20540;&#65292;&#22240;&#20026;&#25105;&#20204;&#37117;&#30693;&#36947;&#27491;&#24120;&#24773;&#20917;&#19979;0x0&#22320;&#22336;&#26159;&#19981;&#21487;&#35835;&#19981;&#21487;&#20889;&#30340;&#65292;&#20294;&#26159;FS&#27573;&#23492;&#23384;&#22120;&#30340;Base&#23646;&#24615;&#20540;&#20026;    <span style="color: #003366;">
0x7FFDF000&#65292;&#25152;&#20197;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;&#22914;&#19979;&#20195;&#30721;&#21435;&#25506;&#27979;    </span>
&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">void</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> var = </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    __asm {</code></div>
<div class="line"><code class="plain">        MOV AX,FS</code></div>
<div class="line"><code class="plain">        MOV GS,AX</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// MOV DWORD PTR DS:[0], EAX</code></div>
<div class="line"><code class="plain">        MOV DWORD PTR GS:[</code><code class="value">0</code><code class="plain">], EAX</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p  class="auto-cursor-target" 
>&#22914;&#19978;&#20195;&#30721;&#32534;&#35793;&#24182;&#36816;&#34892;&#19981;&#20250;&#26377;&#20219;&#20309;&#25253;&#38169;&#65292;&#22240;&#20026;&#25105;&#20204;&#23558;EAX&#23492;&#23384;&#22120;&#20540;&#20889;&#20837;&#21040;&#30340;&#23454;&#38469;&#22320;&#22336;&#26159;    <span style="color: #003366;">
<strong class=" ">0x7FFDF000+0x0</strong>&#65292;&#22914;&#33509;&#20320;&#23558;MOV&#25351;&#20196;&#21518;&#30340;GS&#25442;&#25104;DS&#21017;&#32534;&#35793;&#36816;&#34892;&#23601;&#20250;&#25253;&#38169;&#65306;    </span>
</p>
<p  class="auto-cursor-target" 
>    <span style="color: #003366;">
<img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-10_11-17-31.png" alt="images/download/attachments/1015831/image2022-6-10_11-17-31.png" width="600"  />
<br/>    </span>
</p>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeaOoua1i0xpbWl0">
        <h4 class="heading auto-cursor-target"><span>&#25506;&#27979;Limit</span></h4>
<p  class="auto-cursor-target" 
>&#25105;&#20204;&#30693;&#36947;Limit&#34920;&#31034;&#24403;&#21069;&#27573;&#30340;&#25972;&#20010;&#38271;&#24230;&#65292;FS&#27573;&#23492;&#23384;&#22120;&#30340;Limit&#23646;&#24615;&#20540;&#20026;0xFFF&#65292;&#22240;&#27492;&#25105;&#20204;&#21487;&#20197;&#35774;&#23450;&#19968;&#20010;&#36229;&#20986;&#38271;&#24230;&#30340;&#20540;&#21435;&#20889;&#20837;&#26469;&#25506;&#27979;Limit&#23646;&#24615;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">void</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> var = </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    __asm {</code></div>
<div class="line"><code class="plain">        MOV AX,FS</code></div>
<div class="line"><code class="plain">        MOV GS,AX</code></div>
<div class="line"><code class="plain">        MOV DWORD PTR GS:[</code><code class="value">0x1000</code><code class="plain">], EAX</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p  class="auto-cursor-target" 
>&#22914;&#19978;&#20195;&#30721;&#20013;&#65292;&#25105;&#20204;&#21521;    <span style="color: #003366;">
<strong class=" ">0x7FFDF000+0x1000</strong>&#20889;&#20837;&#20869;&#23481;&#65292;&#30001;&#20110;FS&#27573;&#30340;&#38271;&#24230;&#21482;&#26377;0xFFF&#65292;0x1000&#24456;&#26126;&#26174;&#22823;&#20110;0xFFF&#65292;&#25152;&#20197;&#36825;&#27573;&#20195;&#30721;&#32534;&#35793;&#36816;&#34892;&#23601;&#20250;&#25253;&#38169;&#65306;    </span>
</p>
<p  class="auto-cursor-target" 
>    <span style="color: #003366;">
<img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-10_11-22-36.png" alt="images/download/attachments/1015831/image2022-6-10_11-22-36.png" width="600"  />
<br/>    </span>
</p>
    </div>
    </div>
    </div>
    <div class="section section-2" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeaPj-i_sOespuS4jumAieaLqeWtkA">
        <h2 class="heading auto-cursor-target"><span>&#25551;&#36848;&#31526;&#19982;&#36873;&#25321;&#23376;</span></h2>
<p   
>&#22312;&#20043;&#21069;&#30340;&#31456;&#33410;&#20013;&#25105;&#20204;&#20351;&#29992;&#20102;&#22914;&#19979;&#36825;&#31181;&#25351;&#20196;&#21521;&#27573;&#23492;&#23384;&#22120;&#20013;&#20889;&#20837;&#20540;&#65292;&#24182;&#19988;&#22312;&#26368;&#21021;&#20171;&#32461;&#27573;&#23492;&#23384;&#22120;&#30340;&#26102;&#20505;&#23601;&#25552;&#21040;&#65292;&#34429;&#28982;&#36825;&#37324;&#25105;&#20204;&#26159;&#23558;16&#20301;&#23492;&#23384;&#22120;&#30340;&#20540;&#20889;&#20837;&#36827;&#21435;&#65292;&#20294;&#23454;&#38469;&#19978;&#20889;&#20837;&#30340;&#20173;&#28982;&#26159;96&#20301;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">MOV GS,AX</code></div>
</div>
    </div>
<p   
>&#37027;&#20040;&#21478;&#22806;80&#20301;&#30340;&#20540;&#26159;&#20174;&#20309;&#32780;&#26469;&#30340;&#21602;&#65311;&#25105;&#20204;&#23601;&#38656;&#35201;&#20102;&#35299;&#36825;&#20004;&#20010;&#27010;&#24565;&#65306;GDT&#65288;Global Descriptor Table&#65292;&#20840;&#23616;&#25551;&#36848;&#31526;&#34920;&#65289;&#12289;LDT&#65288;Local Descriptor Table&#65292;&#23616;&#37096;&#25551;&#36848;&#31526;&#34920;&#65289;&#12290;</p>
<p   
>&#24403;&#25105;&#20204;&#25191;&#34892;&#22914;&#19978;&#31867;&#20284;&#25351;&#20196;&#26102;&#65292;CPU&#20250;&#26681;&#25454;AX&#30340;&#20540;&#36873;&#25321;GDT&#12289;LDT&#36825;&#20004;&#24352;&#34920;&#20013;&#30340;&#19968;&#24352;&#34920;&#36827;&#34892;&#26597;&#35810;&#65292;&#22312;&#34920;&#20013;&#26597;&#35810;&#20986;&#23545;&#24212;&#30340;&#20449;&#24687;&#32473;&#21040;&#27573;&#23492;&#23384;&#22120;&#12290;</p>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeWPjOacuuiwg-ivleeOr-Wigw">
        <h3 class="heading "><span>&#21452;&#26426;&#35843;&#35797;&#29615;&#22659;</span></h3>
<p   
>&#36825;&#37324;&#25105;&#20204;&#24819;&#35201;&#21435;&#22312;&#26597;&#30475;GDT&#34920;&#23601;&#38656;&#35201;&#20351;&#29992;Windbg&#35843;&#35797;&#20869;&#26680;&#65292;&#20026;&#20102;&#20415;&#20110;&#26410;&#26469;&#30340;&#23398;&#20064;&#35843;&#35797;&#65292;&#25105;&#20204;&#38656;&#35201;&#26469;&#37197;&#32622;&#19968;&#19979;&#35843;&#35797;&#29615;&#22659;&#12290;&#35843;&#35797;&#27169;&#24335;&#20026;&#21452;&#26426;&#35843;&#35797;&#65288;<strong class=" ">&#22240;&#20026;&#20320;&#35843;&#35797;&#30340;&#26159;&#20869;&#26680;&#65292;&#26412;&#26426;&#35843;&#35797;&#30340;&#35805;&#65292;&#20320;&#22312;&#20869;&#26680;&#26029;&#28857;&#23454;&#38469;&#19978;&#25972;&#20010;&#31995;&#32479;&#20063;&#23601;&#20572;&#27490;&#20102;&#65292;&#20320;&#20063;&#23601;&#26080;&#27861;&#32487;&#32493;&#35843;&#35797;&#65292;&#25152;&#20197;&#25105;&#20204;&#38656;&#35201;&#20351;&#29992;&#21452;&#26426;&#35843;&#35797;&#27169;&#24335;&#36827;&#34892;&#35843;&#35797;&#12290;</strong>&#65289;&#65292;&#20320;&#38656;&#35201;&#22312;&#20320;&#30340;&#29289;&#29702;&#26426;&#22120;&#19978;&#23433;&#35013;VMware&#34394;&#25311;&#26426;&#65292;&#25509;&#30528;&#22312;VMware&#20013;&#23433;&#35013;Windows XP&#31995;&#32479;&#30340;&#34394;&#25311;&#26426;&#65307;&#25509;&#30528;&#65292;&#22312;&#29289;&#29702;&#26426;&#22120;&#19978;&#23433;&#35013;Windbg&#65292;&#20320;&#21487;&#20197;&#36890;&#36807;&#24494;&#36719;&#23448;&#26041;&#22320;&#22336;&#36827;&#34892;&#19979;&#36733;&#23433;&#35013;&#65306;<a  class="external-link" href="https://docs.microsoft.com/zh-cn/windows-hardware/drivers/debugger/debugger-download-tools">https://docs.microsoft.com/zh-cn/windows-hardware/drivers/debugger/debugger-download-tools</a>&#12290;&#29615;&#22659;&#23433;&#35013;&#27969;&#31243;&#22823;&#33268;&#23601;&#26159;&#22914;&#27492;&#65292;&#36825;&#37324;&#19981;&#20877;&#36827;&#34892;&#22270;&#25991;&#36184;&#36848;&#12290;</p>
<p   
>&#24403;&#20320;&#20934;&#22791;&#22909;&#29615;&#22659;&#20043;&#21518;&#65292;&#35774;&#32622;Window XP&#34394;&#25311;&#26426;&#65292;&#28155;&#21152;&#20018;&#34892;&#31471;&#21475;&#24182;&#25353;&#22914;&#19979;&#22270;&#36827;&#34892;&#37197;&#32622;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-14_15-49-27.png" alt="images/download/attachments/1015831/image2022-6-14_15-49-27.png" width="600"  />
    </p>
<p   
>&#28982;&#21518;&#22312;Windows XP&#34394;&#25311;&#26426;&#20013;&#20462;&#25913;C&#30424;&#19979;&#30340;boot.ini&#25991;&#20214;&#65288;&#21462;&#28040;&#25991;&#20214;&#38544;&#34255;&#21363;&#21487;&#30475;&#35265;&#65289;&#65292;&#28155;&#21152;&#22914;&#19979;&#20869;&#23481;&#21363;&#21487;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">multi(</code><code class="value">0</code><code class="plain">)disk(</code><code class="value">0</code><code class="plain">)rdisk(</code><code class="value">0</code><code class="plain">)partition(</code><code class="value">1</code><code class="plain">)\WINDOWS=</code><code class="string">"XP DEBUG"</code><code class="plain"> /execute=optin /fastdetect /debug /debugport=com1 /baudrate=</code><code class="value">115200</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-14_16-4-6.png" alt="images/download/attachments/1015831/image2022-6-14_16-4-6.png" width="600"  />
    </p>
<p   
>&#25509;&#30528;&#25214;&#21040;&#20320;&#29289;&#29702;&#26426;&#19978;&#30340;Windbg&#65288;x86&#65289;&#25991;&#20214;&#65292;&#24182;&#21457;&#36865;&#24555;&#25463;&#26041;&#24335;&#21040;&#26700;&#38754;&#65292;&#20462;&#25913;&#24555;&#25463;&#26041;&#24335;&#30340;&#30446;&#26631;&#20540;&#20026;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="string">"你的目录\windbg.exe"</code><code class="plain"> -b -k com:pipe,port=\\.\pipe\com_1,baud=</code><code class="value">115200</code><code class="plain">,pipe</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-14_16-6-40.png" alt="images/download/attachments/1015831/image2022-6-14_16-6-40.png" width="600"  />
    </p>
<p   
>&#36825;&#26102;&#20505;&#25105;&#20204;&#30340;&#29615;&#22659;&#20934;&#22791;&#24037;&#20316;&#24050;&#32463;&#23436;&#25104;&#20102;&#65292;&#37325;&#21551;&#34394;&#25311;&#26426;&#33267;&#22914;&#19979;&#30028;&#38754;&#65292;&#36873;&#25321;<strong class=" ">XP DEBUG&#21551;&#29992;&#35843;&#35797;&#31243;&#24207;</strong>&#36827;&#20837;&#31995;&#32479;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-14_16-8-11.png" alt="images/download/attachments/1015831/image2022-6-14_16-8-11.png" width="600"  />
    </p>
<p   
>&#28982;&#21518;&#24555;&#36895;&#30340;&#21452;&#20987;&#20320;&#20462;&#25913;&#21518;&#30340;Windbg&#24555;&#25463;&#26041;&#24335;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#25105;&#20204;&#23601;&#21487;&#20197;&#21435;&#35266;&#23519;Windows XP&#30340;&#20869;&#26680;&#20102;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-14_16-18-23.png" alt="images/download/attachments/1015831/image2022-6-14_16-18-23.png" width="600"  />
    </p>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLUdEVOihqOS_oeaBrw">
        <h3 class="heading "><span>GDT&#34920;&#20449;&#24687;</span></h3>
<p   
>&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;Windbg&#21435;&#26597;&#30475;GDT&#34920;&#30340;&#19968;&#20123;&#20449;&#24687;&#65292;&#22312;Windbg&#20013;&#20351;&#29992;&#22914;&#19979;&#25351;&#20196;&#21435;&#26597;&#30475;GDT&#34920;&#30456;&#20851;&#30340;&#23646;&#24615;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">r gdtr - 查看GDT表的位置</code></div>
<div class="line"><code class="plain">r gdtl - 查看GDT表的大小</code></div>
<div class="line"><code class="comments">// gdtr、gdtl也都称之为寄存器</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-14_16-30-10.png" alt="images/download/attachments/1015831/image2022-6-14_16-30-10.png" width="600"  />
    </p>
<p   
>&#25105;&#20204;&#30693;&#36947;GDT&#34920;&#30340;&#20301;&#32622;&#20043;&#21518;&#23601;&#21487;&#20197;&#20351;&#29992;&#22914;&#19979;&#25351;&#20196;&#21435;&#25214;&#21040;&#36825;&#24352;&#34920;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">dd gdtr寄存器的值</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-14_16-31-15.png" alt="images/download/attachments/1015831/image2022-6-14_16-31-15.png" width="400"  />
    </p>
<p   
>&#22914;&#19978;&#22270;&#20013;&#65292;&#26368;&#24038;&#36793;&#30340;800&#24320;&#22836;&#30340;&#23601;&#26159;&#22320;&#22336;&#65292;&#21491;&#36793;&#30340;&#23601;&#26159;&#34920;&#20013;&#30340;&#25968;&#25454;&#12290;</p>
<p   
>&#36825;&#37324;&#25105;&#20204;&#20351;&#29992;dd&#25351;&#20196;&#21435;&#26597;&#30475;&#25968;&#25454;&#23454;&#38469;&#19978;&#19981;&#26159;&#24456;&#26041;&#20415;&#65292;&#22240;&#20026;&#23427;&#34920;&#31034;&#20197;4&#23383;&#33410;&#19968;&#32452;&#30340;&#26041;&#24335;&#23637;&#31034;&#25968;&#25454;&#65292;&#25105;&#20204;&#20026;&#20102;&#30475;&#36215;&#26469;&#26356;&#21152;&#26041;&#20415;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;dq&#25351;&#20196;&#21435;&#26597;&#30475;&#25968;&#25454;&#65292;&#23427;&#26159;&#20197;8&#23383;&#33410;&#19968;&#32452;&#30340;&#26041;&#24335;&#23637;&#31034;&#25968;&#25454;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-14_16-37-7.png" alt="images/download/attachments/1015831/image2022-6-14_16-37-7.png" width="400"  />
    </p>
<p   
>&#25105;&#20204;&#36890;&#36807;gdtl&#23492;&#23384;&#22120;&#30693;&#36947;&#24403;&#21069;GDT&#34920;&#30340;&#22823;&#23567;&#65292;&#20294;&#26159;&#20351;&#29992;dq/dd&#25351;&#20196;&#21435;&#26597;&#30475;&#34920;&#30340;&#26102;&#20505;&#24456;&#26126;&#26174;&#65292;&#23427;&#23637;&#31034;&#20986;&#26469;&#30340;&#25968;&#25454;&#24182;&#27809;&#26377;&#37027;&#20040;&#22810;&#65292;&#25152;&#20197;&#25105;&#20204;&#21487;&#20197;&#22312;&#20043;&#21518;&#21152;&#19978;&#21442;&#25968;&#26469;&#33258;&#23450;&#20041;&#25105;&#20204;&#36820;&#22238;&#25968;&#25454;&#22823;&#23567;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">dq gdtr寄存器的值 L40</code></div>
<div class="line"><code class="comments">// L不区分大小写，40在这里表示十六进制0x40，当前指令的意思是展示0x40组（dq-&gt;8字节）GDT表的数据</code></div>
</div>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLQ">
        <h4 class="heading "><span></span></h4>
    </div>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeauteaPj-i_sOespg">
        <h3 class="heading "><span>&#27573;&#25551;&#36848;&#31526;</span></h3>
<p   
>&#22312;GDT&#34920;&#20013;&#23384;&#20648;&#30340;&#20803;&#32032;&#23601;&#26159;&#27573;&#25551;&#36848;&#31526;&#65292;&#27599;&#19968;&#20010;&#27573;&#25551;&#36848;&#31526;&#30340;&#23485;&#24230;&#26159;8&#23383;&#33410;&#12290;&#27573;&#25551;&#36848;&#31526;&#30340;&#32467;&#26500;&#22914;&#19979;&#22270;&#25152;&#31034;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-15_15-14-33.png" alt="images/download/attachments/1015831/image2022-6-15_15-14-33.png" width="600"  />
    </p>
<p   
>&#36825;&#26159;&#19968;&#20010;&#20174;&#39640;&#21040;&#20302;&#30340;&#39034;&#24207;&#65292;&#21516;&#26102;&#22312;Windbg&#20013;&#23545;&#24212;&#30340;&#20063;&#21487;&#20197;&#25353;&#22270;&#23558;&#25968;&#25454;&#24179;&#38138;&#36807;&#26469;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-14_17-35-49.png" alt="images/download/attachments/1015831/image2022-6-14_17-35-49.png" width="400"  />
    </p>
<p   
>dq/dd&#25351;&#20196;&#20250;&#24110;&#25105;&#20204;&#33258;&#21160;&#25490;&#22909;&#65292;&#20415;&#20110;&#23545;&#29031;&#30528;&#32467;&#26500;&#30452;&#25509;&#30475;&#65292;&#22914;&#26524;&#20320;&#24819;&#35266;&#23519;&#30340;&#20180;&#32454;&#19968;&#20123;&#21487;&#20197;&#20351;&#29992;db&#25351;&#20196;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-14_17-38-37.png" alt="images/download/attachments/1015831/image2022-6-14_17-38-37.png" width="400"  />
    </p>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#36825;&#20010;&#23545;&#24212;&#20851;&#31995;&#23601;&#24456;&#23481;&#26131;&#29702;&#35299;&#20102;&#65292;&#20854;&#20182;&#30340;&#20197;&#27492;&#31867;&#25512;&#21363;&#21487;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-14_17-41-47.png" alt="images/download/attachments/1015831/image2022-6-14_17-41-47.png" width="400"  />
    </p>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeautemAieaLqeWtkA">
        <h3 class="heading "><span>&#27573;&#36873;&#25321;&#23376;</span></h3>
<p   
>&#27573;&#36873;&#25321;&#23376;&#26159;&#19968;&#20010;16&#20301;&#30340;&#27573;&#25551;&#36848;&#31526;&#65292;&#35813;&#25551;&#36848;&#31526;&#25351;&#21521;&#20102;&#23450;&#20041;&#35813;&#27573;&#30340;&#27573;&#25551;&#36848;&#31526;&#12290;&#20043;&#21069;&#25105;&#20204;&#25152;&#20030;&#20363;&#30340;AX&#23492;&#23384;&#22120;&#23601;&#21487;&#20197;&#31216;&#20043;&#20026;&#27573;&#36873;&#25321;&#23376;&#12290;</p>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#23601;&#26159;&#27573;&#36873;&#25321;&#23376;&#30340;&#32467;&#26500;&#21450;&#23545;&#24212;&#20301;&#30340;&#23646;&#24615;&#35828;&#26126;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-14_17-48-17.png" alt="images/download/attachments/1015831/image2022-6-14_17-48-17.png" width="600"  />
    </p>
<p   
>&#25152;&#20197;&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;&#27573;&#36873;&#25321;&#23376;&#30340;TI&#20301;&#30693;&#36947;&#26597;&#35810;GDT&#36824;&#26159;LDT&#34920;&#65288;<strong class=" ">&#27880;&#24847;&#65292;&#22312;Windows XP&#20013;&#27809;&#26377;&#20351;&#29992;LDT&#34920;&#65292;&#25152;&#20197;&#40664;&#35748;&#24773;&#20917;&#19979;TI&#20301;&#37117;&#26159;0&#12290;</strong>&#65289;&#65292;Index&#20301;&#21487;&#20197;&#30693;&#36947;&#20855;&#20307;&#35201;&#26597;&#30340;&#34920;&#30340;&#21738;&#19968;&#20010;&#27573;&#25551;&#36848;&#31526;&#12290;</p>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeWKoOi9veauteaPj-i_sOespuiHs-auteWvhOWtmOWZqA">
        <h3 class="heading "><span>&#21152;&#36733;&#27573;&#25551;&#36848;&#31526;&#33267;&#27573;&#23492;&#23384;&#22120;</span></h3>
<p   
>&#20043;&#21069;&#25105;&#20204;&#25152;&#20030;&#20363;&#30340;MOV&#25351;&#20196;&#26412;&#36136;&#19978;&#23601;&#26159;&#21152;&#36733;&#27573;&#25551;&#36848;&#31526;&#33267;&#27573;&#23492;&#23384;&#22120;&#65292;&#38500;&#20102;&#35813;&#25351;&#20196;&#22806;&#65292;&#25105;&#20204;&#36824;&#21487;&#20197;&#20351;&#29992;LES&#12289;LSS&#12289;LDS&#12289;LFS&#12289;LGS&#25351;&#20196;&#23436;&#25104;&#36825;&#19968;&#21160;&#20316;&#12290;</p>
<p   
>&#38656;&#35201;&#27880;&#24847;&#30340;&#26159;&#65292;CS&#27573;&#23492;&#23384;&#22120;&#19981;&#33021;&#36890;&#36807;&#19978;&#36848;&#25351;&#20196;&#36827;&#34892;&#20462;&#25913;&#65292;&#36825;&#26159;&#22240;&#20026;CS&#20026;&#20195;&#30721;&#27573;&#65292;CS&#30340;&#25913;&#21464;&#20250;&#23548;&#33268;EIP&#30340;&#25913;&#21464;&#65307;&#22914;&#26524;&#20320;&#24819;&#35201;&#20462;&#25913;CS&#65292;&#23601;&#38656;&#35201;&#20445;&#35777;CS&#21644;EIP&#19968;&#36215;&#20462;&#25913;&#65292;&#36825;&#20010;&#22312;&#20043;&#21518;&#30340;&#31456;&#33410;&#20013;&#20250;&#23398;&#21040;&#12290;</p>
<p   
>&#22914;&#19979;&#20195;&#30721;&#25152;&#31034;&#65292;&#25105;&#20204;&#20351;&#29992;LES&#25351;&#20196;&#65292;&#23427;&#30340;&#24847;&#24605;&#26159;&#23558;buffer&#30340;&#39640;2&#20010;&#23383;&#33410;&#65288;&#27573;&#36873;&#25321;&#23376;&#65289;&#32473;&#21040;ES&#27573;&#23492;&#23384;&#22120;&#65292;&#20302;4&#20010;&#23383;&#33410;&#32473;&#21040;ECX&#23492;&#23384;&#22120;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">void</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> buffer[</code><code class="value">6</code><code class="plain">];</code></div>
<div class="line"><code class="plain">    __asm {</code></div>
<div class="line"><code class="plain">        LES ECX,FWORD PTR DS:[buffer]</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>&#38656;&#35201;&#27880;&#24847;&#30340;&#26159;&#27573;&#36873;&#25321;&#23376;&#30340;RPL&#25968;&#20540;&#35201;&#23567;&#20110;&#27573;&#25551;&#36848;&#31526;&#20013;&#30340;DPL&#12290;</p>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeauteaPj-i_sOespueahOWxnuaApw">
        <h3 class="heading "><span>&#27573;&#25551;&#36848;&#31526;&#30340;&#23646;&#24615;</span></h3>
<p   
>&#24403;&#25105;&#20204;&#25191;&#34892;MOV&#31867;&#20284;&#25351;&#20196;&#26102;&#65292;CPU&#20250;&#26681;&#25454;&#27573;&#36873;&#25321;&#23376;&#30340;&#20540;&#36873;&#25321;GDT&#12289;LDT&#36825;&#20004;&#24352;&#34920;&#20013;&#30340;&#19968;&#24352;&#34920;&#36827;&#34892;&#26597;&#35810;&#65292;&#22312;&#34920;&#20013;&#26597;&#35810;&#20986;&#27573;&#25551;&#36848;&#31526;&#32473;&#21040;&#27573;&#23492;&#23384;&#22120;&#65292;<strong class=" ">&#20294;&#26159;&#25105;&#20204;&#30693;&#36947;&#27573;&#25551;&#36848;&#31526;&#21482;&#26377;64&#20301;&#65292;&#32780;&#38500;&#20102;&#27573;&#36873;&#25321;&#23376;&#26412;&#36523;&#30340;&#20540;&#22806;&#65292;&#27573;&#23492;&#23384;&#22120;&#36824;&#38656;&#35201;80&#20301;&#65292;&#25152;&#20197;&#36825;&#37324;64&#20301;&#26159;&#22914;&#20309;&#21464;&#25104;80&#20301;&#30340;&#21602;&#65311;</strong>&#36825;&#23601;&#38656;&#35201;&#25105;&#20204;&#21435;&#20102;&#35299;&#27573;&#25551;&#36848;&#31526;&#30340;&#30456;&#20851;&#23646;&#24615;&#12290;</p>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVDkvY0">
        <h4 class="heading "><span>P&#20301;</span></h4>
<p   
>P&#20301;&#26159;&#27573;&#25551;&#36848;&#31526;&#39640;&#20301;4&#23383;&#33410;&#30340;&#31532;15&#20301;&#65292;&#23427;&#30340;&#20540;&#20915;&#23450;&#20102;&#27573;&#25551;&#36848;&#31526;&#26159;&#21542;&#26159;&#26377;&#25928;&#30340;&#12290;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">P = </code><code class="value">1</code><code class="plain"> -&gt; 段描述符有效</code></div>
<div class="line"><code class="plain">P = </code><code class="value">0</code><code class="plain"> -&gt; 段描述符无效</code></div>
</div>
    </div>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLUfkvY0">
        <h4 class="heading "><span>G&#20301;</span></h4>
<p   
>&#22312;&#20102;&#35299;G&#20301;&#23646;&#24615;&#20043;&#21069;&#65292;&#25105;&#20204;&#20808;&#26469;&#30475;&#19968;&#19979;&#27573;&#25551;&#36848;&#31526;&#19982;&#27573;&#23492;&#23384;&#22120;&#32467;&#26500;&#30340;&#23545;&#24212;&#20851;&#31995;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#25105;&#20351;&#29992;&#39068;&#33394;&#26041;&#26694;&#26631;&#35760;&#20986;&#20102;&#23427;&#20204;&#20043;&#38388;&#30340;&#23545;&#24212;&#20851;&#31995;&#65288;<strong class=" ">&#22823;&#23478;&#21487;&#20197;&#20250;&#35273;&#24471;&#27573;&#25551;&#36848;&#31526;&#20013;&#30340;&#23646;&#24615;&#20998;&#24067;&#24456;&#38646;&#30862;&#65292;&#36825;&#26159;&#22240;&#20026;&#27573;&#25551;&#36848;&#31526;&#20063;&#26159;&#19968;&#27493;&#19968;&#27493;&#21457;&#23637;&#30340;&#65292;Intel&#38656;&#35201;&#32771;&#34385;&#32769;&#29256;&#26412;&#30340;&#31995;&#32479;&#23601;&#38656;&#35201;&#21521;&#19979;&#20860;&#23481;&#65292;&#25152;&#20197;&#27573;&#25551;&#36848;&#31526;&#30340;&#32467;&#26500;&#23601;&#19981;&#33021;&#26377;&#21464;&#21270;&#65292;&#21482;&#33021;&#22312;&#20197;&#21069;&#30340;&#32467;&#26500;&#19978;&#36827;&#34892;&#25299;&#23637;</strong>&#65289;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-15_16-12-47.png" alt="images/download/attachments/1015831/image2022-6-15_16-12-47.png" width="600"  />
    </p>
<p   
>&#20180;&#32454;&#30475;&#36825;&#24352;&#22270;&#65292;&#20320;&#23601;&#20250;&#21457;&#29616;&#22312;&#27573;&#23492;&#23384;&#22120;&#32467;&#26500;&#20013;&#30340;&#25104;&#21592;Limit&#23545;&#24212;&#21040;&#27573;&#25551;&#36848;&#31526;&#20013;&#21482;&#26377;20&#20301;&#65292;&#20854;&#20313;&#30340;12&#20301;&#27809;&#26377;&#20102;&#65292;&#20063;&#23601;&#34920;&#31034;&#36825;&#37324;&#30340;Limit&#26368;&#22823;&#20540;&#23601;&#26159;0xFFFFF&#65292;&#32780;&#21478;&#22806;12&#20301;&#21462;&#20915;&#20110;&#25551;&#36848;&#31526;&#30340;&#23646;&#24615;G&#20301;&#12290;</p>
<p   
>&#24403;G&#20301;&#30340;&#20540;&#20026;0&#26102;&#65292;Limit&#26368;&#22823;&#20540;&#23601;&#26159;0xFFFFF&#65292;&#25353;32&#20301;&#20070;&#20889;&#23601;&#26159;0x000FFFFF&#65307;&#24403;G&#20301;&#30340;&#20540;&#20026;1&#26102;&#65292;Limit&#30340;&#21333;&#20301;&#23601;&#26159;4KB&#65292;&#23427;&#30340;&#21462;&#20540;&#20844;&#24335;&#23601;&#26159;&#65306;<u class=" "><strong class=" ">&#65288;&#26681;&#25454;&#27573;&#25551;&#36848;&#31526;&#20013;&#25340;&#25509;&#20986;&#26469;&#30340;Limit&#20540;&#65288;20&#20301;&#65289;+ 1&#65289;* 4KB - 1</strong></u>&#65292;&#26681;&#25454;&#21462;&#20540;&#20844;&#24335;&#27492;&#26102;Limit&#30340;&#26368;&#22823;&#20540;&#20026;0xFFFFFFFF&#12290;</p>
<p   
>&#33267;&#27492;&#65292;&#25105;&#20204;&#23601;&#30693;&#36947;&#20102;CPU&#26159;&#22914;&#20309;&#23558;&#27573;&#25551;&#36848;&#31526;&#30340;&#23545;&#24212;&#23646;&#24615;&#21462;&#20986;&#26469;&#25918;&#20837;&#27573;&#23492;&#23384;&#22120;&#30340;&#32467;&#26500;&#20013;&#65292;&#20063;&#35299;&#37322;&#20102;64&#20301;&#21464;&#25104;80&#20301;&#30340;&#36923;&#36753;&#12290;</p>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVPkvY0">
        <h4 class="heading "><span>S&#20301;</span></h4>
<p   
>S&#20301;&#26159;&#27573;&#25551;&#36848;&#31526;&#39640;&#20301;4&#23383;&#33410;&#30340;&#31532;12&#20301;&#65292;&#23427;&#30340;&#20540;&#34920;&#31034;&#24403;&#21069;&#25551;&#36848;&#31526;&#26159;&#23646;&#20110;&#20160;&#20040;&#27573;&#30340;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">S = </code><code class="value">1</code><code class="plain"> -&gt; 表示代码段或数据段描述符</code></div>
<div class="line"><code class="plain">S = </code><code class="value">0</code><code class="plain"> -&gt; 表示系统段描述符</code></div>
</div>
    </div>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVR5cGXln58">
        <h4 class="heading "><span>Type&#22495;</span></h4>
<p   
>S&#20301;&#30340;&#20540;&#21516;&#26679;&#20063;&#20915;&#23450;&#20102;Type&#22495;&#30340;&#20540;&#65292; &#24403;S&#20301;&#30340;&#20540;&#20026;1&#26102;&#34920;&#31034;&#24403;&#21069;&#20026;&#20195;&#30721;&#25110;&#25968;&#25454;&#27573;&#25551;&#36848;&#31526;&#65292;&#37027;&#20040;Type&#22495;&#30340;&#20540;&#23601;&#26159;&#22914;&#19979;&#36825;&#24352;&#34920;&#26684;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-15_18-40-27.png" alt="images/download/attachments/1015831/image2022-6-15_18-40-27.png" width="600"  />
    </p>
<p   
>&#22914;&#34920;&#26684;&#25152;&#31034;&#65292;Type&#22495;&#26159;&#27573;&#25551;&#36848;&#31526;&#39640;&#20301;4&#23383;&#33410;&#30340;&#31532;8&#20301;&#33267;&#31532;11&#20301;&#65292;&#31532;11&#20301;&#20026;0&#21017;&#26159;&#25968;&#25454;&#27573;&#65292;&#20026;1&#21017;&#26159;&#20195;&#30721;&#27573;&#12290;&#22312;&#35814;&#32454;&#20102;&#35299;&#36825;&#24352;&#34920;&#26684;&#20043;&#21069;&#65292;&#25105;&#20204;&#20808;&#26469;&#26681;&#25454;&#23454;&#38469;&#30340;GDT&#34920;&#26469;&#25214;&#19968;&#19979;&#25968;&#25454;&#27573;/&#20195;&#30721;&#27573;&#30340;&#25551;&#36848;&#31526;&#12290;</p>
<p   
>&#39318;&#20808;&#25105;&#20204;&#38656;&#35201;&#26681;&#25454;P&#20301;&#30340;&#20540;&#20026;1&#26469;&#30830;&#23450;&#25551;&#36848;&#31526;&#26159;&#26377;&#25928;&#30340;&#65292;&#25509;&#30528;DPL&#22312;Windows&#37324;&#21482;&#33021;&#20986;&#29616;&#20004;&#31181;&#24773;&#20917;&#65306;00/11&#65288;<strong class=" ">&#21518;&#26399;&#31456;&#33410;&#20013;&#20250;&#35762;&#35299;&#35813;&#23646;&#24615;</strong>&#65289;&#65292;&#28982;&#21518;S&#20301;&#24517;&#39035;&#26159;1&#25165;&#33021;&#26159;&#25968;&#25454;&#27573;/&#20195;&#30721;&#27573;&#30340;&#25551;&#36848;&#31526;&#65292;&#25152;&#20197;&#25105;&#20204;&#23601;&#21487;&#20197;&#24471;&#20986;P&#12289;DPL&#12289;S&#25340;&#25509;&#30340;&#20540;&#20026;&#65306;1001/1111&#65292;&#36716;&#20026;&#21313;&#20845;&#36827;&#21046;&#23601;&#26159;&#65306;0x9/0xF&#12290;</p>
<p   
>&#26368;&#21518;&#25105;&#20204;&#26469;&#30475;&#19979;Type&#22495;&#21517;&#30340;&#20540;&#65292;&#25353;&#34920;&#26684;&#25152;&#31034;&#65292;&#23427;&#30340;&#20540;&#20063;&#23601;&#26159;0x0 - 0xF&#65292;&#24182;&#19988;0x8&#26159;&#19968;&#20010;&#30028;&#38480;&#28857;&#65292;&#24403;&#20540;&#23567;&#20110;0x8&#21017;&#34920;&#31034;&#24403;&#21069;&#27573;&#26159;&#25968;&#25454;&#27573;&#65292;&#21453;&#20043;&#21017;&#26159;&#20195;&#30721;&#27573;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-15_18-55-9.png" alt="images/download/attachments/1015831/image2022-6-15_18-55-9.png" width="600"  />
    </p>
<p   
>&#32508;&#19978;&#25152;&#31034;&#65292;&#25105;&#20204;&#21435;&#30475;GDT&#34920;&#20013;&#30340;&#20869;&#23481;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#32418;&#33394;&#26041;&#26694;&#26631;&#35760;&#30340;&#23601;&#26159;&#20195;&#30721;&#27573;&#65292;&#32511;&#33394;&#30340;&#25968;&#25454;&#27573;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-15_19-2-59.png" alt="images/download/attachments/1015831/image2022-6-15_19-2-59.png" width="400"  />
    </p>
<p   
>&#25105;&#20204;&#22238;&#36807;&#22836;&#26469;&#20877;&#30475;Type&#22495;&#30340;&#34920;&#26684;&#65292;&#38500;&#20102;&#31532;11&#20301;&#22806;&#65292;&#31532;8&#12289;9&#12289;10&#20301;&#22312;&#20195;&#30721;&#21644;&#25968;&#25454;&#27573;&#20013;&#37117;&#26377;&#19981;&#21516;&#30340;&#24847;&#20041;&#12290;</p>
<p   
>&#22312;&#25968;&#25454;&#27573;&#26102;&#65292;<strong class=" ">A&#65288;&#35775;&#38382;&#20301;&#65292;&#31532;8&#20301;&#65289;&#34920;&#31034;&#35813;&#27573;&#26159;&#21542;&#34987;&#35775;&#38382;&#36807;&#65292;&#24403;&#22788;&#29702;&#22120;&#23558;&#35813;&#27573;&#25551;&#36848;&#31526;&#32622;&#20837;&#26576;&#20010;&#27573;&#23492;&#23384;&#22120;&#26102;&#65292;&#20854;&#20540;&#23601;&#20250;&#34987;&#20462;&#25913;&#20026;1&#65307;W&#65288;&#21487;&#20889;&#20301;&#65292;&#31532;9&#20301;&#65289;&#34920;&#31034;&#24403;&#21069;&#25968;&#25454;&#27573;&#26159;&#21542;&#21487;&#20889;&#65307;E&#65288;&#25299;&#23637;&#20301;&#65292;&#31532;10&#20301;&#65289;&#65292;&#24403;&#35813;&#20540;&#20026;0&#26102;&#21521;&#19978;&#25299;&#23637;&#65292;&#24403;&#35813;&#20540;&#20026;1&#26102;&#21521;&#19979;&#25299;&#23637;</strong>&#12290;</p>
<p   
>&#22312;&#20195;&#30721;&#27573;&#26102;&#20505;&#65292;<strong class=" ">A&#65288;&#35775;&#38382;&#20301;&#65292;&#31532;8&#20301;&#65289;&#19982;&#25968;&#25454;&#27573;&#19968;&#26679;&#30340;&#24847;&#20041;&#65307;R&#65288;&#21487;&#35835;&#20301;&#65292;&#31532;9&#20301;&#65289;&#34920;&#31034;&#24403;&#21069;&#20195;&#30721;&#27573;&#26159;&#21542;&#21487;&#35835;&#65307;C&#65288;&#19968;&#33268;&#20301;&#65292;&#31532;10&#20301;&#65289;&#65292;&#24403;&#35813;&#20540;&#20026;1&#26102;&#21017;&#34920;&#31034;&#19968;&#33268;&#20195;&#30721;&#27573;&#65292;&#24403;&#35813;&#20540;&#20026;0&#26102;&#34920;&#31034;&#38750;&#19968;&#33268;&#20195;&#30721;&#27573;</strong>&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-15_18-40-27.png" alt="images/download/attachments/1015831/image2022-6-15_18-40-27.png" width="600"  />
    </p>
<p   
>&#35828;&#23436;&#20195;&#30721;/&#25968;&#25454;&#27573;&#20043;&#21518;&#65292;&#25105;&#20204;&#26469;&#30475;&#19979;&#24403;S&#20301;&#30340;&#20540;&#20026;0&#26102;&#20505;&#65292;&#21017;&#34920;&#31034;&#24403;&#21069;&#26159;&#31995;&#32479;&#27573;&#25551;&#36848;&#31526;&#65292;&#31995;&#32479;&#27573;&#20998;&#20026;&#20197;&#19979;&#20869;&#23481;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-15_19-30-23.png" alt="images/download/attachments/1015831/image2022-6-15_19-30-23.png" width="600"  />
    </p>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLURC5L2N">
        <h4 class="heading "><span>DB&#20301;</span></h4>
<p   
>DB&#20301;&#26159;&#27573;&#25551;&#36848;&#31526;&#39640;&#20301;4&#23383;&#33410;&#20013;&#30340;&#31532;22&#20301;&#65292;DB&#20301;&#30340;&#20540;&#26377;&#20197;&#19979;&#19977;&#31181;&#22330;&#26223;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#23545;CS&#27573;&#30340;&#24433;&#21709;&#65306;</p>
<ul class=" "><li class=" "><p   
>DB = 0&#65306;&#37319;&#29992;32&#20301;&#23547;&#22336;&#26041;&#24335;</p>
</li><li class=" "><p   
>DB = 1&#65306;&#37319;&#29992;16&#20301;&#23547;&#22336;&#26041;&#24335;</p>
</li></ul></li><li class=" "><p   
>&#23545;SS&#27573;&#30340;&#24433;&#21709;&#65306;</p>
<ul class=" "><li class=" "><p   
>DB = 1&#65306;&#38544;&#24335;&#26632;&#35775;&#38382;&#25351;&#20196;&#65288;&#22914;&#65306;PUSH POP CALL&#65289; &#20351;&#29992;32&#20301;&#26632;&#25351;&#38024;&#23492;&#23384;&#22120;ESP</p>
</li><li class=" "><p   
>DB = 0&#65306;&#38544;&#24335;&#26632;&#35775;&#38382;&#25351;&#20196;&#65288;&#22914;&#65306;PUSH POP CALL&#65289; &#20351;&#29992;16&#20301;&#26632;&#25351;&#38024;&#23492;&#23384;&#22120;SP</p>
</li><li class=" "><p   
>&#38544;&#24335;&#26632;&#35775;&#38382;&#25351;&#20196;&#65306;&#20363;&#22914;PUSH EBP&#65292;&#36825;&#21477;&#25351;&#20196;&#27809;&#26377;&#20986;&#29616;ESP&#21364;&#20462;&#25913;&#20102;ESP&#30340;&#20540;&#65292;&#25152;&#20197;&#25105;&#20204;&#23601;&#21487;&#23601;&#31216;&#36825;&#31181;&#25351;&#20196;&#20026;&#38544;&#24335;&#26632;&#35775;&#38382;&#25351;&#20196;</p>
</li></ul></li><li class=" "><p   
>&#21521;&#19979;&#25193;&#23637;&#30340;&#25968;&#25454;&#27573;&#65306;</p>
<ul class=" "><li class=" "><p   
>DB = 1&#65306;&#27573;&#19978;&#32447;&#20026;4GB</p>
</li><li class=" "><p   
>DB = 0&#65306;&#27573;&#19978;&#32447;&#20026;64KB</p>
</li><li class=" "><p   
>&#23454;&#38469;&#19978;&#26159;&#38480;&#21046;&#25193;&#23637;&#26377;&#25928;&#33539;&#22260;&#65292;&#22823;&#33268;&#22914;&#19979;&#65306;</p>
</li></ul></li></ol><ul class=" "><li class=" "><ul class=" "><li class=" "><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-15_19-40-17.png" alt="images/download/attachments/1015831/image2022-6-15_19-40-17.png" width="400"  />
    </li></ul></li></ul>    </div>
    </div>
    </div>
    <div class="section section-2" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeauteadg-mZkA">
        <h2 class="heading "><span>&#27573;&#26435;&#38480;</span></h2>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeadg-mZkOajgOafpQ">
        <h3 class="heading "><span>&#26435;&#38480;&#26816;&#26597;</span></h3>
<p   
>&#25105;&#20204;&#20043;&#21069;&#25152;&#30693;&#36947;&#24403;&#21521;&#27573;&#23492;&#23384;&#22120;&#20889;&#20837;&#26102;&#65292;CPU&#20250;&#26681;&#25454;&#27573;&#36873;&#25321;&#23376;&#21435;&#26597;&#34920;&#65292;&#24182;&#23558;&#23545;&#24212;&#20869;&#23481;&#36827;&#34892;&#26816;&#26597;&#24182;&#22635;&#20837;&#21040;&#23601;&#23492;&#23384;&#22120;&#20013;&#65292;&#36825;&#37324;&#38754;&#23601;&#28041;&#21450;&#21040;&#27573;&#26435;&#38480;&#26816;&#26597;&#12290;</p>
<p   
>&#22312;&#20102;&#35299;&#27573;&#26435;&#38480;&#26816;&#26597;&#20043;&#21069;&#25105;&#20204;&#20808;&#26469;&#30475;&#19968;&#19979;CPU&#30340;&#20998;&#32423;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#23601;&#26159;CPU&#26435;&#38480;&#30340;&#19981;&#21516;&#20998;&#32423;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-20_11-14-32.png" alt="images/download/attachments/1015831/image2022-6-20_11-14-32.png" width="400"  />
    </p>
<p   
>&#22312;Windows&#25805;&#20316;&#31995;&#32479;&#24403;&#20013;&#20351;&#29992;&#20102;Ring 3&#65288;&#24212;&#29992;&#23618;&#65289;&#12289;Ring 0&#65288;&#20869;&#26680;/&#39537;&#21160;&#23618;&#65289;&#30340;&#26435;&#38480;&#20998;&#32423;&#65292;&#25105;&#20204;&#20063;&#21487;&#20197;&#31216;&#20043;&#20026;0&#29615;&#12289;3&#29615;&#12290;</p>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeWIpOaWreeoi-W6j-adg-mZkA">
        <h4 class="heading "><span>&#21028;&#26029;&#31243;&#24207;&#26435;&#38480;</span></h4>
<p   
>&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;CPL&#65288;Current Privilege Level&#65292;&#24403;&#21069;&#29305;&#26435;&#32423;&#65289;&#26469;&#21028;&#26029;&#31243;&#24207;&#30340;&#26435;&#38480;&#31561;&#32423;&#65292;&#36825;&#37324;&#30340;CPL&#23454;&#38469;&#19978;&#23601;&#26159;CS&#21644;SS&#20013;&#23384;&#20648;&#30340;&#27573;&#36873;&#25321;&#23376;&#30340;&#26368;&#21518;2&#20301;&#65288;&#35813;&#20301;&#19982;&#20854;&#20182;&#27573;&#23492;&#23384;&#22120;&#27573;&#36873;&#25321;&#23376;&#30340;RPL&#20301;&#26159;&#21516;&#19968;&#20301;&#32622;&#65289;&#12290;</p>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#25105;&#23558;&#19968;&#20010;EXE&#25991;&#20214;&#20002;&#20837;DTDebug&#20013;&#65292;&#24182;&#25214;&#21040;&#23427;&#30340;CS&#20013;&#30340;&#27573;&#36873;&#25321;&#23376;0x001B&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-20_11-35-32.png" alt="images/download/attachments/1015831/image2022-6-20_11-35-32.png" width="600"  />
    </p>
<p   
>&#25152;&#20197;&#25105;&#20204;&#26681;&#25454;B = 1011&#24471;&#20986;CPL = 0011 = 3&#65292;&#20063;&#23601;&#34920;&#31034;&#24403;&#21069;&#36827;&#31243;&#30340;&#26435;&#38480;&#26159;Ring 3&#65288;&#24212;&#29992;&#23618;&#65292;3&#29615;&#65289;&#12290;</p>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLURQTA">
        <h4 class="heading "><span>DPL</span></h4>
<p   
>DPL&#65288;Descriptor Privilege Level&#65292;&#25551;&#36848;&#31526;&#29305;&#26435;&#32423;&#21035;&#65289;&#23384;&#20648;&#22312;&#27573;&#25551;&#36848;&#31526;&#20013;&#65292;&#20854;&#35268;&#23450;&#20102;&#35775;&#38382;&#35813;&#27573;&#25152;&#38656;&#35201;&#30340;&#29305;&#26435;&#32423;&#21035;&#26159;&#20160;&#20040;&#12290;</p>
<p   
>&#22914;&#19979;&#25351;&#20196;&#20013;&#27573;&#36873;&#25321;&#23376;AX&#25351;&#21521;&#30340;&#27573;&#25551;&#36848;&#31526;&#20013;&#30340;DPL&#20026;0&#65292;&#20294;&#26159;&#24403;&#21069;&#31243;&#24207;&#30340;CPL&#20026;3&#65292;&#37027;&#20040;&#35813;&#25351;&#20196;&#26159;&#26080;&#27861;&#25191;&#34892;&#25104;&#21151;&#30340;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">MOV DS,AX</code></div>
</div>
    </div>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVJQTA">
        <h4 class="heading "><span>RPL</span></h4>
<p   
>RPL&#65288;Request Privilege Level&#65292;&#35831;&#27714;&#29305;&#26435;&#32423;&#21035;&#65289;&#26159;&#38024;&#23545;&#27573;&#36873;&#25321;&#23376;&#32780;&#35328;&#30340;&#65292;&#27599;&#20010;&#27573;&#30340;&#36873;&#25321;&#23376;&#37117;&#26377;&#33258;&#24049;&#30340;RPL&#12290;</p>
<p   
>&#22914;&#19979;&#25351;&#20196;&#20013;&#27573;&#36873;&#25321;&#23376;&#25351;&#21521;&#30340;&#26159;&#21516;&#19968;&#20010;&#27573;&#25551;&#36848;&#31526;&#65292;&#20294;&#26159;&#23427;&#20204;&#30340;RPL&#19981;&#19968;&#26679;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">MOV AX,</code><code class="value">0x0008</code></div>
<div class="line"><code class="plain">MOV DS,AX</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">MOV AX,</code><code class="value">0x000B</code></div>
<div class="line"><code class="plain">MOV DS,AX</code></div>
</div>
    </div>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeaVsOaNruauteeahOadg-mZkOajgOafpQ">
        <h4 class="heading "><span>&#25968;&#25454;&#27573;&#30340;&#26435;&#38480;&#26816;&#26597;</span></h4>
<p   
>&#22312;&#21069;&#38754;&#30340;&#23398;&#20064;&#20013;&#25105;&#20204;&#20102;&#35299;&#20102;CPL&#12289;DPL&#12289;RPL&#65292;&#37027;&#20040;&#23427;&#20204;&#20043;&#38388;&#22312;&#25968;&#25454;&#27573;&#20013;&#21448;&#26159;&#22914;&#20309;&#36827;&#34892;&#26816;&#26597;&#30340;&#21602;&#65311;&#22914;&#19979;&#20195;&#30721;&#65288;&#24403;&#21069;&#31243;&#24207;&#22788;&#20110;0&#29615;&#65292;&#20063;&#23601;&#34920;&#31034;CPL=0&#65289;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">MOV AX,</code><code class="value">0x00B</code><code class="plain"> </code><code class="comments">// 0xB = 1011, RPL = 3</code></div>
<div class="line"><code class="plain">MOV DS,AX </code><code class="comments">// AX指向的段描述符的DPL = 0</code></div>
</div>
    </div>
<p   
>&#22312;&#25968;&#25454;&#27573;&#30340;&#26435;&#38480;&#26816;&#26597;&#20013;&#26159;&#25353;&#29031;&#22914;&#19979;&#20844;&#24335;&#36827;&#34892;&#30340;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="comments">// 数值上的比较</code></div>
<div class="line"><code class="plain">CPL &lt;= DPL &amp;&amp; RPL &lt;= DPL</code></div>
</div>
    </div>
<p  class="auto-cursor-target" 
>&#26681;&#25454;&#36825;&#27573;&#20844;&#24335;&#65292;&#25105;&#20204;&#30340;RPL&#20540;&#24182;&#19981;&#23567;&#20110;&#31561;&#20110;DPL&#65292;&#22240;&#27492;&#25105;&#20204;&#25152;&#25191;&#34892;&#30340;&#21521;&#27573;&#23492;&#23384;&#22120;&#20889;&#20540;&#25351;&#20196;&#26159;&#26080;&#27861;&#25191;&#34892;&#25104;&#21151;&#30340;&#12290;</p>
<p  class="auto-cursor-target" 
><strong class=" ">&#27880;&#24847;</strong>&#65306;&#20195;&#30721;&#27573;&#21644;&#31995;&#32479;&#27573;&#25551;&#36848;&#31526;&#20013;&#30340;&#26816;&#26597;&#26041;&#24335;&#26159;&#19981;&#19968;&#26679;&#30340;&#65292;&#36825;&#20123;&#23558;&#20110;&#21518;&#38754;&#30340;&#31456;&#33410;&#20013;&#20102;&#35299;&#21040;&#12290;</p>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeS4uuS7gOS5iOmcgOimgeaciVJQTA">
        <h4 class="heading auto-cursor-target"><span>&#20026;&#20160;&#20040;&#38656;&#35201;&#26377;RPL</span></h4>
<p   
>&#25105;&#20204;&#26377;&#20102;CPL&#12289;DPL&#23454;&#38469;&#19978;&#24050;&#32463;&#23436;&#25104;&#20102;&#26368;&#22522;&#26412;&#30340;&#27573;&#26435;&#38480;&#26816;&#26597;&#65292;&#20026;&#20160;&#20040;&#36824;&#38656;&#35201;RPL&#21602;&#65311;&#25105;&#20204;&#20197;&#25991;&#20214;&#35835;&#20889;&#20026;&#20363;&#65292;&#25105;&#20204;&#21487;&#20197;&#23545;&#19968;&#20010;&#25991;&#20214;&#36827;&#34892;&#35835;&#20889;&#65292;&#20294;&#26159;&#20026;&#20102;&#36991;&#20813;&#20986;&#38169;&#65292;&#22312;&#22823;&#22810;&#24773;&#20917;&#19979;&#65292;&#22914;&#26524;&#20320;&#21482;&#38656;&#35201;&#35835;&#21462;&#26435;&#38480;&#65292;&#37027;&#20040;&#20320;&#40664;&#35748;&#20250;&#20351;&#29992;&#21482;&#35835;&#27169;&#24335;&#21435;&#25171;&#24320;&#25991;&#20214;&#12290;&#22240;&#27492;&#65292;&#22312;&#36825;&#37324;&#20063;&#26159;&#21516;&#26679;&#30340;&#36947;&#29702;&#65292;<strong class=" ">&#20320;&#26377;&#39640;&#26435;&#38480;&#24182;&#19981;&#20195;&#34920;&#20320;&#19968;&#23450;&#38656;&#35201;&#20351;&#29992;&#39640;&#26435;&#38480;&#65292;&#20026;&#20102;&#31283;&#23450;&#24615;&#12289;&#23433;&#20840;&#24615;&#65292;&#20197;&#26368;&#23567;&#26435;&#38480;&#21407;&#21017;&#28385;&#36275;&#23545;&#24212;&#22330;&#26223;&#21363;&#21487;</strong>&#12290;</p>
    </div>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeS7o-eggei3qOautQ">
        <h3 class="heading "><span>&#20195;&#30721;&#36328;&#27573;</span></h3>
<p   
>&#20195;&#30721;&#36328;&#27573;&#26412;&#36136;&#19978;&#23601;&#26159;&#20462;&#25913;CS&#27573;&#23492;&#23384;&#22120;&#65292;&#25105;&#20204;&#20043;&#21069;&#26377;&#20102;&#35299;&#21040;&#35835;&#20889;&#27573;&#23492;&#23384;&#22120;&#21487;&#20197;&#20351;&#29992;MOV&#25110;LXX&#25351;&#20196;&#36827;&#34892;&#65292;&#20294;&#26159;&#30001;&#20110;CS&#27573;&#23492;&#23384;&#22120;&#30340;&#29305;&#27530;&#24615;&#25105;&#20204;&#27809;&#21150;&#27861;&#20043;&#38388;&#20462;&#25913;&#12290;</p>
<p   
>CS&#26159;&#20195;&#30721;&#27573;&#65292;&#23427;&#30340;&#25913;&#21464;&#23601;&#24847;&#21619;&#30528;EIP&#30340;&#25913;&#21464;&#65292;&#20462;&#25913;CS&#30340;&#21516;&#26102;&#23601;&#24517;&#39035;&#35201;&#20462;&#25913;EIP&#65292;&#25152;&#20197;&#24494;&#36719;&#20063;&#27809;&#26377;&#30452;&#25509;&#25552;&#20379;&#20197;&#19978;&#25152;&#36848;&#30340;&#31867;&#20284;&#25351;&#20196;&#26469;&#20462;&#25913;CS&#27573;&#23492;&#23384;&#22120;&#12290;&#37027;&#20040;&#25105;&#20204;&#24819;&#21516;&#26102;&#20462;&#25913;CS&#19982;EIP&#65292;&#21487;&#20197;&#20351;&#29992;&#22914;&#19979;&#36825;&#20123;&#25351;&#20196;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">JMP FAR</code></div>
<div class="line"><code class="plain">CALL FAR</code></div>
<div class="line"><code class="plain">RETF</code></div>
<div class="line"><code class="plain">INT</code></div>
<div class="line"><code class="plain">IRETED</code></div>
</div>
    </div>
<p   
>&#26412;&#31456;&#33410;&#20027;&#35201;&#20102;&#35299;&#19968;&#19979;JMP FAR&#25351;&#20196;&#26159;&#22914;&#20309;&#25191;&#34892;&#30340;&#12290;</p>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLea1geeoiw">
        <h4 class="heading "><span>&#27969;&#31243;</span></h4>
<p   
>JMP FAR&#25351;&#20196;&#65292;&#20320;&#21487;&#20197;&#31216;&#20043;&#20026;&#38271;&#36339;&#36716;&#65292;&#22914;&#19979;&#23601;&#26159;JMP FAR&#25351;&#20196;&#26684;&#24335;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="comments">// JMP FAR 段选择子:要跳转的地址</code></div>
<div class="line"><code class="plain">JMP FAR </code><code class="value">0x20</code><code class="plain">:</code><code class="value">0x004183D7</code></div>
</div>
    </div>
<p   
>&#37027;&#20040;CPU&#36935;&#21040;&#36825;&#26679;&#30340;&#25351;&#20196;&#23427;&#30340;&#27969;&#31243;&#26159;&#24590;&#20040;&#26679;&#30340;&#21602;&#65311;&#23427;&#19968;&#20849;&#26377;5&#20010;&#27493;&#39588;&#65292;&#25105;&#20204;&#20197;&#22914;&#19978;&#25351;&#20196;&#24102;&#20837;&#30475;&#19968;&#19979;&#65306;</p>
<ol class=" "><li class=" "><p   
><strong class=" ">&#23558;&#27573;&#36873;&#25321;&#23376;&#25286;&#20998;</strong>&#65306;0x20 = 0000 0000 0010 0000, RPL = 00, TI = 0, Index = 0100(&#21313;&#36827;&#21046;&#65306;4)&#65307;</p>
</li><li class=" "><p   
><strong class=" ">&#26681;&#25454;&#27573;&#36873;&#25321;&#23376;&#26597;&#34920;&#33719;&#21462;&#27573;&#25551;&#36848;&#31526;</strong>&#65306;&#22240;&#20026;TI=0&#65292;&#25152;&#20197;&#26597;GDT&#34920;&#65292;&#21448;&#26681;&#25454;Index=4&#25214;&#21040;&#23545;&#24212;&#30340;&#27573;&#25551;&#36848;&#31526;&#65292;&#22914;&#26524;&#27573;&#25551;&#36848;&#31526;&#20026;&#20195;&#30721;&#27573;&#12289;&#31995;&#32479;&#27573;&#65288;&#35843;&#29992;&#38376;&#12289;TSS&#20219;&#21153;&#27573;&#12289;&#20219;&#21153;&#38376;&#65289;&#65292;&#37027;&#20040;&#35813;&#25351;&#20196;&#26159;&#20801;&#35768;&#36339;&#36716;&#30340;&#65307;</p>
</li><li class=" "><p   
><strong class=" ">&#26435;&#38480;&#26816;&#26597;</strong>&#65306;&#26681;&#25454;&#20195;&#30721;&#27573;&#26159;&#21542;&#19968;&#33268;&#26469;&#20570;&#26435;&#38480;&#26816;&#26597;&#65288;XPL&#25968;&#20540;&#27604;&#36739;&#65289;&#65292;&#22914;&#26524;&#26159;&#38750;&#19968;&#33268;&#20195;&#30721;&#27573;&#21017;&#35201;&#27714;CPL==DPL&amp;&amp;RPL&lt;=DPL&#65292;&#22914;&#26524;&#26159;&#19968;&#33268;&#20195;&#30721;&#27573;&#21017;&#35201;&#27714;CPL&gt;=DPL&#65307;</p>
<ol class=" "><li class=" "><p   
><strong class=" ">&#38750;&#19968;&#33268;&#20195;&#30721;&#27573;</strong>&#65306;&#25105;&#20204;&#21448;&#31216;&#20043;&#20026;<strong class=" ">&#26222;&#36890;&#20195;&#30721;&#27573;</strong>&#65292;&#23427;&#21482;&#20801;&#35768;&#21516;&#32423;&#35775;&#38382;&#65292;&#20363;&#22914;Ring3&#21482;&#33021;&#35775;&#38382;Ring3&#65288;Ring0&#21516;&#29702;&#21487;&#24471;&#65289;&#65292;&#20005;&#31105;&#19981;&#21516;&#32423;&#21035;&#30340;&#35775;&#38382;&#65307;</p>
</li><li class=" "><p   
><strong class=" ">&#19968;&#33268;&#20195;&#30721;&#27573;</strong>&#65306;&#25105;&#20204;&#21448;&#31216;&#20043;&#20026;<strong class=" ">&#20849;&#20139;&#27573;</strong>&#65292;&#29305;&#26435;&#32423;&#39640;&#30340;&#31243;&#24207;&#19981;&#20801;&#35768;&#35775;&#38382;&#29305;&#26435;&#32423;&#20302;&#30340;&#25968;&#25454;&#65292;Ring0&#19981;&#20801;&#35768;&#35775;&#38382;Ring3&#30340;&#25968;&#25454;&#65292;&#29305;&#26435;&#32423;&#20302;&#30340;&#31243;&#24207;&#21487;&#20197;&#35775;&#38382;&#21040;&#29305;&#26435;&#32423;&#39640;&#24471;&#25968;&#25454;&#65292;&#20294;&#29305;&#26435;&#32423;&#19981;&#20250;&#21457;&#29983;&#25913;&#21464;&#65292;Ring3&#36824;&#26159;Ring3&#12290;</p>
</li></ol></li><li class=" "><p   
><strong class=" ">&#21152;&#36733;&#27573;&#25551;&#36848;&#31526;</strong>&#65306;&#36890;&#36807;&#26435;&#38480;&#26816;&#26597;&#20043;&#21518;&#65292;CPU&#20250;&#23558;&#27573;&#25551;&#36848;&#31526;&#21152;&#36733;&#21040;CS&#27573;&#23492;&#23384;&#22120;&#20013;&#65307;</p>
</li><li class=" "><p   
><strong class=" ">&#20195;&#30721;&#25191;&#34892;</strong>&#65306;CPU&#23558;CS.Base + Offset&#30340;&#20540;&#20889;&#20837;&#21040;EIP&#65292;&#28982;&#21518;&#25191;&#34892;CS:EIP&#22788;&#30340;&#20195;&#30721;&#65292;&#27573;&#38388;&#36339;&#36716;&#21363;&#32467;&#26463;&#12290;</p>
</li></ol><p   
>&#30452;&#25509;&#23545;&#20195;&#30721;&#27573;&#36827;&#34892;JMP&#25110;&#32773; CALL&#30340;&#25805;&#20316;&#65292;&#26080;&#35770;&#30446;&#26631;&#26159;&#19968;&#33268;&#20195;&#30721;&#27573;&#36824;&#26159;&#38750;&#19968;&#33268;&#20195;&#30721;&#27573;&#65292;CPL&#37117;&#19981;&#20250;&#21457;&#29983;&#25913;&#21464;&#12290;&#22914;&#26524;&#35201;&#25552;&#21319;CPL&#30340;&#26435;&#38480;&#65292;&#21482;&#33021;&#36890;&#36807;&#35843;&#29992;&#38376;&#25110;&#31867;&#20284;&#26041;&#27861;&#12290;</p>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeWunumqjA">
        <h4 class="heading "><span>&#23454;&#39564;</span></h4>
<p   
>&#20043;&#21069;&#25105;&#20204;&#24050;&#32463;&#20102;&#35299;&#20102;JMP FAR&#25351;&#20196;&#30340;&#25191;&#34892;&#27969;&#31243;&#20102;&#65292;&#25105;&#20204;&#21487;&#20197;&#26469;&#23454;&#38469;&#23454;&#39564;&#19968;&#19979;&#12290;</p>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLemdnuS4gOiHtOS7o-eggeauteaPj-i_sOespg">
        <h5 class="heading "><span>&#38750;&#19968;&#33268;&#20195;&#30721;&#27573;&#25551;&#36848;&#31526;</span></h5>
<p   
>&#39318;&#20808;&#36890;&#36807;Windbg&#25214;&#21040;&#19968;&#20010;&#38750;&#19968;&#33268;&#30340;&#20195;&#30721;&#27573;&#25551;&#36848;&#31526;&#65288;&#36890;&#36807;&#27573;&#25551;&#36848;&#31526;&#30340;S&#20301;&#21644;Type&#20301;&#26469;&#30830;&#23450;&#65289;&#65292;&#28982;&#21518;&#22797;&#21046;&#19968;&#20221;&#20889;&#20837;&#21040;GDT&#34920;&#20013;&#12290;</p>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#26631;&#35760;&#20986;&#30340;&#20869;&#23481;&#65292;&#23601;&#26159;&#19968;&#20010;&#38750;&#19968;&#33268;&#30340;&#20195;&#30721;&#27573;&#25551;&#36848;&#31526;&#65288;S&#20301;=1 &amp;&amp; Type&#22495;&#20013;&#30340;C&#20301;=0&#65289;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-22_14-38-12.png" alt="images/download/attachments/1015831/image2022-6-22_14-38-12.png" width="400"  />
    </p>
<p   
>&#25105;&#20204;&#20351;&#29992;&#22914;&#19979;&#25351;&#20196;&#23558;&#26631;&#35760;&#30340;&#27573;&#25551;&#36848;&#31526;&#25918;&#20837;GDT&#34920;&#20013;&#30340;&#31354;&#30333;&#37096;&#20998;&#65288;&#22240;&#20026;&#22914;&#26524;&#25105;&#20204;&#30452;&#25509;&#20351;&#29992;&#29616;&#26377;&#30340;&#20540;&#21435;&#27979;&#35797;&#65292;&#30475;&#36215;&#26469;&#19981;&#22815;&#30452;&#35266;&#65289;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">eq 8003f048 00cffb00`0000ffff</code></div>
</div>
    </div>
<p   
>&#37027;&#20040;&#25509;&#30528;&#25105;&#20204;&#38656;&#35201;&#26500;&#24314;&#19968;&#20010;JMP FAR&#25351;&#20196;&#65292;&#39318;&#20808;&#26159;&#27573;&#36873;&#25321;&#23376;&#37096;&#20998;&#65292;&#25105;&#20204;&#35201;&#35753;CPU&#26681;&#25454;&#27573;&#36873;&#25321;&#23376;&#30340;Index&#20301;&#25214;&#21040;8003f048&#36825;&#20010;&#22320;&#22336;&#30340;&#27573;&#25551;&#36848;&#31526;&#65292;&#21448;&#30693;&#36947;CPU&#26681;&#25454;Index&#20301;&#30340;&#20540;&#20056;&#20197;8&#20877;&#21152;&#19978;GDT&#30340;&#22522;&#22320;&#22336;&#65292;&#20197;&#21450;&#28385;&#36275;&#26435;&#38480;&#26816;&#26597;&#35201;&#27714;CPL==DPL&amp;&amp;RPL&lt;=DPL&#65292;&#22240;&#27492;&#27573;&#36873;&#25321;&#23376;&#20026;&#65306;0000 0000 0100 1011&#12290;&#26368;&#32456;&#25351;&#20196;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">JMP FAR 4B:004010CC</code></div>
</div>
    </div>
<p   
>&#25105;&#20204;&#21487;&#20197;&#22312;DTDebug&#20013;&#20889;&#20837;&#36825;&#27573;&#27719;&#32534;&#25351;&#20196;&#65292;&#28982;&#21518;F7&#19968;&#19979;&#20320;&#23601;&#20250;&#21457;&#29616;&#36825;&#26102;&#20505;&#31243;&#24207;&#25104;&#21151;&#36339;&#36716;&#21040;0x004010CC&#20301;&#32622;&#65292;&#24182;&#19988;EIP&#21644;CS&#27573;&#23492;&#23384;&#22120;&#30340;&#20540;&#37117;&#21457;&#29983;&#20102;&#25913;&#21464;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-22_17-6-42.png" alt="images/download/attachments/1015831/image2022-6-22_17-6-42.png" width="600"  />
    </p>
<p   
>&#25152;&#20197;&#25105;&#20204;&#23601;&#23436;&#25104;&#38271;&#36339;&#36716;&#23454;&#39564;&#65292;&#25509;&#30528;&#25105;&#20204;&#21487;&#20197;&#26469;&#39564;&#35777;&#19968;&#19979;&#26435;&#38480;&#26816;&#26597;&#37096;&#20998;&#26159;&#21542;&#30495;&#30340;&#25353;&#27969;&#31243;&#25152;&#35828;&#37027;&#26679;&#65292;&#38656;&#35201;&#28385;&#36275;CPL==DPL&amp;&amp;RPL&lt;=DPL&#65292;&#21487;&#20197;&#23558;&#20043;&#21069;&#20889;&#20837;&#30340;&#27573;&#23492;&#23384;&#22120;&#20540;&#20462;&#25913;&#19968;&#19979;&#65288;&#20462;&#25913;&#20102;DPL&#20301;&#30340;&#20540;&#65289;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">eq 8003f048 00cf9b00`0000ffff</code></div>
</div>
    </div>
<p   
>&#24182;&#19988;&#25105;&#20204;&#32487;&#32493;&#20351;&#29992;&#19978;&#38754;&#30340;&#27719;&#32534;&#25351;&#20196;&#21435;&#36816;&#34892;&#23601;&#20250;&#21457;&#29616;&#30452;&#25509;&#20986;&#38169;&#20102;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-22_17-11-29.png" alt="images/download/attachments/1015831/image2022-6-22_17-11-29.png" width="600"  />
    </p>
<p   
>&#33267;&#27492;&#25105;&#20204;&#20063;&#23601;&#39564;&#35777;&#20102;&#27492;&#22788;&#30340;&#26435;&#38480;&#26816;&#26597;&#36923;&#36753;&#12290;</p>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeS4gOiHtOS7o-eggeauteaPj-i_sOespg">
        <h5 class="heading "><span>&#19968;&#33268;&#20195;&#30721;&#27573;&#25551;&#36848;&#31526;</span></h5>
<p   
>&#25105;&#20204;&#21487;&#20197;&#20462;&#25913;&#27573;&#25551;&#36848;&#31526;&#65292;&#23558;&#20854;&#21464;&#20026;&#19968;&#33268;&#20195;&#30721;&#27573;&#25551;&#36848;&#31526;&#65292;&#20063;&#23601;&#26159;&#20462;&#25913;Type&#22495;&#20013;&#30340;C&#20301;=1&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">eq 8003f048 00cf9f00`0000ffff</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-22_17-15-45.png" alt="images/download/attachments/1015831/image2022-6-22_17-15-45.png" width="400"  />
    </p>
<p   
>&#25509;&#30528;&#25105;&#20204;&#20351;&#29992;&#21516;&#26679;&#30340;&#27719;&#32534;&#25351;&#20196;&#36827;&#34892;&#25191;&#34892;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">JMP FAR 4B:004010CC</code></div>
</div>
    </div>
<p   
>&#32780;&#36825;&#37324;&#26159;&#21487;&#20197;&#25191;&#34892;&#25104;&#21151;&#30340;&#65292;&#36825;&#26159;&#22240;&#20026;&#19968;&#33268;&#20195;&#30721;&#27573;&#25551;&#36848;&#31526;&#30340;&#26435;&#38480;&#26657;&#39564;&#26159;&#20801;&#35768;&#20302;&#26435;&#38480;&#31243;&#24207;&#35775;&#38382;&#39640;&#26435;&#38480;&#25968;&#25454;&#30340;&#65292;&#20063;&#23601;&#26159;CPL&gt;=DPL&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-22_17-18-45.png" alt="images/download/attachments/1015831/image2022-6-22_17-18-45.png" width="600"  />
    </p>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeaAu-e7kw">
        <h5 class="heading "><span>&#24635;&#32467;</span></h5>
<ol class=" "><li class=" "><p   
>&#20026;&#20102;&#23545;&#25968;&#25454;&#36827;&#34892;&#20445;&#25252;&#65292;&#26222;&#36890;&#20195;&#30721;&#27573;&#26159;&#31105;&#27490;&#19981;&#21516;&#32423;&#21035;&#36827;&#34892;&#35775;&#38382;&#30340;&#12290;&#29992;&#25143;&#24577;&#30340;&#20195;&#30721;&#19981;&#33021;&#35775;&#38382;&#20869;&#26680;&#30340;&#25968;&#25454;&#65292;&#21516;&#26679;&#65292;&#20869;&#26680;&#24577;&#30340;&#20195;&#30721;&#20063;&#19981;&#33021;&#35775;&#38382;&#29992;&#25143;&#24577;&#30340;&#25968;&#25454;&#65307;</p>
</li><li class=" "><p   
>&#22914;&#26524;&#24819;&#25552;&#20379;&#19968;&#20123;&#36890;&#29992;&#30340;&#21151;&#33021;&#65292;&#32780;&#19988;&#36825;&#20123;&#21151;&#33021;&#24182;&#19981;&#20250;&#30772;&#22351;&#20869;&#26680;&#25968;&#25454;&#65292;&#37027;&#20040;&#21487;&#20197;&#36873;&#25321;&#19968;&#33268;&#20195;&#30721;&#27573;&#65292;&#36825;&#26679;&#20302;&#32423;&#21035;&#30340;&#31243;&#24207;&#21487;&#20197;&#22312;&#19981;&#25552;&#21319;CPL&#26435;&#38480;&#31561;&#32423;&#30340;&#24773;&#20917;&#19979;&#35775;&#38382;&#12290;</p>
</li><li class=" "><p   
>&#22914;&#26524;&#24819;&#35775;&#38382;&#26222;&#36890;&#20195;&#30721;&#27573;&#65292;&#21482;&#26377;&#36890;&#36807;&#35843;&#29992;&#38376;&#31561;&#25552;&#21319;CPL&#26435;&#38480;&#65292;&#25165;&#33021;&#35775;&#38382;&#12290;</p>
</li></ol>    </div>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLemVv-iwg-eUqOS4juefreiwg-eUqA">
        <h4 class="heading "><span>&#38271;&#35843;&#29992;&#19982;&#30701;&#35843;&#29992;</span></h4>
<p   
>&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;JMP FAR&#25351;&#20196;&#23454;&#29616;&#27573;&#38388;&#30340;&#36339;&#36716;&#65292;&#22914;&#26524;&#35201;&#23454;&#29616;&#36328;&#27573;&#30340;&#35843;&#29992;&#23601;&#24517;&#39035;&#35201;&#23398;&#20064;CALL FAR&#25351;&#20196;&#65292;&#20063;&#23601;&#26159;&#38271;&#35843;&#29992;&#12290;CALL FAR&#27604;JMP FAR&#35201;&#22797;&#26434;&#65292;JMP&#24182;&#19981;&#24433;&#21709;&#26632;&#65292;&#20294;CALL&#20250;&#24433;&#21709;&#12290;</p>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeefreiwg-eUqA">
        <h5 class="heading "><span>&#30701;&#35843;&#29992;</span></h5>
<p   
>&#30701;&#35843;&#29992;&#23601;&#26159;&#25105;&#20204;&#20043;&#21069;&#25152;&#23398;&#20064;&#30340;CALL&#25351;&#20196;&#65292;&#25351;&#20196;&#26684;&#24335;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">CALL 立即数/寄存器/内存</code></div>
</div>
    </div>
<p   
>&#24403;&#20320;&#25191;&#34892;CALL&#25351;&#20196;&#26102;&#65292;&#23427;&#39318;&#20808;&#20250;&#21521;&#26632;&#20013;&#21387;&#20837;&#24403;&#21069;CALL&#25351;&#20196;&#30340;&#19979;&#19968;&#34892;&#22320;&#22336;&#65292;&#36825;&#20010;&#22320;&#22336;&#20063;&#31216;&#20043;&#20026;&#36820;&#22238;&#22320;&#22336;&#12290;</p>
<p   
>CALL&#25351;&#20196;&#25191;&#34892;&#20250;&#24433;&#21709;2&#20010;&#23492;&#23384;&#22120;&#65292;&#19968;&#20010;&#26159;ESP&#30340;&#20540;&#65288;&#21387;&#20837;&#22320;&#22336;&#21040;&#26632;&#65292;&#26632;&#39030;&#25552;&#21319;&#65289;&#65292;&#19968;&#20010;&#26159;EIP&#30340;&#20540;&#65288;&#35201;&#36339;&#36716;&#21040;&#26576;&#20010;&#22320;&#22336;&#32487;&#32493;&#25191;&#34892;&#65289;&#12290;</p>
<p   
>&#25152;&#20197;CALL&#25351;&#20196;&#20063;&#21487;&#20063;&#20998;&#35299;&#25104;&#36825;2&#20010;&#25351;&#20196;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">PUSH CALL指令的下一行地址</code></div>
<div class="line"><code class="plain">JMP 立即数/寄存器/内存</code></div>
</div>
    </div>
<p   
>&#25105;&#20204;&#20063;&#30693;&#36947;&#22312;&#27719;&#32534;&#20013;&#30340;CALL&#25351;&#20196;&#22823;&#22810;&#26159;&#29992;&#20110;&#35843;&#29992;&#20989;&#25968;&#30340;&#65292;&#32780;&#22312;&#27599;&#20010;&#20989;&#25968;&#35843;&#29992;&#23436;&#20043;&#21518;&#37117;&#20250;&#26377;&#19968;&#20010;RET&#25351;&#20196;&#65292;&#23427;&#30340;&#20316;&#29992;&#23601;&#26159;&#36339;&#36716;&#22238;CALL&#25351;&#20196;&#30340;&#19979;&#19968;&#34892;&#22320;&#22336;&#65292;&#24182;POP&#12290;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">POP CALL指令的下一行地址</code></div>
<div class="line"><code class="plain">JMP CALL指令的下一行地址</code></div>
</div>
    </div>
<p   
>&#37027;&#20040;&#30701;&#35843;&#29992;&#30340;&#26632;&#22270;&#21464;&#21270;&#23601;&#21487;&#20197;&#20351;&#29992;&#22914;&#19979;&#22270;&#26469;&#34920;&#31034;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-28_16-18-1.png" alt="images/download/attachments/1015831/image2022-6-28_16-18-1.png" width="600"  />
    </p>
<p   
>&#25152;&#20197;&#30701;&#35843;&#29992;&#24433;&#21709;&#30340;&#23492;&#23384;&#22120;&#26159;&#65306;ESP&#12289;EIP</p>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLemVv-iwg-eUqA">
        <h5 class="heading "><span>&#38271;&#35843;&#29992;</span></h5>
    <div class="section section-6" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeWeruauteS4jeaPkOadgw">
        <h6 class="heading "><span>&#22446;&#27573;&#19981;&#25552;&#26435;</span></h6>
<p   
>&#38271;&#35843;&#29992;&#23601;&#26159;CALL FAR&#25351;&#20196;&#65292;&#25351;&#20196;&#26684;&#24335;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">CALL FAR CS:EIP</code></div>
</div>
    </div>
<p   
>&#38271;&#35843;&#29992;&#20998;&#20026;&#20004;&#31181;&#24773;&#20917;&#65292;&#25105;&#20204;&#36825;&#37324;&#25152;&#35762;&#35299;&#30340;&#38271;&#35843;&#29992;&#26159;&#25351;&#22446;&#27573;&#19981;&#25552;&#26435;&#30340;&#12290;&#36825;&#27573;&#25351;&#20196;&#21435;&#25191;&#34892;&#30340;&#26102;&#20505;&#65292;&#22320;&#22336;&#24182;&#19981;&#20250;&#36339;&#36716;&#21040;EIP&#65292;&#22240;&#20026;&#36825;&#37324;&#30340;EIP&#26159;&#24223;&#24323;&#30340;&#65307;&#23454;&#38469;&#25351;&#20196;&#26159;&#26681;&#25454;CS&#27573;&#36873;&#25321;&#23376;&#26597;GDT&#34920;&#65292;&#25214;&#21040;&#34920;&#20013;&#30340;&#27573;&#25551;&#36848;&#31526;&#65288;&#36825;&#20010;&#27573;&#25551;&#36848;&#31526;&#24517;&#39035;&#26159;&#19968;&#20010;&#35843;&#29992;&#38376;&#65289;&#65292;&#20877;&#26681;&#25454;&#35843;&#29992;&#38376;&#30340;&#31526;&#21495;&#35745;&#31639;&#20986;&#35201;&#35843;&#36716;&#30340;&#22320;&#22336;&#65292;&#26368;&#32456;&#20877;&#36339;&#36716;&#36807;&#21435;&#12290;</p>
<p   
>&#36825;&#37324;&#25105;&#20204;&#25152;&#35828;&#30340;&#22446;&#27573;&#19981;&#25552;&#26435;&#30340;&#65292;&#26159;&#25351;&#24403;&#21069;&#20320;&#30340;&#27573;CPL&#19982;&#35201;&#36339;&#36716;&#36807;&#21435;&#30340;&#27573;CPL&#26159;&#21516;&#32423;&#30340;&#12290;&#25191;&#34892;&#38271;&#35843;&#29992;&#26102;&#65292;&#39318;&#20808;&#20250;&#21387;&#20837;&#35843;&#29992;&#32773;&#30340;CS&#65292;&#28982;&#21518;&#20877;&#21387;&#20837;&#38271;&#35843;&#29992;&#25351;&#20196;&#30340;&#19979;&#19968;&#34892;&#22320;&#22336;&#12290;&#35843;&#29992;&#23436;&#25104;&#20043;&#21518;&#65292;&#30001;&#20110;&#21387;&#20837;&#26632;&#30340;&#20869;&#23481;&#19982;&#30701;&#35843;&#29992;&#19981;&#19968;&#26679;&#20102;&#65292;&#25152;&#20197;&#24403;&#35843;&#29992;&#23436;&#25104;&#20043;&#21518;&#19981;&#21487;&#20197;&#20877;&#20351;&#29992;RET&#26469;&#36820;&#22238;&#20102;&#65292;&#32780;&#26159;&#38656;&#35201;&#20351;&#29992;RETF&#25351;&#20196;&#65292;&#36825;&#26679;&#23601;&#21487;&#20197;&#21516;&#26102;&#24674;&#22797;CS&#12289;EIP&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-28_17-8-5.png" alt="images/download/attachments/1015831/image2022-6-28_17-8-5.png" width="600"  />
    </p>
<p   
>&#25152;&#20197;&#36328;&#27573;&#19981;&#25552;&#26435;&#30340;&#38271;&#35843;&#29992;&#24433;&#21709;&#30340;&#23492;&#23384;&#22120;&#23601;&#26159;&#65306;ESP&#12289;EIP&#12289;CS</p>
    </div>
    <div class="section section-6" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeWeruauteW5tuaPkOadgw">
        <h6 class="heading "><span>&#22446;&#27573;&#24182;&#25552;&#26435;</span></h6>
<p   
>&#38271;&#35843;&#29992;&#30340;&#31532;&#20108;&#31181;&#24773;&#20917;&#23601;&#26159;&#36328;&#27573;&#24182;&#25552;&#26435;&#65292;&#20854;&#19982;&#31532;&#19968;&#31181;&#24773;&#20917;&#30340;&#25351;&#20196;&#26159;&#19968;&#26679;&#30340;&#12290;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">CALL FAR CS:EIP</code></div>
</div>
    </div>
<p   
>&#36328;&#27573;&#24182;&#25552;&#26435;&#30340;&#38271;&#35843;&#29992;&#25351;&#20196;&#65292;&#34920;&#31034;&#24403;&#21069;&#25191;&#34892;&#38271;&#35843;&#29992;&#25351;&#20196;&#26102;CPL&#20026;3&#65292;&#25105;&#20204;&#35201;&#21435;&#35843;&#29992;&#30340;&#27573;CPL&#20026;0&#65292;&#25152;&#20197;&#36825;&#23601;&#20250;&#20135;&#29983;&#19968;&#20010;&#25552;&#26435;&#25805;&#20316;&#65292;&#25552;&#26435;&#20250;    <span style="color: #4c4948;">
&#25913;&#21464;    </span>
    <span style="color: #4c4948;">
CS&#30340;CPL&#65292;&#24182;&#19988;&#26681;&#25454;Intel&#30340;&#35268;&#23450;&#65292;    </span>
<strong class=" ">CS&#21644;SS&#30340;CPL&#35201;&#20445;&#25345;&#19968;&#33268;</strong>    <span style="color: #4c4948;">
&#65292;&#25152;&#20197;&#27492;&#26102;SS&#30340;&#20540;&#20063;&#20250;&#21457;&#29983;&#25913;&#21464;&#65307;&#38500;&#27492;&#20043;&#22806;&#65292;&#22240;&#20026;&#21457;&#29983;&#20102;&#25552;&#26435;&#65292;&#26632;&#20174;3&#29615;&#30340;&#26632;&#21464;&#20026;&#20102;0&#29615;&#30340;&#26632;&#65292;&#22240;&#27492;ESP&#20063;&#20250;&#21457;&#29983;&#25913;&#21464;&#12290;&#25152;&#20197;&#20026;&#20102;&#20445;&#35777;&#25105;&#20204;&#38271;&#35843;&#29992;&#23436;&#25104;&#20043;&#21518;&#36824;&#21487;&#20197;&#24674;&#22797;&#65292;&#23601;&#23558;SS&#12289;ESP&#12289;CS&#12289;&#36820;&#22238;&#22320;&#22336;&#21387;&#20837;&#26632;&#20013;&#65306;    </span>
</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-28_17-40-33.png" alt="images/download/attachments/1015831/image2022-6-28_17-40-33.png" width="600"  />
    </p>
<p   
>&#37027;&#20040;&#22312;&#35843;&#29992;&#32467;&#26463;&#20043;&#21518;&#30340;&#26632;&#21464;&#21270;&#23601;&#22914;&#19979;&#22270;&#25152;&#31034;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-28_17-50-31.png" alt="images/download/attachments/1015831/image2022-6-28_17-50-31.png" width="400"  />
    </p>
<p   
>&#25152;&#20197;&#36328;&#27573;&#24182;&#25552;&#26435;&#30340;&#38271;&#35843;&#29992;&#24433;&#21709;&#30340;&#23492;&#23384;&#22120;&#23601;&#26159;&#65306;SS&#12289;ESP&#12289;CS&#12289;EIP</p>
    </div>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeaAu-e7ky4x">
        <h5 class="heading "><span>&#24635;&#32467;</span></h5>
<ol class=" "><li class=" "><p   
>&#36328;&#27573;&#35843;&#29992;&#26102;&#65292;&#19968;&#26086;&#26377;&#26435;&#38480;&#20999;&#25442;&#65292;&#23601;&#20250;&#20999;&#25442;&#26632;&#65307;</p>
</li><li class=" "><p   
>CS&#30340;&#26435;&#38480;&#19968;&#26086;&#25913;&#21464;&#65292;SS&#30340;&#26435;&#38480;&#20063;&#35201;&#38543;&#30528;&#25913;&#21464;&#65292;CS&#19982;SS&#30340;&#31561;&#32423;&#24517;&#39035;&#19968;&#26679;&#65307;</p>
</li><li class=" "><p   
>JMP FAR&#21482;&#33021;&#36339;&#36716;&#21040;&#21516;&#32423;&#38750;&#19968;&#33268;&#20195;&#30721;&#27573;&#65292;&#20294;CALL FAR&#21487;&#20197;&#36890;&#36807;&#35843;&#29992;&#38376;&#25552;&#26435;&#65292;&#25552;&#21319;CPL&#30340;&#26435;&#38480;&#65292;&#36825;&#26679;&#23601;&#21487;&#20197;&#35843;&#29992;&#38750;&#21516;&#32423;&#27573;&#12290;</p>
</li></ol><p   
>&#22240;&#27492;&#25509;&#19979;&#26469;&#25105;&#20204;&#38656;&#35201;&#20102;&#35299;&ldquo;&#38376;&rdquo;&#30456;&#20851;&#30340;&#20869;&#23481;&#12290;</p>
    </div>
    </div>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLemXqA">
        <h3 class="heading "><span>&#38376;</span></h3>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeiwg-eUqOmXqA">
        <h4 class="heading "><span>&#35843;&#29992;&#38376;</span></h4>
<p   
>&#26080;&#35770;&#20320;&#26159;&#36328;&#27573;&#25552;&#26435;&#25110;&#19981;&#25552;&#26435;&#30340;&#38271;&#35843;&#29992;&#25351;&#20196;&#65292;&#26412;&#36136;&#19978;&#37117;&#26159;&#35201;&#36890;&#36807;&#35843;&#29992;&#38376;&#21435;&#36827;&#34892;&#30340;&#65292;&#38271;&#35843;&#29992;&#25351;&#20196;&#25191;&#34892;&#27969;&#31243;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">CALL FAR CS:EIP</code></div>
</div>
    </div>
<ol class=" "><li class=" "><p   
>&#26681;&#25454;CS&#30340;&#20540;&#26597;GDT&#34920;&#65292;&#25214;&#21040;&#23545;&#24212;&#30340;&#27573;&#25551;&#36848;&#31526;&#65292;&#36825;&#20010;&#25551;&#36848;&#31526;&#26159;&#19968;&#20010;&#35843;&#29992;&#38376;&#25551;&#36848;&#31526;&#65307;</p>
</li><li class=" "><p   
>&#22312;&#35843;&#29992;&#38376;&#25551;&#36848;&#31526;&#20013;&#25214;&#21040;&#23427;&#23384;&#20648;&#30340;&#21478;&#22806;&#19968;&#20010;&#20195;&#30721;&#27573;&#30340;&#27573;&#36873;&#25321;&#23376;&#65307;</p>
</li><li class=" "><p   
>&#25214;&#21040;&#27573;&#36873;&#25321;&#23376;&#25351;&#21521;&#30340;&#27573;&#65292;&#30495;&#27491;&#35201;&#25191;&#34892;&#30340;&#22320;&#22336;&#23601;&#26159;&#25351;&#21521;&#30340;&#27573;,Base + &#35843;&#29992;&#38376;&#25551;&#36848;&#31526;&#20013;&#30340;&#20559;&#31227;&#22320;&#22336;&#12290;</p>
</li></ol><p   
>&#35843;&#29992;&#38376;&#25551;&#36848;&#31526;&#30340;&#32467;&#26500;&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#25105;&#20204;&#21487;&#20197;&#30475;&#21040;&#23427;&#36319;&#27573;&#25551;&#36848;&#31526;&#30340;&#32467;&#26500;&#26377;&#19968;&#20123;&#24046;&#21035;&#65292;&#24403;S&#20301;&#20026;0&#21017;&#34920;&#31034;&#36825;&#26159;&#19968;&#20010;&#31995;&#32479;&#27573;&#25551;&#36848;&#31526;&#65292;&#24182;&#19988;&#24403;Type&#22495;&#20026;1100&#26102;&#21017;&#30830;&#23450;&#36825;&#26159;&#19968;&#20010;&#35843;&#29992;&#38376;&#25551;&#36848;&#31526;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-30_10-41-47.png" alt="images/download/attachments/1015831/image2022-6-30_10-41-47.png" width="600"  />
    </p>
<p   
>&#22312;&#20302;32&#20301;&#20013;&#30340;&#31532;16&#21040;31&#20301;&#23601;&#26159;&#27573;&#36873;&#25321;&#23376;&#65292;&#22312;&#20302;32&#20301;&#20013;&#31532;0&#21040;&#31532;15&#20301;&#21450;&#39640;32&#20301;&#20013;&#36807;&#30340;&#31532;16&#21040;31&#20301;&#23384;&#20648;&#30340;&#23601;&#26159;&#20559;&#31227;&#12290;</p>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeaehOmAoOiwg-eUqOmXqA">
        <h5 class="heading "><span>&#26500;&#36896;&#35843;&#29992;&#38376;</span></h5>
<p   
>&#30001;&#20110;Windows&#20013;&#27809;&#26377;&#20351;&#29992;&#35843;&#29992;&#38376;&#65292;&#25152;&#20197;&#25105;&#20204;&#38656;&#35201;&#33258;&#24049;&#21435;&#26500;&#24314;&#19968;&#20010;&#35843;&#29992;&#38376;&#65292;&#20063;&#23601;&#26159;&#21521;GDT&#34920;&#20013;&#20889;&#19968;&#20010;&#35843;&#29992;&#38376;&#25551;&#36848;&#31526;&#12290;</p>
<p   
>&#25105;&#20204;&#25353;&#32467;&#26500;&#22270;&#30340;&#26041;&#24335;&#20174;&#39640;&#20301;&#24320;&#22987;&#26500;&#24314;&#35843;&#29992;&#38376;&#25551;&#36848;&#31526;&#65292;&#39318;&#20808;&#25105;&#20204;&#19981;&#30830;&#23450;&#35201;&#21435;&#30340;&#22320;&#26041;&#26159;&#21738;&#65292;&#25152;&#20197;&#20559;&#31227;31:16&#20808;&#22635;&#19978;0&#65292;&#25509;&#30528;&#25105;&#20204;&#20043;&#21069;&#30693;&#36947;P&#20301;&#24517;&#39035;&#20026;1&#25165;&#34920;&#31034;&#36825;&#26159;&#19968;&#20010;&#26377;&#25928;&#30340;&#27573;&#25551;&#36848;&#31526;&#65292;DPL&#24517;&#39035;&#20026;3&#22240;&#20026;&#25105;&#20204;&#35201;&#20174;3&#29615;&#20351;&#29992;&#38271;&#35843;&#29992;&#25351;&#20196;&#65292;S&#20301;&#24517;&#39035;&#20026;0&#65292;Type&#22495;&#20026;1100&#65292;&#21518;&#38754;&#30340;&#31532;5&#12289;6&#12289;7&#20301;&#40664;&#35748;&#20026;0&#65292;&#31532;0&#21040;&#31532;4&#20301;&#36825;&#37324;&#20889;0&#21363;&#21487;&#65292;&#22240;&#20026;&#25105;&#20204;&#24403;&#21069;&#19981;&#38656;&#35201;&#20256;&#21442;&#65292;&#25152;&#20197;&#25105;&#20204;&#24471;&#20986;&#39640;32&#20301;&#20026;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">0000</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> -&gt; Offset</code></div>
<div class="line"><code class="value">1110</code><code class="plain"> -&gt; P、DPL、S</code></div>
<div class="line"><code class="value">1100</code><code class="plain"> -&gt; Type</code></div>
<div class="line"><code class="value">0000</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> -&gt; </code><code class="value">0</code><code class="plain"> - 7位</code></div>
<div class="line"> </div>
<div class="line"><code class="value">0x0000EC00</code></div>
</div>
    </div>
<p   
>&#20302;32&#20301;&#27573;&#36873;&#25321;&#23376;&#21487;&#20197;&#35774;&#20026;0x0008&#65288;&#23545;&#24212;0&#29615;&#20195;&#30721;&#27573;&#65289;&#12289;0x001B&#65288;&#23545;&#24212;3&#29615;&#20195;&#30721;&#27573;&#65289;&#65292;&#20559;&#31227;&#19981;&#30830;&#23450;&#25152;&#20197;&#22635;0&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">0x00080000</code></div>
</div>
    </div>
<p   
>&#26368;&#32456;&#25105;&#20204;&#24471;&#20986;&#35843;&#29992;&#38376;&#25551;&#36848;&#31526;&#20026;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">0000EC00`</code><code class="value">00080000</code></div>
</div>
    </div>
<p   
>&#25105;&#20204;&#21487;&#20197;&#22312;Windbg&#20013;&#20351;&#29992;eq&#25351;&#20196;&#35206;&#30422;GDT&#34920;&#20013;&#27809;&#26377;&#34987;&#29992;&#21040;&#30340;&#27573;&#25551;&#36848;&#31526;&#65288;&#37117;&#20026;0&#65289;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">eq 8003f048 0000EC00`</code><code class="value">00080000</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-30_11-33-33.png" alt="images/download/attachments/1015831/image2022-6-30_11-33-33.png" width="400"  />
    </p>
<p   
>&#36825;&#26679;&#25105;&#20204;&#23601;&#26500;&#24314;&#22909;&#35843;&#29992;&#38376;&#20102;&#12290;</p>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeiwg-eUqOmXqOS9v-eUqA">
        <h5 class="heading "><span>&#35843;&#29992;&#38376;&#20351;&#29992;</span></h5>
    <div class="section section-6" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeaXoOWPguaVsA">
        <h6 class="heading "><span>&#26080;&#21442;&#25968;</span></h6>
<p   
>&#25105;&#20204;&#30693;&#36947;&#22914;&#20309;&#26500;&#24314;&#35843;&#29992;&#38376;&#20102;&#65292;&#25509;&#19979;&#26469;&#25105;&#20204;&#20351;&#29992;&#35843;&#29992;&#38376;&#65292;&#22914;&#19979;&#20195;&#30721;&#25152;&#31034;&#65292;&#25105;&#20204;&#20351;&#29992;&#38271;&#35843;&#29992;&#25351;&#20196;&#65292;&#32473;&#30340;&#27573;&#36873;&#25321;&#23376;&#20026;0x48&#65292;&#36825;&#26159;&#22240;&#20026;&#23427;&#25286;&#20998;&#20986;&#26469;&#23545;&#24212;&#30340;GDT&#34920;&#30340;&#25551;&#36848;&#31526;&#27491;&#22909;&#26159;&#25105;&#20204;&#19978;&#38754;&#20889;&#20837;&#30340;&#35843;&#29992;&#38376;&#25551;&#36848;&#31526;&#65292;&#30001;&#20110;EIP&#26159;&#24223;&#24323;&#27809;&#29992;&#36807;&#30340;&#65292;&#25152;&#20197;&#25105;&#20204;&#38543;&#20415;&#36171;&#20540;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;windows.h&gt;</code></div>
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> __declspec(naked) GetRegister() {</code></div>
<div class="line"><code class="plain">    _asm {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">int</code><code class="plain"> </code><code class="value">3</code></div>
<div class="line"><code class="plain">        retf</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> buff[</code><code class="value">6</code><code class="plain">];</code></div>
<div class="line"><code class="plain">    *(DWORD*)&amp;buff[</code><code class="value">0</code><code class="plain">] = </code><code class="value">0x12345678</code><code class="plain">; </code><code class="comments">// EIP, 废弃</code></div>
<div class="line"><code class="plain">    *(WORD*)&amp;buff[</code><code class="value">4</code><code class="plain">] = </code><code class="value">0x48</code><code class="plain">; </code><code class="comments">// 段选择子</code></div>
<div class="line"><code class="plain">    _asm {</code></div>
<div class="line"><code class="plain">        call far fword ptr[buff]</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    getchar();</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>&#32780;&#25105;&#20204;&#20043;&#21069;&#26500;&#24314;&#30340;&#35843;&#29992;&#38376;&#25551;&#36848;&#31526;&#20013;&#30340;&#36873;&#25321;&#23376;&#26159;&#25351;&#21521;0&#29615;&#30340;&#20195;&#30721;&#27573;&#65292;<strong class=" ">&#22312;Windows&#37324;&#25152;&#26377;&#25968;&#25454;&#12289;&#20195;&#30721;&#27573;&#30340;Base&#37117;&#20026;0</strong>&#65292;&#25152;&#20197;&#25105;&#20204;&#30495;&#27491;&#36339;&#36716;&#30340;&#20301;&#32622;&#23601;&#26159;&#20559;&#31227;&#20301;&#25351;&#21521;&#30340;&#20869;&#23481;&#12290;&#22240;&#27492;&#65292;&#25105;&#20204;&#35201;&#36816;&#34892;&#22914;&#19978;&#36825;&#27573;&#20195;&#30721;&#30340;&#35805;&#19968;&#23450;&#26159;&#25253;&#38169;&#30340;&#65292;&#22240;&#20026;&#25105;&#20204;&#32473;&#30340;&#20559;&#31227;&#20301;&#32622;&#26159;0&#65292;&#25105;&#20204;&#39044;&#26399;&#25928;&#26524;&#26159;&#24819;&#35201;&#38271;&#36339;&#36716;&#21040;GetRegister&#20989;&#25968;&#65292;&#25152;&#20197;&#25105;&#20204;&#21487;&#20197;&#19979;&#26029;&#28857;&#20808;&#23558;&#35813;&#20989;&#25968;&#30340;&#22320;&#22336;&#33719;&#21462;&#19979;&#26469;&#12290;</p>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#25105;&#20204;&#33719;&#24471;GetRegister&#20989;&#25968;&#30340;&#20989;&#25968;&#22320;&#22336;0x0040B4B0&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-30_14-35-24.png" alt="images/download/attachments/1015831/image2022-6-30_14-35-24.png" width="400"  />
    </p>
<p   
>&#25152;&#20197;&#25105;&#20204;&#21487;&#20197;&#23558;&#35843;&#29992;&#38376;&#25551;&#36848;&#31526;&#25353;&#26684;&#24335;&#37325;&#26032;&#20889;&#20837;GDT&#34920;&#20013;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">0040EC00`0008B4B0</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-30_14-41-47.png" alt="images/download/attachments/1015831/image2022-6-30_14-41-47.png" width="400"  />
    </p>
<p   
>&#36825;&#26679;&#25105;&#20204;&#36816;&#34892;&#20195;&#30721;&#26102;&#20505;&#38271;&#36339;&#36716;&#21040;GetRegister&#20989;&#25968;&#25191;&#34892;&#65292;&#35813;&#20989;&#25968;&#20869;&#26377;&#19968;&#20010;INT 3&#65292;&#36825;&#26159;&#29992;&#26469;&#26029;&#28857;&#30340;&#65288;&#36319;&#36719;&#20214;&#35843;&#35797;&#26377;&#20851;&#65292;&#21407;&#29702;&#22312;&#21518;&#32493;&#31456;&#33410;&#20013;&#35762;&#35299;&#65289;&#65292;&#25152;&#20197;&#20195;&#30721;&#25191;&#34892;&#21040;&#35813;&#20989;&#25968;&#26102;&#20505;&#23601;&#20250;&#20013;&#26029;&#65307;&#24182;&#19988;&#25105;&#20204;&#38656;&#35201;&#27880;&#24847;<strong class=" ">&#34429;&#28982;&#24403;&#21069;&#20195;&#30721;&#26159;&#22312;&#20302;2G&#20013;&#65292;&#20294;&#26159;&#36890;&#36807;&#35843;&#29992;&#38376;&#36825;&#27573;&#20195;&#30721;&#30340;&#26435;&#38480;&#23601;&#24050;&#32463;&#25552;&#21319;&#20026;0&#29615;&#30340;&#26435;&#38480;&#20102;</strong>&#65292;&#20063;&#22240;&#27492;&#65292;&#25105;&#20204;<strong class=" ">&#22312;3&#29615;&#26159;&#27809;&#27861;&#25429;&#25417;&#21040;&#36825;&#20010;&#26029;&#28857;&#30340;&#65292;&#21482;&#33021;&#22312;0&#29615;&#30340;&#35843;&#35797;&#22120;&#20013;&#21435;&#25429;&#25417;</strong>&#65292;&#20063;&#23601;&#26159;&#20013;&#26029;&#21040;&#25105;&#20204;&#30340;Windbg&#35843;&#35797;&#22120;&#12290;</p>
<p   
>&#25105;&#20204;&#25191;&#34892;&#36825;&#27573;&#20195;&#30721;&#20250;&#21457;&#29616;&#65292;Windbg&#30830;&#23454;&#26377;&#21453;&#24212;&#65292;&#24182;&#19988;&#25552;&#31034;&#25105;&#20204;&#22312;&#36825;&#20010;&#22320;&#22336;&#20013;&#26029;&#20102;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-30_15-53-26.png" alt="images/download/attachments/1015831/image2022-6-30_15-53-26.png" width="400"  />
    </p>
<p   
>&#25105;&#20204;&#20063;&#21487;&#20197;&#23545;&#27604;&#19979;&#38271;&#35843;&#29992;&#21069;&#21518;&#30340;&#23492;&#23384;&#22120;&#20449;&#24687;&#65292;&#21457;&#29616;SS&#12289;ESP&#12289;CS&#23492;&#23384;&#22120;&#37117;&#21457;&#29983;&#20102;&#21464;&#21270;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-30_15-59-35.png" alt="images/download/attachments/1015831/image2022-6-30_15-59-35.png" width="600"  />
    </p>
<p   
>&#24182;&#19988;&#25105;&#20204;&#35266;&#23519;&#26632;&#30340;&#20869;&#23481;&#65292;&#20250;&#21457;&#29616;&#30830;&#23454;&#26159;&#22914;&#25105;&#20204;&#20043;&#21069;&#25152;&#30475;&#30340;&#38271;&#35843;&#29992;&#26435;&#38480;&#25552;&#21319;&#30340;&#26632;&#22270;&#19968;&#26679;&#65292;&#23558;SS&#12289;ESP&#12289;CS&#12289;&#36820;&#22238;&#22320;&#22336;&#21387;&#20837;&#26632;&#20013;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-30_16-19-51.png" alt="images/download/attachments/1015831/image2022-6-30_16-19-51.png" width="600"  />
    </p>
    </div>
    <div class="section section-6" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeacieWPguaVsA">
        <h6 class="heading "><span>&#26377;&#21442;&#25968;</span></h6>
<p   
>&#20043;&#21069;&#25105;&#20204;&#20351;&#29992;&#35843;&#29992;&#38376;&#26102;&#27809;&#26377;&#20256;&#36882;&#21442;&#25968;&#65292;&#20294;&#23454;&#38469;&#19978;&#35843;&#29992;&#38376;&#26159;&#25903;&#25345;&#21442;&#25968;&#20256;&#36882;&#30340;&#65292;&#25152;&#20197;&#25105;&#20204;&#26469;&#30475;&#19979;&#22914;&#20309;&#23454;&#29616;&#12290;</p>
<p   
>&#26681;&#25454;&#35843;&#29992;&#38376;&#32467;&#26500;&#25105;&#20204;&#30693;&#36947;&#23427;&#30340;&#39640;32&#20301;&#31532;0&#20301;&#33267;4&#20301;&#34920;&#31034;&#30340;&#23601;&#26159;&#21442;&#25968;&#25968;&#37327;&#65292;&#20063;&#23601;&#26159;&#20320;&#35201;&#20256;&#36882;&#30340;&#21442;&#25968;&#30340;&#20010;&#25968;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-30_10-41-47.png" alt="images/download/attachments/1015831/image2022-6-30_10-41-47.png" width="600"  />
    </p>
<p   
>&#25152;&#20197;&#25105;&#20204;&#21487;&#20197;&#32473;&#20043;&#21069;&#26500;&#24314;&#30340;&#35843;&#29992;&#38376;&#25551;&#36848;&#31526;&#28155;&#21152;&#19978;&#21442;&#25968;&#20010;&#25968;3&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">0040EC03`0008B4B0</code></div>
</div>
    </div>
<p   
>&#25509;&#19979;&#26469;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;&#22914;&#19979;&#20195;&#30721;&#21435;&#20351;&#29992;&#21442;&#25968;&#65292;&#36890;&#36807;push&#21387;&#20837;&#21442;&#25968;&#65292;&#35843;&#29992;&#26102;&#26681;&#25454;ESP&#23547;&#22336;&#33719;&#21462;&#21442;&#25968;&#65292;&#26377;&#20010;&#32454;&#33410;&#38656;&#35201;&#27880;&#24847;&#36825;&#37324;&#30001;&#20110;&#25105;&#20204;&#21387;&#20837;&#20102;3&#20010;&#21442;&#25968;&#65292;&#23548;&#33268;&#26632;&#21457;&#29983;&#20102;&#21464;&#21270;&#65292;&#25152;&#20197;&#20351;&#29992;RETF&#25351;&#20196;&#26102;&#20505;&#38656;&#35201;&#21152;&#19978;0xC&#65292;&#36825;&#26679;&#25191;&#34892;&#23436;&#20195;&#30721;&#21518;&#25165;&#33021;&#20445;&#25345;&#26632;&#24179;&#34913;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;windows.h&gt;</code></div>
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> a,b,c = </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> o_eax = </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> __declspec(naked) GetParam() {</code></div>
<div class="line"><code class="plain">    _asm {</code></div>
<div class="line"><code class="plain">        mov o_eax, eax</code></div>
<div class="line"><code class="plain">        mov eax, [esp+</code><code class="value">8</code><code class="plain">]</code></div>
<div class="line"><code class="plain">        mov c, eax</code></div>
<div class="line"><code class="plain">        mov eax, [esp+</code><code class="value">0xC</code><code class="plain">]</code></div>
<div class="line"><code class="plain">        mov b, eax</code></div>
<div class="line"><code class="plain">        mov eax, [esp+</code><code class="value">0x10</code><code class="plain">]</code></div>
<div class="line"><code class="plain">        mov a, eax</code></div>
<div class="line"><code class="plain">        mov eax, o_eax</code></div>
<div class="line"><code class="plain">            </code></div>
<div class="line"><code class="plain">        retf </code><code class="value">0xC</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> buff[</code><code class="value">6</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    *(DWORD*)&amp;buff[</code><code class="value">0</code><code class="plain">] = </code><code class="value">0x12345678</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    *(WORD*)&amp;buff[</code><code class="value">4</code><code class="plain">] = </code><code class="value">0x48</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    _asm {</code></div>
<div class="line"><code class="plain">        push </code><code class="value">1</code></div>
<div class="line"><code class="plain">        push </code><code class="value">2</code></div>
<div class="line"><code class="plain">        push </code><code class="value">3</code></div>
<div class="line"><code class="plain">        call far fword ptr[buff]</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"%d %d %d"</code><code class="plain">, a, b, c);</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    getchar();</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>&#25105;&#20204;&#25191;&#34892;&#36825;&#27573;&#31243;&#24207;&#21457;&#29616;&#30830;&#23454;&#21487;&#20197;&#36890;&#36807;&#36825;&#31181;&#26041;&#24335;&#33719;&#21462;&#21040;&#20256;&#36882;&#30340;&#21442;&#25968;&#20540;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-30_17-16-52.png" alt="images/download/attachments/1015831/image2022-6-30_17-16-52.png" width="600"  />
    </p>
<p   
>&#37027;&#20040;&#20026;&#20160;&#20040;&#20195;&#30721;&#20013;&#20351;&#29992;ESP&#23547;&#22336;&#26159;&#36825;&#20010;&#23545;&#24212;&#30340;&#20559;&#31227;&#37327;&#21602;&#65292;&#25105;&#20204;&#38656;&#35201;&#22312;&#27719;&#32534;&#20013;&#20889;&#20837;&#19968;&#20010;INT 3&#25351;&#20196;&#35753;&#31243;&#24207;&#20013;&#26029;&#22312;Windbg&#20013;&#65292;&#35266;&#23519;&#19968;&#19979;&#26632;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-30_17-19-16.png" alt="images/download/attachments/1015831/image2022-6-30_17-19-16.png" width="600"  />
    </p>
<p   
>&#26681;&#25454;&#26632;&#25105;&#20204;&#30693;&#36947;&#25105;&#20204;&#20256;&#36882;&#30340;&#21442;&#25968;&#26159;&#22841;&#22312;&#35843;&#29992;&#32773;ESP&#21644;&#35843;&#29992;&#32773;CS&#20013;&#38388;&#30340;&#65292;&#20063;&#23601;&#26159;&#22914;&#19979;&#22270;&#23637;&#31034;&#30340;&#36825;&#26679;&#65306;</p>
<p   
><img  class="confluence-embedded-image confluence-thumbnail"  src="images/download/thumbnails/1015831/image2022-6-30_17-22-35.png" alt="images/download/thumbnails/1015831/image2022-6-30_17-22-35.png" width="150"  />
    </p>
<p   
>&#25152;&#20197;&#22312;&#20195;&#30721;&#20013;&#25105;&#20204;&#23601;&#21487;&#20197;&#20998;&#21035;&#20351;&#29992;0x8&#12289;0xC&#12289;0x10&#20559;&#31227;&#37327;&#21435;&#23558;&#21442;&#25968;&#21462;&#20986;&#26469;&#12290;</p>
    </div>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeaAu-e7ky4y">
        <h5 class="heading "><span>&#24635;&#32467;</span></h5>
<ol class=" "><li class=" "><p   
>&#24403;&#36890;&#36807;&#38376;&#65292;&#26435;&#38480;&#19981;&#21464;&#26102;&#65292;&#21482;&#20250;PUSH&#20004;&#20010;&#20540;&#65306;CS&#21644;&#36820;&#22238;&#22320;&#22336;&#65292;&#26032;&#30340;CS&#30340;&#20540;&#30001;&#35843;&#29992;&#38376;&#20915;&#23450;&#65307;</p>
</li><li class=" "><p   
>&#24403;&#36890;&#36807;&#38376;&#65292;&#26435;&#38480;&#25913;&#21464;&#30340;&#26102;&#20505;&#65292;&#20250;PUSH&#22235;&#20010;&#20540;&#65306;SS&#65292;ESP&#65292;CS&#65292;&#36820;&#22238;&#22320;&#22336;&#65292;&#26032;&#30340;CS&#30001;&#35843;&#29992;&#38376;&#20915;&#23450;&#65292;&#26032;&#30340;SS&#21644;ESP&#30001;TSS&#25552;&#20379;&#65288;&#21518;&#38754;&#20250;&#35762;TSS&#65289;&#65307;</p>
</li><li class=" "><p   
>&#36890;&#36807;&#35843;&#29992;&#38376;&#26102;&#65292;&#30001;&#35843;&#29992;&#38376;&#20915;&#23450;&#35201;&#25191;&#34892;&#30340;&#20195;&#30721;&#65292;&#20294;&#20351;&#29992;RETF&#36820;&#22238;&#26102;&#65292;&#30001;&#26632;&#20013;&#21387;&#20837;&#30340;&#20540;&#20915;&#23450;&#65292;&#20063;&#23601;&#26159;&#35828;&#65292;&#36827;&#38376;&#26102;&#21482;&#33021;&#25353;&#25351;&#23450;&#36335;&#32447;&#36208;&#65292;&#20986;&#38376;&#26102;&#21487;&#20197;&#32763;&#22681;&#65288;&#21482;&#35201;&#25913;&#21464;&#26632;&#37324;&#38754;&#30340;&#20540;&#23601;&#21487;&#20197;&#24819;&#21435;&#21738;&#21435;&#21738;&#65289;&#65307;</p>
</li><li class=" "><p   
>&#21487;&#19981;&#21487;&#20197;&#20877;&#24314;&#20010;&#38376;&#20986;&#21435;&#21602;&#65311;&#20063;&#23601;&#26159;&#29992;CALL&#25351;&#20196;&#65292;&#24403;&#28982;&#21487;&#20197;&#65292;&#21069;&#38376;&#36827;&#65292;&#21518;&#38376;&#20986;&#12290;</p>
</li></ol>    </div>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeS4reaWremXqA">
        <h4 class="heading "><span>&#20013;&#26029;&#38376;</span></h4>
<p   
>Windows&#27809;&#26377;&#20351;&#29992;&#35843;&#29992;&#38376;&#65292;&#20294;&#26159;&#20351;&#29992;&#20102;&#20013;&#26029;&#38376;&#65292;&#24403;&#25105;&#20204;&#26377;&#20102;&#35843;&#29992;&#38376;&#30340;&#22522;&#30784;&#20043;&#21518;&#65292;&#20013;&#26029;&#38376;&#30340;&#23398;&#20064;&#23601;&#24456;&#36731;&#26494;&#20102;&#12290;</p>
<p   
>&#20013;&#26029;&#38376;&#26377;&#20004;&#20010;&#22330;&#26223;&#65306;<strong class=" ">1.&#31995;&#32479;&#35843;&#29992;&#65306;</strong>&#22823;&#23478;&#22312;&#24320;&#21457;&#24212;&#29992;&#31243;&#24207;&#26102;&#37117;&#20250;&#20351;&#29992;&#21040;Windows&#25552;&#20379;&#30340;API&#65292;&#36825;&#20123;API&#22312;&#25191;&#34892;&#30340;&#36807;&#31243;&#20013;&#38656;&#35201;&#20174;3&#29615;&#19968;&#27493;&#19968;&#27493;&#36827;&#20837;&#21040;0&#29615;&#65292;&#36825;&#19968;&#36807;&#31243;&#23601;&#26159;&#31995;&#32479;&#35843;&#29992;&#65292;&#22312;&#36825;&#20010;&#36807;&#31243;&#20013;&#20063;&#29992;&#21040;&#20102;&#20013;&#26029;&#38376;&#65288;&#19968;&#20123;&#27604;&#36739;&#32769;&#30340;API&#20351;&#29992;&#30340;&#26159;&#20013;&#26029;&#38376;&#65292;&#20294;&#26159;&#26032;API&#20013;&#20351;&#29992;&#30340;&#37117;&#26159;&#24555;&#36895;&#35843;&#29992;&#65289;<strong class=" ">&#65307;2.&#35843;&#35797;&#65306;</strong>&#22823;&#23478;&#20351;&#29992;OD&#35843;&#35797;&#31243;&#24207;&#26102;&#20505;&#20250;&#20351;&#29992;&#26029;&#28857;&#65292;&#26029;&#28857;&#26412;&#36136;&#19978;&#23601;&#26159;&#22312;&#20320;&#36873;&#20013;&#30340;&#36825;&#19968;&#34892;&#20013;&#20889;&#20837;&#19968;&#20010;&#23383;&#33410;0xCC&#65292;&#20063;&#23601;&#26159;INT 3&#25351;&#20196;&#65292;&#36825;&#20010;&#25351;&#20196;&#23601;&#26159;&#29992;&#26469;&#25191;&#34892;&#20013;&#26029;&#38376;&#30340;&#12290;</p>
<p   
>&#20013;&#26029;&#38376;&#20063;&#26377;&#19968;&#24352;&#34920;&#65292;&#25105;&#20204;&#31216;&#20043;&#20026;IDT&#65288;&#20013;&#26029;&#25551;&#36848;&#31526;&#34920;&#65289;&#65292;&#19982;GDT&#19968;&#26679;&#65292;IDT&#20063;&#26159;&#30001;&#19968;&#31995;&#21015;&#25551;&#36848;&#31526;&#32452;&#25104;&#30340;&#65292;&#27599;&#20010;&#25551;&#36848;&#31526;&#21344;8&#23383;&#33410;&#65292;&#38656;&#35201;&#27880;&#24847;&#30340;&#26159;IDT&#34920;&#20013;&#30340;&#31532;&#19968;&#20010;&#20803;&#32032;&#19981;&#26159;NULL&#65288;GDT&#26159;&#65289;&#12290;</p>
<p   
>&#19982;GDT&#19968;&#26679;&#65292;&#25105;&#20204;&#20063;&#21487;&#20197;&#22312;Windbg&#20013;&#26597;&#30475;IDT&#34920;&#30340;&#22522;&#22336;&#21644;&#38271;&#24230;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">r idtr</code></div>
<div class="line"><code class="plain">r idtl</code></div>
</div>
    </div>
<p   
>&#22312;IDT&#34920;&#20013;&#26377;3&#31181;&#38376;&#25551;&#36848;&#31526;&#65306;1.&#20219;&#21153;&#38376;&#25551;&#36848;&#31526;&#65307;2.&#20013;&#26029;&#38376;&#25551;&#36848;&#31526;&#65307;3.&#38519;&#38449;&#38376;&#25551;&#36848;&#31526;&#12290;&#25105;&#20204;&#26469;&#30475;&#19968;&#19979;&#20013;&#26029;&#38376;&#25551;&#36848;&#31526;&#30340;&#32467;&#26500;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-6-30_17-50-47.png" alt="images/download/attachments/1015831/image2022-6-30_17-50-47.png" width="400"  />
    </p>
<p   
>&#25105;&#20204;&#20250;&#21457;&#29616;&#20013;&#26029;&#38376;&#25551;&#36848;&#31526;&#19982;&#35843;&#29992;&#38376;&#25551;&#36848;&#31526;&#24046;&#21035;&#19981;&#26159;&#24456;&#22823;&#65292;&#20854;&#20013;&#23427;&#22810;&#20102;&#19968;&#20010;D&#20301;&#65292;&#35813;&#20540;&#20026;0&#26102;&#34920;&#31034;16&#20301;&#20013;&#26029;&#38376;&#65292;&#20026;1&#26102;&#34920;&#31034;32&#20301;&#20013;&#26029;&#38376;&#65292;&#20854;&#20182;&#30340;&#37117;&#19968;&#26679;&#12290;</p>
<p   
>&#25509;&#30528;&#25105;&#20204;&#26469;&#30475;&#19968;&#19979;&#20013;&#26029;&#38376;&#30340;&#25191;&#34892;&#27969;&#31243;&#65292;&#23454;&#38469;&#19978;&#21644;&#35843;&#29992;&#38376;&#24046;&#21035;&#19981;&#26159;&#24456;&#22823;&#65292;&#21487;&#20197;&#31867;&#27604;&#30340;&#26469;&#30475;&#65306;</p>
<ul class=" "><li class=" "><p   
>&#25191;&#34892;&#35843;&#29992;&#38376;&#30340;&#25351;&#20196;&#65306;CALL CS:EIP&#65292;&#20854;&#20013;CS&#26159;&#27573;&#36873;&#25321;&#23376;&#65292;&#21253;&#21547;&#20102;&#26597;&#25214;GDT&#34920;&#30340;&#26159;&#19968;&#20010;&#32034;&#24341;&#65307;</p>
</li><li class=" "><p   
>&#25191;&#34892;&#20013;&#26029;&#38376;&#30340;&#25351;&#20196;&#65306;INT N&#65292;&#20854;&#20013;N&#26159;IDT&#34920;&#30340;&#19968;&#20010;&#32034;&#24341;&#12290;</p>
</li></ul><p   
>&#25191;&#34892;&#27969;&#31243;&#23601;&#21482;&#26377;&#36825;&#20010;&#24046;&#21035;&#65292;&#24403;CPU<strong class=" ">&#36890;&#36807;N&#36825;&#20010;&#32034;&#24341;&#22312;IDT&#34920;&#20013;&#25214;</strong>&#21040;&#20102;&#20013;&#26029;&#38376;&#25551;&#36848;&#31526;&#21518;&#65292;&#25191;&#34892;&#30340;&#27493;&#39588;&#23601;&#21644;&#35843;&#29992;&#38376;&#30340;&#27493;&#39588;&#23436;&#20840;&#19968;&#26679;&#20102;&#65292;&#21487;&#20197;&#21442;&#32771;&#35843;&#29992;&#38376;&#30340;&#25191;&#34892;&#27969;&#31243;&#12290;</p>
<p   
>&#24403;&#25214;&#21040;&#20013;&#26029;&#38376;&#25551;&#36848;&#31526;&#21518;&#65292;CPU&#36824;&#26159;&#20250;&#36890;&#36807;&#20013;&#26029;&#38376;&#25551;&#36848;&#31526;&#37324;&#30340;&#27573;&#36873;&#25321;&#23376;&#65292;&#21435;GDT&#34920;&#20013;&#25214;&#21040;&#23545;&#24212;&#30340;&#27573;&#25551;&#36848;&#31526;&#65292;<strong class=" ">&#27573;&#25551;&#36848;&#31526;&#30340;&#22522;&#22336;&#21152;&#19978;&#24403;&#21069;&#20013;&#26029;&#38376;&#25551;&#36848;&#31526;&#30340;&#27573;&#20869;&#20559;&#31227;&#23601;&#26159;&#38656;&#35201;&#36339;&#36716;&#20195;&#30721;&#27573;&#30340;&#22320;&#22336;</strong>&#12290;&#25152;&#20197;&#35828;&#20013;&#26029;&#38376;&#30340;&#25191;&#34892;&#20250;&#26597;&#25214;&#20004;&#24352;&#34920;&#65292;&#20808;&#26597;&#25214;IDT&#34920;&#65292;&#20877;&#26597;&#25214;GDT&#34920;&#12290;</p>
<p   
><strong class=" ">&#19982;&#35843;&#29992;&#38376;&#20351;&#29992;&#38271;&#36820;&#22238;RETF&#19981;&#21516;&#65292;&#20013;&#26029;&#38376;&#20351;&#29992;&#20013;&#26029;&#36820;&#22238;&#25351;&#20196;&#65306;IRET/IRETD&#12290;</strong></p>
<p   
>INT N&#25351;&#20196;&#65306;</p>
<ul class=" "><li class=" "><p   
>&#22312;&#27809;&#26377;&#26435;&#38480;&#20999;&#25442;&#26102;&#65292;&#20250;&#21521;&#26632;&#21387;&#20837;3&#20010;&#20540;&#65292;&#20998;&#21035;&#26159;CS&#65292;EFLAG&#65292;&#36820;&#22238;&#22320;&#22336;&#65307;</p>
</li><li class=" "><p   
>&#22312;&#26377;&#26435;&#38480;&#20999;&#25442;&#26102;&#65292;&#20250;&#21521;&#26632;&#21387;&#20837;5&#20010;&#20540;&#65292;&#20998;&#21035;&#26159;SS&#65292;ESP&#65292;EFLAG&#65292;CS&#65292;&#36820;&#22238;&#22320;&#22336;&#12290;</p>
</li></ul><p   
>&#36825;&#20063;&#26159;&#19982;&#35843;&#29992;&#38376;&#19981;&#21516;&#30340;&#22320;&#26041;&#65292;&#20013;&#26029;&#38376;&#20250;&#22810;&#21387;&#20837;&#19968;&#20010;&#20540;&#65292;&#36825;&#20063;&#23601;&#35828;&#26126;EFLAG&#36890;&#36807;&#20013;&#26029;&#38376;&#36328;&#27573;&#26102;&#65292;&#20540;&#20250;&#25913;&#21464;&#12290;</p>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLemZt-mYsemXqA">
        <h4 class="heading "><span>&#38519;&#38449;&#38376;</span></h4>
<p   
>&#38519;&#36827;&#38376;&#19982;&#20013;&#26029;&#38376;&#20960;&#20046;&#26159;&#19968;&#26679;&#30340;&#65292;&#38519;&#38449;&#38376;&#25551;&#36848;&#31526;&#20063;&#23384;&#20648;&#22312;IDT&#34920;&#20013;&#65292;&#20854;&#19982;&#20013;&#26029;&#38376;&#25551;&#36848;&#31526;&#21807;&#19968;&#19981;&#21516;&#30340;&#26159;&#39640;32&#20301;&#30340;&#31532;8&#20301;&#20026;1&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-2_16-40-36.png" alt="images/download/attachments/1015831/image2022-7-2_16-40-36.png" width="400"  />
    <br/>&#38500;&#27492;&#20043;&#22806;    <span style="color: #4c4948;">
&#38519;&#38449;&#38376;&#21644;&#20013;&#26029;&#38376;&#30340;&#21306;&#21035;&#22312;&#20110;&#65292;&#20013;&#26029;&#38376;&#25191;&#34892;&#21518;EFLAG&#23492;&#23384;&#22120;&#30340;&#20540;&#21457;&#29983;&#20102;&#25913;&#21464;&#65292;&#32780;&#38519;&#38449;&#38376;&#19981;&#20250;&#25913;&#21464;EFLAG&#30340;&#20540;&#12290;    </span>
</p>
<p   
>    <span style="color: #4c4948;">
&#20013;&#26029;&#38376;&#20250;&#20462;&#25913;EFLAG&#23492;&#23384;&#22120;&#20013;&#30340;IF&#20301;&#30340;&#20540;&#65292;    <span style="color: #4c4948;">
IF&#26631;&#24535;&#26159;&#29992;&#20110;&#25511;&#21046;&#22788;&#29702;&#22120;&#23545;&#21487;&#23631;&#34109;&#20013;&#26029;&#35831;&#27714;&#30340;&#21709;&#24212;&#12290;    </span>
<strong class=" ">&#32622;1&#20197;&#21709;&#24212;&#21487;&#23631;&#34109;&#20013;&#26029;</strong>    <span style="color: #4c4948;">
&#65292;    </span>
<strong class=" ">&#21453;&#20043;&#21017;&#31105;&#27490;&#21487;&#23631;&#34109;&#20013;&#26029;</strong>    <span style="color: #4c4948;">
&#12290;IF&#26631;&#24535;    </span>
<strong class=" ">&#23545;&#19981;&#21487;&#23631;&#34109;&#20013;&#26029;&#27809;&#26377;&#24433;&#21709;</strong>    <span style="color: #4c4948;">
&#12290;    </span>
    </span>
</p>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeS7u-WKoeautQ">
        <h4 class="heading "><span>&#20219;&#21153;&#27573;</span></h4>
<p   
>&#22312;&#20197;&#19978;&#31456;&#33410;&#20013;&#25105;&#20204;&#20102;&#35299;&#21040;&#24403;&#20351;&#29992;&#35843;&#29992;&#12289;&#20013;&#26029;&#12289;&#38519;&#38449;&#38376;&#26102;&#65292;&#24403;&#20986;&#29616;&#26435;&#38480;&#20999;&#25442;&#30340;&#26102;&#20505;&#26632;&#20063;&#20250;&#38543;&#20043;&#20999;&#25442;&#65292;&#24182;&#19988;&#30001;&#20110;CS&#30340;CPL&#21457;&#29983;&#20102;&#25913;&#21464;&#65292;&#20063;&#23601;&#23548;&#33268;SS&#24517;&#39035;&#36827;&#34892;&#20999;&#25442;&#12290;<strong class=" ">&#25105;&#20204;&#30693;&#36947;CS&#30340;&#20540;&#26159;&#30001;&#38376;&#26469;&#25351;&#23450;&#30340;&#65292;&#20294;&#26159;ESP&#21644;SS&#21602;&#65311;&#23427;&#20204;&#22522;&#20110;TSS&#65288;Task-state segement&#65292;&#20219;&#21153;&#27573;&#65289;&#24471;&#21040;&#30340;&#20540;&#12290;</strong></p>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVRTU-e7k-aehA">
        <h5 class="heading "><span>TSS&#32467;&#26500;</span></h5>
<p   
>TSS&#26412;&#36136;&#19978;&#23601;&#26159;&#19968;&#22359;&#20869;&#23384;&#65292;&#36825;&#22359;&#20869;&#23384;&#30340;&#22823;&#23567;&#26159;104&#23383;&#33410;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#23601;&#26159;&#23427;&#30340;&#32467;&#26500;&#65292;&#25105;&#20204;&#21487;&#20197;&#30475;&#35265;TSS&#37324;&#21253;&#21547;&#20102;&#25152;&#26377;&#23492;&#23384;&#22120;&#30340;&#20540;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-6_9-58-44.png" alt="images/download/attachments/1015831/image2022-7-6_9-58-44.png" width="400"  />
    </p>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVRTU-S9nOeUqA">
        <h5 class="heading "><span>TSS&#20316;&#29992;</span></h5>
<p   
>Intel&#30340;&#35774;&#35745;&#24605;&#24819;&#23601;&#26159;<strong class=" ">&#24403;&#20320;&#35201;&#21435;&#21019;&#24314;&#19968;&#20010;&#26032;&#30340;&#20219;&#21153;&#65288;&#32447;&#31243;&#65289;&#26102;&#24212;&#35813;&#26377;&#19968;&#20010;&#26032;&#30340;&#29615;&#22659;&#65292;&#32780;&#19981;&#26159;&#22522;&#20110;&#32769;&#30340;&#29615;&#22659;&#21435;&#20570;</strong>&#65292;&#36825;&#20063;&#23601;&#38656;&#35201;&#25442;&#25481;&#20320;&#30340;&#25152;&#26377;&#23492;&#23384;&#22120;&#65292;&#22240;&#27492;&#20320;&#21487;&#20197;&#20174;TSS&#20013;&#25226;&#21508;&#20540;&#25289;&#36807;&#26469;&#32473;&#21040;&#23492;&#23384;&#22120;&#65292;&#24182;&#19988;&#23558;&#21407;&#20808;&#30340;&#23492;&#23384;&#22120;&#30340;&#20540;&#20877;&#25918;&#20837;TSS&#20013;&#65292;&#36825;&#26679;&#21487;&#20197;&#30452;&#25509;&#24674;&#22797;&#21407;&#20808;&#30340;&#29615;&#22659;&#12290;</p>
<p   
>&#20294;&#36825;&#21482;&#26159;Intel&#30340;&#35774;&#35745;&#24605;&#24819;&#65292;&#25805;&#20316;&#31995;&#32479;&#24182;&#27809;&#26377;&#36825;&#26679;&#20570;&#65292;&#25152;&#20197;&#25105;&#20204;&#29702;&#35299;TSS&#30340;&#35805;&#65292;<strong class=" ">&#21482;&#38656;&#35201;&#30693;&#36947;&#23427;&#21487;&#20197;&#19968;&#27425;&#24615;&#25442;&#25481;&#25152;&#26377;&#30340;&#23492;&#23384;&#22120;&#21363;&#21487;</strong>&#12290;</p>
<p   
>&#37027;&#20040;&#25105;&#20204;&#20063;&#21487;&#20197;&#26681;&#25454;TSS&#30340;&#32467;&#26500;&#30693;&#36947;&#65292;&#37324;&#38754;&#30340;ESP0&#12289;ESP1&#12289;ESP2&#23601;&#34920;&#31034;0&#29615;&#12289;1&#29615;&#12289;2&#29615;&#65292;SS[0-2]&#20063;&#26159;&#22914;&#27492;&#65292;&#25152;&#20197;&#25105;&#20204;&#20063;&#23601;&#30693;&#36947;&#26435;&#38480;&#20999;&#25442;&#26102;ESP&#12289;SS&#30340;&#20540;&#26159;&#20174;TSS&#20013;&#33719;&#21462;&#30340;&#12290;</p>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLea1geeoiy4x">
        <h5 class="heading "><span>&#27969;&#31243;</span></h5>
<p   
>CPU&#21462;&#20540;&#30340;&#27969;&#31243;&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#26681;&#25454;TR&#23492;&#23384;&#22120;&#65288;Task Register&#65289;&#30340;&#27573;&#36873;&#25321;&#23376;&#21040;GDT&#34920;&#20013;&#25214;&#21040;TSS&#27573;&#25551;&#36848;&#31526;&#65292;&#24471;&#21040;&#20102;TSS&#30340;&#22522;&#22336;&#12289;&#20197;&#21450;&#27573;&#22823;&#23567;&#65292;&#36825;&#26679;&#23601;&#33021;&#23450;&#20301;&#21040;TSS&#36825;&#22359;&#20869;&#23384;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-6_10-22-27.png" alt="images/download/attachments/1015831/image2022-7-6_10-22-27.png" width="600"  />
    </p>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVRTU-auteaPj-i_sOespg">
        <h5 class="heading "><span>TSS&#27573;&#25551;&#36848;&#31526;</span></h5>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#23601;&#26159;TSS&#27573;&#25551;&#36848;&#31526;&#30340;&#32467;&#26500;&#65292;TSS&#27573;&#25551;&#36848;&#31526;&#20063;&#23646;&#20110;&#31995;&#32479;&#27573;&#25551;&#36848;&#31526;&#30340;&#19968;&#31181;&#65292;&#25152;&#20197;&#39640;4&#23383;&#33410;&#30340;&#31532;12&#20301;&#20026;0&#65292;<strong class=" ">&#24403;Type&#20301;&#20026;1001&#25110;1011&#23601;&#34920;&#31034;&#24403;&#21069;&#26159;TSS&#27573;&#25551;&#36848;&#31526;&#65292;&#21069;&#32773;&#34920;&#31034;&#24403;&#21069;&#27573;&#25551;&#36848;&#31526;&#27809;&#26377;&#34987;&#21152;&#36733;&#21040;TR&#23492;&#23384;&#22120;&#20013;&#65292;&#21518;&#32773;&#21017;&#21453;&#20043;</strong>&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-6_10-46-30.png" alt="images/download/attachments/1015831/image2022-7-6_10-46-30.png" width="600"  />
    </p>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVRS5q615a-E5a2Y5Zmo">
        <h5 class="heading "><span>TR&#27573;&#23492;&#23384;&#22120;</span></h5>
<p   
>&#25105;&#20204;&#24819;&#35835;&#20889;TR&#27573;&#23492;&#23384;&#22120;&#30340;&#35805;&#19981;&#33021;&#20351;&#29992;MOV&#25351;&#20196;&#65292;&#38656;&#35201;&#20351;&#29992;&#21040;LTR&#12289;STR&#25351;&#20196;&#12290;</p>
<p   
><strong class=" ">LTR&#25351;&#20196;&#21487;&#20197;&#23558;TSS&#27573;&#25551;&#36848;&#31526;&#21152;&#36733;&#21040;TR&#23492;&#23384;&#22120;&#20013;</strong>&#65292;&#20294;&#21482;&#33021;&#25913;&#21464;TR&#23492;&#23384;&#22120;&#30340;&#20540;&#65288;96&#20301;&#65289;&#65292;&#24182;&#19981;&#20250;&#25913;&#21464;TSS&#65307;LTR&#25351;&#20196;&#21482;&#33021;&#22312;&#31995;&#32479;&#23618;&#20351;&#29992;&#65307;&#21152;&#36733;&#21518;TSS&#27573;&#25551;&#36848;&#31526;&#30340;&#29366;&#24577;&#20301;&#65288;&#39640;4&#23383;&#33410;&#30340;&#31532;9&#20301;&#65292;&#25110;&#21487;&#20197;&#29702;&#35299;&#20026;Type&#22495;&#20174;0x9/1001&#21464;&#25104;&#20102;0xB/1011&#65289;&#20250;&#21457;&#29983;&#25913;&#21464;&#12290;</p>
<p   
>STR&#25351;&#20196;&#21487;&#20197;&#35835;&#21462;TR&#27573;&#23492;&#23384;&#22120;&#30340;&#20869;&#23481;&#65292;&#20294;&#26159;&#35813;&#25351;&#20196;<strong class=" ">&#21482;&#33021;&#35835;&#21462;TR&#27573;&#23492;&#23384;&#22120;&#30340;16&#20301;&#65292;&#20063;&#23601;&#26159;&#36873;&#25321;&#23376;</strong>&#12290;</p>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeWunueOsOS7u-WKoeWIh-aNog">
        <h5 class="heading "><span>&#23454;&#29616;&#20219;&#21153;&#20999;&#25442;</span></h5>
<p   
>&#22312;Windows&#25805;&#20316;&#31995;&#32479;&#20013;&#27809;&#26377;&#20351;&#29992;TSS&#36827;&#34892;&#20219;&#21153;&#65288;&#32447;&#31243;&#65289;&#20999;&#25442;&#65292;&#25105;&#20204;&#21487;&#20197;&#25163;&#21160;&#23454;&#29616;&#19968;&#19979;&#12290;&#20027;&#35201;&#20998;&#20026;&#20960;&#20010;&#27493;&#39588;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#26500;&#36896;&#23436;&#25972;&#30340;TSS&#65307;</p>
</li><li class=" "><p   
>&#26500;&#36896;TSS&#27573;&#25551;&#36848;&#31526;&#65307;</p>
</li><li class=" "><p   
>&#20351;&#29992;CALL FAR/JMP FAR&#25351;&#20196;&#20462;&#25913;TR&#23492;&#23384;&#22120;&#12290;</p>
</li></ol>    <div class="section section-6" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeaehOmAoOWujOaVtOeahFRTUw">
        <h6 class="heading "><span>&#26500;&#36896;&#23436;&#25972;&#30340;TSS</span></h6>
<p   
>&#22914;&#19979;&#25105;&#20204;&#20351;&#29992;&#20195;&#30721;&#26500;&#36896;&#20102;&#19968;&#20010;&#23436;&#25972;&#30340;TSS&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">DWORD tss[</code><code class="value">0x68</code><code class="plain">] = {</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// Previous Task Link</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 不同权限对应的ESP、SS，如果不涉及到权限切换所以可以将这些寄存器的值全部填0</code></div>
<div class="line"><code class="plain">    (DWORD)stack, </code><code class="comments">// ESP0</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000010</code><code class="plain">,    </code><code class="comments">// SS0</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// ESP1</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// SS1</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// ESP2</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// SS2</code></div>
<div class="line"><code class="plain">    (DWORD)iCr3, </code><code class="comments">// Cr3，与页的知识有关，必须要赋值</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00401020</code><code class="plain">,    </code><code class="comments">// EIP，下一次执行代码的位置，必须要赋值</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// EFLAGS</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// EAX</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// ECX</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// EDX</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// EBX</code></div>
<div class="line"><code class="plain">    (DWORD)stack, </code><code class="comments">// ESP，任务切换时也需要切换栈，所以在代码中我们可以声明一个数组，将其地址作为一块栈</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// EBP</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// ESI</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// EDI</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000023</code><code class="plain">,    </code><code class="comments">// ES</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000008</code><code class="plain">, </code><code class="comments">// CS，切到0环的代码段描述符</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000010</code><code class="plain">,    </code><code class="comments">// SS，CS与SS需要保持一致</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000023</code><code class="plain">,    </code><code class="comments">// DS</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000030</code><code class="plain">,    </code><code class="comments">// FS，切到0环就是0x30，3环就是0x3B</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// GS，Windows没有使用这个段寄存器所以永远是0</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// LDT，填0</code></div>
<div class="line"><code class="plain">    </code><code class="value">0x20ac0000</code><code class="plain">    </code><code class="comments">// IO_MAP，Windows2000以后不用了</code></div>
<div class="line"><code class="plain">};</code></div>
</div>
    </div>
    </div>
    <div class="section section-6" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeaehOmAoFRTU-auteaPj-i_sOespg">
        <h6 class="heading "><span>&#26500;&#36896;TSS&#27573;&#25551;&#36848;&#31526;</span></h6>
<p   
>&#26681;&#25454;TSS&#27573;&#25551;&#36848;&#31526;&#30340;&#32467;&#26500;&#26500;&#36896;&#25551;&#36848;&#31526;&#65292;&#39318;&#20808;&#33719;&#21462;TSS&#30340;&#22320;&#22336;&#65292;&#22312;&#20195;&#30721;&#20013;&#19979;&#26029;&#28857;&#28982;&#21518;&#26597;&#30475;&#22320;&#22336;&#21363;&#21487;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-6_16-36-42.png" alt="images/download/attachments/1015831/image2022-7-6_16-36-42.png" width="600"  />
    </p>
<p   
>&#20854;&#22320;&#22336;&#20026;0x0012fd70&#65292;&#25105;&#20204;&#23601;&#24471;&#20986;&#23545;&#24212;TSS&#27573;&#25551;&#36848;&#31526;&#20013;Base&#30340;&#20540;&#65292;&#25509;&#30528;Limit&#23601;&#26159;TSS&#30340;&#22823;&#23567;0x68&#65292;DPL&#20026;3&#65288;3&#29615;&#31243;&#24207;&#35775;&#38382;&#65289;&#65292;Type&#22495;&#20026;0x9&#21363;&#34920;&#31034;&#24403;&#21069;&#25551;&#36848;&#31526;&#27809;&#26377;&#34987;&#21152;&#36733;&#36807;&#12290;&#26368;&#32456;&#24471;&#20986;TSS&#27573;&#25551;&#36848;&#31526;&#20026;&#65306;<strong class=" ">0000e912`fd700068</strong>&#12290;</p>
<p   
>&#25509;&#30528;&#25105;&#20204;&#20351;&#29992;eq&#25351;&#20196;&#22312;Windbg&#20013;&#21521;GDT&#34920;&#20013;&#20889;&#20837;&#25105;&#20204;&#26500;&#36896;&#22909;&#30340;TSS&#27573;&#25551;&#36848;&#31526;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-6_16-43-24.png" alt="images/download/attachments/1015831/image2022-7-6_16-43-24.png" width="400"  />
    </p>
<p   
>&#28982;&#21518;&#25105;&#20204;&#30340;&#23436;&#25972;&#20195;&#30721;&#22914;&#19979;&#25152;&#31034;&#65292;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"><code class="plain">#include &lt;windows.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> o_eax, n_esp;</code></div>
<div class="line"><code class="keyword">short</code><code class="plain"> n_cs, n_ss;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> __declspec(naked) GetValue() {</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 将寄存器保存到全局变量中</code></div>
<div class="line"><code class="plain">    _asm {</code></div>
<div class="line"><code class="plain">        mov o_eax, eax</code></div>
<div class="line"><code class="plain">        mov n_esp, esp</code></div>
<div class="line"><code class="plain">        mov ax, cs</code></div>
<div class="line"><code class="plain">        mov n_cs, ax</code></div>
<div class="line"><code class="plain">        mov ax, ss</code></div>
<div class="line"><code class="plain">        mov n_ss, ax</code></div>
<div class="line"><code class="plain">        mov eax, o_eax</code></div>
<div class="line"><code class="plain">        iret</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> stack[</code><code class="value">100</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">}; </code><code class="comments">// 栈</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> buffer[</code><code class="value">6</code><code class="plain">] = {</code><code class="value">0x0</code><code class="plain">, </code><code class="value">0x0</code><code class="plain">, </code><code class="value">0x0</code><code class="plain">, </code><code class="value">0x0</code><code class="plain">, </code><code class="value">0x4B</code><code class="plain">, </code><code class="value">0x0</code><code class="plain">}; </code><code class="comments">// 选择子</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> iCr3 = </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    printf(</code><code class="string">"Input: "</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    scanf(</code><code class="string">"%x"</code><code class="plain">, &amp;iCr3);</code></div>
<div class="line"><code class="plain">    getchar();</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    DWORD tss[</code><code class="value">0x68</code><code class="plain">] = {</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// Previous Task Link</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// 不同权限对应的ESP、SS，如果不涉及到权限切换所以可以将这些寄存器的值全部填0</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// ESP0</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// SS0</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// ESP1</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// SS1</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// ESP2</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// SS2</code></div>
<div class="line"><code class="plain">        (DWORD)iCr3, </code><code class="comments">// Cr3，与页的知识有关，必须要赋值</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00401020</code><code class="plain">,    </code><code class="comments">// EIP，下一次执行代码的位置，必须要赋值，在代码中就是GetValue函数的地址</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// EFLAGS</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// EAX</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// ECX</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// EDX</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// EBX</code></div>
<div class="line"><code class="plain">        (DWORD)stack, </code><code class="comments">// ESP，任务切换时也需要切换栈，所以在代码中我们可以声明一个数组，将其地址作为一块栈</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// EBP</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// ESI</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// EDI</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000023</code><code class="plain">,    </code><code class="comments">// ES</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000008</code><code class="plain">, </code><code class="comments">// CS，切到0环的代码段描述符</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000010</code><code class="plain">,    </code><code class="comments">// SS，CS与SS需要保持一致</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000023</code><code class="plain">,    </code><code class="comments">// DS</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000030</code><code class="plain">,    </code><code class="comments">// FS，切到0环就是0x30，3环就是0x3B</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// GS，Windows没有使用这个段寄存器所以永远是0</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">,    </code><code class="comments">// LDT，填0</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x20ac0000</code><code class="plain">    </code><code class="comments">// IO_MAP，Windows2000以后不用了，默认值</code></div>
<div class="line"><code class="plain">    };</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    _asm {</code></div>
<div class="line"><code class="plain">        call far fword ptr[buffer] </code><code class="comments">// 长调用</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="comments">// 输出寄存器的值证明完成了任务切换</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"ESP: %x, CS: %x, SS: %x \n"</code><code class="plain">, n_esp, n_cs, n_ss);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    getchar();</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>&#25509;&#30528;&#25105;&#20204;&#38656;&#35201;&#36816;&#34892;&#31243;&#24207;&#65292;&#28982;&#21518;&#22312;Windbg&#20013;&#26029;&#28857;&#36755;&#20837;<strong class=" "><u class=" ">!process 0 0</u></strong>&#25351;&#20196;&#33719;&#21462;Cr3&#30340;&#20540;&#22635;&#20837;&#21040;&#31243;&#24207;&#20013;&#12290;&#20294;&#26159;&#25105;&#20204;&#38656;&#35201;&#23548;&#20837;&#31526;&#21495;&#34920;&#25165;&#33021;&#20351;&#29992;Windbg&#36825;&#20010;&#25351;&#20196;&#65292;&#25152;&#20197;&#26681;&#25454;&#25105;&#20204;&#30340;&#31995;&#32479;&#29256;&#26412;&#25214;&#21040;&#23545;&#24212;&#30340;&#31163;&#32447;&#31526;&#21495;&#34920;&#23433;&#35013;&#21253;&#65288;&#36825;&#37324;&#25105;&#26159;Windows XP SP2&#65292;&#23433;&#35013;&#21253;&#38142;&#25509;&#65306;https://pan.baidu.com/s/1j0oDzGHVviMvilWgWhdoxg&#65292;&#25552;&#21462;&#30721;&#65306;keey&#65289;&#12290;</p>
<p   
>&#23433;&#35013;&#23436;&#25104;&#20043;&#21518;&#25509;&#30528;&#22312;Windbg&#20013;&#25353;&#22914;&#19979;&#22270;&#25152;&#31034;&#22635;&#20837;&#31526;&#21495;&#34920;&#30340;&#30446;&#24405;&#21363;&#21487;&#21152;&#36733;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-7_15-21-28.png" alt="images/download/attachments/1015831/image2022-7-7_15-21-28.png" width="600"  />
    </p>
<p   
>&#25509;&#30528;&#25105;&#20204;&#25353;&#29031;&#27969;&#31243;&#26469;&#65292;&#33719;&#21462;&#21040;&#24403;&#21069;&#31243;&#24207;&#30340;Cr3&#20540;0x219cd000&#65292;&#24182;&#19988;&#36755;&#20837;&#21040;&#31243;&#24207;&#20013;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-7_15-29-37.png" alt="images/download/attachments/1015831/image2022-7-7_15-29-37.png" width="600"  />
    </p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-7_15-30-25.png" alt="images/download/attachments/1015831/image2022-7-7_15-30-25.png" width="600"  />
    </p>
<p   
>&#36755;&#20837;&#20043;&#21518;&#22238;&#36710;&#25104;&#21151;&#65292;&#31243;&#24207;&#36755;&#20986;&#30340;&#23492;&#23384;&#22120;&#20540;&#23601;&#26159;&#25105;&#20204;TSS&#20013;&#36171;&#20104;&#30340;&#65292;&#21017;&#23454;&#39564;&#25104;&#21151;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-7_15-33-16.png" alt="images/download/attachments/1015831/image2022-7-7_15-33-16.png" width="600"  />
    </p>
    </div>
    </div>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeS7u-WKoemXqA">
        <h4 class="heading "><span>&#20219;&#21153;&#38376;</span></h4>
<p   
>&#38500;&#20102;&#20043;&#21069;&#25152;&#25552;&#21040;&#30340;JMP/CALL&#25351;&#20196;&#36827;&#34892;&#20219;&#21153;&#20999;&#25442;&#22806;&#65292;&#25105;&#20204;&#36824;&#21487;&#20197;&#20351;&#29992;&#20219;&#21153;&#38376;&#65292;&#23427;&#30340;&#20248;&#21183;&#22914;&#19979;&#65306;</p>
<ul class=" "><li class=" "><p   
>&#20219;&#21153;&#38376;&#21487;&#20197;&#25918;&#22312;GDT&#34920;&#20013;&#65292;&#20063;&#21487;&#20197;&#25918;&#22312;IDT&#34920;&#20013;&#65292;&#36824;&#33021;&#25918;&#22312;&#24403;&#21069;&#32447;&#31243;&#30340;LDT&#34920;&#20013;&#65292;&#32780;TSS&#27573;&#25551;&#36848;&#31526;&#21482;&#33021;&#22312;GDT&#34920;&#20013;&#65307;</p>
</li><li class=" "><p   
>&#20219;&#21153;&#38376;&#21487;&#20197;&#35753;&#20302;&#26435;&#38480;&#30340;&#32447;&#31243;&#36827;&#34892;&#20219;&#24847;&#20999;&#25442;&#65292;&#36890;&#36807;&#20219;&#21153;&#38376;&#65292;TSS&#27573;&#25551;&#36848;&#31526;&#23601;&#19981;&#20877;&#36827;&#34892;&#26435;&#38480;&#26816;&#26597;&#20102;&#65288;<strong class=" ">CPL=3&#30340;&#31243;&#24207;&#20351;&#29992;DPL=3&#30340;&#20219;&#21153;&#38376;&#65292;&#21487;&#20197;&#35775;&#38382;&#21040;DPL=0&#30340;TSS&#27573;&#25551;&#36848;&#31526;&#65292;&#26368;&#32456;&#21487;&#20197;&#23436;&#25104;&#20219;&#21153;&#20999;&#25442;</strong>&#65289;&#65307;</p>
</li><li class=" "><p   
>&#30001;&#20110;&#20219;&#21153;&#38376;&#21487;&#20197;&#20301;&#20110;IDT&#34920;&#20013;&#65292;&#25152;&#20197;&#24403;&#36935;&#21040;&#20013;&#26029;&#25110;&#32773;&#24322;&#24120;&#26102;&#65292;&#21487;&#20197;&#20999;&#25442;&#21040;&#29420;&#31435;&#30340;&#20219;&#21153;&#21435;&#22788;&#29702;&#24322;&#24120;&#12290;</p>
</li></ul><p   
>&#19979;&#38754;&#20026;&#19981;&#21516;&#34920;&#20013;&#65292;&#20219;&#21153;&#38376;&#36827;&#34892;&#20219;&#21153;&#20999;&#25442;&#30340;&#36807;&#31243;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-8_10-24-54.png" alt="images/download/attachments/1015831/image2022-7-8_10-24-54.png" width="600"  />
    </p>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeaPj-i_sOespg">
        <h5 class="heading "><span>&#25551;&#36848;&#31526;</span></h5>
<p   
>&#20219;&#21153;&#38376;&#25551;&#36848;&#31526;&#20063;&#23384;&#20648;&#22312;IDT&#34920;&#20013;&#65292;&#23427;&#30340;&#32467;&#26500;&#22914;&#19979;&#25152;&#31034;&#65292;&#28784;&#33394;&#30340;&#37096;&#20998;&#20445;&#30041;&#65288;&#22635;0&#65289;&#65292;    <span style="color: #4c4948;">
DPL&#19968;&#33324;&#35774;&#32622;&#20026;3&#65292;&#26041;&#20415;3&#29615;&#24212;&#29992;&#31243;&#24207;&#35775;&#38382;&#65292;Type&#22495;&#21517;&#26159;&#22266;&#23450;&#30340;0101&#65292;TSS&#27573;&#36873;&#25321;&#23376;&#65292;&#25351;&#21521;&#20301;&#20110;GDT&#34920;&#20013;TSS&#27573;&#25551;&#36848;&#31526;&#30340;&#20301;&#32622;    </span>
&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-8_10-17-59.png" alt="images/download/attachments/1015831/image2022-7-8_10-17-59.png" width="600"  />
    </p>
<p   
><br/></p>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeWunueOsOS7u-WKoeWIh-aNoi4x">
        <h5 class="heading "><span>&#23454;&#29616;&#20219;&#21153;&#20999;&#25442;</span></h5>
<p   
>&#22312;&#20570;&quot;&#20351;&#29992;&#20219;&#21153;&#38376;&#23454;&#29616;&#20219;&#21153;&#20999;&#25442;&quot;&#23454;&#39564;&#20043;&#21069;&#65292;&#25105;&#20204;&#20808;&#26469;&#30475;&#19968;&#19979;&#20219;&#21153;&#38376;&#30340;&#25191;&#34892;&#36807;&#31243;&#22914;&#19979;&#25152;&#31034;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#20351;&#29992;INT N&#25351;&#20196;&#65307;</p>
</li><li class=" "><p   
>&#26597;IDT&#34920;&#65292;&#25214;&#21040;&#20219;&#21153;&#38376;&#25551;&#36848;&#31526;&#65307;</p>
</li><li class=" "><p   
>&#36890;&#36807;&#20219;&#21153;&#38376;&#25551;&#36848;&#31526;&#30340;TSS&#27573;&#36873;&#25321;&#23376;&#65292;&#22312;GDT&#34920;&#20013;&#25214;&#21040;TSS&#27573;&#25551;&#36848;&#31526;&#65307;</p>
</li><li class=" "><p   
>&#20351;&#29992;TSS&#27573;&#20013;&#30340;&#20540;&#20462;&#25913;TR&#23492;&#23384;&#22120;&#65307;</p>
</li><li class=" "><p   
>IRETD&#36820;&#22238;&#12290;</p>
</li></ol><p   
>&#25152;&#20197;&#25353;&#29031;&#27969;&#31243;&#26469;&#65292;&#25105;&#20204;&#38656;&#35201;&#20808;&#26500;&#24314;TSS&#27573;&#25551;&#36848;&#31526;&#65292;&#36825;&#37324;&#19982;&#20219;&#21153;&#27573;&#23454;&#39564;&#19968;&#26679;&#65292;&#19981;&#36807;&#20026;&#20102;&#35770;&#35777;&#20043;&#21069;&#25152;&#35828;&#30340;&#36890;&#36807;&#20219;&#21153;&#38376;&#25214;&#21040;TSS&#27573;&#25551;&#36848;&#31526;&#23601;&#19981;&#26816;&#26597;&#26435;&#38480;&#36825;&#20010;&#35828;&#27861;&#65292;&#25105;&#20204;&#38656;&#35201;&#23558;TSS&#27573;&#25551;&#36848;&#31526;&#20013;&#30340;DPL&#20301;&#20462;&#25913;&#20026;0&#65292;&#25152;&#20197;&#24471;&#20986;TSS&#27573;&#25551;&#36848;&#31526;&#20026;&#65306;<strong class=" ">00008912`fd780068</strong>&#65292;&#22312;Windbg&#20013;&#20889;&#20837;GDT&#34920;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-8_10-49-18.png" alt="images/download/attachments/1015831/image2022-7-8_10-49-18.png" width="400"  />
    </p>
<p   
>&#25509;&#30528;&#26500;&#24314;&#20219;&#21153;&#38376;&#25551;&#36848;&#31526;&#65292;&#26681;&#25454;TSS&#27573;&#25551;&#36848;&#31526;&#30340;&#20301;&#32622;&#24471;&#20986;&#36873;&#25321;&#23376;&#24102;&#20837;&#24182;&#32467;&#21512;&#38376;&#25551;&#36848;&#31526;&#30340;&#32467;&#26500;&#65292;&#26368;&#32456;&#24471;&#20986;&#20219;&#21153;&#38376;&#25551;&#36848;&#31526;&#20026;&#65306;<strong class=" ">0000e500`004b0000</strong>&#65292;&#22312;Windbg&#20013;&#20889;&#20837;IDT&#34920;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-8_10-54-2.png" alt="images/download/attachments/1015831/image2022-7-8_10-54-2.png" width="400"  />
    </p>
<p   
>&#25509;&#30528;&#25105;&#20204;&#22312;&#20195;&#30721;&#20013;&#21152;&#20837;INT N&#25351;&#20196;&#65292;N&#20026;0x20&#65288;&#25105;&#20204;&#20889;&#20837;&#30340;&#20219;&#21153;&#38376;&#25551;&#36848;&#31526;&#22312;IDT&#34920;&#20013;&#36807;&#30340;&#32034;&#24341;&#20540;&#65289;&#65292;&#23436;&#25972;&#20195;&#30721;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"><code class="plain">#include &lt;windows.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> o_eax, n_esp;</code></div>
<div class="line"><code class="keyword">short</code><code class="plain"> n_cs, n_ss;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> __declspec(naked) GetValue() {</code></div>
<div class="line"><code class="plain">    _asm {</code></div>
<div class="line"><code class="plain">        mov o_eax, eax</code></div>
<div class="line"><code class="plain">        mov n_esp, esp</code></div>
<div class="line"><code class="plain">        mov ax, cs</code></div>
<div class="line"><code class="plain">        mov n_cs, ax</code></div>
<div class="line"><code class="plain">        mov ax, ss</code></div>
<div class="line"><code class="plain">        mov n_ss, ax</code></div>
<div class="line"><code class="plain">        mov eax, o_eax</code></div>
<div class="line"><code class="plain">        iret</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> stack[</code><code class="value">100</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">}; </code><code class="comments">// 堆栈</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> iCr3 = </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"Input: "</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    scanf(</code><code class="string">"%x"</code><code class="plain">, &amp;iCr3);</code></div>
<div class="line"><code class="plain">    getchar();</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    DWORD tss[</code><code class="value">0x68</code><code class="plain">] = {</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// Previous Task Link</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// 不同权限对应的ESP、SS，如果不涉及到权限切换所以可以将这些寄存器的值全部填0</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// ESP0</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// SS0</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// ESP1</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// SS1</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// ESP2</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// SS2</code></div>
<div class="line"><code class="plain">        (DWORD)iCr3, </code><code class="comments">// Cr3，与页的知识有关，必须要赋值</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00401020</code><code class="plain">, </code><code class="comments">// EIP，下一次执行代码的位置，必须要赋值</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// EFLAGS</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// EAX</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// ECX</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// EDX</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// EBX</code></div>
<div class="line"><code class="plain">        (DWORD)stack, </code><code class="comments">// ESP，任务切换时也需要切换堆栈，所以在代码中我们可以声明一个数组，将其地址作为一块堆栈</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// EBP</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// ESI</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// EDI</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000023</code><code class="plain">, </code><code class="comments">// ES</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000008</code><code class="plain">, </code><code class="comments">// CS，切到0环的代码段描述符</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000010</code><code class="plain">, </code><code class="comments">// SS，CS与SS需要保持一致</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000023</code><code class="plain">, </code><code class="comments">// DS</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000030</code><code class="plain">, </code><code class="comments">// FS，切到0环就是0x30，3环就是0x3B</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// GS，Windows没有使用这个段寄存器所以永远是0</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x00000000</code><code class="plain">, </code><code class="comments">// LDT，填0</code></div>
<div class="line"><code class="plain">        </code><code class="value">0x20ac0000</code><code class="plain"> </code><code class="comments">// IO_MAP，Windows2000以后不用了</code></div>
<div class="line"><code class="plain">    };</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    _asm {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">int</code><code class="plain"> </code><code class="value">0x20</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 输出寄存器的值证明完成了任务切换</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"ESP: %x, CS: %x, SS: %x \n"</code><code class="plain">, n_esp, n_cs, n_ss); </code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    getchar();</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>&#32534;&#35793;&#36816;&#34892;&#31243;&#24207;&#65292;&#22312;Windbg&#20013;&#36755;&#20837;<strong class=" ">!process 0 0</strong>&#25351;&#20196;&#25214;&#21040;Cr3&#20540;&#36755;&#20837;&#21040;&#31243;&#24207;&#20013;&#21363;&#21487;&#65292;&#26368;&#32456;&#25105;&#20204;&#21487;&#20197;&#30475;&#21040;&#33719;&#21462;&#21040;&#30340;&#23492;&#23384;&#22120;&#20540;&#30830;&#23454;&#20026;&#25105;&#20204;&#25152;&#26500;&#24314;&#30340;TSS&#20013;&#23545;&#24212;&#30340;&#20540;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-8_11-3-28.png" alt="images/download/attachments/1015831/image2022-7-8_11-3-28.png" width="600"  />
    </p>
    </div>
    </div>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLemhtQ">
        <h1 class="heading "><span>&#39029;</span></h1>
<p   
>&#20445;&#25252;&#27169;&#24335;&#19979;&#26377;&#27573;&#12289;&#39029;&#26426;&#21046;&#65292;&#26412;&#31456;&#33410;&#23601;&#26469;&#20102;&#35299;&#39029;&#30340;&#26426;&#21046;&#65292;&#23427;&#30456;&#23545;&#20110;&#27573;&#26469;&#35828;&#26356;&#21152;&#37325;&#35201;&#12290;</p>
    <div class="section section-2" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLTEwLTEwLTEy5YiG6aG1">
        <h2 class="heading "><span>10-10-12&#20998;&#39029;</span></h2>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-8_15-23-56.png" alt="images/download/attachments/1015831/image2022-7-8_15-23-56.png" width="400"  />
    </p>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeacr-ivreamguW_tQ">
        <h3 class="heading "><span>&#26415;&#35821;&#27010;&#24565;</span></h3>
<p   
>&#20026;&#20102;&#20415;&#20110;&#26356;&#22909;&#30340;&#23398;&#20064;&#65292;&#25105;&#20204;&#38656;&#35201;&#20102;&#35299;&#19968;&#19979;&#32447;&#24615;&#22320;&#22336;&#12289;&#26377;&#25928;&#22320;&#22336;&#12289;&#29289;&#29702;&#22320;&#22336;&#20998;&#21035;&#26159;&#20160;&#20040;&#12290;&#25105;&#20204;&#30475;&#27719;&#32534;&#25351;&#20196;&#26102;&#32463;&#24120;&#20250;&#30475;&#35265;&#22914;&#19979;&#31867;&#20284;&#30340;&#25351;&#20196;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">MOV EAX, DWORD PTR DS:[</code><code class="value">0x12345678</code><code class="plain">]</code></div>
</div>
    </div>
<p   
>&#22312;&#36825;&#37324;&#25351;&#20196;&#20013;&#65292;<strong class=" ">0x12345678&#23601;&#26159;&#26377;&#25928;&#22320;&#22336;</strong>&#65292;&#26681;&#25454;&#20043;&#21069;&#27573;&#30340;&#23398;&#20064;&#65292;&#25105;&#20204;&#30693;&#36947;&#36825;&#27573;&#25351;&#20196;&#30495;&#27491;&#35835;&#21462;&#30340;&#22320;&#22336;&#26159;<strong class=" ">DS.Base+0x12345678&#65292;&#36825;&#20010;&#22320;&#22336;&#23601;&#26159;&#32447;&#24615;&#22320;&#22336;&#65288;&#26377;&#25928;&#22320;&#22336;+&#27573;&#23492;&#23384;&#22120;&#30340;Base&#65289;</strong>&#12290;&#26377;&#20102;&#32447;&#24615;&#22320;&#22336;&#20043;&#21518;CPU&#20250;&#23558;&#20854;&#36716;&#20026;&#29289;&#29702;&#22320;&#22336;&#65292;&#36825;&#26679;&#25165;&#33021;&#25214;&#21040;&#30495;&#27491;&#30340;&#25968;&#25454;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-8_15-35-0.png" alt="images/download/attachments/1015831/image2022-7-8_15-35-0.png" width="400"  />
    </p>
<p   
>32&#20301;&#31995;&#32479;&#19978;&#23558;&#32447;&#24615;&#22320;&#22336;&#36716;&#20026;&#29289;&#29702;&#22320;&#22336;&#26377;2&#31181;&#26041;&#24335;&#65306;10-10-12&#12289;2-9-9-12&#65292;&#25105;&#20204;&#26412;&#33410;&#35201;&#23398;&#30340;&#23601;&#26159;&#21069;&#32773;&#12290;</p>
<p   
>&#25105;&#20204;&#20043;&#21069;&#36827;&#34892;&#21452;&#26426;&#35843;&#35797;&#37197;&#32622;&#26102;&#20505;&#35774;&#32622;&#20102;C:\boot.ini&#36825;&#20010;&#25991;&#20214;&#65292;&#22312;&#20889;&#20837;&#30340;&#20869;&#23481;&#20013;&#26377;&#19968;&#20010;&#21442;&#25968;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#24403;&#35813;&#21442;&#25968;&#20026;execute&#26102;&#21017;&#34920;&#31034;&#24403;&#21069;&#30340;&#20998;&#39029;&#26426;&#21046;&#23601;&#26159;10-10-12&#65292;noexecute&#21017;&#34920;&#31034;&#24403;&#21069;&#30340;&#20998;&#39029;&#26426;&#21046;&#20026;2-9-9-12&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-18_9-46-19.png" alt="images/download/attachments/1015831/image2022-7-18_9-46-19.png" width="600"  />
    </p>
<p   
>&#20462;&#25913;&#35813;&#21442;&#25968;&#28982;&#21518;&#37325;&#21551;&#31995;&#32479;&#21363;&#21487;&#12290;</p>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeWvu-aJvueJqeeQhuWcsOWdgA">
        <h3 class="heading "><span>&#23547;&#25214;&#29289;&#29702;&#22320;&#22336;</span></h3>
<p   
>&#22312;&#20570;&#23454;&#39564;&#20043;&#21069;&#25105;&#20204;&#38656;&#35201;&#30693;&#36947;&#20174;&#32447;&#24615;&#22320;&#22336;&#23547;&#25214;&#21040;&#29289;&#29702;&#22320;&#22336;&#30340;&#27969;&#31243;&#65292;&#22914;&#19979;&#25152;&#31034;&#65292;CPU&#36890;&#36807;&#36827;&#31243;&#30340;CR3&#65288;<strong class=" ">CR3&#26159;&#19968;&#20010;&#23492;&#23384;&#22120;&#65292;CR3&#25351;&#21521;&#30340;&#39029;&#26377;4096&#23383;&#33410;&#65288;4KB&#65289;&#65292;&#27599;4&#23383;&#33410;&#20316;&#20026;&#19968;&#20010;&#25104;&#21592;&#23384;&#20648;&#65292;&#19968;&#20849;&#26377;1024&#20010;&#25104;&#21592;</strong>&#65289;&#25214;&#21040;&#31532;&#19968;&#32423;&#39029;&#65292;&#20877;&#36890;&#36807;&#31532;&#19968;&#32423;&#25214;&#21040;&#31532;&#20108;&#32423;&#65292;&#26368;&#21518;&#25214;&#21040;&#29289;&#29702;&#39029;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-18_10-27-38.png" alt="images/download/attachments/1015831/image2022-7-18_10-27-38.png" width="400"  />
    </p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#23558;&#31532;&#19968;&#32423;&#12289;&#31532;&#20108;&#32423;&#29702;&#35299;&#20026;&#26159;&#19968;&#20010;&#30446;&#24405;&#65292;&#36890;&#36807;&#30446;&#24405;&#25214;&#21040;&#29289;&#29702;&#39029;&#65288;&#20869;&#23481;&#65289;&#65292;&#32780;&#30446;&#24405;&#30340;&#32034;&#24341;&#23601;&#26159;10-10-12&#20998;&#39029;&#26426;&#21046;&#25152;&#21010;&#20998;&#20986;&#26469;&#30340;&#12290;</p>
<p   
>&#25152;&#35859;10-10-12&#20998;&#39029;&#26426;&#21046;&#65292;&#26412;&#36136;&#19978;&#23601;&#26159;&#23558;&#32447;&#24615;&#22320;&#22336;&#25353;&#20301;&#20998;&#20026;&#19977;&#20010;&#37096;&#20998;&#65292;&#20998;&#21035;&#26159;10&#20301;&#12289;10&#20301;&#12289;12&#20301;&#65292;&#28982;&#21518;&#36890;&#36807;&#36825;&#19977;&#20010;&#37096;&#20998;&#20316;&#20026;&#32034;&#24341;&#25214;&#21040;&#29289;&#29702;&#39029;&#12290;</p>
<p   
>&#25509;&#19979;&#26469;&#25105;&#20204;&#21487;&#20197;&#25163;&#21160;&#20570;&#23454;&#39564;&#26469;&#20174;&#32447;&#24615;&#22320;&#22336;&#23547;&#25214;&#21040;&#29289;&#29702;&#22320;&#22336;&#65292;&#39318;&#20808;&#25171;&#24320;&#19968;&#20010;&#35760;&#20107;&#26412;&#36755;&#20837;&#19968;&#27573;&#20869;&#23481;&#65292;&#28982;&#21518;&#25171;&#24320;CE&#36719;&#20214;&#25214;&#21040;&#35813;&#36827;&#31243;&#65292;&#25628;&#32034;&#25105;&#20204;&#36755;&#20837;&#30340;&#20869;&#23481;&#65292;&#25214;&#21040;&#35813;&#23383;&#31526;&#20018;&#23545;&#24212;&#30340;&#32447;&#24615;&#22320;&#22336;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#32447;&#24615;&#22320;&#22336;&#21363;&#20026;<strong class=" ">0x000AAFF8</strong>&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-18_10-8-27.png" alt="images/download/attachments/1015831/image2022-7-18_10-8-27.png"  height="250" />
    </p>
<p   
>&#25353;10-10-12&#20998;&#39029;&#26426;&#21046;&#20998;&#20026;&#19977;&#20010;&#37096;&#20998;&#65292;&#21069;&#20004;&#37096;&#20998;&#38656;&#35201;*4&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">0000</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="value">00</code><code class="plain">     </code><code class="comments">//  Hex: 0*4 = 0</code></div>
<div class="line"><code class="value">00</code><code class="plain"> </code><code class="value">1010</code><code class="plain"> </code><code class="value">1010</code><code class="plain">     </code><code class="comments">//  Hex: AA*4 = 2A8</code></div>
<div class="line"><code class="value">1111</code><code class="plain"> </code><code class="value">1111</code><code class="plain"> </code><code class="value">1000</code><code class="plain">  </code><code class="comments">//  Hex: FF8</code></div>
</div>
    </div>
<p   
>&#25509;&#30528;&#25105;&#20204;&#25214;&#21040;&#35813;&#35760;&#20107;&#26412;&#36827;&#31243;&#30340;CR3&#23492;&#23384;&#22120;&#20540;&#65306;0x16bcf000&#65292;&#20351;&#29992;dd&#25351;&#20196;&#65288;<strong class=" ">dd&#21069;&#38656;&#35201;&#21152;&#19978;&#24863;&#21497;&#21495;</strong>&#65289;&#21152;&#19978;&#31532;&#19968;&#37096;&#20998;&#30340;&#20540;&#22312;&#31532;&#19968;&#32423;&#39029;&#25214;&#21040;&#31532;&#20108;&#32423;&#39029;&#22320;&#22336;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">!dd 16bcf000+</code><code class="value">0</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-18_11-6-0.png" alt="images/download/attachments/1015831/image2022-7-18_11-6-0.png" width="400"  />
    </p>
<p   
>&#33719;&#24471;&#31532;&#20108;&#32423;&#39029;&#22320;&#22336;0x16d0e867&#65292;&#36825;&#20010;&#22320;&#22336;&#19981;&#26159;&#30495;&#27491;&#30340;&#22320;&#22336;&#65292;<strong class=" ">&#20302;12&#20301;&#20026;&#23646;&#24615;&#65292;&#38656;&#35201;&#23558;&#20854;&#22635;0</strong>&#21464;&#20026;0x16d0e000&#65292;&#25509;&#30528;&#20877;&#21152;&#19978;&#31532;&#20108;&#37096;&#20998;&#30340;&#20540;&#25214;&#21040;&#29289;&#29702;&#39029;&#22320;&#22336;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">!dd 16d0e000+2A8</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-18_11-6-44.png" alt="images/download/attachments/1015831/image2022-7-18_11-6-44.png" width="400"  />
    </p>
<p   
>&#33719;&#21462;&#21040;0x16d45867&#65292;&#20302;12&#20301;&#32622;0&#65292;&#22320;&#22336;&#20026;0x16d45000&#65292;&#20877;&#21152;&#19978;&#31532;&#19977;&#37096;&#20998;&#30340;&#20540;&#21363;&#21487;&#33719;&#21462;&#21040;&#29289;&#29702;&#22320;&#22336;&#65292;&#36825;&#37324;&#25105;&#20204;&#21487;&#20197;&#20197;&#23383;&#33410;&#30340;&#24418;&#24335;&#26597;&#30475;&#25968;&#25454;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-18_11-8-9.png" alt="images/download/attachments/1015831/image2022-7-18_11-8-9.png" width="600"  />
    </p>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVBEReS4jlBURQ">
        <h3 class="heading "><span>PDE&#19982;PTE</span></h3>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeacr-ivreamguW_tS4x">
        <h4 class="heading "><span>&#26415;&#35821;&#27010;&#24565;</span></h4>
<p   
>&#19978;&#19968;&#31456;&#33410;&#20013;&#25105;&#20204;&#31616;&#21333;&#20102;&#35299;&#20102;80x86&#30340;10-10-12&#20998;&#39029;&#26426;&#21046;&#65292;&#22823;&#33268;&#30340;&#27969;&#31243;&#25105;&#20204;&#24050;&#32463;&#28165;&#26970;&#20102;&#65292;&#20294;&#26159;&#25105;&#20204;&#20043;&#21069;&#25152;&#25552;&#21040;&#30340;&#31532;N&#32423;&#65292;&#23454;&#38469;&#19978;&#23427;&#20204;&#26377;&#33258;&#24049;&#30340;&#21517;&#23383;&#65306;</p>
<p   
>&#31532;&#19968;&#32423;&#21483;&#39029;&#30446;&#24405;&#34920;&#65288;PDT&#65292;P    <span style="color: #333333;">
age Directory Table&#65289;&#65292;&#23427;&#26377;4KB&#30340;&#22823;&#23567;&#65292;&#27599;&#20010;&#25104;&#21592;&#22823;&#23567;&#26159;4&#23383;&#33410;&#65292;&#27599;&#20010;&#25104;&#21592;&#30340;&#21517;&#23383;&#21483;&#39029;&#30446;&#24405;&#39033;&#65288;PDE&#65292;Page Directory Entry&#65289;&#65307;    </span>
</p>
<p   
>    <span style="color: #333333;">
&#31532;&#20108;&#32423;&#21483;&#39029;&#34920;&#65288;PTT&#65292;Page Table&#65289;&#65292;&#23427;&#21516;&#26679;&#26377;4KB&#30340;&#22823;&#23567;&#65292;&#27599;&#20010;&#25104;&#21592;&#20063;&#26159;4&#23383;&#33410;&#22823;&#23567;&#65292;&#27599;&#20010;&#25104;&#21592;&#30340;&#21517;&#23383;&#21483;&#39029;&#34920;&#39033;&#65288;PTE&#65292;Page Table Entry&#65289;&#12290;    </span>
</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-18_16-0-50.png" alt="images/download/attachments/1015831/image2022-7-18_16-0-50.png" width="600"  />
    </p>
<p   
>10-10-12&#20998;&#39029;&#26426;&#21046;&#21487;&#20197;&#26681;&#25454;&#25104;&#21592;&#25968;&#26469;&#29702;&#35299;&#65292;<strong class=" ">&#29289;&#29702;&#39029;&#23384;&#20648;&#30340;&#26159;&#25968;&#25454;&#65292;&#20197;&#23383;&#33410;&#20026;&#25104;&#21592;&#21333;&#20301;&#65292;&#29289;&#29702;&#39029;&#26377;4096&#20010;&#23383;&#33410;&#65292;&#20063;&#23601;&#26159;2&#30340;12&#27425;&#26041;&#65292;&#32780;&#39029;&#34920;&#12289;&#39029;&#30446;&#24405;&#34920;&#25104;&#21592;&#21333;&#20301;&#37117;&#26159;4&#23383;&#33410;&#65292;&#26377;1024&#20010;&#25104;&#21592;&#65292;&#25152;&#20197;&#23601;&#26159;2&#30340;10&#27425;&#26041;</strong>&#12290;</p>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeWunumqjC4x">
        <h5 class="heading "><span>&#23454;&#39564;</span></h5>
<p   
>PTE&#26377;&#36825;&#20960;&#20010;&#29305;&#24449;&#65306;PTE&#21487;&#20197;&#27809;&#26377;&#29289;&#29702;&#39029;&#65307;&#19968;&#20010;PTE&#21482;&#33021;&#23545;&#24212;&#19968;&#20010;&#29289;&#29702;&#39029;&#65307;&#22810;&#20010;PTE&#21487;&#20197;&#23545;&#24212;&#21516;&#19968;&#20010;&#29289;&#29702;&#39029;&#12290;</p>
<p   
>&#20026;&#20102;&#35770;&#35777;&#35266;&#28857;&#65292;&#25105;&#20204;&#21487;&#20197;&#20570;&#19968;&#20010;&#23454;&#39564;&#65292;&#20197;&#32447;&#24615;&#22320;&#22336;0x0&#20026;&#20363;&#65292;&#25286;&#20998;&#24182;&#35266;&#23519;&#20854;PTE&#26159;&#21542;&#26377;&#29289;&#29702;&#39029;&#12290;</p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#38543;&#20415;&#36215;&#19968;&#20010;&#36827;&#31243;&#28982;&#21518;&#25214;&#21040;CR3&#26469;&#26597;&#30475;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#25105;&#20204;&#30475;&#21040;&#23427;&#27809;&#26377;&#29289;&#29702;&#39029;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-18_16-26-58.png" alt="images/download/attachments/1015831/image2022-7-18_16-26-58.png" width="600"  />
    </p>
<p   
>&#36825;&#20063;&#23601;&#34920;&#31034;PTE&#21487;&#20197;&#27809;&#26377;&#29289;&#29702;&#39029;&#65292;&#37027;&#20040;&#36825;&#20010;0x0&#30340;&#32447;&#24615;&#22320;&#22336;&#25105;&#20204;&#26159;&#21542;&#21487;&#20197;&#36827;&#34892;&#35835;&#20889;&#21602;&#65311;&#23454;&#38469;&#19978;&#26159;&#21487;&#20197;&#30340;&#65292;&#25105;&#20204;&#24050;&#32463;&#20102;&#35299;0x0&#36825;&#20010;&#22320;&#22336;&#19981;&#33021;&#35835;&#20889;&#30340;&#21407;&#22240;&#26159;&#22240;&#20026;&#20854;&#23545;&#24212;PTE&#27809;&#26377;&#29289;&#29702;&#39029;&#65292;&#37027;&#25105;&#20204;&#21487;&#20197;&#32473;&#23427;&#19968;&#20010;&#29289;&#29702;&#39029;&#12290;</p>
<p   
>&#29992;&#22914;&#19979;&#20195;&#30721;&#26469;&#23454;&#39564;&#65292;&#25105;&#20204;&#36816;&#34892;&#36825;&#27573;&#20195;&#30721;&#65292;&#20808;&#33719;&#21462;&#21464;&#37327;a&#30340;&#32447;&#24615;&#22320;&#22336;&#65292;&#28982;&#21518;&#25214;&#21040;&#20854;&#29289;&#29702;&#39029;&#22320;&#22336;&#65292;&#36171;&#20540;&#32473;0x0&#30340;PTE&#65292;&#28982;&#21518;&#22238;&#36710;&#21363;&#21487;&#21521;0x0&#22320;&#22336;&#20889;&#20837;&#20869;&#23481;&#65292;&#24182;&#35835;&#21462;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;stdio.h&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> main()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> a = </code><code class="value">10</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"a address: %x \n"</code><code class="plain">, &amp;a);</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    getchar();</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    *(</code><code class="keyword">int</code><code class="plain">*)</code><code class="value">0</code><code class="plain"> = </code><code class="value">123</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"0 address data: %x \n"</code><code class="plain">, *(</code><code class="keyword">int</code><code class="plain">*)</code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    getchar();</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>&#33719;&#21462;&#21464;&#37327;a&#30340;&#32447;&#24615;&#22320;&#22336;&#20026;0x0012FF7C&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-18_16-44-22.png" alt="images/download/attachments/1015831/image2022-7-18_16-44-22.png" width="600"  />
    </p>
<p   
>&#25353;10-10-12&#20998;&#39029;&#26426;&#21046;&#25286;&#20998;&#20026;&#19977;&#37096;&#20998;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">0000</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="value">00</code><code class="plain"> </code><code class="comments">//  Hex: 0*4 = 0</code></div>
<div class="line"><code class="value">01</code><code class="plain"> </code><code class="value">0010</code><code class="plain"> </code><code class="value">1111</code><code class="plain"> </code><code class="comments">//  Hex: 12F*4 = 4BC</code></div>
<div class="line"><code class="value">1111</code><code class="plain"> </code><code class="value">0111</code><code class="plain"> </code><code class="value">1100</code><code class="plain"> </code><code class="comments">//  Hex: F7C</code></div>
</div>
    </div>
<p   
>&#25509;&#30528;&#25105;&#20204;&#25214;&#21040;PTE&#30340;&#20540;&#20026;0x25D97867&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-18_16-58-14.png" alt="images/download/attachments/1015831/image2022-7-18_16-58-14.png" width="400"  />
    </p>
<p   
>&#25509;&#30528;&#25105;&#20204;&#23558;&#35813;&#20540;&#28155;&#21152;&#21040;0x0&#22320;&#22336;&#23545;&#24212;&#30340;PTE&#20013;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">!ed 25f01000 25d97867</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-18_16-59-53.png" alt="images/download/attachments/1015831/image2022-7-18_16-59-53.png" width="400"  />
    </p>
<p   
>&#36825;&#26102;&#20505;&#22312;&#22238;&#21040;&#31243;&#24207;&#25353;&#22238;&#36710;&#25191;&#34892;&#23601;&#20250;&#21457;&#29616;&#25105;&#20204;&#25104;&#21151;&#30340;&#21521;0x0&#32447;&#24615;&#22320;&#22336;&#35835;&#20889;&#20102;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-18_17-0-31.png" alt="images/download/attachments/1015831/image2022-7-18_17-0-31.png" width="600"  />
    </p>
    </div>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeS9jjEy5L2N5bGe5oCn">
        <h4 class="heading "><span>&#20302;12&#20301;&#23646;&#24615;</span></h4>
<p   
>&#22312;&#20043;&#21069;&#30340;&#23454;&#39564;&#20013;&#25105;&#20204;&#30693;&#36947;PDE/PTE&#30340;&#20302;12&#20301;&#34920;&#31034;&#23646;&#24615;&#65292;<strong class=" ">&#36825;&#20004;&#20010;&#23646;&#24615;&#36827;&#34892;&#19982;&#36816;&#31639;&#24471;&#20986;&#30340;&#32467;&#26524;&#23601;&#26159;&#29289;&#29702;&#39029;&#30340;&#23646;&#24615;</strong>&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-18_17-7-45.png" alt="images/download/attachments/1015831/image2022-7-18_17-7-45.png" width="600"  />
    </p>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVDkvY0uMQ">
        <h5 class="heading "><span>P&#20301;</span></h5>
<p   
>P&#20301;&#34920;&#31034;&#24403;&#21069;&#29289;&#29702;&#39029;&#30340;&#26377;&#25928;&#24615;&#65292;&#20026;1&#34920;&#31034;&#26377;&#25928;&#65292;&#20026;0&#21017;&#34920;&#31034;&#26080;&#25928;&#65292;<strong class=" ">&#30001;&#20110;&#29289;&#29702;&#39029;&#30340;&#23646;&#24615;&#26159;PDE&#21644;PTE&#23646;&#24615;&#36827;&#34892;&#19982;&#36816;&#31639;&#30340;&#26469;&#30340;&#25152;&#20197;&#38656;&#35201;PDE&#21644;PTE&#23646;&#24615;&#30340;P&#20301;&#22343;&#20026;1</strong>&#65292;&#25165;&#33021;&#34920;&#31034;&#29289;&#29702;&#39029;&#26159;&#26377;&#25928;&#30340;&#12290;</p>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVIvV-S9jQ">
        <h5 class="heading "><span>R/W&#20301;</span></h5>
<p   
>R/W&#20301;&#34920;&#31034;&#29289;&#29702;&#39029;&#30340;&#35835;&#20889;&#26435;&#38480;&#65292;&#20026;1&#34920;&#31034;&#21487;&#35835;&#21487;&#20889;&#65292;&#20026;0&#21017;&#34920;&#31034;&#21482;&#35835;&#12290;&#20363;&#22914;&#25105;&#20204;&#20043;&#21069;&#25152;&#23398;&#20064;&#30340;&#24120;&#37327;&#65292;&#23427;&#23601;&#26159;&#19968;&#20010;&#21482;&#35835;&#30340;&#20869;&#23481;&#65292;&#23545;&#24212;&#30340;&#29289;&#29702;&#39029;&#23646;&#24615;&#30340;R/W&#20301;&#20540;&#20026;0&#65292;&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;Windbg&#20462;&#25913;&#36825;&#20010;&#20540;&#26469;&#36798;&#21040;&#20889;&#20837;&#30340;&#30446;&#30340;&#12290;</p>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVUvU-S9jQ">
        <h5 class="heading "><span>U/S&#20301;</span></h5>
<p   
>U/S&#20301;&#34920;&#31034;&#29289;&#29702;&#39029;&#30340;&#35775;&#38382;&#26435;&#38480;&#65292;&#20026;1&#34920;&#31034;&#26222;&#36890;&#29992;&#25143;&#21487;&#20197;&#35775;&#38382;&#65292;&#20026;0&#21017;&#34920;&#31034;&#29305;&#26435;&#29992;&#25143;&#21487;&#20197;&#35775;&#38382;&#12290;</p>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVBT5L2N">
        <h5 class="heading "><span>PS&#20301;</span></h5>
<p   
>PS&#20301;&#65288;Page Size&#65289;&#21482;&#23545;PDE&#26377;&#24847;&#20041;&#65292;&#20026;1&#34920;&#31034;PDE&#30452;&#25509;&#25351;&#21521;&#29289;&#29702;&#39029;&#65288;&#27809;&#26377;PTE&#65289;&#65292;&#20302;22&#20301;&#23601;&#26159;&#29289;&#29702;&#39029;&#30340;&#39029;&#20869;&#20559;&#31227;&#12290;&#22240;&#27492;&#65292;&#32447;&#24615;&#22320;&#22336;&#23601;&#21482;&#33021;&#25286;&#20998;&#20026;2&#37096;&#20998;&#65292;<strong class=" ">&#32780;&#23427;&#30340;&#19968;&#20010;&#29289;&#29702;&#39029;&#23601;&#19981;&#20877;&#26159;4KB&#22823;&#23567;&#65292;&#32780;&#26159;4MB&#22823;&#23567;&#65292;&#25105;&#20204;&#20063;&#31216;&#20043;&#20026;&#22823;&#39029;</strong>&#12290;</p>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLUHkvY0">
        <h5 class="heading "><span>A&#20301;</span></h5>
<p   
>A&#20301;&#34920;&#31034;&#24403;&#21069;&#26159;&#21542;&#34987;&#35775;&#38382;&#36807;&#65292;&#20026;1&#34920;&#31034;&#35775;&#38382;&#36807;&#65292;&#20026;0&#21017;&#34920;&#31034;&#27809;&#26377;&#35775;&#38382;&#36807;&#12290;</p>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLUTkvY0">
        <h5 class="heading "><span>D&#20301;</span></h5>
<p   
>D&#20301;&#34920;&#31034;&#24403;&#21069;&#26159;&#21542;&#34987;&#20889;&#20837;&#36807;&#65292;&#20026;1&#34920;&#31034;&#20889;&#20837;&#36807;&#65292;&#20026;0&#21017;&#34920;&#31034;&#27809;&#26377;&#20889;&#20837;&#36807;&#12290;</p>
    </div>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeihqOWfuuWdgA">
        <h4 class="heading "><span>&#34920;&#22522;&#22336;</span></h4>
<p   
>&#20043;&#21069;&#30340;&#23454;&#39564;&#25105;&#20204;&#21487;&#20197;&#22312;Windbg&#20013;&#36890;&#36807;&#32447;&#24615;&#22320;&#22336;&#25286;&#20998;&#65292;&#25214;&#21040;PDE&#12289;PTE&#65292;&#26368;&#32456;&#25214;&#21040;&#29289;&#29702;&#39029;&#65292;&#23545;&#23646;&#24615;&#36827;&#34892;&#20462;&#25913;&#31561;&#25805;&#20316;&#12290;&#20294;&#26159;&#36825;&#26679;&#30340;&#25805;&#20316;&#37117;&#26159;&#22522;&#20110;&#25163;&#21160;&#35843;&#35797;&#22120;&#30340;&#65292;&#25105;&#20204;&#35201;&#24819;&#36890;&#36807;&#20195;&#30721;&#21435;&#23436;&#25104;&#23601;&#38656;&#35201;&#36890;&#36807;&#34920;&#22522;&#22336;&#65288;&#39029;&#30446;&#24405;&#34920;&#12289;&#39029;&#34920;&#65289;&#12290;</p>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLemhteebruW9leihqA">
        <h5 class="heading "><span>&#39029;&#30446;&#24405;&#34920;</span></h5>
<p   
>&#39029;&#30446;&#24405;&#34920;&#22522;&#22336;&#23601;&#26159;0xC0300000&#65292;&#36890;&#36807;&#23427;&#25214;&#21040;&#30340;&#29289;&#29702;&#39029;&#23601;&#26159;&#39029;&#30446;&#24405;&#34920;&#65292;&#36825;&#20010;&#29289;&#29702;&#39029;&#26082;&#26159;&#39029;&#30446;&#24405;&#34920;&#20063;&#26159;&#39029;&#34920;&#12290;&#36825;&#37324;&#30340;&#39029;&#30446;&#24405;&#34920;&#26159;&#19968;&#24352;&#29305;&#27530;&#30340;&#39029;&#34920;&#65292;&#27599;&#19968;&#39033;PTE&#25351;&#21521;&#30340;&#19981;&#26159;&#26222;&#36890;&#30340;&#29289;&#29702;&#39029;&#65292;&#32780;&#26159;&#25351;&#21521;&#20854;&#20182;&#30340;&#39029;&#34920;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-19_11-3-21.png" alt="images/download/attachments/1015831/image2022-7-19_11-3-21.png" width="400"  />
    </p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#20570;&#20010;&#23454;&#39564;&#26469;&#35770;&#35777;&#36825;&#20123;&#35266;&#28857;&#65292;&#38543;&#20415;&#21551;&#21160;&#19968;&#20010;&#31243;&#24207;&#25214;&#21040;&#23427;&#30340;PDT&#34920;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-19_11-10-39.png" alt="images/download/attachments/1015831/image2022-7-19_11-10-39.png" width="600"  />
    </p>
<p   
>&#23558;0xC0300000&#25353;10-10-12&#20998;&#39029;&#26426;&#21046;&#36827;&#34892;&#25286;&#20998;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">1100</code><code class="plain"> </code><code class="value">000</code><code class="plain"> </code><code class="value">00</code><code class="plain"> </code><code class="comments">//  Hex: 300*4 = C00</code></div>
<div class="line"><code class="value">11</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="value">000</code><code class="plain"> </code><code class="comments">//  Hex: 300*4 = C00</code></div>
<div class="line"><code class="value">0000</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="comments">//  Hex: 0</code></div>
</div>
    </div>
<p   
>&#25353;&#36825;&#20010;&#25286;&#20998;&#30340;&#20986;&#26469;&#30340;&#20559;&#31227;&#25214;&#21040;&#29289;&#29702;&#39029;&#65292;&#25105;&#20204;&#23601;&#20250;&#21457;&#29616;&#36825;&#37324;&#25214;&#21040;&#30340;&#29289;&#29702;&#39029;&#20869;&#23481;&#19982;&#19978;&#38754;&#30340;PDT&#34920;&#20869;&#23481;&#26159;&#19968;&#33268;&#30340;&#65292;&#24182;&#19988;&#20320;&#25243;&#24320;&#20559;&#31227;&#20063;&#20250;&#21457;&#29616;&#65292;&#23427;&#20204;&#30340;&#22522;&#22336;&#37117;&#26159;&#19968;&#26679;&#30340;&#65292;<strong class=" ">&#25152;&#20197;&#20063;&#23601;&#35770;&#35777;&#20102;&#36825;&#20010;&#29289;&#29702;&#39029;&#26082;&#26159;&#39029;&#30446;&#24405;&#34920;&#20063;&#26159;&#39029;&#34920;</strong>&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-19_11-12-19.png" alt="images/download/attachments/1015831/image2022-7-19_11-12-19.png" width="400"  />
    </p>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLemhteihqA">
        <h5 class="heading "><span>&#39029;&#34920;</span></h5>
<p   
>&#22522;&#20110;&#39029;&#30446;&#24405;&#34920;&#22522;&#22336;&#65292;&#25105;&#20204;&#21487;&#20197;&#35775;&#38382;&#26576;&#20010;&#32447;&#24615;&#22320;&#22336;&#30340;PDT&#65292;&#20294;&#26159;&#36825;&#26679;&#20165;&#20165;&#21487;&#20197;&#25805;&#25511;PDT&#34920;&#30340;&#20869;&#23481;&#65288;PDE&#65289;&#65292;&#24182;&#19981;&#33021;&#25805;&#25511;PTE&#65292;&#20063;&#23601;&#26159;&#26080;&#27861;&#35775;&#38382;PTT&#34920;&#12290;</p>
<p   
>&#25105;&#20204;&#35201;&#24819;&#35775;&#38382;PTT&#34920;&#23601;&#38656;&#35201;&#39029;&#34920;&#22522;&#22336;&#65292;&#39029;&#34920;&#22522;&#22336;&#23601;&#26159;0xC0000000&#65292;&#19982;&#39029;&#30446;&#24405;&#34920;&#22522;&#22336;&#20570;&#30340;&#23454;&#39564;&#19968;&#26679;&#65292;&#25105;&#20204;&#20808;&#25214;&#21040;&#26576;&#20010;&#32447;&#24615;&#22320;&#22336;&#30340;PTT&#34920;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-19_14-53-29.png" alt="images/download/attachments/1015831/image2022-7-19_14-53-29.png" width="600"  />
    </p>
<p   
>&#25286;&#20998;0xC0000000&#20026;&#19977;&#37096;&#20998;&#65292;&#24102;&#20837;&#26597;&#25214;&#29289;&#29702;&#39029;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">1100</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="value">00</code><code class="plain"> </code><code class="comments">// Hex: 300*4 = C00</code></div>
<div class="line"><code class="value">00</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="comments">// Hex: 0*4 = 0</code></div>
<div class="line"><code class="value">0000</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="comments">// Hex: 0</code></div>
</div>
    </div>
<p   
>&#26368;&#32456;&#32467;&#26524;&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#25105;&#20204;&#21487;&#20197;&#30475;&#21040;&#26597;&#25214;&#20986;&#26469;&#30340;&#29289;&#29702;&#39029;&#20869;&#23481;&#19982;&#19978;&#22270;&#20013;&#30340;PTT&#34920;&#20869;&#23481;&#26159;&#19968;&#33268;&#30340;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-19_14-36-52.png" alt="images/download/attachments/1015831/image2022-7-19_14-36-52.png" width="400"  />
    </p>
<p   
>&#25105;&#20204;&#20063;&#30001;&#22270;&#24471;&#30693;&#65292;<strong class=" ">!dd 200a7000+0</strong>&#25351;&#20196;&#30340;&#32467;&#26524;&#65292;0x0&#24320;&#22987;&#26159;&#31532;&#19968;&#20010;PTT&#34920;&#30340;&#22320;&#22336;&#65292;0x4&#24320;&#22987;&#23601;&#26159;&#31532;&#20108;&#20010;PTT&#34920;&#30340;&#22320;&#22336;&#65292;&#20063;&#23601;&#26159;&#38656;&#35201;&#25351;&#20196;&#21464;&#20026;<strong class=" ">!dd 200a7000+4</strong>&#25351;&#20196;&#65292;&#25105;&#20204;&#20877;&#26681;&#25454;&#36825;&#20010;&#25351;&#20196;&#36827;&#34892;&#21453;&#25512;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">!dd 200a7000+C00 </code><code class="comments">// Hex: C00 / 4 = 300, 1100 0000 00</code></div>
<div class="line"><code class="plain">!dd 200a7000+</code><code class="value">4</code><code class="plain"> </code><code class="comments">// Hex: 4 / 4 = 1, 00 0000 0001</code></div>
<div class="line"><code class="plain">!dd 1ff20000+</code><code class="value">0</code><code class="plain"> </code><code class="comments">// Hex: 0, 0000 0000 0000</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">-&gt; </code><code class="value">1100</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="value">0001</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="value">0000</code><code class="plain"> </code><code class="value">0000</code></div>
<div class="line"><code class="plain">-&gt; Hex: </code><code class="value">0xC0001000</code></div>
</div>
    </div>
<p   
>&#26368;&#32456;&#24471;&#20986;&#32447;&#24615;&#22320;&#22336;&#20026;&#65306;0xC0001000&#65292;<strong class=" ">&#37027;&#20040;&#26681;&#25454;&#36825;&#20010;&#35268;&#24459;&#25105;&#20204;&#23601;&#30693;&#36947;&#22312;0xC0000000&#30340;&#22522;&#30784;&#19978;&#27599;&#36882;&#22686;0x1000&#65292;&#21363;&#34920;&#31034;&#33719;&#21462;&#19979;&#19968;&#20010;PTT</strong>&#65292;0x1000&#27491;&#22909;&#26159;4096&#23383;&#33410;&#65288;&#19968;&#20010;&#39029;&#30340;&#22823;&#23567;4KB&#65289;&#12290;</p>
    </div>
    <div class="section section-5" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeaAu-e7ky4z">
        <h5 class="heading "><span>&#24635;&#32467;</span></h5>
<p   
>&#24403;&#23398;&#20064;&#23436;&#36825;&#37096;&#20998;&#30340;&#20869;&#23481;&#20043;&#21518;&#65292;&#25105;&#20204;&#23545;10-10-12&#20998;&#39029;&#26426;&#21046;&#21448;&#26377;&#20102;&#26032;&#30340;&#35748;&#30693;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#39029;&#34920;&#65288;PTT&#65289;&#34987;&#26144;&#23556;&#21040;&#20102;&#20174;0xC0000000&#21040;0xC03FFFFF&#30340;4MB&#22320;&#22336;&#31354;&#38388;&#65288;&#19968;&#20010;&#34920;4KB&#65292;&#19968;&#20849;&#26377;1024&#20010;&#34920;&#65289;&#65307;</p>
</li><li class=" "><p   
>&#22312;&#36825;1024&#20010;&#34920;&#20013;&#26377;&#19968;&#24352;&#29305;&#27530;&#30340;&#34920;&#65292;&#23601;&#26159;&#39029;&#30446;&#24405;&#34920;&#65288;PDT&#65289;&#65307;</p>
</li><li class=" "><p   
>&#39029;&#30446;&#24405;&#34920;&#34987;&#26144;&#23556;&#21040;&#20102;&#20174;0xC0300000&#24320;&#22987;&#22788;&#30340;4KB&#22320;&#22336;&#31354;&#38388;&#12290;</p>
</li></ol><p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-19_14-59-57.png" alt="images/download/attachments/1015831/image2022-7-19_14-59-57.png" width="400"  />
    </p>
<p   
>&#25484;&#25569;&#20102;2&#20010;&#34920;&#22522;&#22336;&#65292;&#23601;&#30456;&#24403;&#20110;&#25484;&#25569;&#20102;&#19968;&#20849;&#36827;&#31243;&#25152;&#26377;&#30340;&#29289;&#29702;&#20869;&#23384;&#35835;&#20889;&#26435;&#38480;&#65292;&#20320;&#21487;&#20197;&#36890;&#36807;&#22914;&#19979;&#20844;&#24335;&#21435;&#35775;&#38382;&#39029;&#30446;&#24405;&#34920;&#12289;&#39029;&#34920;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="comments">// 定义</code></div>
<div class="line"><code class="value">10</code><code class="plain">-</code><code class="value">10</code><code class="plain">-12拆分就是如下：</code></div>
<div class="line"><code class="plain">PDI(</code><code class="value">10</code><code class="plain">)：Page Dictory Index，页目录索引</code></div>
<div class="line"><code class="plain">PTI(</code><code class="value">10</code><code class="plain">)：Page Table Index，页表索引</code></div>
<div class="line"><code class="plain">PPI(</code><code class="value">12</code><code class="plain">)：Physical Page Index, 物理页索引</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 访问页目录表公式</code></div>
<div class="line"><code class="value">0xC0300000</code><code class="plain"> + PDI * </code><code class="value">4</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 访问页表公式</code></div>
<div class="line"><code class="value">0xC0000000</code><code class="plain"> + PDI * </code><code class="value">4096</code><code class="plain"> + PTI * </code><code class="value">4</code></div>
</div>
    </div>
    </div>
    </div>
    </div>
    </div>
    <div class="section section-2" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLTItOS05LTEy5YiG6aG1">
        <h2 class="heading "><span>2-9-9-12&#20998;&#39029;</span></h2>
<p   
>&#22312;&#20043;&#21069;&#30340;&#35838;&#31243;&#20013;&#25105;&#20204;&#35762;&#35299;&#20102;10-10-12&#20998;&#39029;&#26426;&#21046;&#65292;&#22312;&#36825;&#31181;&#26426;&#21046;&#26041;&#24335;&#19979;&#29289;&#29702;&#22320;&#22336;&#26368;&#22810;&#21487;&#36798;4GB&#12290;&#20294;&#38543;&#30528;&#30828;&#20214;&#21457;&#23637;&#65292;4GB&#30340;&#29289;&#29702;&#22320;&#22336;&#33539;&#22260;&#24050;&#32463;&#26080;&#27861;&#28385;&#36275;&#38656;&#27714;&#65292;Intel&#22312;1996&#24180;&#23601;&#24050;&#32463;&#24847;&#35782;&#21040;&#36825;&#20010;&#38382;&#39064;&#20102;&#65292;&#25152;&#20197;&#35774;&#35745;&#20102;&#26032;&#30340;&#20998;&#39029;&#26426;&#21046;&#65292;&#36825;&#20063;&#23601;&#26159;&#25105;&#20204;&#26412;&#33410;&#35838;&#35201;&#35762;&#30340;<strong class=" ">2-9-9-12&#20998;&#39029;&#26426;&#21046;&#65292;&#21448;&#31216;&#20026;PAE&#65288;&#29289;&#29702;&#22320;&#22336;&#25193;&#23637;&#65289;&#20998;&#39029;</strong>&#12290;</p>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeWIhumhteiuvuiuoQ">
        <h3 class="heading "><span>&#20998;&#39029;&#35774;&#35745;</span></h3>
<p   
>&#22312;&#20102;&#35299;2-9-9-12&#20998;&#39029;&#26426;&#21046;&#20043;&#21069;&#25105;&#20204;&#38656;&#35201;&#20174;10-10-12&#20998;&#39029;&#26426;&#21046;&#24320;&#22987;&#20102;&#35299;&#65292;&#23427;&#20204;&#30340;&#20998;&#39029;&#35774;&#35745;&#30340;&#36923;&#36753;&#65292;&#36825;&#26679;&#20415;&#20110;&#25105;&#20204;&#25484;&#25569;&#21644;&#23398;&#20064;&#12290;</p>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLTEwLTEwLTEy">
        <h4 class="heading "><span>10-10-12</span></h4>
<p   
>10-10-12&#30340;&#20998;&#39029;&#35774;&#35745;&#36923;&#36753;&#22914;&#19979;&#65306;</p>
<ol class=" "><li class=" "><p   
>Intel&#35748;&#20026;&#19968;&#24352;&#39029;&#30340;&#22823;&#23567;&#20026;4KB&#26159;&#27604;&#36739;&#21512;&#29702;&#30340;&#65292;&#20808;&#30830;&#23450;&#20102;&#39029;&#30340;&#22823;&#23567;&#20026;4KB&#65288;4096&#20010;&#23383;&#33410;&#65292;&#20063;&#23601;&#26159;2&#30340;12&#27425;&#26041;&#65289;&#65292;<strong class=" ">&#27492;&#26102;10-10-12&#20013;&#30340;12&#23601;&#30830;&#23450;&#20102;</strong>&#65307;&#65288;&#39029;&#20869;&#20559;&#31227;&#65292;&#25214;&#21040;&#20219;&#19968;&#19968;&#20010;&#23383;&#33410;&#65289;</p>
</li><li class=" "><p   
>&#24403;&#21021;&#30340;&#29289;&#29702;&#20869;&#23384;&#27604;&#36739;&#23567;&#65292;4&#20010;&#23383;&#33410;&#30340;PTE&#25104;&#21592;&#23601;&#22815;&#20102;&#65292;&#39029;&#30340;&#22823;&#23567;&#26159;4KB&#65292;&#25152;&#20197;&#19968;&#20010;&#39029;&#33021;&#23384;&#20648;1024&#20010;PTE&#65288;&#20063;&#23601;&#26159;2&#30340;10&#27425;&#26041;&#65289;&#65292;<strong class=" ">&#27492;&#26102;10-10-12&#20013;&#30340;&#31532;&#20108;&#20010;10&#20063;&#30830;&#23450;&#20102;</strong>&#65307;&#65288;&#23547;&#25214;PTE&#65289;</p>
</li><li class=" "><p   
>&#22240;&#20026;&#25972;&#20010;&#32447;&#24615;&#22320;&#22336;&#26159;32&#20301;&#30340;&#65292;&#25105;&#20204;&#24050;&#32463;&#30830;&#23450;&#20102;12&#12289;10&#20301;&#65292;&#37027;&#20040;&#26368;&#21518;&#23601;&#21097;&#19979;10&#20301;&#20102;&#65292;<strong class=" ">&#27492;&#26102;10-10-12&#20013;&#30340;&#31532;&#19968;&#20010;10&#20063;&#23601;&#30830;&#23450;&#20102;</strong>&#12290;&#65288;&#23547;&#25214;PTI&#65289;</p>
</li></ol>    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLTItOS05LTEy">
        <h4 class="heading "><span>2-9-9-12</span></h4>
<p   
>&#25105;&#20204;&#20877;&#26469;&#30475;2-9-9-12&#30340;&#20998;&#39029;&#35774;&#35745;&#36923;&#36753;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#39029;&#30340;&#22823;&#23567;&#26159;&#30830;&#23450;&#30340;&#65292;4KB&#22823;&#23567;&#19981;&#33021;&#38543;&#20415;&#26356;&#25913;&#65292;<strong class=" ">&#25152;&#20197;2-9-9-12&#20013;&#30340;12&#23601;&#30830;&#23450;&#20102;</strong>&#65307;&#65288;&#39029;&#20869;&#20559;&#31227;&#65292;&#25214;&#21040;&#20219;&#19968;&#19968;&#20010;&#23383;&#33410;&#65289;</p>
</li><li class=" "><p   
>&#22914;&#26524;&#24819;&#22686;&#22823;&#29289;&#29702;&#20869;&#23384;&#30340;&#35775;&#38382;&#33539;&#22260;&#65292;&#23601;&#38656;&#35201;&#22686;&#22823;PTE&#65292;&#30001;&#20110;&#38656;&#35201;&#32771;&#34385;&#23545;&#40784;&#65292;&#25152;&#20197;&#22686;&#21152;&#21040;8&#20010;&#23383;&#33410;&#65292;&#36825;&#37324;&#22686;&#21152;&#30340;&#21482;&#26159;PTE&#32467;&#26500;&#20013;&#30340;&#29289;&#29702;&#22320;&#22336;&#37096;&#20998;&#65292;&#23646;&#24615;&#37096;&#20998;&#24182;&#27809;&#26377;&#22686;&#21152;&#65307;&#37027;&#20040;&#36825;&#37324;&#19968;&#20010;&#39029;&#21487;&#20197;&#23384;&#20648;512&#20010;PTE&#65288;&#20063;&#23601;&#26159;2&#30340;9&#27425;&#26041;&#65289;<strong class=" ">&#65292;&#27492;&#26102;2-9-9-12&#20013;&#30340;&#31532;&#20108;&#20010;9&#30830;&#23450;&#20102;</strong>&#65307;<br/></p>
<img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-20_14-35-39.png" alt="images/download/attachments/1015831/image2022-7-20_14-35-39.png" width="600"  />
    </li><li class=" "><p   
>&#21516;&#29702;PDE&#20063;&#30001;&#21407;&#26469;&#30340;4&#20010;&#23383;&#33410;&#21464;&#25104;&#20102;8&#20010;&#23383;&#33410;&#65292;PDT&#34920;&#20063;&#30001;1024&#20010;&#25104;&#21592;&#21464;&#25104;&#20102;512&#20010;&#25104;&#21592;&#65292;&#20063;&#23601;&#19982;PTE&#19968;&#26679;&#20102;&#65292;<strong class=" ">&#27492;&#26102;2-9-9-12&#20013;&#30340;&#31532;&#19968;&#20010;9&#30830;&#23450;&#20102;</strong>&#65307;</p>
</li><li class=" "><p   
>&#32447;&#24615;&#22320;&#22336;&#26159;32&#20301;&#30340;&#65292;&#36825;&#26679;&#31639;&#19979;&#26469;&#23601;&#36824;&#21097;&#19979;2&#20301;&#65292;<strong class=" ">&#36825;2&#20301;&#23601;&#26159;&#26032;&#25299;&#23637;&#20986;&#26469;PDPI&#65288;Page Directory Point Table Index&#65292;&#39029;&#30446;&#24405;&#25351;&#38024;&#34920;&#32034;&#24341;&#65289;&#65292;&#20063;&#23601;&#26377;&#20102;&#19968;&#24352;&#26032;&#30340;&#34920;&#21483;PDPT&#65288;Page Directory Point Table&#65292;&#39029;&#30446;&#24405;&#25351;&#38024;&#34920;&#65289;&#65292;&#20854;&#20013;&#30340;&#25104;&#21592;&#23601;&#26159;PDPTE&#65288;Page Directory Point Table Entry&#65292;&#39029;&#30446;&#24405;&#25351;&#38024;&#34920;&#39033;&#65292;&#21516;&#26679;&#26159;8&#23383;&#33410;&#65289;</strong>&#12290;</p>
</li></ol><p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#23601;&#26159;2-9-9-12&#30340;&#20998;&#39029;&#32467;&#26500;&#65292;&#22312;10-10-12&#20998;&#39029;&#32467;&#26500;&#20013;CR3&#25351;&#21521;&#30340;&#23601;&#26159;PDT&#65292;&#32780;&#22312;2-9-9-12&#30340;&#20998;&#39029;&#32467;&#26500;&#20013;&#65292;&#22312;PDT&#20043;&#21069;&#65292;&#20063;&#23601;&#26159;CR3&#25351;&#21521;&#30340;&#26159;PDPT&#34920;&#65292;&#36825;&#24352;&#34920;&#26377;&#22235;&#20010;&#25104;&#21592;&#65288;&#22240;&#20026;PDPI&#21482;&#26377;2&#20301;&#65292;&#26368;&#22810;&#33021;&#20132;&#21449;4&#20010;&#32467;&#26524;&#65306;00 01 11 10&#65289;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-20_14-44-55.png" alt="images/download/attachments/1015831/image2022-7-20_14-44-55.png" width="600"  />
    </p>
<p   
>&#22312;&#20043;&#21069;&#30340;&#23454;&#39564;&#20013;&#25105;&#20204;&#20462;&#25913;&#20102;C:\boot.ini&#25991;&#20214;&#65292;&#29616;&#22312;&#25105;&#20204;&#21487;&#20197;&#20462;&#25913;&#21442;&#25968;&#20026;noexecute&#65292;&#28982;&#21518;&#37325;&#21551;&#31995;&#32479;&#65292;&#36825;&#26679;&#23601;&#21487;&#20197;&#24320;&#21551;2-9-9-12&#20998;&#39029;&#26426;&#21046;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-18_9-46-19.png" alt="images/download/attachments/1015831/image2022-7-18_9-46-19.png" width="600"  />
    </p>
    </div>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVBEUFRF57uT5p6E">
        <h3 class="heading "><span>PDPTE&#32467;&#26500;</span></h3>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#28784;&#33394;&#37096;&#20998;&#20026;&#20445;&#30041;&#37096;&#20998;&#65292;&#19981;&#19968;&#23450;&#22635;0&#12290;&#25509;&#30528;&#25105;&#20204;&#26469;&#30475;&#19979;&#36825;&#20010;&#32467;&#26500;&#65292;&#31532;0&#20301;&#22635;1&#65307;PWT&#12289;PCD&#20301;&#38656;&#35201;&#31561;&#21040;&#20043;&#21518;&#30340;&#20869;&#23481;&#23398;&#23436;&#20877;&#23398;&#20064;&#65307;&#31532;9-11&#20301;Available&#26159;&#32473;&#25805;&#20316;&#31995;&#32479;&#36719;&#20214;&#29992;&#30340;&#65292;CPU&#19981;&#20351;&#29992;&#65307;&#20174;&#31532;12-35&#20301;&#23601;&#26159;&#39029;&#30446;&#24405;&#34920;&#22522;&#22336;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-20_16-26-47.png" alt="images/download/attachments/1015831/image2022-7-20_16-26-47.png" width="400"  />
    </p>
<p   
>&#24403;&#20320;&#24819;&#35201;&#20351;&#29992;&#36825;&#20010;&#22320;&#22336;&#21435;&#23547;&#25214;PDT&#34920;&#26102;&#65292;&#19982;&#20043;&#21069;10-10-12&#30340;&#23454;&#39564;&#19968;&#26679;&#65292;&#23646;&#24615;&#37096;&#20998;&#65288;&#20302;12&#20301;&#65289;&#35201;&#22635;0&#12290;</p>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVBERee7k-aehA">
        <h3 class="heading "><span>PDE&#32467;&#26500;</span></h3>
<p   
>PDE&#30340;&#32467;&#26500;&#19982;10-10-12&#30340;&#32467;&#26500;&#24046;&#19981;&#22810;&#65292;&#28784;&#33394;&#37096;&#20998;&#20026;&#20445;&#30041;&#37096;&#20998;&#65292;&#24403;PS&#20301;&#20026;1&#26102;&#26159;&#22823;&#39029;&#65288;&#19979;&#22270;&#20013;&#30340;&#31532;&#19968;&#20010;&#32467;&#26500;&#65289;&#65292;&#31532;35-21&#20301;&#26159;&#22823;&#39029;&#30340;&#29289;&#29702;&#22320;&#22336;&#65292;&#36825;&#26679;36&#20301;&#30340;&#29289;&#29702;&#22320;&#22336;&#30340;&#20302;21&#20301;&#20026;0&#65292;&#36825;&#23601;&#24847;&#21619;&#30528;&#39029;&#30340;&#22823;&#23567;&#20026;2MB&#65292;&#19988;&#37117;&#26159;2MB&#23545;&#40784;&#65307;<strong class=" ">&#24182;&#19988;&#22810;&#20102;&#19968;&#20010;PAT&#20301;&#65288;&#39029;&#23646;&#24615;&#34920;&#65289;</strong>&#65292;&#20063;&#23601;&#26159;&#31532;12&#20301;&#65292;&#35813;&#20301;&#19982;CPU&#30456;&#20851;&#65292;&#20294;&#24182;&#19981;&#26159;&#25152;&#26377;CPU&#37117;&#25903;&#25345;&#35813;&#20301;&#65292;&#22914;&#26524;&#19981;&#25903;&#25345;&#65292;&#35813;&#20301;&#20250;&#22635;0&#12290;</p>
<p   
>&#24403;P&#20301;&#20026;0&#26102;&#65288;&#19979;&#22270;&#20013;&#30340;&#31532;&#20108;&#20010;&#32467;&#26500;&#65289;&#65292;&#31532;35-12&#20301;&#26159;&#39029;&#34920;&#22522;&#22336;&#65292;&#20302;12&#20301;&#22635;0&#65292;&#20849;36&#20301;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-20_16-35-51.png" alt="images/download/attachments/1015831/image2022-7-20_16-35-51.png" width="400"  />
    </p>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVBURee7k-aehA">
        <h3 class="heading "><span>PTE&#32467;&#26500;</span></h3>
<p   
>PTE&#30340;&#32467;&#26500;&#24456;&#31616;&#21333;&#65292;&#31532;12-35&#20301;&#23601;&#26159;&#29289;&#29702;&#39029;&#22522;&#22336;&#65292;&#20302;12&#20301;&#22635;0&#65292;&#20849;36&#20301;&#12290;&#29289;&#29702;&#39029;&#22522;&#22336;&#21152;12&#20301;&#30340;&#39029;&#20869;&#20559;&#31227;&#65292;&#23601;&#21487;&#20197;&#25214;&#21040;&#20855;&#20307;&#30340;&#25968;&#25454;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-20_16-45-35.png" alt="images/download/attachments/1015831/image2022-7-20_16-45-35.png" width="400"  />
    </p>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVhE5qCH5b-X5L2N">
        <h3 class="heading "><span>XD&#26631;&#24535;&#20301;</span></h3>
<p   
>XD&#26631;&#24535;&#20301;&#22312;AMD&#20013;&#31216;&#20043;&#20026;NX&#65292;&#21363;No Exection&#12290;&#23427;&#30340;&#35774;&#35745;&#26159;&#22240;&#20026;&#22823;&#22810;&#25968;&#28431;&#27934;&#20135;&#29983;&#30340;&#21407;&#22240;&#26159;&#22240;&#20026;&#25968;&#25454;&#34987;&#24403;&#25104;&#25351;&#20196;&#21435;&#25191;&#34892;&#20102;&#65292;&#20026;&#20102;&#38450;&#33539;&#36825;&#19968;&#38382;&#39064;&#65292;Intel&#20570;&#20102;&#30828;&#20214;&#20445;&#25252;&#65292;&#20570;&#20102;&#19968;&#20010;&#19981;&#21487;&#25191;&#34892;&#20301;&#12290;&#24403;XD&#20301;&#20026;1&#26102;&#65292;&#20320;&#30340;&#36719;&#20214;&#23384;&#22312;&#28322;&#20986;&#28431;&#27934;&#20063;&#27809;&#20851;&#31995;&#65292;&#22240;&#20026;&#21363;&#20351;&#20320;&#30340;EIP&#36339;&#21040;&#20102;&#21361;&#38505;&#30340;&quot;&#25968;&#25454;&#21306;&quot;&#65292;&#20063;&#26159;&#19981;&#21487;&#25191;&#34892;&#30340;&#12290;</p>
<p   
>&#22312;2-9-9-12&#20998;&#39029;&#26426;&#21046;&#19979;&#65292;PDE&#19982;PTE&#30340;&#26368;&#39640;&#20301;&#20026;XD/NX&#20301;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-20_16-55-37.png" alt="images/download/attachments/1015831/image2022-7-20_16-55-37.png" width="400"  />
    </p>
    </div>
    </div>
    <div class="section section-2" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVRMQg">
        <h2 class="heading "><span>TLB</span></h2>
<p   
>&#25105;&#20204;&#37117;&#30693;&#36947;&#36890;&#36807;&#19968;&#20010;&#32447;&#24615;&#22320;&#22336;&#35775;&#38382;&#19968;&#20010;&#29289;&#29702;&#39029;&#65292;&#22312;10-10-12&#30340;&#20998;&#39029;&#26426;&#21046;&#19979;&#65292;&#38656;&#35201;&#20808;&#35835;PDE&#22312;&#35835;PTE&#65292;&#26368;&#21518;&#35835;4&#23383;&#33410;&#30340;&#39029;&#65292;&#36825;&#26679;&#20174;&#26412;&#36136;&#19978;&#26469;&#35828;&#35835;&#21462;&#30340;&#20869;&#23481;&#26377;12&#20010;&#23383;&#33410;&#65292;&#24456;&#24433;&#21709;&#25928;&#29575;&#65307;&#24182;&#19988;&#22312;2-9-9-12&#20998;&#39029;&#26426;&#21046;&#19979;&#30001;&#20110;&#29289;&#29702;&#22320;&#22336;&#30340;&#25299;&#23637;&#65292;&#20250;&#23548;&#33268;&#35835;&#21462;&#30340;&#23383;&#33410;&#26356;&#22810;&#65292;&#29978;&#33267;&#22312;&#26576;&#20123;&#24773;&#20917;&#19979;&#65292;&#25968;&#25454;&#19981;&#22312;&#21516;&#19968;&#29289;&#29702;&#39029;&#65292;&#23601;&#20250;&#23384;&#22312;&#36328;&#39029;&#30340;&#24773;&#20917;&#12290;</p>
<p   
>&#20026;&#20102;&#25552;&#39640;&#25928;&#29575;&#65292;<strong class=" ">CPU&#22312;&#20869;&#37096;&#20570;&#20102;&#19968;&#24352;&#34920;&#65292;&#26469;&#35760;&#24405;&#36825;&#20123;&#19996;&#35199;&#65292;&#36825;&#23601;&#26159;TLB&#65288;Translation Lookaside Buffer&#65292;&#36716;&#35793;&#26597;&#25214;&#32531;&#20914;&#21306;&#65289;</strong>&#65292;&#23427;&#21644;&#23492;&#23384;&#22120;&#19968;&#26679;&#24555;&#65292;&#20294;&#21516;&#26679;&#23427;&#30340;&#22823;&#23567;&#20063;&#19981;&#20250;&#22826;&#22823;&#12290;</p>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLee7k-aehC4x">
        <h3 class="heading "><span>&#32467;&#26500;</span></h3>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#23601;&#26159;TLB&#30340;&#32467;&#26500;&#65288;TLB&#20013;&#23384;&#20648;&#30340;&#25104;&#21592;&#32467;&#26500;&#65292;<strong class=" ">&#19981;&#21516;&#30340;CPU&#19979;&#65292;TLB&#34920;&#30340;&#22823;&#23567;&#26159;&#19981;&#19968;&#26679;&#30340;</strong>&#65289;&#65292;&#32447;&#24615;&#22320;&#22336;&#12289;&#29289;&#29702;&#22320;&#22336;&#25105;&#20204;&#37117;&#30693;&#36947;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-22_13-44-4.png" alt="images/download/attachments/1015831/image2022-7-22_13-44-4.png" width="400"  />
    </p>
<p   
>&#23646;&#24615;&#65288;ATTR&#65289;&#26159;PDPE&#12289;PDE&#12289;PTE&#19977;&#20010;&#23646;&#24615;&#36827;&#34892;AND&#36816;&#31639;&#20986;&#26469;&#30340;&#32467;&#26524;&#65292;&#22914;&#26524;&#26159;10-10-12&#20998;&#39029;&#26426;&#21046;&#30340;&#35805;&#23601;&#26159;PDE&#12289;PTE&#36827;&#34892;AND&#36816;&#31639;&#30340;&#32467;&#26524;&#12290;</p>
<p   
>Cr3&#25913;&#20102;&#23601;&#20250;&#30452;&#25509;&#21047;&#26032;TLB&#65288;&#20063;&#23601;&#26159;&#36827;&#31243;&#20999;&#25442;&#65292;<strong class=" ">&#22240;&#20026;&#22312;&#36827;&#31243;&#20999;&#25442;&#21518;TLB&#21407;&#20808;&#23384;&#20648;&#30340;&#32447;&#24615;&#22320;&#22336;&#21644;&#29289;&#29702;&#22320;&#22336;&#30340;&#23545;&#24212;&#20851;&#31995;&#23601;&#27809;&#26377;&#24847;&#20041;&#20102;</strong>&#65289;&#65307;&#30001;&#20110;&#25805;&#20316;&#31995;&#32479;&#20013;&#30340;&#39640;2G&#26144;&#23556;&#22522;&#26412;&#19981;&#21464;&#65292;&#25152;&#20197;&#20026;&#20102;&#19981;&#37325;&#22797;&#30340;&#24314;&#31435;&#39640;2G&#30340;TLB&#23545;&#24212;&#20851;&#31995;&#65292;<strong class=" ">&#22312;PDE&#21644;PTE&#20013;&#26377;&#20010;&#26631;&#24535;&#20301;G&#20301;&#65292;&#23427;&#34920;&#31034;&#20854;&#29289;&#29702;&#39029;&#26159;&#21542;&#20026;&#20840;&#23616;&#39029;&#65292;&#24403;&#35813;&#20540;&#20026;1&#26102;&#21017;&#19981;&#20250;&#21047;&#26032;TLB&#65288;&#21482;&#26377;&#24403;PDE&#30340;PS&#20301;&#20026;1&#26102;&#65292;&#21363;&#20854;&#29289;&#29702;&#39029;&#20026;&#22823;&#39029;&#65292;G&#20301;&#25165;&#26377;&#25928;&#65289;</strong>&#65307;&#24403;TLB&#34920;&#23384;&#28385;&#20102;&#20043;&#21518;&#65292;&#23558;&#26681;&#25454;&#32479;&#35745;&#65288;LRU&#65289;&#20449;&#24687;&#65288;<strong class=" ">&#32479;&#35745;&#20449;&#24687;&#20869;&#23384;&#20648;&#20102;&#27599;&#20010;&#22320;&#22336;&#30340;&#35835;&#20889;&#24773;&#20917;</strong>&#65289;&#23558;&#19981;&#24120;&#29992;&#30340;&#22320;&#22336;&#24223;&#24323;&#65292;&#26368;&#36817;&#24120;&#29992;&#30340;&#20445;&#30041;&#19979;&#26469;&#12290;</p>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeenjeexuw">
        <h3 class="heading "><span>&#31181;&#31867;</span></h3>
<p   
>TLB&#22312;x86&#20307;&#31995;&#30340;CPU&#37324;&#30340;&#23454;&#38469;&#24212;&#29992;&#26368;&#26089;&#26159;&#20174;Intel&#30340;486CPU&#24320;&#22987;&#30340;&#65292;&#22312;x86&#20307;&#31995;&#30340;CPU&#37324;&#65292;&#19968;&#33324;&#37117;&#35774;&#26377;&#22914;&#19979;4&#32452;TLB&#65306;</p>
<ol class=" "><li class=" "><p   
>&#32531;&#23384;&#19968;&#33324;&#39029;&#34920;&#65288;4KB&#23383;&#33410;&#39029;&#38754;&#65289;&#30340;&#25351;&#20196;&#39029;&#34920;&#32531;&#23384;&#65288;Instruction-TLB&#65289;&#65307;</p>
</li><li class=" "><p   
>&#32531;&#23384;&#19968;&#33324;&#39029;&#34920;&#65288;4KB&#23383;&#33410;&#39029;&#38754;&#65289;&#30340;&#25968;&#25454;&#39029;&#34920;&#32531;&#23384;&#65288;Data-TLB&#65289;&#65307;</p>
</li><li class=" "><p   
>&#32531;&#23384;&#22823;&#23610;&#23544;&#39029;&#34920;&#65288;2MB/4MB&#23383;&#33410;&#39029;&#38754;&#65289;&#30340;&#25351;&#20196;&#39029;&#34920;&#32531;&#23384;&#65288;Instruction-TLB&#65289;&#65307;</p>
</li><li class=" "><p   
>&#32531;&#23384;&#22823;&#23610;&#23544;&#39029;&#34920;&#65288;2MB/4MB&#23383;&#33410;&#39029;&#38754;&#65289;&#30340;&#25968;&#25454;&#39029;&#34920;&#32531;&#23384;&#65288;Instruction-TLB&#65289;&#12290;</p>
</li></ol>    </div>
    </div>
    <div class="section section-2" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeS4reaWreS4juW8guW4uA">
        <h2 class="heading "><span>&#20013;&#26029;&#19982;&#24322;&#24120;</span></h2>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeS4reaWrQ">
        <h3 class="heading "><span>&#20013;&#26029;</span></h3>
<p   
>&#20013;&#26029;&#36890;&#24120;&#26159;&#30001;CPU&#22806;&#37096;&#30340;&#36755;&#20837;&#25110;&#36755;&#20986;&#35774;&#22791;&#65288;&#30828;&#20214;&#65289;&#25152;&#35302;&#21457;&#30340;&#65292;&#20379;&#22806;&#37096;&#35774;&#22791;&#36890;&#30693;CPU&#26377;&#20107;&#24773;&#38656;&#35201;&#22788;&#29702;&#65292;&#22240;&#27492;&#21448;&#31216;&#20043;&#20026;&#20013;&#26029;&#35831;&#27714;&#65288;IRQ-Interrupt Request&#65289;&#12290;</p>
<p   
>&#20013;&#26029;&#35831;&#27714;&#30340;&#30446;&#30340;&#26159;<strong class=" ">&#24076;&#26395;CPU&#26242;&#26102;&#20572;&#27490;&#25191;&#34892;&#24403;&#21069;&#27491;&#22312;&#25191;&#34892;&#30340;&#31243;&#24207;</strong>&#65292;&#36716;&#21435;&#25191;&#34892;&#20013;&#26029;&#35831;&#27714;&#25152;&#23545;&#24212;&#30340;&#20013;&#26029;&#22788;&#29702;&#31243;&#24207;&#65288;&#20013;&#26029;&#22788;&#29702;&#31243;&#24207;&#22312;&#21738;&#30001;IDT&#34920;&#20915;&#23450;&#65289;&#12290;</p>
<p   
>80x86&#26377;&#20004;&#26465;&#20013;&#26029;&#35831;&#27714;&#32447;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#19981;&#21487;&#23631;&#34109;&#20013;&#26029;&#32447;&#65292;&#31216;&#20026;NMI&#65288;NonMaskable Interrupt&#65289;&#65307;</p>
</li><li class=" "><p   
>&#21487;&#23631;&#34109;&#20013;&#26029;&#32447;&#65292;&#31216;&#20026;INTR&#65288;Interrupt Require&#65289;&#12290;</p>
</li></ol>    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeS4jeWPr-Wxj-iUveS4reaWree6vw">
        <h4 class="heading "><span>&#19981;&#21487;&#23631;&#34109;&#20013;&#26029;&#32447;</span></h4>
<p   
>&#24403;&#19981;&#21487;&#23631;&#34109;&#20013;&#26029;&#20135;&#29983;&#26102;&#65292;CPU&#20250;&#22312;IDT&#34920;&#20013;&#25214;&#21040;&#19979;&#26631;&#20026;0x2&#30340;&#38376;&#65292;&#36890;&#36807;&#36825;&#20010;&#38376;&#23601;&#21487;&#20197;&#25214;&#21040;&#20013;&#26029;&#22788;&#29702;&#31243;&#24207;&#65307;&#19981;&#21487;&#23631;&#34109;&#20013;&#26029;&#19981;&#21463;EFLAG&#23492;&#23384;&#22120;&#20013;&#30340;IF&#20301;&#30340;&#24433;&#21709;&#65292;&#24403;&#20135;&#29983;&#26102;&#65292;CPU&#24517;&#39035;&#22788;&#29702;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-22_14-39-34.png" alt="images/download/attachments/1015831/image2022-7-22_14-39-34.png" width="400"  />
    </p>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeWPr-Wxj-iUveS4reaWree6vw">
        <h4 class="heading "><span>&#21487;&#23631;&#34109;&#20013;&#26029;&#32447;</span></h4>
<p   
>&#22312;&#30828;&#20214;&#32423;&#23618;&#38754;&#65292;&#21487;&#23631;&#34109;&#20013;&#26029;&#26159;&#30001;&#19968;&#22359;&#19987;&#38376;&#30340;&#33455;&#29255;&#26469;&#31649;&#29702;&#30340;&#65292;&#25105;&#20204;&#31216;&#20043;&#20026;&#20013;&#26029;&#25511;&#21046;&#22120;&#65307;&#23427;&#36127;&#36131;&#20998;&#37197;&#32456;&#31471;&#36164;&#28304;&#21644;&#31649;&#29702;&#21508;&#20010;&#20013;&#26029;&#28304;&#21457;&#20986;&#30340;&#20013;&#26029;&#35831;&#27714;&#65307;&#20026;&#20102;&#20415;&#20110;&#26631;&#35782;&#21508;&#20010;&#20013;&#26029;&#35831;&#27714;&#65292;&#20013;&#26029;&#31649;&#29702;&#22120;&#36890;&#24120;&#22312;IRQ&#65288;Interrupt Request&#65289;&#21518;&#38754;&#21152;&#19978;&#25968;&#23383;&#26469;&#34920;&#31034;&#19981;&#21516;&#30340;&#35831;&#27714;&#65292;&#20363;&#22914;&#22312;Windows&#20013;&#26102;&#38047;&#20013;&#26029;&#30340;IRQ&#32534;&#21495;&#20026;0&#65292;&#20063;&#23601;&#26159;IRQ0&#12290;</p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#22312;&#36890;&#36807;&#36825;&#20010;&#36335;&#24452;&#65306;&#21491;&#38190;&#25105;&#30340;&#30005;&#33041;-&#31649;&#29702;-&#35774;&#22791;&#31649;&#29702;&#22120;-System timer-&#23646;&#24615;-&#36164;&#28304;&#65292;&#25214;&#21040;Windows&#26102;&#38047;&#30340;&#20013;&#26029;&#32534;&#21495;&#65288;&#20854;&#20182;&#35774;&#22791;&#20063;&#26159;&#19968;&#26679;&#30340;&#65289;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-22_14-49-2.png" alt="images/download/attachments/1015831/image2022-7-22_14-49-2.png" width="600"  />
    </p>
<p   
>&#24403;&#21487;&#23631;&#34109;&#20013;&#26029;&#20135;&#29983;&#26102;&#65292;CPU&#20250;&#22312;IDT&#34920;&#20013;&#25214;&#21040;&#19979;&#26631;&#20026;0x30/0x31-0x3F&#30340;&#38376;&#65292;&#36890;&#36807;&#36825;&#20010;&#38376;&#23601;&#21487;&#20197;&#25214;&#21040;&#20013;&#26029;&#22788;&#29702;&#31243;&#24207;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#26102;&#38047;&#20013;&#26029;&#21644;&#20854;&#30828;&#20214;&#35774;&#22791;&#30340;&#20013;&#26029;&#19979;&#26631;&#26159;&#19981;&#19968;&#26679;&#30340;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-22_15-2-28.png" alt="images/download/attachments/1015831/image2022-7-22_15-2-28.png" width="400"  />
    </p>
<p   
>&#22914;&#26524;&#25105;&#20204;&#33258;&#24049;&#30340;&#31243;&#24207;&#25191;&#34892;&#26102;&#19981;&#24076;&#26395;CPU&#21435;&#22788;&#29702;&#36825;&#20123;&#20013;&#26029;&#65292;&#21487;&#20197;&#20351;&#29992;CLI&#25351;&#20196;&#28165;&#31354;EFLAG&#23492;&#23384;&#22120;&#20013;&#30340;IF&#20301;&#65292;&#25110;&#20351;&#29992;STI&#25351;&#20196;&#35774;&#32622;EFLAG&#23492;&#23384;&#22120;&#20013;&#30340;IF&#20301;&#12290;</p>
<p   
>&#38656;&#35201;&#27880;&#24847;&#65292;<strong class=" ">&#30828;&#20214;&#35774;&#22791;&#30340;&#20013;&#26029;&#19982;IDT&#34920;&#20013;&#30340;&#23545;&#24212;&#20851;&#31995;&#19981;&#26159;&#22266;&#23450;&#30340;</strong>&#65292;&#21487;&#20197;&#21442;&#32771;APIC&#65288;Advanced Programmable Interrupt Controller&#65292;&#39640;&#32423;&#21487;&#32534;&#31243;&#20013;&#26029;&#25511;&#21046;&#22120;&#65289;&#12290;</p>
    </div>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeW8guW4uA">
        <h3 class="heading "><span>&#24322;&#24120;</span></h3>
<p   
>&#24322;&#24120;&#36890;&#24120;&#26159;CPU&#22312;&#25191;&#34892;&#25351;&#20196;&#26102;&#26816;&#27979;&#21040;&#30340;&#26576;&#20123;&#38169;&#35823;&#65292;&#27604;&#22914;&#38500;0&#12289;&#35775;&#38382;&#26080;&#25928;&#39029;&#38754;&#31561;&#12290;</p>
<p   
>&#20013;&#26029;&#19982;&#24322;&#24120;&#30340;&#21306;&#21035;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#20013;&#26029;&#26469;&#33258;&#20110;&#22806;&#37096;&#35774;&#22791;&#65292;&#26159;&#20013;&#26029;&#28304;&#65288;&#38190;&#30424;&#12289;&#40736;&#26631;&#31561;&#31561;&#65289;&#21457;&#36215;&#30340;&#65292;CPU&#26159;&#34987;&#21160;&#35302;&#21457;&#30340;&#65307;</p>
</li><li class=" "><p   
>&#24322;&#24120;&#26469;&#33258;&#20110;CPU&#26412;&#36523;&#65292;&#26159;CPU&#20027;&#21160;&#20135;&#29983;&#30340;&#65307;</p>
</li></ol><p   
>&#20043;&#21069;&#25105;&#20204;&#25152;&#20102;&#35299;&#30340;<strong class=" ">INT N&#25351;&#20196;&#34429;&#28982;&#34987;&#31216;&#20043;&#20026;&#36719;&#20214;&#20013;&#26029;&#65292;&#20294;&#20854;&#26412;&#36136;&#26159;&#24322;&#24120;</strong>&#65292;ELFAG&#30340;IF&#20301;&#23545;&#35813;&#25351;&#20196;&#26159;&#26080;&#25928;&#30340;&#12290;</p>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeW8guW4uOWkhOeQhg">
        <h4 class="heading "><span>&#24322;&#24120;&#22788;&#29702;</span></h4>
<p   
>&#26080;&#35770;&#26159;&#30001;&#30828;&#20214;&#35774;&#22791;&#35302;&#21457;&#30340;&#20013;&#26029;&#35831;&#27714;&#36824;&#26159;&#30001;CPU&#20135;&#29983;&#30340;&#24322;&#24120;&#65292;&#22788;&#29702;&#31243;&#24207;&#37117;&#22312;IDT&#34920;&#20013;&#12290;</p>
<p   
>&#24120;&#35265;&#30340;&#24322;&#24120;&#22788;&#29702;&#31243;&#24207;&#22914;&#19979;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-22_15-11-56.png" alt="images/download/attachments/1015831/image2022-7-22_15-11-56.png" width="400"  />
    </p>
    </div>
    <div class="section section-4" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLee8uumhteW8guW4uA">
        <h4 class="heading "><span>&#32570;&#39029;&#24322;&#24120;</span></h4>
<p   
>&#32570;&#39029;&#24322;&#24120;&#22312;&#25805;&#20316;&#31995;&#32479;&#20013;&#26159;&#26080;&#26102;&#19981;&#21051;&#37117;&#22312;&#21457;&#29983;&#30340;&#65292;&#27604;&#22914;<strong class=" ">&#24403;PDE/PTE&#30340;P&#20301;&#20026;0</strong>&#25110;<strong class=" ">PDE/PTE&#30340;&#23646;&#24615;&#20026;&#21482;&#35835;&#20294;&#31243;&#24207;&#35797;&#22270;&#20889;&#20837;</strong>&#65292;&#36825;&#26102;&#20505;&#23601;&#20250;&#20135;&#29983;&#32570;&#39029;&#24322;&#24120;&#12290;</p>
<p   
>&#19968;&#26086;&#21457;&#29983;&#32570;&#39029;&#24322;&#24120;&#65292;CPU&#23601;&#20250;&#25191;&#34892;IDT&#34920;&#20013;0xE&#21495;&#20013;&#26029;&#22788;&#29702;&#31243;&#24207;&#65292;&#20063;&#23601;&#26159;&#30001;&#25805;&#20316;&#31995;&#32479;&#26469;&#25509;&#31649;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-22_15-15-46.png" alt="images/download/attachments/1015831/image2022-7-22_15-15-46.png" width="400"  />
    </p>
    </div>
    </div>
    </div>
    <div class="section section-2" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLeaOp-WItuWvhOWtmOWZqA">
        <h2 class="heading "><span>&#25511;&#21046;&#23492;&#23384;&#22120;</span></h2>
<p   
>&#25511;&#21046;&#23492;&#23384;&#22120;&#20027;&#35201;&#29992;&#20110;&#25511;&#21046;&#21644;&#30830;&#23450;CPU&#30340;&#25805;&#20316;&#27169;&#24335;&#65292;&#19968;&#20849;&#30001;5&#20010;&#25511;&#21046;&#23492;&#23384;&#22120;&#65292;&#20998;&#21035;&#26159;Cr0-4&#65292;Cr1&#26159;&#20445;&#30041;&#30340;&#65292;Cr3&#23601;&#26159;&#25105;&#20204;&#20043;&#21069;&#32463;&#24120;&#20351;&#29992;&#21040;&#30340;&#65292;&#36890;&#36807;Cr3&#21487;&#20197;&#25214;&#21040;&#39029;&#30446;&#24405;&#34920;&#22522;&#22336;&#65288;&#20998;&#39029;&#26426;&#21046;&#20915;&#23450;&#65289;&#12290;</p>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLUNyMOWvhOWtmOWZqA">
        <h3 class="heading "><span>Cr0&#23492;&#23384;&#22120;</span></h3>
<p   
>Cr0&#23492;&#23384;&#22120;&#65292;&#20027;&#35201;&#21253;&#25324;&#19968;&#20123;&#25511;&#21046;&#25805;&#20316;&#31995;&#32479;&#27169;&#24335;&#20197;&#21450;&#22788;&#29702;&#22120;&#29366;&#24577;&#30340;&#25511;&#21046;&#26631;&#24535;&#20301;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-22_15-24-29.png" alt="images/download/attachments/1015831/image2022-7-22_15-24-29.png" width="400"  />
    </p>
<p   
>&#25105;&#20204;&#26469;&#30475;&#19979;&#20960;&#20010;&#20027;&#35201;&#30340;&#26631;&#24535;&#20301;&#65306;</p>
<ol class=" "><li class=" "><p   
>PE&#65306;Cr0&#19979;&#26631;&#20026;0&#30340;&#20301;&#26159;&#21551;&#29992;&#20445;&#25252;&#65288;Protection Enable&#65289;&#26631;&#24535;&#12290;PE&#20026;1&#26102;&#20026;&#20445;&#25252;&#27169;&#24335;&#65292;PE&#20026;0&#26102;&#20026;&#23454;&#22320;&#22336;&#27169;&#24335;&#65292;<strong class=" ">&#36825;&#20010;&#26631;&#24535;&#20165;&#24320;&#21551;&#27573;&#32423;&#20445;&#25252;&#65292;&#32780;&#24182;&#27809;&#26377;&#21551;&#29992;&#20998;&#39029;&#26426;&#21046;&#20445;&#25252;</strong>&#12290;&#33509;&#35201;&#21551;&#29992;&#20998;&#39029;&#26426;&#21046;&#20445;&#25252;&#65292;&#37027;&#20040;PE&#21644;PG&#26631;&#24535;&#37117;&#35201;&#35774;&#20540;&#12290;</p>
</li><li class=" "><p   
>PG&#65306;&#24403;&#35813;&#20301;&#24320;&#21551;&#26102;&#21363;&#24320;&#21551;&#20102;&#20998;&#39029;&#26426;&#21046;&#20445;&#25252;&#65292;&#22312;<strong class=" ">&#24320;&#21551;&#36825;&#20010;&#26631;&#24535;&#20043;&#21069;&#24517;&#39035;&#24050;&#32463;&#25110;&#32773;&#21516;&#26102;&#24320;&#21551;PE&#26631;&#24535;</strong>&#12290;</p>
<ul class=" "><li class=" "><p   
>PG=0&#19988;PE=0&#65306;&#22788;&#29702;&#22120;&#24037;&#20316;&#22312;&#23454;&#22320;&#22336;&#27169;&#24335;&#19979;&#65307;</p>
</li><li class=" "><p   
>PG=0&#19988;PE=1&#65306;&#22788;&#29702;&#22120;&#24037;&#20316;&#22312;&#27809;&#26377;&#24320;&#21551;&#20998;&#39029;&#26426;&#21046;&#30340;&#20445;&#25252;&#27169;&#24335;&#19979;&#65288;&#19981;&#23384;&#22312;&#36825;&#26679;&#30340;&#25805;&#20316;&#31995;&#32479;&#65289;&#65307;</p>
</li><li class=" "><p   
>PG=1&#19988;PE=0&#65306;&#22312;PE&#27809;&#26377;&#24320;&#21551;&#30340;&#24773;&#20917;&#19979;&#26080;&#27861;&#24320;&#21551;PG&#65292;&#25152;&#20197;&#36825;&#31181;&#24773;&#20917;&#26159;&#19981;&#23384;&#22312;&#30340;&#65307;</p>
</li><li class=" "><p   
>PG=1&#19988;PE=1&#65306;&#22788;&#29702;&#22120;&#24037;&#20316;&#22312;&#24320;&#21551;&#20102;&#20998;&#39029;&#26426;&#21046;&#30340;&#20445;&#25252;&#27169;&#24335;&#19979;&#12290;</p>
</li></ul></li><li class=" "><p   
>WP&#65306;&#23545;&#20110;Intel 80486&#25110;&#20197;&#19978;&#30340;CPU&#65292;CR0&#30340;&#31532;16&#20301;&#26159;&#20889;&#20445;&#25252;&#65288;Write Proctect&#65289;&#26631;&#24535;&#65292;&#24403;&#35774;&#32622;&#35813;&#26631;&#24535;&#26102;&#65292;&#22788;&#29702;&#22120;&#20250;&#31105;&#27490;&#36229;&#32423;&#29992;&#25143;&#31243;&#24207;&#65288;&#20363;&#22914;&#29305;&#26435;&#32423;0&#30340;&#31243;&#24207;&#65289;&#21521;&#29992;&#25143;&#32423;&#21482;&#35835;&#39029;&#38754;&#25191;&#34892;&#20889;&#25805;&#20316;&#12290;</p>
<ul class=" "><li class=" "><p   
>&#23545;&#20110;0&#29615;&#31243;&#24207;&#65292;&#22914;&#26524;WP=0&#65292;&#21487;&#20197;<strong class=" ">&#35835;&#20889;</strong>&#20219;&#24847;&#29992;&#25143;&#32423;&#29289;&#29702;&#39029;&#65292;&#21482;&#35201;&#32447;&#24615;&#22320;&#22336;&#26377;&#25928;&#65307;</p>
</li><li class=" "><p   
>&#23545;&#20110;0&#29615;&#31243;&#24207;&#65292;&#22914;&#26524;WP=1&#65292;&#21487;&#20197;<strong class=" ">&#35835;&#21462;</strong>&#20219;&#24847;&#29992;&#25143;&#32423;&#29289;&#29702;&#39029;&#65292;&#20294;&#23545;&#20110;&#21482;&#35835;&#30340;&#29289;&#29702;&#39029;&#65292;&#21017;&#19981;&#33021;&#20889;&#12290;</p>
</li></ul></li></ol>    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLUNyMuWvhOWtmOWZqA">
        <h3 class="heading "><span>Cr2&#23492;&#23384;&#22120;</span></h3>
<p   
>&#24403;CPU&#35775;&#38382;&#26576;&#20010;&#26080;&#25928;&#39029;&#26102;&#65292;&#20250;&#20135;&#29983;&#32570;&#39029;&#24322;&#24120;&#65292;&#27492;&#26102;CPU&#20250;&#23558;&#24341;&#36215;&#24322;&#24120;&#30340;&#32447;&#24615;&#22320;&#22336;&#23384;&#25918;&#33267;Cr2&#23492;&#23384;&#22120;&#20013;&#65292;&#20197;&#20415;&#25805;&#20316;&#31995;&#32479;&#22788;&#29702;&#23436;&#32570;&#39029;&#24322;&#24120;&#21518;&#65292;&#36820;&#22238;&#21040;&#21407;&#26412;&#25191;&#34892;&#30340;&#20301;&#32622;&#32487;&#32493;&#25191;&#34892;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-22_15-31-58.png" alt="images/download/attachments/1015831/image2022-7-22_15-31-58.png" width="400"  />
    </p>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLUNyNOWvhOWtmOWZqA">
        <h3 class="heading "><span>Cr4&#23492;&#23384;&#22120;</span></h3>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-22_15-40-57.png" alt="images/download/attachments/1015831/image2022-7-22_15-40-57.png" width="400"  />
    </p>
<p   
>PAE&#20301;&#20026;1&#26102;&#65292;&#26159;PAE&#65288;2-9-912&#65289;&#20998;&#39029;&#65307;&#20026;0&#26102;&#65292;&#26159;10-10-12&#20998;&#39029;&#12290;&#20043;&#21069;&#22312;C:\boot.ini&#25991;&#20214;&#20013;&#35774;&#32622;execute/noexecute&#21442;&#25968;&#65292;&#20854;&#26412;&#36136;&#23601;&#26159;&#23601;&#26159;&#20462;&#25913;PAE&#20301;&#65307;PSE&#20301;&#29992;&#20110;&#25511;&#21046;PDE&#20013;PS&#20301;&#30340;&#24320;&#20851;&#65292;&#24403;PSE&#20026;1&#26102;&#65292;PS&#20301;&#25165;&#26377;&#25928;&#12290;&#20855;&#20307;&#22914;&#19979;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-22_15-43-41.png" alt="images/download/attachments/1015831/image2022-7-22_15-43-41.png" width="400"  />
    </p>
    </div>
    </div>
    <div class="section section-2" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVBXVOS4jlBDROS9jQ">
        <h2 class="heading "><span>PWT&#19982;PCD&#20301;</span></h2>
<p   
>&#22312;&#20043;&#21069;&#23398;&#20064;PDE&#12289;PDT&#32467;&#26500;&#20013;&#25105;&#20204;&#27809;&#26377;&#35762;&#35299;PWT&#12289;PCD&#20301;&#65292;&#29616;&#22312;&#25105;&#20204;&#26469;&#20102;&#35299;&#20197;&#19979;&#12290;</p>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLUNQVee8k-WtmA">
        <h3 class="heading "><span>CPU&#32531;&#23384;</span></h3>
<p   
>&#22312;&#20102;&#35299;&#36825;&#20004;&#20010;&#20301;&#20043;&#21069;&#25105;&#20204;&#38656;&#35201;&#26377;&#19968;&#20010;&#21069;&#32622;&#30693;&#35782;&#65292;&#37027;&#23601;&#26159;CPU&#32531;&#23384;&#12290;CPU&#32531;&#23384;&#26159;&#20301;&#20110;CPU&#21644;&#29289;&#29702;&#20869;&#23384;&#20043;&#38388;&#30340;&#20020;&#26102;&#23384;&#20648;&#22120;&#65292;&#23427;&#30340;&#23481;&#37327;&#27604;&#20869;&#23384;&#23567;&#24456;&#22810;&#65292;&#20294;&#26159;&#20132;&#25442;&#36895;&#24230;&#27604;&#20869;&#23384;&#24555;&#24456;&#22810;&#12290;</p>
<p   
>CPU&#32531;&#23384;&#21487;&#20197;&#20570;&#30340;&#24456;&#22823;&#65292;&#25105;&#20204;&#21548;&#30528;&#23427;&#20284;&#20046;&#19982;TLB&#26377;&#30528;&#26576;&#20123;&#30456;&#20284;&#20043;&#22788;&#65292;&#20294;&#23454;&#38469;&#19978;&#26159;&#30001;&#24046;&#24322;&#30340;&#65306;TLB&#32531;&#23384;&#30340;&#26159;&#32447;&#24615;&#22320;&#22336;&#21644;&#29289;&#29702;&#22320;&#22336;&#30340;&#23545;&#24212;&#20851;&#31995;&#65292;CPU&#32531;&#23384;&#30340;&#26159;&#29289;&#29702;&#22320;&#22336;&#21644;&#23454;&#38469;&#20869;&#23481;&#30340;&#23545;&#24212;&#20851;&#31995;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015831/image2022-7-22_15-50-45.png" alt="images/download/attachments/1015831/image2022-7-22_15-50-45.png" width="400"  />
    </p>
    </div>
    <div class="section section-3" id="src-1015831_safe-id-aWQt5L-d5oqk5qih5byPLVBXVC9QQ0Q">
        <h3 class="heading "><span>PWT/PCD</span></h3>
<p   
>PWT&#65288;Page Write Through&#65292;&#39029;&#30452;&#20889;&#65289;&#65292;&#35813;&#20540;&#20026;1&#26102;&#19981;&#20165;&#20889;&#20837;&#32531;&#23384;&#20013;&#65292;&#20063;&#20250;&#20889;&#20837;&#21040;&#20869;&#23384;&#20013;&#65307;&#20026;0&#26102;&#21482;&#20250;&#20889;&#20837;&#32531;&#23384;&#12290;</p>
<p   
>PCD&#65288;Page Cahe Disable&#65292;&#39029;&#32531;&#23384;&#21487;&#32534;&#36753;&#65289;&#65292;&#35813;&#20540;&#20026;1&#26102;&#31105;&#27490;&#20889;&#20837;&#32531;&#23384;&#65292;&#30452;&#25509;&#20889;&#20837;&#20869;&#23384;&#65307;&#27604;&#22914;&#39029;&#34920;&#25152;&#22312;&#30340;&#39029;&#24050;&#32463;&#23384;&#20648;&#22312;TLB&#20013;&#20102;&#65292;&#24182;&#19981;&#38656;&#35201;&#20877;&#32531;&#23384;&#20102;&#65292;&#25152;&#20197;&#35813;&#20301;&#23601;&#21487;&#20197;&#35774;&#20026;1&#12290;</p>
    </div>
    </div>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="%E4%B8%AD%E7%BA%A7%E7%AF%87.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>&#20013;&#32423;&#31687;</span>
        </a>
                <a href="%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>&#31995;&#32479;&#35843;&#29992;</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
