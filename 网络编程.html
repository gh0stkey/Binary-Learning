<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>&#32593;&#32476;&#32534;&#31243; - &#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="1015827">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">BinaryLearning</span>
                    <img class="space-logo" src="global.logo" />
                </h1>
                <a href="Binary-Learning.html" class="ht-space-link">
                    <h2>&#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</h2>
                </a>
                <p><br><a href="https://github.com/gh0stkey/Binary-Learning" target="_blank">ᴀᴜᴛʜᴏʀ: ᴋᴇʏ</a><br><br>不积跬步，无以至千里；<br>不积小流，无以成江海。</p>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=1015818"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Binary-Learning.html">&#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</a></li>
                                                                                     <li><a href="%E5%88%9D%E7%BA%A7%E7%AF%87.html">&#21021;&#32423;&#31687;</a></li>
                                                            </ul>
</div>            <h1 id="src-1015818"> <span>&#32593;&#32476;&#32534;&#31243;</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

    <div class="section section-1" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWfuuacrOamguW_teaJq-ebsg">
        <h1 class="heading "><span>&#22522;&#26412;&#27010;&#24565;&#25195;&#30450;</span></h1>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeS4uuS7gOS5iOmcgOimgeiuoeeul-acuue9kee7nA">
        <h2 class="heading "><span>&#20026;&#20160;&#20040;&#38656;&#35201;&#35745;&#31639;&#26426;&#32593;&#32476;</span></h2>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;A&#12289;B&#12289;C&#19977;&#20010;&#19981;&#21516;&#22320;&#22495;&#30340;&#20027;&#26426;&#35201;&#24819;&#36827;&#34892;&#36890;&#20449;&#19981;&#26159;&#20973;&#31354;&#23601;&#21487;&#20197;&#36890;&#20449;&#30340;&#65292;&#32780;&#26159;&#38656;&#35201;&#22522;&#20110;&#20114;&#32852;&#32593;&#36827;&#34892;&#20114;&#30456;&#36830;&#25509;&#12289;&#36890;&#20449;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-7-5_13-34-4.png" alt="images/download/attachments/1015818/image2021-7-5_13-34-4.png" width="600"  />
    </p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeS4uuS7gOS5iOmcgOimgeWNj-iurg">
        <h2 class="heading "><span>&#20026;&#20160;&#20040;&#38656;&#35201;&#21327;&#35758;</span></h2>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#32418;&#21644;&#34013;&#26159;&#32852;&#21512;&#25915;&#25171;&#32511;&#65292;&#23427;&#20204;&#20197;&#28925;&#28779;&#20026;&#20449;&#21495;&#20986;&#21160;&#25915;&#25171;&#32511;&#65292;&#37027;&#20040;&#36825;&#26102;&#20505;&#23601;&#38656;&#35201;&#19968;&#20010;&#32422;&#23450;&#65292;&#27604;&#22914;&#32418;&#20808;&#28857;&#28925;&#28779;&#65292;&#28982;&#21518;&#34013;&#30475;&#35265;&#20102;&#29436;&#28895;&#20877;&#28857;&#28925;&#28779;&#65292;&#32418;&#30475;&#35265;&#20102;&#34013;&#30340;&#29436;&#28895;&#20043;&#21518;&#29060;&#28781;&#28925;&#28779;&#65292;&#20197;&#27492;&#34920;&#31034;&#33258;&#24049;&#30475;&#35265;&#20102;&#65292;&#32780;&#34013;&#30475;&#35265;&#20102;&#32418;&#29060;&#28781;&#28925;&#28779;&#20043;&#21518;&#20063;&#29060;&#28781;&#33258;&#24049;&#30340;&#28925;&#28779;&#20197;&#27492;&#34920;&#31034;&#33258;&#24049;&#30693;&#36947;&#32418;&#30475;&#35265;&#20102;&#27492;&#20449;&#21495;&#65292;&#32780;&#21518;&#20004;&#20154;&#23601;&#38656;&#35201;&#20877;&#32422;&#23450;&#20449;&#21495;&#19968;&#36215;&#25972;&#39039;&#20986;&#20891;&#20197;&#30830;&#20445;&#27809;&#26377;&#22833;&#35823;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-7-5_21-41-39.png" alt="images/download/attachments/1015818/image2021-7-5_21-41-39.png" width="600"  />
    </p>
<p   
>&#25152;&#20197;&#25105;&#20204;&#30693;&#36947;&#34013;&#21644;&#32418;&#20043;&#38388;&#30340;&#36890;&#20449;&#19981;&#33021;&#20445;&#35777;100%&#25104;&#21151;&#65292;&#20294;&#26159;&#35201;&#23613;&#37327;&#20445;&#35777;&#27809;&#26377;&#22833;&#35823;&#30340;&#35805;&#23601;&#38656;&#35201;&#19968;&#36941;&#21448;&#19968;&#36941;&#30340;&#21435;&#30830;&#35748;&#65292;&#32780;&#36825;&#20123;&#19968;&#27425;&#21448;&#19968;&#27425;&#30340;&#30830;&#23450;&#23601;&#26159;&#21452;&#26041;&#23450;&#19979;&#30340;&#21327;&#35758;&#65307;&#30001;&#27492;&#25105;&#20204;&#21487;&#20197;&#28165;&#26970;&#30340;&#35748;&#35782;&#21040;&#25105;&#20204;&#22312;&#32593;&#32476;&#36890;&#20449;&#20013;&#26159;&#24517;&#39035;&#35201;&#26377;&#21327;&#35758;&#30340;&#23384;&#22312;&#30340;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeS4uuS7gOS5iOmcgOimgei_meS5iOWkmuWNj-iurg">
        <h2 class="heading "><span>&#20026;&#20160;&#20040;&#38656;&#35201;&#36825;&#20040;&#22810;&#21327;&#35758;</span></h2>
<p   
>&#19978;&#25991;&#20013;&#25105;&#20204;&#20030;&#20102;&#20004;&#20891;&#21327;&#21516;&#20316;&#25112;&#65292;&#20182;&#20204;&#20043;&#38388;&#26377;&#20010;&#20316;&#25112;&#21327;&#35758;&#65292;&#32780;&#19968;&#26086;&#20316;&#25112;&#25104;&#21151;&#65292;&#22842;&#19979;&#23545;&#26041;&#22478;&#27744;&#37027;&#23601;&#38656;&#35201;&#21478;&#22806;&#19968;&#20010;&#29916;&#20998;&#25112;&#26524;&#30340;&#21327;&#35758;&#65292;&#25152;&#20197;&#27599;&#20010;&#19981;&#21516;&#30340;&#22330;&#26223;&#37117;&#20250;&#26377;&#23545;&#24212;&#30340;&#21327;&#35758;&#65292;&#36825;&#26159;&#26377;&#36825;&#20040;&#22810;&#21327;&#35758;&#30340;&#21407;&#22240;&#12290;</p>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#25105;&#20204;&#30340;&#35745;&#31639;&#26426;&#32593;&#32476;&#20063;&#26377;&#24456;&#22810;&#21327;&#35758;&#65292;&#19979;&#38754;&#26159;&#20998;&#20026;&#20116;&#23618;&#65292;&#22914;&#26524;&#20320;&#20102;&#35299;&#36807;&#35745;&#31639;&#26426;&#32593;&#32476;&#21327;&#35758;&#24212;&#35813;&#20250;&#30693;&#36947;&#19971;&#23618;&#27169;&#22411;&#12289;&#20116;&#23618;&#27169;&#22411;&#65292;&#20294;&#26412;&#31456;&#33410;&#19981;&#35762;&#19971;&#23618;&#27169;&#22411;&#32780;&#26159;&#36873;&#25321;&#20116;&#23618;&#27169;&#22411;&#65292;&#22240;&#20026;&#19971;&#23618;&#27169;&#22411;&#26159;&#19968;&#31181;&#29702;&#24819;&#21270;&#30340;&#27169;&#22411;&#65292;&#23454;&#38469;&#24212;&#29992;&#25105;&#20204;&#29992;&#21040;&#30340;&#26159;&#20116;&#23618;&#27169;&#22411;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-7-12_22-7-20.png" alt="images/download/attachments/1015818/image2021-7-12_22-7-20.png" width="600"  />
    </p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-7-20_13-17-26.png" alt="images/download/attachments/1015818/image2021-7-20_13-17-26.png" width="600"  />
    </p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWmguS9leWumuS9jeS6kuiBlOe9keS4iueahOe7iOerrw">
        <h2 class="heading "><span>&#22914;&#20309;&#23450;&#20301;&#20114;&#32852;&#32593;&#19978;&#30340;&#32456;&#31471;</span></h2>
<p   
>&#39318;&#20808;&#25105;&#20204;&#29087;&#30693;&#30340;&#31995;&#32479;&#26159;&#36890;&#36807;&#32447;&#31243;ID&#12289;&#36827;&#31243;ID&#30693;&#36947;&#23545;&#24212;&#30340;&#32447;&#31243;&#21644;&#36827;&#31243;&#30340;&#65292;&#22312;&#27599;&#20010;&#22269;&#23478;&#20844;&#27665;&#37117;&#26159;&#26377;&#36523;&#20221;&#35777;&#21495;&#30721;&#30340;&#65292;&#36825;&#20063;&#29992;&#26469;&#23450;&#20301;&#20320;&#36825;&#20010;&#20154;&#65307;&#22312;&#20114;&#32852;&#32593;&#19978;&#21516;&#26679;&#20063;&#26377;&#36825;&#26679;&#19968;&#20010;&#26631;&#35782;&#21435;&#30830;&#35748;&#32456;&#31471;&#65292;&#36825;&#23601;&#26159;<strong class=" ">IP&#22320;&#22336;</strong>&#12290;</p>
<p   
>IP&#22320;&#22336;&#20197;&quot;<strong class=" ">.</strong>&quot;&#31526;&#21495;&#20998;&#21106;&#65292;&#19968;&#20849;&#26377;&#22235;&#32452;&#65292;&#20363;&#22914;&#65306;120.120.120.120&#65292;&#27599;&#19968;&#32452;&#37117;&#26159;&#30340;&#21306;&#38388;&#37117;&#26159;0&#21040;255&#65292;IP&#22320;&#22336;&#30340;&#32452;&#25104;&#26159;&#32593;&#32476;&#21495;&#21152;&#19978;&#20027;&#26426;&#21495;&#65292;&#32780;&#20855;&#20307;&#30340;&#30028;&#23450;&#25105;&#20204;&#21487;&#20197;&#26597;&#30475;&#19979;&#25991;&#12290;</p>
<p   
>IP&#22320;&#22336;&#20998;&#20026;5&#31867;&#65292;&#20854;&#20998;&#21035;&#22914;&#19979;&#25152;&#31034;&#65306;</p>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col  width="49.0"/>
                                    <col  width="81.0"/>
                                    <col  width="132.0"/>
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>&#31867;&#22411;</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>&#36215;&#22987;&#22320;&#22336;</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>&#32467;&#26463;&#22320;&#22336;</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>A&#31867;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>0.0.0.0</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>127.255.255.255</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>B&#31867;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>128.0.0.0</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>191.255.255.255</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>C&#31867;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>192.0.0.0</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>223.255.255.255</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>D&#31867;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>224.0.0.0</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>239.255.255.255</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>E&#31867;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>240.0.0.0</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>247.255.255.255</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p   
>&#25105;&#20204;&#19981;&#38656;&#35201;&#27515;&#35760;&#30828;&#32972;&#65292;&#38656;&#35201;&#30340;&#26102;&#20505;&#33258;&#24049;&#26597;&#19979;&#23601;&#21487;&#20197;&#65292;&#20855;&#20307;&#21547;&#20041;&#32593;&#19978;&#24456;&#22810;&#65292;&#36825;&#37324;&#19981;&#36807;&#22810;&#36184;&#36848;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-7-14_20-56-53.png" alt="images/download/attachments/1015818/image2021-7-14_20-56-53.png" width="600"  />
    </p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWmguS9leWMuuWIhuWHuue9kee7nOWPt-OAgeS4u-acuuWPtw">
        <h2 class="heading "><span>&#22914;&#20309;&#21306;&#20998;&#20986;&#32593;&#32476;&#21495;&#12289;&#20027;&#26426;&#21495;</span></h2>
<p   
>&#22914;&#19978;&#22270;&#20013;&#25105;&#20204;&#21487;&#20197;&#30693;&#36947;IP&#22320;&#22336;&#20998;&#25104;&#20102;&#32593;&#32476;&#21495;&#21644;&#20027;&#26426;&#21495;&#20004;&#37096;&#20998;&#65292;&#36890;&#36807;&#23376;&#32593;&#25513;&#30721;&#21487;&#20197;&#20174;IP&#22320;&#22336;&#20013;&#21306;&#20998;&#20986;&#32593;&#32476;&#21495;&#65292;&#20854;&#36816;&#31639;&#35268;&#21017;&#26159;&#65306;<u class=" "><strong class=" ">&#32593;&#32476;&#21495; = IP&#22320;&#22336; &amp;(&#25353;&#20301;&#19982;) &#23376;&#32593;&#25513;&#30721;</strong></u>&#12290;</p>
<p   
>&#25105;&#20204;&#26597;&#30475;&#33258;&#24049;&#26412;&#26426;&#30340;IP&#22320;&#22336;&#21644;&#23376;&#32593;&#25513;&#30721;&#26469;&#35745;&#31639;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-7-13_13-16-49.png" alt="images/download/attachments/1015818/image2021-7-13_13-16-49.png" width="600"  />
    </p>
<p   
>IP&#22320;&#22336;&#65306;<strong class=" ">192.168.8.117</strong>&#65292;&#23376;&#32593;&#25513;&#30721;&#65306;<strong class=" ">255.255.255.0</strong>&#65292;&#23558;&#36825;&#20004;&#20010;&#36716;&#20026;&#20108;&#36827;&#21046;&#21017;&#20026;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">11000000.10101000</code><code class="plain">.</code><code class="value">00001000.01110101</code></div>
<div class="line"><code class="value">11111111.11111111</code><code class="plain">.</code><code class="value">11111111.00000000</code></div>
</div>
    </div>
<p   
>&#25105;&#20204;&#36827;&#34892;&#25353;&#20301;&#19982;&#36816;&#31639;&#65292;&#32467;&#26524;&#23601;&#26159;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">11000000.10101000</code><code class="plain">.</code><code class="value">00001000.00000000</code></div>
<div class="line"><code class="plain">C0.A8.</code><code class="value">08.00</code></div>
<div class="line"><code class="value">192.168</code><code class="plain">.</code><code class="value">8.0</code></div>
</div>
    </div>
<p   
>&#37027;&#20040;&#22312;&#36825;&#37324;<strong class=" ">192.168.8.0</strong>&#23601;&#26159;&#20854;&#32593;&#32476;&#21495;&#65292;&#21516;&#26679;&#25105;&#20204;&#21487;&#20197;&#26681;&#25454;&#23376;&#32593;&#25513;&#30721;&#26469;&#33719;&#21462;&#20027;&#26426;&#21495;&#65292;&#20854;&#36816;&#31639;&#35268;&#21017;&#26159;&#65306;<u class=" "><strong class=" ">&#20027;&#26426;&#21495; = IP&#22320;&#22336; &amp;(&#25353;&#20301;&#19982;) ~(&#21462;&#21453;)&#23376;&#32593;&#25513;&#30721;</strong></u>&#12290;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">~ </code><code class="value">11111111.11111111</code><code class="plain">.</code><code class="value">11111111.00000000</code><code class="plain"> </code><code class="comments">// 取反子网掩码</code></div>
<div class="line"><code class="plain">  </code><code class="value">00000000.00000000</code><code class="plain">.</code><code class="value">00000000.11111111</code></div>
<div class="line"><code class="plain">&amp; </code><code class="value">11000000.10101000</code><code class="plain">.</code><code class="value">00001000.01110101</code><code class="plain"> </code><code class="comments">// 按位与</code></div>
<div class="line"><code class="plain">  </code><code class="value">00000000.00000000</code><code class="plain">.</code><code class="value">00000000.01110101</code></div>
<div class="line"><code class="plain">Dec -&gt; </code><code class="value">0.0</code><code class="plain">.</code><code class="value">0.117</code><code class="plain"> </code><code class="comments">// 十进制结果</code></div>
</div>
    </div>
<p   
>&#26368;&#32456;&#32467;&#26524;&#25105;&#20204;&#30693;&#36947;&#20102;&#20854;&#20027;&#26426;&#21495;&#20026;<strong class=" ">0.0.0.117</strong>&#12290;</p>
<p   
>&#23376;&#32593;&#25513;&#30721;&#26412;&#36136;&#19978;&#26159;32&#20301;&#30340;&#20108;&#36827;&#21046;&#65292;&#21482;&#19981;&#36807;&#26159;&#20026;&#20102;&#30475;&#30528;&#30452;&#35266;&#19968;&#20123;&#23601;&#36716;&#20026;&#20102;&#21313;&#36827;&#21046;&#65292;&#23376;&#32593;&#25513;&#30721;1&#25152;&#23545;&#24212;&#30340;&#20301;&#20026;&#32593;&#32476;&#21495;&#20301;&#32780;0&#25152;&#23545;&#24212;&#30340;&#20301;&#20026;&#20027;&#26426;&#21495;&#20301;&#65292;&#20854;&#29992;&#26469;&#21306;&#20998;&#26377;&#20960;&#20010;&#23376;&#32593;&#65292;&#20363;&#22914;&#36825;&#37324;&#25105;&#20204;&#30340;<strong class=" ">255.255.255.0</strong>&#65292;&#36716;&#20026;&#20108;&#36827;&#21046;&#23454;&#38469;&#19978;&#21069;24&#20301;&#26159;&#32593;&#32476;&#20301;&#65292;&#21518;8&#20301;&#26159;&#20027;&#26426;&#20301;&#65292;&#37027;&#20063;&#23601;&#34920;&#31034;&#25105;&#20204;&#21482;&#26377;&#19968;&#20010;&#23376;&#32593;&#65292;&#22312;&#36825;&#37324;&#25105;&#20204;&#30340;&#23376;&#32593;&#22320;&#22336;&#33539;&#22260;&#23601;&#26159;&#65306;<strong class=" ">192.168.8.0-192.168.8.255</strong>&#65292;&#21487;&#29992;&#30340;&#20027;&#26426;&#21495;&#35745;&#31639;&#20844;&#24335;&#23601;&#26159;<strong class=" ">2&#30340;8&#65288;&#20027;&#26426;&#20301;&#65289;&#27425;&#26041;-2</strong>&#65292;&#36825;&#37324;&#32467;&#26524;&#20063;&#23601;&#26159;254&#65292;&#20026;&#20160;&#20040;&#25105;&#20204;&#36824;&#38656;&#35201;&#20943;&#21435;2&#65292;&#36825;&#26159;&#22240;&#20026;&#26681;&#25454;&#35745;&#31639;&#26041;&#27861;&#65292;<strong class=" ">192.168.8.0&#23601;&#26159;&#32593;&#32476;&#21495;&#65288;&#20195;&#34920;&#24403;&#21069;&#32593;&#32476;&#65289;&#65292;</strong>&#21516;&#26102;&#26681;&#25454;&#23450;&#20041;&#65292;<strong class=" ">&#20027;&#26426;&#21495;&#20301;&#20840;&#20026;1&#30340;&#22320;&#22336;&#20026;&#27492;&#32593;&#27573;&#30340;&#24191;&#25773;&#22320;&#22336;</strong>&#65292;&#27492;&#26102;&#30340;&#24191;&#25773;&#22320;&#22336;&#20026;<strong class=" ">192.168.8.255</strong>&#65292;&#21435;&#25481;&#32593;&#32476;&#22320;&#22336;&#21644;&#24191;&#25773;&#22320;&#22336;&#65292;&#20063;&#23601;&#26159;254&#20010;&#20027;&#26426;&#21495;&#21487;&#29992;&#12290;</p>
<p   
>&#32780;&#22914;&#26524;&#25105;&#20204;&#30340;&#23376;&#32593;&#25513;&#30721;&#20026;<strong class=" ">255.255.255.192</strong>&#65292;&#36716;&#20026;&#20108;&#36827;&#21046;&#23601;&#26159;<strong class=" ">11111111.11111111.11111111.11000000</strong>&#65292;&#21487;&#20197;&#30475;&#35265;&#20854;&#22312;&#25105;&#20204;&#30340;&#21407;&#20808;&#30340;&#21518;8&#20301;&#20027;&#26426;&#20301;&#20013;&#21344;&#29992;&#20102;2&#20301;&#20316;&#20026;&#32593;&#32476;&#20301;&#65292;&#29616;&#22312;&#26377;26&#20010;1&#65292;&#37027;&#20040;&#26681;&#25454;&#20108;&#36827;&#21046;&#38750;0&#21363;1&#65292;&#20854;&#34920;&#29616;&#26041;&#24335;&#23601;&#26377;<strong class=" ">11000000&#12289;10000000&#12289;00000000&#12289;01000000</strong>&#65292;&#20063;&#23601;&#26159;&#35828;&#25105;&#20204;&#23558;&#21407;&#26377;&#30340;<strong class=" ">192.168.8.0</strong>&#36825;&#20010;&#32593;&#32476;&#20998;&#25104;&#20102;&#22235;&#20221;&#65292;&#21363;4&#20010;&#23376;&#32593;&#65292;&#20063;&#21487;&#20197;&#29702;&#35299;&#20026;&#36825;&#37324;&#23601;&#26159;<strong class=" ">2&#30340;2&#65288;&#21518;8&#20301;&#20027;&#26426;&#20301;&#20013;&#21344;&#29992;&#20102;2&#20301;&#65289;&#27425;&#26041;</strong>&#65292;&#29616;&#22312;&#25105;&#20204;&#23558;&#23427;&#20204;&#36716;&#25442;&#25104;10&#36827;&#21046;&#23601;&#20998;&#21035;&#26159;<strong class=" ">0&#12289;64&#12289;128&#12289;192</strong>&#65292;&#37027;&#20040;&#36825;4&#27573;&#32593;&#32476;&#30340;&#33539;&#22260;&#22914;&#19979;&#25152;&#31034;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">192.168</code><code class="plain">.</code><code class="value">8.0</code><code class="plain"> - </code><code class="value">192.168</code><code class="plain">.</code><code class="value">8.63</code></div>
<div class="line"><code class="value">192.168</code><code class="plain">.</code><code class="value">8.64</code><code class="plain"> - </code><code class="value">192.168</code><code class="plain">.</code><code class="value">8.127</code></div>
<div class="line"><code class="value">192.168</code><code class="plain">.</code><code class="value">8.128</code><code class="plain"> - </code><code class="value">192.168</code><code class="plain">.</code><code class="value">8.191</code></div>
<div class="line"><code class="value">192.168</code><code class="plain">.</code><code class="value">8.192</code><code class="plain"> - </code><code class="value">192.168</code><code class="plain">.</code><code class="value">8.255</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeerr-WPo-WPt-aYr-S7gOS5iA">
        <h2 class="heading "><span>&#31471;&#21475;&#21495;&#26159;&#20160;&#20040;</span></h2>
<p   
>&#38382;&#39064;&#65306;&#31995;&#32479;&#20013;&#26377;&#24456;&#22810;&#20010;&#36827;&#31243;&#36830;&#30528;&#32593;&#65292;&#27604;&#22914;QQ&#12289;&#24494;&#20449;&#12289;&#36805;&#38647;...&#37027;&#20040;&#31995;&#32479;&#26159;&#22914;&#20309;&#21306;&#20998;&#20986;&#25968;&#25454;&#21253;&#24212;&#35813;&#20998;&#32473;&#21738;&#20010;&#36827;&#31243;&#21602;&#65311;</p>
<p   
>&#31572;&#26696;&#65306;&#31995;&#32479;&#26159;&#26681;&#25454;&#31471;&#21475;&#21495;&#26469;&#21306;&#20998;&#20986;&#25968;&#25454;&#21253;&#24212;&#35813;&#20998;&#32473;&#21738;&#20010;&#36827;&#31243;&#65292;&#27599;&#20010;&#32852;&#32593;&#30340;&#36827;&#31243;&#37117;&#20250;&#20998;&#37197;&#19968;&#20010;&#31995;&#32479;&#21807;&#19968;&#30340;ID&#65292;&#21457;&#36865;&#25968;&#25454;&#21253;&#30340;&#26102;&#20505;&#36825;&#20010;ID&#20063;&#20250;&#25918;&#36827;&#21435;&#65292;&#25509;&#21463;&#25968;&#25454;&#21253;&#30340;&#26102;&#20505;&#23601;&#21487;&#20197;&#26681;&#25454;&#36825;&#20010;ID&#26469;&#20998;&#21035;&#20986;&#23545;&#24212;&#36827;&#31243;&#65292;&#36825;&#20010;ID&#20063;&#23601;&#26159;&#31471;&#21475;&#21495;&#12290;</p>
<p   
>&#27880;&#24847;&#65306;&#31471;&#21475;&#21495;&#30340;&#33539;&#22260;&#23601;&#26159;0-65535</p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLee9keWFs-aYr-S7gOS5iA">
        <h2 class="heading "><span>&#32593;&#20851;&#26159;&#20160;&#20040;</span></h2>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#36335;&#30001;&#22120;&#23601;&#26159;&#19968;&#20010;&#32593;&#20851;&#65292;&#32593;&#20851;&#23601;&#30456;&#24403;&#20110;&#26159;&#32593;&#32476;&#30340;&#19968;&#25159;&#38376;&#65292;&#20851;&#20869;&#26159;&#19968;&#20010;&#32593;&#32476;&#65292;A&#12289;B&#12289;C&#12289;D&#37117;&#21487;&#20197;&#22312;&#36825;&#20010;&#32593;&#20869;&#36827;&#34892;&#36890;&#20449;&#65292;&#23601;&#19981;&#38656;&#35201;&#32593;&#20851;&#20102;&#65292;&#32780;&#22914;&#26524;A&#24819;&#36319;E&#36827;&#34892;&#36890;&#20449;&#23601;&#38656;&#35201;&#36890;&#36807;&#32593;&#20851;&#23558;&#20320;&#30340;&#35831;&#27714;&#36716;&#21457;&#21435;&#36890;&#20449;&#65292;&#36825;&#26159;&#22240;&#20026;E&#19981;&#22312;&#20851;&#20869;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-7-20_13-6-52.png" alt="images/download/attachments/1015818/image2021-7-20_13-6-52.png" width="600"  />
    </p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLUROU-aYr-S7gOS5iA">
        <h2 class="heading "><span>DNS&#26159;&#20160;&#20040;</span></h2>
<p   
>&#20551;&#35774;&#20320;&#35775;&#38382;&#30340;&#26159;www.baidu.com&#65292;&#36825;&#26159;&#19968;&#20010;&#22495;&#21517;&#65292;&#20294;&#26159;&#36825;&#20010;&#22495;&#21517;&#20320;&#24819;&#35201;&#21435;&#35775;&#38382;&#21040;&#30495;&#27491;&#30340;&#37027;&#20123;&#23637;&#31034;&#32473;&#20320;&#30340;&#36164;&#28304;&#20854;&#32972;&#21518;&#23545;&#24212;&#30340;&#27491;&#26159;&#26576;&#20010;&#26381;&#21153;&#22120;&#30340;IP&#65292;&#26681;&#25454;&#36825;&#20010;IP&#21644;&#23545;&#24212;&#30340;&#31471;&#21475;&#20320;&#25165;&#21487;&#20197;&#35775;&#38382;&#21040;&#36164;&#28304;&#65292;&#32780;&#23558;&#22495;&#21517;&#21644;IP&#36827;&#34892;&#20851;&#32852;&#30340;&#27491;&#26159;DNS&#12290;</p>
<p   
>DNS&#26381;&#21153;&#22120;&#36890;&#36807;&#35760;&#24405;&#22495;&#21517;&#21644;IP&#30340;&#20851;&#32852;&#65292;&#24403;&#20320;&#24819;&#35201;&#21435;&#35775;&#38382;&#26576;&#20010;&#22495;&#21517;&#30340;&#26102;&#20505;&#65292;&#23601;&#38656;&#35201;&#32473;DNS&#26381;&#21153;&#22120;&#21457;&#36865;&#35831;&#27714;&#65292;&#32780;&#21518;DNS&#26381;&#21153;&#22120;&#25509;&#25910;&#21040;&#20320;&#30340;&#35831;&#27714;&#65292;&#23558;&#35831;&#27714;&#20013;&#24819;&#35201;&#26597;&#35810;&#30340;&#22495;&#21517;&#22312;DNS&#26381;&#21153;&#22120;&#26412;&#36523;&#30340;&#35760;&#24405;&#20013;&#21435;&#25628;&#32034;&#25214;&#21040;&#23545;&#24212;&#30340;IP&#65292;&#26368;&#21518;&#36820;&#22238;&#32473;&#20320;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-7-20_13-11-43.png" alt="images/download/attachments/1015818/image2021-7-20_13-11-43.png" width="600"  />
    </p>
<p   
><br/></p>
    </div>
    </div>
    <div class="section section-1" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVRDUOWuouaIt-err-WSjOacjeWKoeWZqOerr-e8lueoi-aetuaehA">
        <h1 class="heading "><span>TCP&#23458;&#25143;&#31471;&#21644;&#26381;&#21153;&#22120;&#31471;&#32534;&#31243;&#26550;&#26500;</span></h1>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeS7gOS5iOaYr1RDUA">
        <h2 class="heading "><span>&#20160;&#20040;&#26159;TCP</span></h2>
<p   
>TCP&#65292;&#33521;&#25991;&#20840;&#31216;&#26159;Transmission Control Protocol&#65292;&#20013;&#25991;&#20026;&#20256;&#36755;<strong class=" ">&#25511;&#21046;</strong>&#21327;&#35758;&#65292;&#22312;&#25105;&#20204;&#20043;&#21069;&#25152;&#35828;&#30340;&#20116;&#23618;&#36824;&#26159;&#19971;&#23618;&#27169;&#22411;&#20013;&#65292;TCP&#37117;&#23646;&#20110;&#20256;&#36755;&#23618;&#12290;</p>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;A&#21644;B&#22522;&#20110;TCP&#21327;&#35758;&#36827;&#34892;&#20256;&#36755;&#25511;&#21046;&#65292;&#35813;&#21327;&#35758;&#21487;&#20197;&#25511;&#21046;&#21327;&#35758;&#20256;&#36755;&#25110;&#32773;&#35828;&#20445;&#35777;&#20256;&#36755;&#36807;&#31243;&#20013;&#30340;&#25968;&#25454;&#26159;&#27491;&#30830;&#30340;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-7-20_13-15-17.png" alt="images/download/attachments/1015818/image2021-7-20_13-15-17.png" width="600"  />
    </p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLemdouWQkei_nuaOpQ">
        <h2 class="heading "><span>&#38754;&#21521;&#36830;&#25509;</span></h2>
<p   
>&#20043;&#21069;&#25105;&#20204;&#35828;&#21040;TCP&#21327;&#35758;&#21487;&#20197;&#20445;&#35777;&#20256;&#36755;&#36807;&#31243;&#20013;&#30340;&#25968;&#25454;&#26159;&#27491;&#30830;&#30340;&#65292;&#36825;&#26159;&#22240;&#20026;&#20854;&#26159;<strong class=" ">&#38754;&#21521;&#36830;&#25509;</strong>&#30340;&#32593;&#32476;&#21327;&#35758;&#12290;</p>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#23458;&#25143;&#31471;&#21644;&#26381;&#21153;&#22120;&#31471;&#22522;&#20110;TCP&#36827;&#34892;&#20256;&#36755;&#36890;&#20449;&#65292;&#39318;&#20808;&#23458;&#25143;&#31471;&#35201;&#36319;&#26381;&#21153;&#22120;&#31471;&#35828;&#65288;&#21457;&#36865;&#35831;&#27714;&#65289;&#25105;&#35201;&#36319;&#20320;&#36827;&#34892;&#36830;&#25509;&#65292;&#20854;&#27425;&#26381;&#21153;&#22120;&#31471;&#35201;&#22238;&#24212;&#65288;&#21457;&#36865;&#35831;&#27714;&#65289;&#20801;&#35768;&#23458;&#25143;&#31471;&#36827;&#34892;&#36830;&#25509;&#65292;&#32780;&#21518;&#23458;&#25143;&#31471;&#25165;&#20250;&#22312;&#21457;&#36865;&#19968;&#20010;&#35831;&#27714;&#27491;&#24335;&#36830;&#25509;&#65292;&#36825;&#23601;&#26159;<strong class=" ">&#19977;&#27425;&#25569;&#25163;</strong>&#30340;&#29305;&#28857;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-7-20_13-20-23.png" alt="images/download/attachments/1015818/image2021-7-20_13-20-23.png" width="600"  />
    </p>
<p   
>&#24403;&#23458;&#25143;&#31471;&#21644;&#26381;&#21153;&#22120;&#31471;&#36830;&#36215;&#26469;&#20043;&#21518;&#65292;&#25165;&#26159;&#20250;&#36827;&#20837;&#20256;&#36755;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeacjeWKoeWZqOerr-e8lueoi-ahhuaetg">
        <h2 class="heading "><span>&#26381;&#21153;&#22120;&#31471;&#32534;&#31243;&#26694;&#26550;</span></h2>
<p   
>&#20102;&#35299;&#20102;&#29702;&#35770;&#20043;&#21518;&#23601;&#35201;&#20184;&#35832;&#20110;&#34892;&#21160;&#65292;&#22312;&#32534;&#31243;&#30340;&#26102;&#20505;&#25105;&#20204;&#30340;&#26381;&#21153;&#22120;&#31471;&#35201;&#26377;&#19971;&#20010;&#27493;&#39588;&#21435;&#23436;&#25104;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">1</code><code class="plain">. 创建套接字</code></div>
<div class="line"><code class="value">2</code><code class="plain">. 绑定套接字</code></div>
<div class="line"><code class="value">3</code><code class="plain">. 监听套接字</code></div>
<div class="line"><code class="value">4</code><code class="plain">. 等待连接</code></div>
<div class="line"><code class="value">5</code><code class="plain">. 收发数据</code></div>
<div class="line"><code class="value">6</code><code class="plain">. 断开连接(被动)</code></div>
<div class="line"><code class="value">7</code><code class="plain">. 关闭套接字</code></div>
</div>
    </div>
<p   
>&#36825;&#26102;&#20505;&#23601;&#26377;&#19968;&#20010;&#26032;&#30340;&#19996;&#35199;&#65292;&#23601;&#26159;&#22871;&#25509;&#23383;&#65292;&#36825;&#26159;&#31995;&#32479;&#32473;&#20320;&#25171;&#21253;&#22909;&#30340;&#65292;&#20320;&#21487;&#20197;&#29702;&#35299;&#36825;&#26159;&#32593;&#32476;&#36890;&#20449;&#36807;&#31243;&#20013;&#31471;&#28857;&#30340;&#25277;&#35937;&#34920;&#31034;&#65292;&#32780;&#24819;&#35201;&#23458;&#25143;&#31471;&#21435;&#36830;&#25509;&#26381;&#21153;&#22120;&#31471;&#65292;&#23601;&#38656;&#35201;&#19968;&#23545;&#22871;&#25509;&#23383;&#65292;&#19968;&#20010;&#36816;&#34892;&#22312;&#26381;&#21153;&#22120;&#31471;&#65292;&#19968;&#20010;&#36816;&#34892;&#22312;&#23458;&#25143;&#31471;&#65307;&#22914;&#26524;&#27010;&#24565;&#26080;&#27861;&#24456;&#28165;&#26224;&#30340;&#21435;&#20102;&#35299;&#65292;&#27809;&#20851;&#31995;&#65292;&#22312;&#23454;&#38469;&#32534;&#31243;&#20013;&#20320;&#23601;&#20250;&#26377;&#25152;&#20307;&#20250;&#12290;</p>
    <div class="section section-3" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeaMiemhuuW6j-e8luWGmeS7o-eggQ">
        <h3 class="heading "><span>&#25353;&#39034;&#24207;&#32534;&#20889;&#20195;&#30721;</span></h3>
<p   
>&#39318;&#20808;&#25105;&#20204;&#21019;&#24314;&#19968;&#20010;Win32&#25511;&#21046;&#21488;&#24212;&#29992;&#30340;&#39033;&#30446;&#65292;&#20854;&#27425;&#22312;&#22836;&#37096;&#21253;&#21547;&#25991;&#20214;&#21644;&#35843;&#29992;lib&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;WINSOCK2.H&gt;</code></div>
<div class="line"><code class="plain">#pragma comment(lib, </code><code class="string">"ws2_32.lib"</code><code class="plain">)</code></div>
</div>
    </div>
<p   
>&#25509;&#30528;&#25105;&#20204;&#23601;&#38656;&#35201;&#25353;&#29031;&#39034;&#24207;&#21435;&#32534;&#20889;&#20195;&#30721;&#65292;&#39318;&#20808;&#31532;&#19968;&#27493;&#26159;&#21019;&#24314;&#22871;&#25509;&#23383;&#65292;&#36825;&#20010;&#38656;&#35201;&#29992;&#21040;&#19968;&#20010;&#20989;&#25968;socket&#65292;&#20854;&#35821;&#27861;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">SOCKET socket(</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> af,       </code><code class="comments">// 地址族规范：常见有IPv6（AF_INET6）或IPv4（AF_INET）</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> type,     </code><code class="comments">// 套接字类型：原始套接字SOCKET_RAW（对较低层次的协议直接访问，例如IP、ICMP协议）、SOCK_STREAM面向连接（TCP/IP协议）、SOCK_DGRAM面向无连接（UDP协议）</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> protocol  </code><code class="comments">// 使用的协议：这里我们可以直接写0，这样操作系统就会根据前面两个选项推断出你想用的协议</code></div>
<div class="line"><code class="plain">);</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 实现代码</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">SOCKET sSocket = socket(AF_INET, SOCK_STREAM, </code><code class="value">0</code><code class="plain">);</code></div>
</div>
    </div>
<p   
>&#25509;&#19979;&#26469;&#25105;&#20204;&#30340;&#23601;&#38656;&#35201;&#32465;&#23450;&#22871;&#25509;&#23383;&#65292;&#20351;&#29992;&#20989;&#25968;bind&#65292;&#20854;&#35821;&#27861;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> bind(</code></div>
<div class="line"><code class="plain">  SOCKET s,                          </code><code class="comments">// 套接字：将创建的套接字变量名字写上去</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">const</code><code class="plain"> struct sockaddr FAR *name,   </code><code class="comments">// 网络地址信息：包含通信所需要的相关信息，传递的应该是一个sockaddr结构体，在具体传参的时候，会用该结构体的变体sockaddr_in形式去初始化相关字段</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> namelen                        </code><code class="comments">// sockaddr_in结构体的长度</code></div>
<div class="line"><code class="plain">);</code></div>
</div>
    </div>
<p   
>sockaddr_in&#32467;&#26500;&#20307;&#30340;&#23450;&#20041;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="comments">/*</code></div>
<div class="line"><code class="comments"> * Socket address, internet style.</code></div>
<div class="line"><code class="comments"> */</code></div>
<div class="line"><code class="plain">struct sockaddr_in {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">short</code><code class="plain">   sin_family; </code><code class="comments">// 地址族规范：与创建套接字时候所使用的一致即可</code></div>
<div class="line"><code class="plain">        u_short sin_port; </code><code class="comments">// 端口</code></div>
<div class="line"><code class="plain">        struct  in_addr sin_addr; </code><code class="comments">// IP地址</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">char</code><code class="plain">    sin_zero[</code><code class="value">8</code><code class="plain">]; </code><code class="comments">// 无特殊的含义，只是为了与sockaddr结构体一致，因为在给套接字分配网络地址的时候会调用bind函数，其中的参数会把sockaddr_in结构体转化为sockaddr结构体</code></div>
<div class="line"><code class="plain">};</code></div>
</div>
    </div>
<p   
>&#25105;&#20204;&#21482;&#38656;&#35201;&#20851;&#27880;&#21069;&#19977;&#20010;&#25104;&#21592;&#21363;&#21487;&#65292;&#26368;&#21518;&#19968;&#20010;&#19981;&#29992;&#31649;&#65292;&#21487;&#20197;&#30475;&#35265;IP&#22320;&#22336;&#21448;&#26159;&#19968;&#20010;&#32467;&#26500;&#20307;&#65292;&#25105;&#20204;&#25509;&#30528;&#30475;&#30475;in_addr&#32467;&#26500;&#20307;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="comments">/*</code></div>
<div class="line"><code class="comments"> * Internet address (old style... should be updated)</code></div>
<div class="line"><code class="comments"> */</code></div>
<div class="line"><code class="plain">struct in_addr {</code></div>
<div class="line"><code class="plain">        union {</code></div>
<div class="line"><code class="plain">                struct { u_char s_b1,s_b2,s_b3,s_b4; } S_un_b;</code></div>
<div class="line"><code class="plain">                struct { u_short s_w1,s_w2; } S_un_w;</code></div>
<div class="line"><code class="plain">                u_long S_addr;</code></div>
<div class="line"><code class="plain">        } S_un;</code></div>
<div class="line"><code class="plain">#define s_addr  S_un.S_addr</code></div>
<div class="line"><code class="plain">                                </code><code class="comments">/* can be used for most tcp &amp; ip code */</code></div>
<div class="line"><code class="plain">#define s_host  S_un.S_un_b.s_b2</code></div>
<div class="line"><code class="plain">                                </code><code class="comments">/* host on imp */</code></div>
<div class="line"><code class="plain">#define s_net   S_un.S_un_b.s_b1</code></div>
<div class="line"><code class="plain">                                </code><code class="comments">/* network */</code></div>
<div class="line"><code class="plain">#define s_imp   S_un.S_un_w.s_w2</code></div>
<div class="line"><code class="plain">                                </code><code class="comments">/* imp */</code></div>
<div class="line"><code class="plain">#define s_impno S_un.S_un_b.s_b4</code></div>
<div class="line"><code class="plain">                                </code><code class="comments">/* imp # */</code></div>
<div class="line"><code class="plain">#define s_lh    S_un.S_un_b.s_b3</code></div>
<div class="line"><code class="plain">                                </code><code class="comments">/* logical host */</code></div>
<div class="line"><code class="plain">};</code></div>
</div>
    </div>
<p   
>&#36825;&#20010;&#32467;&#26500;&#20307;&#37324;&#38754;&#21448;&#26159;&#19968;&#20010;&#32852;&#21512;&#20307;&#65292;&#32852;&#21512;&#20307;&#21644;&#32467;&#26500;&#20307;&#26159;&#24046;&#19981;&#22810;&#30340;&#65292;&#21306;&#21035;&#22312;&#20110;&#32852;&#21512;&#20307;&#29992;&#20110;&#35206;&#30422;&#20351;&#29992;&#32780;&#32467;&#26500;&#20307;&#26159;&#19981;&#35206;&#30422;&#20351;&#29992;&#65307;</p>
<p   
>&#24182;&#19988;&#25105;&#20204;&#36890;&#36807;&#20195;&#30721;&#21487;&#20197;&#30475;&#35265;&#36825;&#23601;&#26159;&#19968;&#20010;u_long&#31867;&#22411;&#30340;&#22320;&#22336;&#65292;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;&#20989;&#25968;inet_addr&#26469;&#25353;&#29031;&#32593;&#32476;&#23383;&#33410;&#24207;&#36716;&#25442;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">inet_addr(</code><code class="string">"192.168.1.1"</code><code class="plain">);</code></div>
</div>
    </div>
<p   
>&#26368;&#32456;&#65292;&#25105;&#20204;&#22312;&#36171;&#20540;&#30340;&#26102;&#20505;&#36824;&#26159;&#35201;&#36873;&#25321;&#26576;&#20010;&#25104;&#21592;&#21435;&#36171;&#20540;&#65292;&#20195;&#30721;&#23454;&#29616;&#22914;&#19979;&#65288;&#38656;&#35201;&#27880;&#24847;&#30340;&#26159;&#65292;&#36825;&#37324;&#30340;IP&#22320;&#22336;&#26159;&#19981;&#21487;&#20197;&#20081;&#20889;&#30340;&#38656;&#35201;&#36890;&#36807;&#21629;&#20196;&#34892;&#25110;&#20854;&#20182;&#26041;&#24335;&#33719;&#21462;&#26412;&#26426;&#30340;IP&#22320;&#22336;&#65289;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">sockaddr_in sockAddrInfo = {</code><code class="value">0</code><code class="plain">};    </code><code class="comments">// 初始化</code></div>
<div class="line"><code class="plain">sockAddrInfo.sin_addr.S_un.S_addr = inet_addr(</code><code class="string">"192.168.1.1"</code><code class="plain">); </code><code class="comments">// 地址</code></div>
<div class="line"><code class="plain">sockAddrInfo.sin_port = htons(</code><code class="value">2118</code><code class="plain">); </code><code class="comments">// 端口需要按照网络字节序，所以需要使用htons函数</code></div>
<div class="line"><code class="plain">sockAddrInfo.sin_family = AF_INET; </code><code class="comments">// 地址族规范</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">bind(sSocket, (sockaddr*)&amp;sockAddrInfo, sizeof(sockAddrInfo));</code></div>
</div>
    </div>
<p   
>&#31532;&#19977;&#27493;&#23601;&#26159;&#30417;&#21548;&#22871;&#25509;&#23383;&#65292;&#20351;&#29992;&#20989;&#25968;listen&#65292;&#20854;&#35821;&#27861;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> listen(</code></div>
<div class="line"><code class="plain">  SOCKET s,    </code><code class="comments">// 套接字：将创建的套接字变量名字写上去</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> backlog  </code><code class="comments">// 待处理连接队列的最大长度：表示队列中最多同时有多少个连接请求</code></div>
<div class="line"><code class="plain">);</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 实现代码</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">listen(sSocket, </code><code class="value">1</code><code class="plain">);</code></div>
</div>
    </div>
<p   
>&#31532;&#22235;&#27493;&#31561;&#24453;&#36830;&#25509;&#65292;&#20351;&#29992;&#20989;&#25968;accept&#65292;&#20854;&#35821;&#27861;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">SOCKET accept(</code></div>
<div class="line"><code class="plain">  SOCKET s, </code><code class="comments">// 套接字：将创建的套接字变量名字写上去</code></div>
<div class="line"><code class="plain">  struct sockaddr FAR *addr, </code><code class="comments">// 输出参数，需要传入一个sockaddr结构体的地址</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> FAR *addrlen </code><code class="comments">// 输出参数，需要传入一个sockaddr结构体长度的地址</code></div>
<div class="line"><code class="plain">);</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 实现代码，accept返回的也是一个SOCKET，我们需要赋值一下</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">sockaddr_in acceptSockAddrInfo = {</code><code class="value">0</code><code class="plain">};    </code><code class="comments">// 初始化</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> acceptSockAddrLen = </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">SOCKET aSocket = accept(sSocket, (sockaddr*)&amp;acceptSockAddrInfo, &amp;acceptSockAddrLen);</code></div>
</div>
    </div>
<p   
>&#31532;&#20116;&#27493;&#25910;&#21457;&#25968;&#25454;&#65292;&#39318;&#20808;&#25105;&#20204;&#30475;&#19979;&#25910;&#25968;&#25454;&#65292;&#20351;&#29992;&#21040;&#20989;&#25968;recv&#65292;&#20854;&#35821;&#27861;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> recv(</code></div>
<div class="line"><code class="plain">  SOCKET s,       </code><code class="comments">// 套接字：将accept返回的套接字变量名字写上去</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">char</code><code class="plain"> FAR *buf,  </code><code class="comments">// 输出参数，数据缓冲区，接收到的数据</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> len,        </code><code class="comments">// 缓冲区大小</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> flags       </code><code class="comments">// 指定调用方式的标志，这个我们就直接写0即可</code></div>
<div class="line"><code class="plain">);</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 实现代码</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">char</code><code class="plain"> buf[</code><code class="value">100</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">recv(aSocket, buf, </code><code class="value">100</code><code class="plain">, </code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">printf(</code><code class="string">"Recv data: %s\n"</code><code class="plain">, buf);</code></div>
</div>
    </div>
<p   
>&#25509;&#30528;&#25105;&#20204;&#30475;&#19979;&#21457;&#25968;&#25454;&#65292;&#20351;&#29992;&#20989;&#25968;send&#65292;&#20854;&#35821;&#27861;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> send(</code></div>
<div class="line"><code class="plain">  SOCKET s,             </code><code class="comments">// 套接字：将accept返回的套接字变量名字写上去</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">const</code><code class="plain"> </code><code class="keyword">char</code><code class="plain"> FAR *buf,  </code><code class="comments">// 传输数据的缓冲区</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> len,              </code><code class="comments">// 缓冲区大小</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> flags             </code><code class="comments">// 指定调用方式的标志，这个我们就直接写0即可</code></div>
<div class="line"><code class="plain">);</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 实现代码</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">send(aSocket, buf, strlen(buf)+</code><code class="value">1</code><code class="plain">, </code><code class="value">0</code><code class="plain">);</code></div>
</div>
    </div>
<p   
>&#31532;&#20845;&#27493;&#26029;&#24320;&#36830;&#25509;&#65292;&#25105;&#20204;&#20351;&#29992;shutdown&#20989;&#25968;&#65292;&#20854;&#35821;&#27861;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> shutdown(</code></div>
<div class="line"><code class="plain">  SOCKET s,  </code><code class="comments">// 套接字：将accept返回的套接字变量名字写上去</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> how    </code><code class="comments">// 断开连接的形式：SD_SEND不再发送数据、SD_RECEIVE不再接受数据、SD_BOTH不再收发数据</code></div>
<div class="line"><code class="plain">);</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 实现代码</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">shutdown(aSocket, SD_SEND);</code></div>
</div>
    </div>
<p   
>&#31532;&#19971;&#27493;&#20063;&#26159;&#26368;&#21518;&#19968;&#27493;&#65292;&#20851;&#38381;&#22871;&#25509;&#23383;&#65288;&#36825;&#37324;&#26377;2&#20010;&#37117;&#35201;&#20851;&#38381;&#65289;&#65292;&#20351;&#29992;&#20989;&#25968;closesocket&#65292;&#20854;&#35821;&#27861;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> closesocket(</code></div>
<div class="line"><code class="plain">  SOCKET s  </code><code class="comments">// 套接字：将accept返回的套接字变量名字写上去</code></div>
<div class="line"><code class="plain">);</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 实现代码</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">closesocket(aSocket);</code></div>
<div class="line"><code class="plain">closesocket(sSocket);</code></div>
</div>
    </div>
<p   
>&#36825;&#26102;&#20505;&#36824;&#27809;&#26377;&#32467;&#26463;&#65292;&#38656;&#35201;&#20351;&#29992;&#20989;&#25968;WSAStartup&#36827;&#34892;Winsock&#30340;&#21021;&#22987;&#21270;&#65292;&#20854;&#35821;&#27861;&#26684;&#24335;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> WSAStartup(</code></div>
<div class="line"><code class="plain">  WORD wVersionRequested, </code><code class="comments">// 版本号，指定所需的Windows Sockets版本，我们可以使用MAKEWORD去创建一个版本号</code></div>
<div class="line"><code class="plain">  LPWSADATA lpWSAData </code><code class="comments">// 指向WSADATA数据结构的指针，用于接收Windows Sockets实现的细节</code></div>
<div class="line"><code class="plain">);</code></div>
</div>
    </div>
<p   
>&#23454;&#29616;&#20195;&#30721;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">WORD wsVersion = MAKEWORD(</code><code class="value">2</code><code class="plain">, </code><code class="value">2</code><code class="plain">);</code></div>
<div class="line"><code class="plain">WSADATA wsaData = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">WSAStartup(wsVersion, &amp;wsaData);</code></div>
</div>
    </div>
<p   
>&#26368;&#32456;&#25105;&#20204;&#23454;&#29616;&#20102;&#26381;&#21153;&#22120;&#31471;&#30340;&#21151;&#33021;&#65292;&#23436;&#25972;&#20195;&#30721;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> main(</code><code class="keyword">int</code><code class="plain"> argc, </code><code class="keyword">char</code><code class="plain">* argv[])</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 0. 初始化</code></div>
<div class="line"><code class="plain">    WORD wsVersion = MAKEWORD(</code><code class="value">2</code><code class="plain">, </code><code class="value">2</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    WSADATA wsaData = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    WSAStartup(wsVersion, &amp;wsaData);</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 1. 创建套接字</code></div>
<div class="line"><code class="plain">    SOCKET sSocket = socket(AF_INET, SOCK_STREAM, </code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (SOCKET_ERROR == sSocket) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"套接字闯创建失败!\n"</code><code class="plain"> );</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"套接字闯创建成功!\n"</code><code class="plain"> );</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 2. 绑定套接字</code></div>
<div class="line"><code class="plain">    sockaddr_in sockAddrInfo = {</code><code class="value">0</code><code class="plain">};    </code><code class="comments">// 初始化</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_addr.S_un.S_addr = inet_addr(</code><code class="string">"172.16.176.5"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_port = htons(</code><code class="value">2118</code><code class="plain">); </code><code class="comments">// 端口</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_family = AF_INET; </code><code class="comments">// 地址族规范</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> bRes = bind(sSocket, (sockaddr*)&amp;sockAddrInfo, sizeof(sockAddrInfo));</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (SOCKET_ERROR == bRes) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"绑定失败!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"绑定成功!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 3. 监听套接字</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> lRes = listen(sSocket, </code><code class="value">1</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (SOCKET_ERROR == lRes) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"监听失败!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"监听成功!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 4. 等待连接</code></div>
<div class="line"><code class="plain">    sockaddr_in acceptSockAddrInfo = {</code><code class="value">0</code><code class="plain">};    </code><code class="comments">// 初始化</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> acceptSockAddrLen = sizeof(acceptSockAddrInfo);</code></div>
<div class="line"><code class="plain">    SOCKET aSocket = accept(sSocket, (sockaddr*)&amp;acceptSockAddrInfo, &amp;acceptSockAddrLen);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (INVALID_SOCKET == aSocket) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"服务端等待连接失败!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"服务端等待连接成功!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 5. 收发数据</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> buf[</code><code class="value">100</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 循环</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">while</code><code class="plain"> (</code><code class="keyword">true</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">int</code><code class="plain"> ret = recv(aSocket, buf, </code><code class="value">100</code><code class="plain">, </code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (ret == </code><code class="value">0</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">            </code><code class="comments">// 如果recv返回为0则表示客户端要断开连接，就跳出循环断开连接</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"Recv data: %s\n"</code><code class="plain">, buf);</code></div>
<div class="line"><code class="plain">        send(aSocket, buf, strlen(buf)+</code><code class="value">1</code><code class="plain">, </code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">        memset(buf, </code><code class="value">0</code><code class="plain">, </code><code class="value">100</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 6. 断开连接(被动)</code></div>
<div class="line"><code class="plain">    shutdown(aSocket, SD_SEND);</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 7. 关闭套接字</code></div>
<div class="line"><code class="plain">    closesocket(aSocket);</code></div>
<div class="line"><code class="plain">    closesocket(sSocket);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    WSACleanup();</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>&#26368;&#21518;&#65292;&#22914;&#26524;&#20320;&#19981;&#20351;&#29992;&#20102;&#36825;&#20010;&#25193;&#23637;&#23601;&#38656;&#35201;&#20351;&#29992;WSACleanup&#20989;&#25968;&#21435;&#32456;&#27490;&#20351;&#29992;&#65307;<strong class=" ">&#24314;&#35758;&#22312;&#23454;&#38469;&#32534;&#31243;&#36807;&#31243;&#20013;&#65292;&#24212;&#35813;&#23558;&#20989;&#25968;&#30340;&#36820;&#22238;&#20540;&#23384;&#20648;&#19979;&#26469;&#24182;&#20570;&#21028;&#26029;&#12290;</strong></p>
    </div>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWuouaIt-err-e8lueoi-ahhuaetg">
        <h2 class="heading "><span>&#23458;&#25143;&#31471;&#32534;&#31243;&#26694;&#26550;</span></h2>
<p   
>&#23458;&#25143;&#31471;&#32534;&#31243;&#26694;&#26550;&#30340;&#27493;&#39588;&#23601;&#31616;&#21333;&#20102;&#19968;&#20123;&#65292;&#21482;&#26377;&#20845;&#20010;&#27493;&#39588;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">1</code><code class="plain">. 创建套接字</code></div>
<div class="line"><code class="value">2</code><code class="plain">. 绑定套接字</code></div>
<div class="line"><code class="value">3</code><code class="plain">. 连接服务器</code></div>
<div class="line"><code class="value">4</code><code class="plain">. 收发数据</code></div>
<div class="line"><code class="value">5</code><code class="plain">. 断开连接(主动)</code></div>
<div class="line"><code class="value">6</code><code class="plain">. 关闭套接字</code></div>
</div>
    </div>
<p   
>&#20102;&#35299;&#20102;&#26381;&#21153;&#22120;&#31471;&#22914;&#20309;&#32534;&#20889;&#65292;&#23458;&#25143;&#31471;&#20063;&#23601;&#20102;&#22914;&#25351;&#25484;&#30340;&#65292;&#23454;&#29616;&#20195;&#30721;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> main(</code><code class="keyword">int</code><code class="plain"> argc, </code><code class="keyword">char</code><code class="plain">* argv[])</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 0. 初始化</code></div>
<div class="line"><code class="plain">    WORD wsVersion = MAKEWORD(</code><code class="value">2</code><code class="plain">, </code><code class="value">2</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    WSADATA wsaData = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    WSAStartup(wsVersion, &amp;wsaData);</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 1. 创建套接字</code></div>
<div class="line"><code class="plain">    SOCKET cSocket = socket(AF_INET, SOCK_STREAM, </code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (SOCKET_ERROR == cSocket) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"套接字闯创建失败!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"套接字闯创建成功!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 2. 绑定套接字</code></div>
<div class="line"><code class="plain">    sockaddr_in sockAddrInfo = {</code><code class="value">0</code><code class="plain">};    </code><code class="comments">// 初始化</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_addr.S_un.S_addr = inet_addr(</code><code class="string">"172.16.176.12"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_port = htons(</code><code class="value">2119</code><code class="plain">); </code><code class="comments">// 端口</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_family = AF_INET; </code><code class="comments">// 地址族规范</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> bRes = bind(cSocket, (sockaddr*)&amp;sockAddrInfo, sizeof(sockAddrInfo));</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (SOCKET_ERROR == bRes) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"绑定失败!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"绑定成功!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 3. 连接服务器</code></div>
<div class="line"><code class="plain">    sockaddr_in serverSockAddrInfo = {</code><code class="value">0</code><code class="plain">};    </code><code class="comments">// 初始化</code></div>
<div class="line"><code class="plain">    serverSockAddrInfo.sin_addr.S_un.S_addr = inet_addr(</code><code class="string">"172.16.176.5"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    serverSockAddrInfo.sin_port = htons(</code><code class="value">2118</code><code class="plain">); </code><code class="comments">// 端口</code></div>
<div class="line"><code class="plain">    serverSockAddrInfo.sin_family = AF_INET; </code><code class="comments">// 地址族规范</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> cRes = connect(cSocket, (sockaddr*)&amp;serverSockAddrInfo, sizeof(serverSockAddrInfo));</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (SOCKET_ERROR == cRes) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"与服务器连接失败!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"与服务器连接成功!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 4. 收发数据</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"Input: "</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> sendData[</code><code class="value">100</code><code class="plain">];</code></div>
<div class="line"><code class="plain">    scanf(</code><code class="string">"%s"</code><code class="plain">, sendData);</code></div>
<div class="line"><code class="plain">    send(cSocket, sendData, strlen(sendData)+</code><code class="value">1</code><code class="plain">, </code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> buf[</code><code class="value">100</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    recv(cSocket, buf, </code><code class="value">100</code><code class="plain">, </code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"Recv data: %s \n"</code><code class="plain">, buf);</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 5. 断开连接(主动)</code></div>
<div class="line"><code class="plain">    shutdown(cSocket, SD_SEND);</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 6. 关闭套接字</code></div>
<div class="line"><code class="plain">    closesocket(cSocket);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    WSACleanup();</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>&#19982;&#26381;&#21153;&#22120;&#31471;&#19981;&#21516;&#30340;&#26159;&#65292;&#23458;&#25143;&#31471;&#38656;&#35201;&#36830;&#25509;&#26381;&#21153;&#22120;&#31471;&#65292;&#21516;&#26679;&#20063;&#26159;&#36890;&#36807;sockaddr_in&#32467;&#26500;&#20307;&#21435;&#25351;&#23450;&#26381;&#21153;&#22120;&#31471;&#30340;&#22320;&#22336;&#21644;&#31471;&#21475;&#65292;&#20351;&#29992;&#21040;&#20102;&#19968;&#20010;&#26032;&#30340;&#20989;&#25968;connect&#65292;&#35813;&#20989;&#25968;&#35821;&#27861;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> connect(</code></div>
<div class="line"><code class="plain">  SOCKET s,                         </code><code class="comments">// 套接字：</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">const</code><code class="plain"> struct sockaddr FAR *name,  </code><code class="comments">// sockaddr 结构体</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> namelen                       </code><code class="comments">// 结构体长度</code></div>
<div class="line"><code class="plain">);</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-7_17-33-37.png" alt="images/download/attachments/1015818/image2021-8-7_17-33-37.png" width="600"  />
    </p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLemcgOimgeihpeWFheeahOiDjOaZr-efpeivhg">
        <h2 class="heading "><span>&#38656;&#35201;&#34917;&#20805;&#30340;&#32972;&#26223;&#30693;&#35782;</span></h2>
<p   
>&#34917;&#20805;&#30340;&#32972;&#26223;&#30693;&#35782;&#23454;&#38469;&#19978;&#26159;&#20043;&#21069;&#20063;&#20102;&#35299;&#36807;&#30340;&#23384;&#20648;&#25968;&#25454;&#30340;&#22823;&#12289;&#23567;&#31471;&#30340;&#23384;&#20648;&#27169;&#24335;&#65292;&#36825;&#37324;&#23601;&#19981;&#20877;&#36807;&#22810;&#36184;&#36848;&#12290;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">字节序: 字节与存储位置的关系</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">小端: 将低序字节存储在起始地址</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">大端: 将高序字节存储在起始地址</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">网络字节序: 顾名思义就是网络上的字节序</code></div>
</div>
    </div>
<p   
>&#25105;&#20204;&#38656;&#35201;&#37325;&#28857;&#30340;&#26159;&#32593;&#32476;&#23383;&#33410;&#24207;&#65292;&#20854;&#39038;&#21517;&#24605;&#20041;&#23601;&#26159;&#32593;&#32476;&#19978;&#30340;&#23383;&#33410;&#24207;&#65292;&#27604;&#22914;&#35828;&#19968;&#20010;&#25968;&#25454;&#22312;&#20320;&#30005;&#33041;&#19978;&#23384;&#20648;&#30340;&#26159;&#23567;&#31471;&#23384;&#20648;&#65292;&#32780;&#21487;&#33021;&#22312;&#32593;&#32476;&#20256;&#36755;&#30340;&#26102;&#20505;&#23601;&#26159;&#22823;&#31471;&#27169;&#24335;&#65292;&#25152;&#20197;&#20320;&#23601;&#38656;&#35201;&#23558;&#20320;&#30005;&#33041;&#19978;&#30340;&#23384;&#20648;&#30340;&#25968;&#25454;&#36716;&#25442;&#12290;</p>
    </div>
    </div>
    <div class="section section-1" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVRDUOS4ieasoeaPoeaJi-S4juaKk-WMheWIhuaekA">
        <h1 class="heading "><span>TCP&#19977;&#27425;&#25569;&#25163;&#19982;&#25235;&#21253;&#20998;&#26512;</span></h1>
<p   
>&#34429;&#28982;&#25105;&#20204;&#24050;&#32463;&#20102;&#35299;&#36807;TCP&#19977;&#27425;&#25569;&#25163;&#30340;&#27969;&#31243;&#65292;&#20294;&#26159;&#37324;&#38754;&#20855;&#20307;&#30340;&#32454;&#33410;&#65292;&#25105;&#20204;&#24182;&#19981;&#20102;&#35299;&#65292;&#20102;&#35299;&#36825;&#20123;&#32454;&#33410;&#20063;&#26377;&#20415;&#20110;&#25105;&#20204;&#21435;&#28145;&#20837;&#20102;&#35299;TCP&#21327;&#35758;&#20197;&#21450;&#35299;&#20915;&#20170;&#21518;&#32454;&#33410;&#24615;&#30340;&#38382;&#39064;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-8_11-48-17.png" alt="images/download/attachments/1015818/image2021-8-8_11-48-17.png" width="600"  />
    </p>
<p   
>&#22312;&#36825;&#37324;&#65292;&#25105;&#20204;&#20351;&#29992;Wireshark&#36825;&#20010;&#25235;&#21253;&#24037;&#20855;&#65292;&#19979;&#36733;&#22320;&#22336;&#65306;<a  class="external-link" href="https://www.wireshark.org/">https://www.wireshark.org/</a></p>
<p   
>&#25509;&#19979;&#26469;&#25105;&#20204;&#20351;&#29992;&#20004;&#21488;&#26426;&#22120;&#20316;&#20026;&#26381;&#21153;&#22120;&#31471;&#21644;&#23458;&#25143;&#31471;&#65292;&#22312;&#23458;&#25143;&#31471;&#26426;&#22120;&#19978;&#23433;&#35013;Wireshark&#36719;&#20214;&#36827;&#34892;&#25235;&#21253;&#65292;&#22914;&#19979;&#22270;&#65288;&#24038;&#26381;&#21153;&#22120;&#31471;&#65292;&#21491;&#23458;&#25143;&#31471;&#65289;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-7_20-57-19.png" alt="images/download/attachments/1015818/image2021-8-7_20-57-19.png" width="600"  />
    </p>
<p   
>Wireshark&#30452;&#25509;&#25235;&#32593;&#21345;&#30340;&#27969;&#37327;&#21363;&#21487;&#65292;&#29992;&#36807;&#28388;&#35821;&#27861;&#26469;&#36807;&#28388;&#19968;&#19979;&#65306;<u class=" "><strong class=" ">(ip.dst==172.16.176.5 and tcp.port==2118) or (ip.src==172.16.176.5)</strong></u>&#65292;172.16.176.5&#22320;&#22336;&#20026;&#26381;&#21153;&#22120;&#31471;&#30340;IP&#22320;&#22336;&#65292;172.16.176.12&#22320;&#22336;&#20026;&#23458;&#25143;&#31471;&#30340;IP&#22320;&#22336;&#12290;</p>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#25105;&#20204;&#19968;&#20849;&#25235;&#21040;&#20102;&#19977;&#20010;&#21253;&#65292; &#36825;&#19977;&#20010;&#21253;&#23601;&#26159;&#25105;&#20204;&#25152;&#35828;&#30340;&#19977;&#27425;&#25569;&#25163;&#23545;&#24212;&#30340;&#21253;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-7_20-59-39.png" alt="images/download/attachments/1015818/image2021-8-7_20-59-39.png" width="600"  />
    </p>
<p   
>&#39318;&#20808;&#25105;&#20204;&#21487;&#20197;&#30475;&#21040;&#31532;&#19968;&#20010;&#21253;&#65292;&#23601;&#26159;&#23458;&#25143;&#31471;&#21521;&#26381;&#21153;&#22120;&#31471;&#21457;&#36865;SYN&#65288;&#21516;&#27493;&#24207;&#21015;&#32534;&#21495;&#65289;&#21253;&#65292;&#25105;&#20204;&#21487;&#20197;&#30475;&#35265;&#20854;&#26377;&#19968;&#20010;seq=0&#65292;&#36825;&#34920;&#31034;&#19968;&#20010;&#24207;&#21495;&#65292;&#26159;&#38543;&#26426;&#30340;&#65307;</p>
<p   
>&#25509;&#30528;&#26381;&#21153;&#22120;&#31471;&#21709;&#24212;&#35813;&#35831;&#27714;&#65292;&#36820;&#22238;&#20102;SYN+ACK&#65288;&#30830;&#35748;&#23383;&#31526;&#65289;&#21253;&#34920;&#31034;&#20801;&#35768;&#36830;&#25509;&#65292;&#21516;&#26679;&#20063;&#26377;&#19968;&#20010;seq=0&#65292;&#24182;&#19988;&#22810;&#20986;&#20102;&#19968;&#20010;ack=1&#65292;&#21516;&#26679;&#36825;&#37324;&#30340;seq&#26159;&#38543;&#26426;&#34920;&#31034;&#30340;&#65292;&#32780;ack&#21017;&#26159;&#30001;&#31532;&#19968;&#20010;&#21253;&#30340;seq=0&#36825;&#20010;&#20540;+1&#30340;&#32467;&#26524;&#65307;</p>
<p   
>&#26368;&#21518;&#23458;&#25143;&#31471;&#25910;&#21040;&#30830;&#35748;&#35831;&#27714;&#65292;&#22238;&#24212;&#26381;&#21153;&#22120;&#31471;&#30340;&#35831;&#27714;&#34920;&#31034;&#36830;&#25509;&#25104;&#21151;&#65292;&#21457;&#36865;&#20102;ACK&#21253;&#65292;seq&#25105;&#20204;&#23601;&#19981;&#29992;&#31649;&#20102;&#65292;&#36825;&#37324;ack&#30340;&#20540;&#20063;&#26159;&#31532;&#20108;&#20010;&#21253;&#30340;seq=0&#36825;&#20010;&#20540;+1&#30340;&#32467;&#26524;&#12290;</p>
    </div>
    <div class="section section-1" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVRDUOWbm-asoeaPoeaJi-S4juaKk-WMheWIhuaekA">
        <h1 class="heading "><span>TCP&#22235;&#27425;&#25569;&#25163;&#19982;&#25235;&#21253;&#20998;&#26512;</span></h1>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeS6huino-Wbm-asoeaPoeaJiw">
        <h2 class="heading "><span>&#20102;&#35299;&#22235;&#27425;&#25569;&#25163;</span></h2>
<p   
>&#20043;&#21069;&#25105;&#20204;&#25152;&#20102;&#35299;&#30340;&#19977;&#27425;&#25569;&#25163;&#65292;&#26159;&#22312;&#24314;&#31435;&#36830;&#25509;&#26102;&#30340;&#65292;&#32780;&#25105;&#20204;&#29616;&#22312;&#25152;&#38656;&#35201;&#20102;&#35299;&#30340;&#22235;&#27425;&#25569;&#25163;&#65292;&#21017;&#26159;&#22312;&#26029;&#24320;&#36830;&#25509;&#26102;&#30340;&#65307;&#20320;&#21487;&#20197;&#24605;&#32771;&#19968;&#19979;&#20026;&#20160;&#20040;&#22312;&#36825;&#37324;&#36830;&#25509;&#26102;&#38656;&#35201;&#19977;&#27425;&#25569;&#25163;&#65292;&#32780;&#22312;&#26029;&#24320;&#36830;&#25509;&#26102;&#65292;&#21364;&#38656;&#35201;&#22235;&#27425;&#25569;&#25163;&#21602;&#65311;</p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#30475;&#35265;&#22914;&#19979;&#22270;&#65292;&#20551;&#35774;&#26381;&#21153;&#22120;&#31471;&#21644;&#23458;&#25143;&#31471;&#26159;&#20004;&#20010;&#30456;&#20146;&#30456;&#29233;&#30340;&#24651;&#20154;&#65292;&#23458;&#25143;&#31471;&#25552;&#20986;&#35201;&#36319;&#26381;&#21153;&#22120;&#31471;&#20998;&#25163;&#65292;&#38656;&#35201;&#24471;&#21040;&#26381;&#21153;&#22120;&#31471;&#30340;&#30830;&#35748;&#65292;&#32780;&#19981;&#20165;&#20165;&#26159;&#21333;&#26041;&#38754;&#30340;&#20998;&#25163;&#65292;&#26381;&#21153;&#22120;&#31471;&#20063;&#35201;&#25552;&#20986;&#36319;&#23458;&#25143;&#31471;&#20998;&#25163;&#65292;&#23458;&#25143;&#31471;&#20063;&#35201;&#30830;&#35748;&#12290;&#37027;&#20040;&#20026;&#20160;&#20040;&#38656;&#35201;&#36825;&#26679;&#21602;&#65311;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-8_11-47-48.png" alt="images/download/attachments/1015818/image2021-8-8_11-47-48.png" width="600"  />
    </p>
<p   
>&#36825;&#26102;&#20505;&#25105;&#20204;&#38656;&#35201;&#20102;&#35299;&#36890;&#20449;&#20013;&#30340;&#19977;&#31181;&#36890;&#20449;&#27169;&#24335;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#21333;&#24037;&#65306;A&#21644;B&#36827;&#34892;&#36890;&#20449;&#65292;&#21482;&#33021;&#26377;&#19968;&#26041;&#21457;&#36865;&#65292;&#19968;&#26041;&#25509;&#25910;&#65292;&#21482;&#26377;&#19968;&#26465;&#36890;&#20449;&#32447;&#36335;&#65307;</p>
</li><li class=" "><p   
>&#21452;&#24037;&#65306;A&#21644;B&#36827;&#34892;&#36890;&#20449;&#65292;&#21452;&#26041;&#21487;&#20197;&#21516;&#26102;&#20114;&#30456;&#21457;&#36865;&#25509;&#25910;&#65292;&#26377;&#20004;&#26465;&#36890;&#20449;&#32447;&#36335;&#65307;</p>
</li><li class=" "><p   
>&#20934;&#21452;&#24037;&#65306;A&#21644;B&#36827;&#34892;&#36890;&#20449;&#65292;&#21452;&#26041;&#21487;&#20197;&#20114;&#30456;&#21457;&#36865;&#25509;&#25910;&#65292;&#20294;&#19981;&#21487;&#20197;&#21516;&#26102;&#36827;&#34892;&#65292;&#21482;&#26377;&#19968;&#26465;&#36890;&#20449;&#32447;&#36335;&#12290;</p>
</li></ol><p   
>&#22312;&#20114;&#32852;&#32593;&#20013;&#37319;&#29992;&#20102;&#36825;&#31181;&#21452;&#24037;&#30340;&#36890;&#20449;&#27169;&#24335;&#65292;&#25152;&#20197;&#35828;&#24403;&#23458;&#25143;&#31471;&#32473;&#26381;&#21153;&#22120;&#31471;&#35828;&#35201;&#26029;&#24320;&#36890;&#20449;&#30340;&#26102;&#20505;&#65292;&#23454;&#38469;&#19978;&#21482;&#26029;&#24320;&#20102;&#19968;&#26465;&#36890;&#20449;&#32447;&#36335;&#65292;&#36824;&#26377;&#19968;&#26465;&#36890;&#20449;&#32447;&#36335;&#38656;&#35201;&#26381;&#21153;&#22120;&#31471;&#32473;&#23458;&#25143;&#31471;&#35828;&#35201;&#26029;&#24320;&#36890;&#20449;&#25165;&#20250;&#26029;&#24320;&#12290;</p>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#21457;&#36865;&#26029;&#24320;&#36830;&#25509;&#23601;&#26159;&#20808;&#21457;&#36865;FIN&#21253;&#65292;&#31561;&#24453;&#23545;&#26041;&#21457;&#36865;ACK&#21253;&#22238;&#24212;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-8_11-56-29.png" alt="images/download/attachments/1015818/image2021-8-8_11-56-29.png" width="600"  />
    </p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#26469;&#30475;&#19979;TCP&#24314;&#31435;&#36830;&#25509;&#12289;&#36890;&#20449;&#12289;&#26029;&#24320;&#36830;&#25509;&#20840;&#35980;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-8_11-49-58.png" alt="images/download/attachments/1015818/image2021-8-8_11-49-58.png" width="600"  />
    </p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeaKk-WMheWIhuaekA">
        <h2 class="heading "><span>&#25235;&#21253;&#20998;&#26512;</span></h2>
<p   
>&#22312;&#25235;&#21253;&#20043;&#21069;&#65292;&#25105;&#20204;&#38656;&#35201;&#25913;&#19968;&#19979;&#26381;&#21153;&#22120;&#31471;&#30340;&#20195;&#30721;&#65292;&#22312;&#25910;&#21457;&#25968;&#25454;&#26102;&#65292;&#25105;&#20204;&#24212;&#35813;&#20889;&#19968;&#20010;&#27515;&#24490;&#29615;&#65292;&#28982;&#21518;&#21028;&#26029;recv&#20989;&#25968;&#30340;&#36820;&#22238;&#20540;&#26159;&#21542;&#20026;0&#65292;&#20026;0&#21017;&#34920;&#31034;&#23458;&#25143;&#31471;&#35201;&#26029;&#24320;&#36830;&#25509;&#65292;&#23601;&#36339;&#20986;&#24490;&#29615;&#20174;&#32780;&#36827;&#20837;&#26029;&#24320;&#36830;&#25509;&#30340;&#20195;&#30721;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-8_16-46-1.png" alt="images/download/attachments/1015818/image2021-8-8_16-46-1.png" width="600"  />
    </p>
<p   
>&#26368;&#21518;&#65292;&#26469;&#20351;&#29992;Wireshark&#25235;&#21253;&#27979;&#35797;&#19968;&#19979;&#30475;&#30475;&#36825;&#20010;&#20840;&#35980;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-8_12-32-24.png" alt="images/download/attachments/1015818/image2021-8-8_12-32-24.png" width="600"  />
    </p>
<p   
>&#21487;&#20197;&#30475;&#35265;&#26524;&#28982;&#22914;&#25105;&#20204;&#25152;&#20102;&#35299;&#30340;&#22312;&#26029;&#24320;&#36830;&#25509;&#30340;&#26102;&#20505;&#21457;&#36865;&#20102;FIN&#20197;&#21450;ACK&#21253;&#65292;&#36825;&#37324;&#30340;seq&#30340;&#20540;&#21644;ack&#30340;&#20540;&#19982;&#25105;&#20204;&#20043;&#21069;&#25152;&#35828;&#30340;&#26159;&#19968;&#26679;&#30340;&#65292;seq&#26159;&#38543;&#26426;&#30340;&#65292;&#20294;ack&#30340;&#20540;&#26159;&#26681;&#25454;&#19978;&#19968;&#26465;&#30340;seq&#30340;&#20540;+1&#25152;&#24471;&#20986;&#26469;&#30340;&#12290;</p>
    </div>
    </div>
    <div class="section section-1" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVVEUOWuouaIt-err-WSjOacjeWKoeWZqOerr-e8lueoi-aetuaehA">
        <h1 class="heading "><span>UDP&#23458;&#25143;&#31471;&#21644;&#26381;&#21153;&#22120;&#31471;&#32534;&#31243;&#26550;&#26500;</span></h1>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeS7gOS5iOaYr1VEUA">
        <h2 class="heading "><span>&#20160;&#20040;&#26159;UDP</span></h2>
<p   
>UDP&#26159;User Datagram Protocol&#30340;&#39318;&#23383;&#27597;&#31616;&#20889;&#65292;&#32763;&#35793;&#36807;&#26469;&#23601;&#26159;&#26631;&#35782;&#29992;&#25143;&#25968;&#25454;&#25253;&#21327;&#35758;&#12290;UDP&#20063;&#26159;&#23646;&#20110;&#20256;&#36755;&#23618;&#30340;&#21327;&#35758;&#65292;&#20174;&#21517;&#23383;&#19978;&#26469;&#30475;&#65292;TCP&#26159;&#20256;&#36755;&#25511;&#21046;&#65292;&#32780;UDP&#26159;&#29992;&#25143;&#25968;&#25454;&#25253;&#65292;&#20854;&#23454;&#20063;&#23601;&#35828;&#26126;&#20102;UDP&#21327;&#35758;&#24182;&#19981;&#20250;&#21435;&#25511;&#21046;&#20256;&#36755;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLemdouWQkeaXoOi_nuaOpQ">
        <h2 class="heading "><span>&#38754;&#21521;&#26080;&#36830;&#25509;</span></h2>
<p   
>&#38754;&#21521;&#26080;&#36830;&#25509;&#65292;&#23601;&#26159;&#19981;&#29992;&#21435;&#35810;&#38382;&#26381;&#21153;&#22120;&#20801;&#19981;&#20801;&#35768;&#21457;&#36865;&#25968;&#25454;&#65292;&#20182;&#19981;&#31649;&#20320;&#24590;&#20040;&#21150;&#65292;&#30452;&#25509;&#23601;&#32473;&#20320;&#21457;&#36865;&#25968;&#25454;&#20102;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-8_16-24-34.png" alt="images/download/attachments/1015818/image2021-8-8_16-24-34.png" width="600"  />
    </p>
<p   
>&#36825;&#26679;&#20570;&#30340;&#22909;&#22788;&#23601;&#26159;&#38750;&#24120;&#39640;&#25928;&#65292;&#20294;&#26159;&#21364;&#27809;&#21150;&#27861;&#20445;&#35777;&#25968;&#25454;&#26159;&#21542;&#27491;&#30830;&#22320;&#20256;&#36882;&#36807;&#21435;&#20102;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeacjeWKoeWZqOerr-e8lueoi-ahhuaeti4x">
        <h2 class="heading "><span>&#26381;&#21153;&#22120;&#31471;&#32534;&#31243;&#26694;&#26550;</span></h2>
<p   
>&#22312;UDP&#21327;&#35758;&#20013;&#26381;&#21153;&#22120;&#31471;&#21644;&#23458;&#25143;&#31471;&#30340;&#27010;&#24565;&#34987;&#24369;&#21270;&#20102;&#65292;&#24456;&#38590;&#30028;&#23450;&#23458;&#25143;&#31471;&#19982;&#26381;&#21153;&#31471;&#65292;&#25152;&#20197;&#19968;&#33324;&#22312;UDP&#21327;&#35758;&#20013;&#65292;&#25105;&#20204;&#19981;&#20197;&#26381;&#21153;&#22120;&#31471;&#21644;&#23458;&#25143;&#31471;&#27010;&#24565;&#21435;&#20570;&#31216;&#35859;&#65292;&#32780;&#26159;&#20197;&#31471;&#23545;&#31471;&#36825;&#31181;&#27010;&#24565;&#12290;</p>
<p   
>&#25509;&#30528;&#23601;&#26159;&#26381;&#21153;&#22120;&#31471;&#32534;&#31243;&#26694;&#26550;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">1</code><code class="plain">. 创建套接字</code></div>
<div class="line"><code class="value">2</code><code class="plain">. 绑定套接字</code></div>
<div class="line"><code class="value">3</code><code class="plain">. 收发数据</code></div>
<div class="line"><code class="value">4</code><code class="plain">. 关闭套接字</code></div>
</div>
    </div>
<p   
>&#23454;&#38469;&#20195;&#30721;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> main(</code><code class="keyword">int</code><code class="plain"> argc, </code><code class="keyword">char</code><code class="plain">* argv[])</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 0. 初始化</code></div>
<div class="line"><code class="plain">    WORD wsVersion = MAKEWORD(</code><code class="value">2</code><code class="plain">, </code><code class="value">2</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    WSADATA wsaData = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    WSAStartup(wsVersion, &amp;wsaData);</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 1. 创建套接字</code></div>
<div class="line"><code class="plain">    SOCKET sSocket = socket(AF_INET, SOCK_DGRAM, </code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (SOCKET_ERROR == sSocket) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"套接字闯创建失败!\n"</code><code class="plain"> );</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"套接字闯创建成功!\n"</code><code class="plain"> );</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 2. 绑定套接字</code></div>
<div class="line"><code class="plain">    sockaddr_in sockAddrInfo = {</code><code class="value">0</code><code class="plain">};    </code><code class="comments">// 初始化</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_addr.S_un.S_addr = inet_addr(</code><code class="string">"172.16.176.5"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_port = htons(</code><code class="value">2118</code><code class="plain">); </code><code class="comments">// 端口</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_family = AF_INET; </code><code class="comments">// 地址族规范</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> bRes = bind(sSocket, (sockaddr*)&amp;sockAddrInfo, sizeof(sockAddrInfo));</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (SOCKET_ERROR == bRes) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"绑定失败!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"绑定成功!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 3. 收发数据</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> recvBuf[</code><code class="value">100</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">while</code><code class="plain"> (</code><code class="keyword">true</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">        recvfrom(sSocket, recvBuf, </code><code class="value">100</code><code class="plain">, </code><code class="value">0</code><code class="plain">, NULL, NULL);</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (strlen(recvBuf) != </code><code class="value">0</code><code class="plain">){</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"Recv Data: %s \n"</code><code class="plain">, recvBuf);</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">        memset(recvBuff, </code><code class="value">0</code><code class="plain">, </code><code class="value">100</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 4. 关闭套接字</code></div>
<div class="line"><code class="plain">    closesocket(sSocket);</code></div>
<div class="line"><code class="plain">    WSACleanup();</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>&#30456;&#27604;&#36739;TCP&#21327;&#35758;&#25105;&#20204;&#23569;&#20102;&#24456;&#22810;&#20195;&#30721;&#65292;&#24182;&#19988;&#22312;&#21019;&#24314;&#22871;&#25509;&#23383;&#30340;&#26102;&#20505;&#21442;&#25968;&#21464;&#25104;&#20102;SOCK_DGRAM&#65292;&#25105;&#20204;&#36824;&#38656;&#35201;&#20102;&#35299;&#19968;&#20010;&#26032;&#20989;&#25968;recvfrom&#65292;&#36825;&#20010;&#20989;&#25968;&#26159;&#29992;&#26469;&#25910;&#20449;&#24687;&#30340;&#65292;&#20854;&#35821;&#27861;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> recvfrom(</code></div>
<div class="line"><code class="plain">  SOCKET s,                   </code><code class="comments">// 套接字</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">char</code><code class="plain"> FAR* buf,              </code><code class="comments">// 输出参数，接收数据的缓冲区</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> len,                    </code><code class="comments">// 缓冲区长度</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> flags,                  </code><code class="comments">// 指定调用方式的标志，这个我们就直接写0即可</code></div>
<div class="line"><code class="plain">  struct sockaddr FAR *from,  </code><code class="comments">// 输出参数（可选，我们可以直接写NULL），sockaddr结构体</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> FAR *fromlen            </code><code class="comments">// 输入输出共用参数（可选，我们可以直接写NULL），sockaddr结构体的大小，注意这里需要传入实际的大小</code></div>
<div class="line"><code class="plain">);</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWuouaIt-err-e8lueoi-ahhuaeti4x">
        <h2 class="heading "><span>&#23458;&#25143;&#31471;&#32534;&#31243;&#26694;&#26550;</span></h2>
<p   
>&#20102;&#35299;&#20102;&#65292;&#26381;&#21153;&#31471;&#21464;&#25104;&#26694;&#26550;&#20043;&#21518;&#25105;&#20204;&#20877;&#26469;&#30475;&#23458;&#25143;&#31471;&#20250;&#21457;&#29616;&#65292;&#23427;&#30340;&#27493;&#39588;&#26356;&#21152;&#31616;&#21333;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">1</code><code class="plain">. 创建套接字</code></div>
<div class="line"><code class="value">2</code><code class="plain">. 收发数据</code></div>
<div class="line"><code class="value">3</code><code class="plain">. 关闭套接字</code></div>
</div>
    </div>
<p   
>&#23454;&#38469;&#20195;&#30721;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> main(</code><code class="keyword">int</code><code class="plain"> argc, </code><code class="keyword">char</code><code class="plain">* argv[])</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 0. 初始化</code></div>
<div class="line"><code class="plain">    WORD wsVersion = MAKEWORD(</code><code class="value">2</code><code class="plain">, </code><code class="value">2</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    WSADATA wsaData = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    WSAStartup(wsVersion, &amp;wsaData);</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 1. 创建套接字</code></div>
<div class="line"><code class="plain">    SOCKET cSocket = socket(AF_INET, SOCK_DGRAM, </code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (SOCKET_ERROR == cSocket) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"套接字闯创建失败!\n"</code><code class="plain"> );</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"套接字闯创建成功!\n"</code><code class="plain"> );</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 2. 收发数据</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"Input: "</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> sendBuf[</code><code class="value">100</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    scanf(</code><code class="string">"%s"</code><code class="plain">, sendBuf);</code></div>
<div class="line"><code class="plain">    sockaddr_in sockAddrInfo = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_addr.S_un.S_addr = inet_addr(</code><code class="string">"127.0.0.1"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_port = htons(</code><code class="value">2118</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_family = AF_INET;</code></div>
<div class="line"><code class="plain">    sendto(cSocket, sendBuf, </code><code class="value">100</code><code class="plain">, </code><code class="value">0</code><code class="plain">, (sockaddr*)&amp;sockAddrInfo, sizeof(sockAddrInfo));</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 3. 关闭套接字</code></div>
<div class="line"><code class="plain">    closesocket(cSocket);</code></div>
<div class="line"><code class="plain">    WSACleanup();</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
>&#19982;&#26381;&#21153;&#31471;&#24847;&#20041;&#65292;&#36825;&#37324;&#26377;&#19968;&#20010;&#26032;&#20989;&#25968;sendto&#65292;&#20854;&#35821;&#27861;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> sendto(</code></div>
<div class="line"><code class="plain">  SOCKET s,                        </code><code class="comments">// 套接字</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">const</code><code class="plain"> </code><code class="keyword">char</code><code class="plain"> FAR *buf,             </code><code class="comments">// 发送的数据</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> len,                         </code><code class="comments">// 发送的数据长度</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> flags,                       </code><code class="comments">// 指定调用方式的标志，这个我们就直接写0即可</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">const</code><code class="plain"> struct sockaddr FAR *to,   </code><code class="comments">// sockaddr 结构体，表示发送数据给谁</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">int</code><code class="plain"> tolen                        </code><code class="comments">// sockaddr 结构体长度</code></div>
<div class="line"><code class="plain">);</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVRDUOWSjFVEUOeahOavlOi-gw">
        <h2 class="heading "><span>TCP&#21644;UDP&#30340;&#27604;&#36739;</span></h2>
<p   
>&#22914;&#19979;&#23601;&#26159;TCP&#21327;&#35758;&#21644;UDP&#21327;&#35758;&#30340;&#20248;&#32570;&#28857;&#65292;&#25105;&#20204;&#21487;&#20197;&#26681;&#25454;&#23454;&#38469;&#22330;&#26223;&#24773;&#20917;&#65292;&#24182;&#26681;&#25454;&#20004;&#20010;&#21327;&#35758;&#30340;&#20248;&#32570;&#28857;&#21435;&#36873;&#25321;&#36866;&#21512;&#24403;&#21069;&#22330;&#26223;&#30340;&#21327;&#35758;&#12290;</p>
    <div  class="tablewrap">
        <table class="relative-table wrapped confluenceTable">
                    <colgroup>
                                    <col  width="16.129%"/>
                                    <col  width="35.8065%"/>
                                    <col  width="48.0645%"/>
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>&#21327;&#35758;</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>&#20248;&#28857;</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>&#32570;&#28857;</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>TCP</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&#20256;&#36755;&#21487;&#38752;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&#24930;&#12289;&#20302;&#25928;&#12289;&#27969;&#31243;&#32321;&#29712;</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>UDP</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&#20256;&#36755;&#25928;&#29575;&#39640;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&#20256;&#36755;&#19981;&#21487;&#38752;</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWunueOsOerr-Wvueerr-S6kuebuOaUtuWPkQ">
        <h2 class="heading "><span>&#23454;&#29616;&#31471;&#23545;&#31471;&#20114;&#30456;&#25910;&#21457;</span></h2>
<p   
>&#25105;&#20204;&#24050;&#32463;&#30693;&#36947;&#20102;&#65292;&#22312;UDP&#20013;&#19981;&#23384;&#22312;&#23458;&#25143;&#31471;&#21644;&#26381;&#21153;&#31471;&#30528;&#20004;&#20010;&#27010;&#24565;&#65292;&#25152;&#26377;&#20256;&#36755;&#37117;&#26159;&#31471;&#23545;&#31471;&#30340;&#65292;&#19981;&#20250;&#21306;&#20998;&#65292;&#29616;&#22312;&#25105;&#20204;&#23454;&#29616;&#31471;&#23545;&#31471;&#20114;&#30456;&#25910;&#21457;&#25968;&#25454;&#65292;&#24182;&#19988;&#22312;&#21457;&#20986;&#25110;&#25910;&#21040;&#25968;&#25454;&#20869;&#23481;&#20026;close&#30340;&#26102;&#20505;&#20851;&#38381;&#36830;&#25509;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> main(</code><code class="keyword">int</code><code class="plain"> argc, </code><code class="keyword">char</code><code class="plain">* argv[])</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 0. 初始化</code></div>
<div class="line"><code class="plain">    WORD wsVersion = MAKEWORD(</code><code class="value">2</code><code class="plain">, </code><code class="value">2</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    WSADATA wsaData = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    WSAStartup(wsVersion, &amp;wsaData);</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 1. 创建套接字</code></div>
<div class="line"><code class="plain">    SOCKET cSocket = socket(AF_INET, SOCK_DGRAM, </code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (SOCKET_ERROR == cSocket) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"套接字闯创建失败!\n"</code><code class="plain"> );</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"套接字闯创建成功!\n"</code><code class="plain"> );</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 2. 绑定套接字</code></div>
<div class="line"><code class="plain">    sockaddr_in sockAddrInfo = {</code><code class="value">0</code><code class="plain">};    </code><code class="comments">// 初始化</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_addr.S_un.S_addr = inet_addr(</code><code class="string">"127.0.0.1"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_port = htons(</code><code class="value">2119</code><code class="plain">); </code><code class="comments">// 端口</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_family = AF_INET; </code><code class="comments">// 地址族规范</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> bRes = bind(cSocket, (sockaddr*)&amp;sockAddrInfo, sizeof(sockAddrInfo));</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (SOCKET_ERROR == bRes) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"绑定失败!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"绑定成功!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 3. 收发数据</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> recvBuf[</code><code class="value">100</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> sendBuf[</code><code class="value">100</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    sockaddr sockclient = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    sockaddr_in sockAddrInfoS = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    sockAddrInfoS.sin_addr.S_un.S_addr = inet_addr(</code><code class="string">"127.0.0.1"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    sockAddrInfoS.sin_port = htons(</code><code class="value">2118</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    sockAddrInfoS.sin_family = AF_INET;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">while</code><code class="plain"> (</code><code class="keyword">true</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"Input: "</code><code class="plain">);</code></div>
<div class="line"><code class="plain">        gets(sendBuf); </code><code class="comments">// 这里使用了gets函数替换了scanf函数，是因为scanf函数在获取数据的时候遇到了空格，就不会再去管空格后面的数据了，相当于截断了</code></div>
<div class="line"><code class="plain">        sendto(cSocket, sendBuf, strlen(sendBuf)+</code><code class="value">1</code><code class="plain">, </code><code class="value">0</code><code class="plain">, (sockaddr*)&amp;sockAddrInfoS, sizeof(sockAddrInfoS));</code></div>
<div class="line"><code class="plain">        recvfrom(cSocket, recvBuf, sizeof(recvBuf), </code><code class="value">0</code><code class="plain">, NULL, NULL);</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (strlen(recvBuf) != </code><code class="value">0</code><code class="plain">){</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"Recv Data: %s \n"</code><code class="plain">, recvBuf);</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> ((strcmp(recvBuf, </code><code class="string">"close"</code><code class="plain">)==</code><code class="value">0</code><code class="plain">) || (strcmp(sendBuf, </code><code class="string">"close"</code><code class="plain">)==</code><code class="value">0</code><code class="plain">))</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">        memset(recvBuf, </code><code class="value">0</code><code class="plain">, </code><code class="value">100</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 4. 关闭套接字</code></div>
<div class="line"><code class="plain">    closesocket(cSocket);</code></div>
<div class="line"><code class="plain">    WSACleanup();</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWkmui_nuaOpeS5i-Wkmue6v-eoi-ino-WGs-aWueahiA">
        <h1 class="heading "><span>&#22810;&#36830;&#25509;&#20043;&#22810;&#32447;&#31243;&#35299;&#20915;&#26041;&#26696;</span></h1>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWNlei_nuaOpemdouS4tOeahOeqmOWigw">
        <h2 class="heading "><span>&#21333;&#36830;&#25509;&#38754;&#20020;&#30340;&#31384;&#22659;</span></h2>
<p   
>&#21333;&#36830;&#25509;&#22914;&#19979;&#22270;&#25152;&#31034;&#24403;&#19968;&#20010;&#23458;&#25143;&#31471;&#21644;&#26381;&#21153;&#22120;&#36827;&#34892;&#36890;&#20449;&#26102;&#65292;&#20854;&#23427;&#23458;&#25143;&#31471;&#23601;&#38656;&#35201;&#25490;&#38431;&#65292;&#37027;&#22914;&#26524;&#26159;&#19968;&#20010;&#30005;&#21830;&#32593;&#31449;&#65292;&#20320;&#24819;&#19968;&#19979;&#26377;&#20154;&#20080;&#19996;&#35199;&#20250;&#20808;&#30475;&#24456;&#20037;&#65292;&#28982;&#21518;&#20877;&#23545;&#27604;&#65292;&#28982;&#21518;&#20877;&#25361;&#36873;&#65292;&#24403;&#20182;&#36825;&#19968;&#31995;&#21015;&#21160;&#20316;&#23436;&#25104;&#20043;&#21518;&#21487;&#33021;&#24050;&#32463;&#20960;&#20010;&#23567;&#26102;&#36807;&#21435;&#20102;&#65292;&#37027;&#20040;&#35831;&#38382;&#20320;&#33021;&#24525;&#21463;&#24471;&#20102;&#31561;&#36825;&#20040;&#20960;&#20010;&#23567;&#26102;&#30340;&#38431;&#20237;&#21527;&#65311; &#36825;&#20063;&#26159;&#24403;&#24180;&#32467;&#38754;&#20020;&#30340;&#31384;&#22659;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-9_19-34-8.png" alt="images/download/attachments/1015818/image2021-8-9_19-34-8.png" width="600"  />
    </p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeS7gOS5iOaYr-Wkmui_nuaOpQ">
        <h2 class="heading "><span>&#20160;&#20040;&#26159;&#22810;&#36830;&#25509;</span></h2>
<p   
>&#22810;&#36830;&#25509;&#23601;&#26159;&#35299;&#20915;&#21333;&#36830;&#25509;&#25152;&#38754;&#20020;&#30340;&#31384;&#22659;&#65292;&#20351;&#24471;&#22810;&#20010;&#23458;&#25143;&#31471;&#21487;&#20197;&#21516;&#26102;&#36319;&#19968;&#20010;&#26381;&#21153;&#22120;&#36827;&#34892;&#36890;&#20449;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-9_19-49-13.png" alt="images/download/attachments/1015818/image2021-8-9_19-49-13.png" width="600"  />
    </p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWkmui_nuaOpeaJgOmdouS4tOeahOmXrumimA">
        <h2 class="heading "><span>&#22810;&#36830;&#25509;&#25152;&#38754;&#20020;&#30340;&#38382;&#39064;</span></h2>
<p   
>&#22810;&#36830;&#25509;&#35299;&#20915;&#20102;&#22810;&#23458;&#25143;&#31471;&#19982;&#26381;&#21153;&#22120;&#36890;&#20449;&#25490;&#38431;&#30340;&#38382;&#39064;&#65292;&#20294;&#21516;&#26679;&#20063;&#20250;&#20986;&#29616;&#26032;&#30340;&#38382;&#39064;&#65292;&#24403;&#22810;&#20010;&#23458;&#25143;&#31471;&#36830;&#25509;&#36807;&#26469;&#26102;&#65292;&#26381;&#21153;&#22120;&#24212;&#35813;&#20808;&#32473;&#35841;&#22238;&#22797;&#65311;&#36825;&#26102;&#20505;&#23601;&#20250;&#26377;&#19968;&#20010;&#39034;&#24207;&#36923;&#36753;&#30340;&#38382;&#39064;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-9_20-2-18.png" alt="images/download/attachments/1015818/image2021-8-9_20-2-18.png" width="600"  />
    </p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWkmue6v-eoi-ino-WGs-aWueahiA">
        <h2 class="heading "><span>&#22810;&#32447;&#31243;&#35299;&#20915;&#26041;&#26696;</span></h2>
<p   
>&#20026;&#20102;&#35299;&#20915;&#22810;&#36830;&#25509;&#25152;&#38754;&#20020;&#30340;&#38382;&#39064;&#65292;&#36825;&#26102;&#20505;&#23601;&#38656;&#35201;&#29992;&#21040;&#22810;&#32447;&#31243;&#30340;&#35299;&#20915;&#26041;&#26696;&#65292;&#20026;&#27599;&#20010;&#23458;&#25143;&#31471;&#36830;&#25509;&#24320;&#19968;&#20010;&#32447;&#31243;&#65292;&#20027;&#32447;&#31243;&#21482;&#31649;&#36127;&#36131;&#30417;&#21548;&#23458;&#25143;&#31471;&#36830;&#25509;&#35831;&#27714;&#65292;&#32780;&#30495;&#27491;&#36127;&#36131;&#36890;&#20449;&#30340;&#20219;&#21153;&#36716;&#20132;&#20026;&#24037;&#20316;&#32447;&#31243;&#12290;</p>
<p   
>&#21516;&#26679;&#19968;&#20010;&#19996;&#35199;&#24635;&#20250;&#26377;&#22909;&#20063;&#26377;&#22351;&#65292;&#22312;&#36825;&#37324;&#22810;&#32447;&#31243;&#35299;&#20915;&#26041;&#26696;&#20248;&#28857;&#24456;&#26126;&#26174;&#65292;&#20294;&#32570;&#28857;&#21516;&#26679;&#20063;&#24456;&#33268;&#21629;&#12290;</p>
<p   
>&#20248;&#28857;&#65306;&#25972;&#20010;&#36923;&#36753;&#38750;&#24120;&#28165;&#26970;&#65292;&#32534;&#31243;&#23454;&#29616;&#21450;&#32500;&#25252;&#37117;&#30456;&#23545;&#23481;&#26131;&#65307;</p>
<p   
>&#32570;&#28857;&#65306;&#21344;&#29992;&#31995;&#32479;&#36164;&#28304;&#22826;&#20005;&#37325;&#65292;&#23458;&#25143;&#31471;&#25968;&#37327;&#19978;&#21319;&#21040;&#19968;&#23450;&#31243;&#24230;&#65292;&#23481;&#26131;&#36896;&#25104;&#31995;&#32479;&#30251;&#30186;&#65288;&#36164;&#28304;&#29992;&#20809;&#20102;&#65289;&#12290;</p>
    <div class="section section-3" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWunumZheS7o-eggee8luWGmQ">
        <h3 class="heading "><span>&#23454;&#38469;&#20195;&#30721;&#32534;&#20889;</span></h3>
<p   
>&#23398;&#36807;Win32&#30340;&#35805;&#24212;&#35813;&#20102;&#35299;&#21040;&#24403;&#25105;&#20204;&#25171;&#24320;&#19968;&#20010;&#36827;&#31243;&#30340;&#26102;&#20505;&#65292;&#20250;&#40664;&#35748;&#21551;&#29992;&#19968;&#20010;&#32447;&#31243;&#65288;&#27599;&#20010;&#36827;&#31243;&#33267;&#23569;&#38656;&#35201;&#19968;&#20010;&#32447;&#31243;&#65289;&#65292;&#37027;&#20040;&#25105;&#20204;&#21487;&#20197;&#29992;&#36825;&#20010;&#32447;&#31243;&#20316;&#20026;&#20027;&#32447;&#31243;&#65292;&#36127;&#36131;&#30417;&#21548;&#23458;&#25143;&#31471;&#36830;&#25509;&#35831;&#27714;&#65292;&#20877;&#29992;&#20043;&#21069;&#23398;&#20064;&#21040;&#30340;<strong class=" ">CreateThread</strong>&#20989;&#25968;&#21019;&#24314;&#26032;&#30340;&#24037;&#20316;&#32447;&#31243;&#36127;&#36131;&#36890;&#20449;&#65288;&#25910;&#21457;&#20449;&#24687;&#65289;&#12290;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">DWORD WINAPI ThreadProc(LPVOID lpParameter);</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> main(</code><code class="keyword">int</code><code class="plain"> argc, </code><code class="keyword">char</code><code class="plain">* argv[])</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 0. 初始化</code></div>
<div class="line"><code class="plain">    WORD wsVersion = MAKEWORD(</code><code class="value">2</code><code class="plain">, </code><code class="value">2</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    WSADATA wsaData = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    WSAStartup(wsVersion, &amp;wsaData);</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 1. 创建套接字</code></div>
<div class="line"><code class="plain">    SOCKET sSocket = socket(AF_INET, SOCK_STREAM, </code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (SOCKET_ERROR == sSocket) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"套接字闯创建失败!\n"</code><code class="plain"> );</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"套接字闯创建成功!\n"</code><code class="plain"> );</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 2. 绑定套接字</code></div>
<div class="line"><code class="plain">    sockaddr_in sockAddrInfo = {</code><code class="value">0</code><code class="plain">};    </code><code class="comments">// 初始化</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_addr.S_un.S_addr = inet_addr(</code><code class="string">"127.0.0.1"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_port = htons(</code><code class="value">2118</code><code class="plain">); </code><code class="comments">// 端口</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_family = AF_INET; </code><code class="comments">// 地址族规范</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> bRes = bind(sSocket, (sockaddr*)&amp;sockAddrInfo, sizeof(sockAddrInfo));</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (SOCKET_ERROR == bRes) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"绑定失败!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"绑定成功!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 3. 监听套接字</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> lRes = listen(sSocket, </code><code class="value">1</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (SOCKET_ERROR == lRes) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"监听失败!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"监听成功!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="comments">// 循环</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">while</code><code class="plain"> (</code><code class="keyword">true</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// 4. 等待连接</code></div>
<div class="line"><code class="plain">        sockaddr_in acceptSockAddrInfo = {</code><code class="value">0</code><code class="plain">};    </code><code class="comments">// 初始化</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">int</code><code class="plain"> acceptSockAddrLen = sizeof(acceptSockAddrInfo);</code></div>
<div class="line"><code class="plain">        SOCKET aSocket = accept(sSocket, (sockaddr*)&amp;acceptSockAddrInfo, &amp;acceptSockAddrLen);</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (INVALID_SOCKET != aSocket) {</code></div>
<div class="line"><code class="plain">            HANDLE hThread = CreateThread(NULL, NULL, ThreadProc, (LPVOID)aSocket, </code><code class="value">0</code><code class="plain">, NULL);</code></div>
<div class="line"><code class="plain">            CloseHandle(hThread);</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 7. 关闭套接字</code></div>
<div class="line"><code class="plain">    closesocket(sSocket);</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    WSACleanup();</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">DWORD WINAPI ThreadProc(LPVOID lpParameter) {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> ret = </code><code class="value">1</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    SOCKET aSocket = (SOCKET)lpParameter;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> buf[</code><code class="value">100</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 收发数据</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">do</code><code class="plain"> </code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        ret = recv(aSocket, buf, </code><code class="value">100</code><code class="plain">, </code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (strcmp(buf, </code><code class="string">"close"</code><code class="plain">) == </code><code class="value">0</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"Recv data: %s \n"</code><code class="plain">, buf);</code></div>
<div class="line"><code class="plain">        send(aSocket, buf, strlen(buf)+</code><code class="value">1</code><code class="plain">, </code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">        memset(buf, </code><code class="value">0</code><code class="plain">, </code><code class="value">100</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    } </code><code class="keyword">while</code><code class="plain"> (ret != </code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 断开连接(被动)</code></div>
<div class="line"><code class="plain">    shutdown(aSocket, SD_BOTH);</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 关闭套接字</code></div>
<div class="line"><code class="plain">    closesocket(aSocket);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-9_22-27-57.png" alt="images/download/attachments/1015818/image2021-8-9_22-27-57.png" width="600"  />
    </p>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWkmui_nuaOpeS5i3NlbGVjdOaooeWeiw">
        <h1 class="heading "><span>&#22810;&#36830;&#25509;&#20043;select&#27169;&#22411;</span></h1>
<p   
>&#22810;&#36830;&#25509;&#38656;&#27714;&#20351;&#29992;&#22810;&#32447;&#31243;&#30340;&#26041;&#24335;&#21435;&#28385;&#36275;&#65292;&#20294;&#26159;&#21516;&#26679;&#20063;&#36896;&#25104;&#20102;&#24403;&#23458;&#25143;&#31471;&#36830;&#25509;&#25968;&#37327;&#21040;&#36798;&#19968;&#23450;&#31243;&#24230;&#65292;&#23601;&#20250;&#23548;&#33268;&#21344;&#29992;&#31995;&#32479;&#36164;&#28304;&#22826;&#36807;&#20110;&#20005;&#37325;&#65292;&#25152;&#20197;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;select&#27169;&#22411;&#35299;&#20915;&#26041;&#26696;&#22788;&#29702;&#22810;&#36830;&#25509;&#65292;&#24182;&#33410;&#30465;&#31995;&#32479;&#36164;&#28304;&#12290;</p>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeS7gOS5iOaYr3NlbGVjdOaooeWeiw">
        <h2 class="heading "><span>&#20160;&#20040;&#26159;select&#27169;&#22411;</span></h2>
    <div class="section section-3" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLXNlbGVjdOaooeWei-eahOacrOi0qA">
        <h3 class="heading "><span>select&#27169;&#22411;&#30340;&#26412;&#36136;</span></h3>
<p   
>select&#30340;&#20013;&#25991;&#24847;&#24605;&#26159;&#36873;&#25321;&#65292;&#20063;&#23601;&#34920;&#31034;&#26159;&#20174;&#26576;&#20123;&#19996;&#35199;&#20013;&#21435;&#36873;&#25321;&#33258;&#24049;&#24819;&#35201;&#30340;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#65292;&#26377;&#20004;&#20010;&#22320;&#26041;&#21487;&#20379;&#25105;&#20204;&#36873;&#25321;&#65292;&#20063;&#23601;&#26159;&#21487;&#35835;&#26816;&#27979;&#27744;&#12289;&#21487;&#20889;&#26816;&#27979;&#27744;&#65292;&#22312;&#36825;&#20004;&#20010;&#27744;&#23376;&#37324;&#30340;&#26159;&#25105;&#20204;&#30340;&#22871;&#25509;&#23383;&#21477;&#26564;&#65288;SOCKET&#65289;&#12290;</p>
<p   
>&#20174;&#23383;&#38754;&#24847;&#24605;&#29702;&#35299;&#65292;<strong class=" ">select&#21487;&#20174;&#35832;&#22810;&#36830;&#25509;&#20013;&#26816;&#27979;&#20986;&#21487;&#35835;&#30340;&#65288;accpet&#20989;&#25968;&#65289;&#65292;&#20063;&#23601;&#26159;&#26377;&#21709;&#24212;&#30340;&#36830;&#25509;&#65307;&#20063;&#21487;&#20197;&#20174;&#35832;&#22810;&#36830;&#25509;&#20013;&#26816;&#27979;&#20986;&#21487;&#20889;&#30340;&#65288;recv&#12289;send&#20989;&#25968;&#65289;&#65292;&#20063;&#23601;&#26159;&#21487;&#20197;&#21457;&#36865;&#28040;&#24687;&#30340;&#36830;&#25509;&#12290;</strong></p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-9_23-27-43.png" alt="images/download/attachments/1015818/image2021-8-9_23-27-43.png" width="600"  />
    </p>
    </div>
    <div class="section section-3" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLXNlbGVjdOaooeWei-mAu-i-kQ">
        <h3 class="heading "><span>select&#27169;&#22411;&#36923;&#36753;</span></h3>
<p   
>select&#27169;&#22411;&#36923;&#36753;&#27493;&#39588;&#22914;&#19979;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#23558;&#25152;&#26377;&#30340;socket&#35013;&#36827;&#19968;&#20010;&#25968;&#32452;&#20013;</p>
</li><li class=" "><p   
>&#36890;&#36807;select&#20989;&#25968;&#36941;&#21382;socket&#25968;&#32452;&#65292;&#21462;&#20986;&#26377;&#21709;&#24212;&#65288;&#21487;&#35835;&#12289;&#21487;&#20889;&#65289;&#30340;socket&#25918;&#36827;&#21478;&#19968;&#20010;&#25968;&#32452;</p>
</li><li class=" "><p   
>&#23545;&#23384;&#20837;&#26377;&#21709;&#24212;&#30340;socket&#25968;&#32452;&#22788;&#29702;</p>
</li></ol>    </div>
    <div class="section section-3" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLXNlbGVjdOWHveaVsA">
        <h3 class="heading "><span>select&#20989;&#25968;</span></h3>
<p   
>select&#27169;&#22411;&#23454;&#38469;&#19978;&#23601;&#26159;&#35843;&#29992;&#20102;select&#36825;&#20010;&#20989;&#25968;&#65292;&#20854;&#35821;&#27861;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> select (</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> nfds, </code><code class="comments">// 填0</code></div>
<div class="line"><code class="plain">    fd_set *readfds, </code><code class="comments">// 输入输出共用参数，检查/输出可读的socket</code></div>
<div class="line"><code class="plain">    fd_set *writefds, </code><code class="comments">// 输入输出共用参数，检查/输出可写的socket</code></div>
<div class="line"><code class="plain">    fd_set *exceptfds, </code><code class="comments">// 输入输出共用参数，检查/输出socket上的异常错误</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">const</code><code class="plain"> struct timeval *timeout </code><code class="comments">// struct timeval结构体，最大等待时间，当socket没有响应时，要等待的时间</code></div>
<div class="line"><code class="plain">);</code></div>
</div>
    </div>
<p   
>&#35813;&#20989;&#25968;&#30340;&#20316;&#29992;&#23601;&#26159;&#26816;&#27979;&#20986;&#21487;&#35835;&#12289;&#21487;&#20889;&#30340;socket&#65292;&#23427;&#30340;&#36820;&#22238;&#20540;&#26377;&#36825;&#20123;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">0</code><code class="plain">: 指定等待时间内没有socket响应，continue进行下一次等待</code></div>
<div class="line"><code class="plain">大于0: 有socket响应</code></div>
<div class="line"><code class="plain">SOCKET_ERROR(宏): 发送错误</code></div>
</div>
    </div>
<p   
>&#38500;&#20102;&#38656;&#35201;&#20102;&#35299;&#36825;&#20010;&#20989;&#25968;&#20197;&#22806;&#65292;&#25105;&#20204;&#21487;&#20197;&#30475;&#35265;&#20854;&#25104;&#21592;&#26159;&#19968;&#20010;fd_set&#32467;&#26500;&#20307;&#65292;&#25105;&#20204;&#36824;&#38656;&#35201;&#20102;&#35299;&#19968;&#19979;&#36825;&#20010;&#32467;&#26500;&#20307;&#21644;&#20960;&#20010;&#24120;&#29992;&#30340;&#23439;&#12290;</p>
    </div>
    <div class="section section-3" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLWZkX3NldOe7k-aehOS9kw">
        <h3 class="heading "><span>fd_set&#32467;&#26500;&#20307;</span></h3>
<p   
>fd_set&#26159;&#29992;&#26469;&#35013;socket&#30340;&#32467;&#26500;&#20307;&#65292;&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;&#23427;&#21487;&#20197;&#35013;64&#20010;socket&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#ifndef FD_SETSIZE</code></div>
<div class="line"><code class="plain">#define FD_SETSIZE      </code><code class="value">64</code></div>
<div class="line"><code class="plain">#endif </code><code class="comments">/* FD_SETSIZE */</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">typedef struct fd_set {</code></div>
<div class="line"><code class="plain">        u_int fd_count;               </code><code class="comments">// 统计的数量</code></div>
<div class="line"><code class="plain">        SOCKET  fd_array[FD_SETSIZE]; </code><code class="comments">// 存放SOCKET的数组</code></div>
<div class="line"><code class="plain">} fd_set;</code></div>
</div>
    </div>
<p   
>&#22914;&#26524;&#20320;&#24819;&#35013;&#26356;&#22810;&#30340;socket&#65292;&#21487;&#20197;&#36890;&#36807;&#22312;<strong class=" ">winsock2.h&#22836;&#25991;&#20214;&#21069;&#22768;&#26126;&#23439;</strong>&#65292;&#32473;&#19968;&#20010;&#26356;&#22823;&#30340;&#20540;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#define FD_SETSIZE </code><code class="value">128</code></div>
<div class="line"><code class="plain">#include &lt;WinSock2.h&gt;</code></div>
</div>
    </div>
<p   
>select&#30340;&#21407;&#29702;&#23601;&#26159;&#19981;&#20572;&#30340;&#26816;&#27979;&#65292;&#36234;&#22810;&#30340;socket&#25928;&#29575;&#23601;&#36234;&#20302;&#65292;&#24310;&#36831;&#23601;&#36234;&#22823;&#65292;&#25152;&#20197;&#35828;&#36825;&#20010;&#27169;&#22411;&#21482;&#36866;&#21512;&#23567;&#29992;&#25143;&#37327;&#21435;&#35775;&#38382;&#65292;&#24212;&#35813;&#33258;&#24049;&#36873;&#25321;&#19968;&#20010;&#21512;&#36866;&#30340;&#22823;&#23567;&#12290;</p>
    </div>
    <div class="section section-3" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWbm-S4quaTjeS9nGZkX3NldOeahOaTjeS9nOWujw">
        <h3 class="heading "><span>&#22235;&#20010;&#25805;&#20316;fd_set&#30340;&#25805;&#20316;&#23439;</span></h3>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col />
                                    <col />
                                    <col />
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>&#25805;&#20316;&#23439;</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>&#20316;&#29992;</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>&#20195;&#30721;</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>FD_ZERO</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&#23558;&#23458;&#25143;&#31471;socket&#38598;&#21512;&#28165;&#38646;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><tt class=" ">FD_ZERO(&amp;clientSockets);</tt></p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>FD_SET</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&#28155;&#21152;&#19968;&#20010;socket(&#36229;&#36807;&#40664;&#35748;&#20540;&#22823;&#23567;&#19981;&#20877;&#22788;&#29702;)</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><tt class=" ">FD_SET(socketListen, &amp;clientSockets);</tt></p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>FD_CLR</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&#20174;&#38598;&#21512;&#20013;&#21024;&#38500;&#25351;&#23450;&#30340;socket&#19968;&#23450;&#35201;close&#65292;&#25163;&#21160;&#37322;&#25918;</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><tt class=" ">FD_CLR(socketListen, &amp;clientSockets);</tt></p>
<p   
><tt class=" ">closesocket(socketListen);</tt></p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>FD_ISSET</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>&#26597;&#35810;socket&#26159;&#21542;&#22312;&#38598;&#21512;&#20013;&#65292;&#19981;&#23384;&#22312;&#36820;&#22238;0&#65292;&#23384;&#22312;&#36820;&#22238;&#38750;0</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><tt class=" ">FD_ISSET(socketListen, &amp;clientSockets);</tt></p>
            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWunumZheS7o-eggee8luWGmS4x">
        <h2 class="heading "><span>&#23454;&#38469;&#20195;&#30721;&#32534;&#20889;</span></h2>
<p   
>&#25353;&#29031;select&#27169;&#22411;&#36923;&#36753;&#32534;&#20889;&#20195;&#30721;&#21363;&#21487;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> main(</code><code class="keyword">int</code><code class="plain"> argc, </code><code class="keyword">char</code><code class="plain">* argv[])</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 0. 初始化</code></div>
<div class="line"><code class="plain">    WORD wsVersion = MAKEWORD(</code><code class="value">2</code><code class="plain">, </code><code class="value">2</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    WSADATA wsaData = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    WSAStartup(wsVersion, &amp;wsaData);</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 1. 创建套接字</code></div>
<div class="line"><code class="plain">    SOCKET sSocket = socket(AF_INET, SOCK_STREAM, </code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (SOCKET_ERROR == sSocket) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"套接字闯创建失败!\n"</code><code class="plain"> );</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"套接字闯创建成功!\n"</code><code class="plain"> );</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 2. 绑定套接字</code></div>
<div class="line"><code class="plain">    sockaddr_in sockAddrInfo = {</code><code class="value">0</code><code class="plain">};    </code><code class="comments">// 初始化</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_addr.S_un.S_addr = inet_addr(</code><code class="string">"127.0.0.1"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_port = htons(</code><code class="value">2118</code><code class="plain">); </code><code class="comments">// 端口</code></div>
<div class="line"><code class="plain">    sockAddrInfo.sin_family = AF_INET; </code><code class="comments">// 地址族规范</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> bRes = bind(sSocket, (sockaddr*)&amp;sockAddrInfo, sizeof(sockAddrInfo));</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (SOCKET_ERROR == bRes) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"绑定失败!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"绑定成功!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 3. 监听套接字</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> lRes = listen(sSocket, </code><code class="value">5</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (SOCKET_ERROR == lRes) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"监听失败!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"监听成功!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    fd_set fdSocket; </code><code class="comments">// 定义</code></div>
<div class="line"><code class="plain">    FD_ZERO(&amp;fdSocket); </code><code class="comments">// 初始化</code></div>
<div class="line"><code class="plain">    FD_SET(sSocket, &amp;fdSocket); </code><code class="comments">// 将当前服务器创建的socket放入集合中</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">while</code><code class="plain"> (</code><code class="keyword">true</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">        fd_set readfds = fdSocket; </code><code class="comments">// 定义可读的集合</code></div>
<div class="line"><code class="plain">        fd_set writefds = fdSocket; </code><code class="comments">// 定义可写的集合</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// fd_set exceptfds = fdSocket;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">        </code><code class="comments">// 获取select函数的返回值</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">int</code><code class="plain"> iRes = select(</code><code class="value">0</code><code class="plain">, &amp;readfds, &amp;writefds, NULL, NULL);</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// 如果返回值大于0则说明不存在无响应、错误的情况，继续向下</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (iRes &gt; </code><code class="value">0</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">            </code><code class="comments">// 遍历可写集合，给每个socket发送Hello</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">for</code><code class="plain"> (u_int i = </code><code class="value">0</code><code class="plain">; i &lt; writefds.fd_count; i++) {</code></div>
<div class="line"><code class="plain">                send(readfds.fd_array[i], </code><code class="string">"Hello"</code><code class="plain">, </code><code class="value">6</code><code class="plain">, </code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">            </code><code class="comments">// 遍历可读集合</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">for</code><code class="plain"> (i = </code><code class="value">0</code><code class="plain">; i &lt; readfds.fd_count; i++) {</code></div>
<div class="line"><code class="plain">                </code><code class="comments">// 如果socket为当前服务器创建的scoket则进入accept等待消息</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">if</code><code class="plain"> (readfds.fd_array[i] == sSocket) {</code></div>
<div class="line"><code class="plain">                    sockaddr_in s = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">                    </code><code class="keyword">int</code><code class="plain"> l = sizeof(s);</code></div>
<div class="line"><code class="plain">                    SOCKET aSocket = accept(sSocket, (sockaddr*)&amp;s, &amp;l);</code></div>
<div class="line"><code class="plain">                    </code><code class="keyword">if</code><code class="plain"> (INVALID_SOCKET == aSocket)</code></div>
<div class="line"><code class="plain">                    {</code></div>
<div class="line"><code class="plain">                        </code><code class="keyword">continue</code><code class="plain">;</code></div>
<div class="line"><code class="plain">                    }</code></div>
<div class="line"><code class="plain">                    FD_SET(aSocket, &amp;fdSocket);</code></div>
<div class="line"><code class="plain">                    </code><code class="comments">// inet_ntoa获取IP</code></div>
<div class="line"><code class="plain">                    printf(</code><code class="string">"Accpet Client IP: %s \n"</code><code class="plain">, inet_ntoa(s.sin_addr));</code></div>
<div class="line"><code class="plain">                </code><code class="comments">// 如果不是，则进入接收消息</code></div>
<div class="line"><code class="plain">                } </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">                    </code><code class="keyword">char</code><code class="plain"> buf[</code><code class="value">100</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">                    </code><code class="keyword">int</code><code class="plain"> iRecv = recv(readfds.fd_array[i], buf, sizeof(buf), </code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">                    </code><code class="comments">// 判断接收消息的返回值，大于0则表示接收成功。</code></div>
<div class="line"><code class="plain">                    </code><code class="keyword">if</code><code class="plain"> (iRecv &gt; </code><code class="value">0</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">                        printf(</code><code class="string">"Recv: %s \n"</code><code class="plain">, buf);</code></div>
<div class="line"><code class="plain">                    </code><code class="comments">// 否则就关闭连接、关闭套接字</code></div>
<div class="line"><code class="plain">                    } </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">                        SOCKET tSocket = readfds.fd_array[i];</code></div>
<div class="line"><code class="plain">                        FD_CLR(tSocket, &amp;fdSocket);</code></div>
<div class="line"><code class="plain">                        shutdown(tSocket, SD_BOTH);</code></div>
<div class="line"><code class="plain">                        closesocket(tSocket);</code></div>
<div class="line"><code class="plain">                    }</code></div>
<div class="line"><code class="plain">                }</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">        } </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">continue</code><code class="plain">;</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    closesocket(sSocket);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    WSACleanup();</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-10_12-27-49.png" alt="images/download/attachments/1015818/image2021-8-10_12-27-49.png" width="600"  />
    </p>
    </div>
    </div>
    <div class="section section-1" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLemBjeWOhueJqeeQhue9keWNoQ">
        <h1 class="heading "><span>&#36941;&#21382;&#29289;&#29702;&#32593;&#21345;</span></h1>
<p   
>&#22914;&#26524;&#20320;&#35201;&#25235;&#32593;&#32476;&#30340;&#21253;&#65292;&#39318;&#20808;&#20320;&#35201;&#30693;&#36947;&#20320;&#35201;&#22788;&#29702;&#30340;&#26159;&#21738;&#20010;&#32593;&#21345;&#65292;&#37027;&#20040;&#20320;&#23601;&#35201;&#30693;&#36947;&#36825;&#20010;&#32593;&#21345;&#30340;&#30456;&#20851;&#20449;&#24687;&#65292;&#25152;&#20197;&#26412;&#31456;&#33410;&#23601;&#36941;&#21382;&#29289;&#29702;&#32593;&#21345;&#24182;&#33719;&#21462;&#30456;&#20851;&#20449;&#24687;&#12290;</p>
<p   
>&#25105;&#20204;&#37117;&#30693;&#36947;&#22312;Windows&#25805;&#20316;&#31995;&#32479;&#19978;&#65292;&#25105;&#20204;&#27809;&#26377;&#21150;&#27861;&#30452;&#25509;&#21435;&#25805;&#20316;&#30828;&#20214;&#23618;&#30340;&#19996;&#35199;&#65292;&#22240;&#20026;&#36825;&#23601;&#28041;&#21450;&#21040;&#39537;&#21160;&#20869;&#26680;&#20102;&#65292;&#25105;&#20204;&#24819;&#35201;&#21435;&#29992;&#30340;&#35805;&#23601;&#38656;&#35201;&#36890;&#36807;Windows&#31995;&#32479;&#23553;&#35013;&#22909;&#30340;&#24211;&#65292;&#22312;&#36825;&#37324;&#25105;&#20204;&#20351;&#29992;&#21040;&#30340;&#23601;WinPcap&#24211;&#12290;</p>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVdpblBjYXDku4vnu40">
        <h2 class="heading "><span>WinPcap&#20171;&#32461;</span></h2>
<p   
>WinPcap(Windows Packet Capture)&#26159;Windows&#24179;&#21488;&#19979;&#19968;&#20010;&#20813;&#36153;&#30340;&#12289;&#20844;&#20849;&#30340;&#24211;&#12290;&#24320;&#21457;WinPcap&#36825;&#20010;&#39033;&#30446;&#30340;&#30446;&#30340;&#22312;&#20110;&#20026;Win32 App&#25552;&#20379;&#35775;&#38382;&#32593;&#32476;&#24213;&#23618;&#30340;&#33021;&#21147;&#12290;</p>
    <div class="section section-3" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeW4uOeUqOWKn-iDvQ">
        <h3 class="heading "><span>&#24120;&#29992;&#21151;&#33021;</span></h3>
<p   
>WinPcap&#24120;&#29992;&#30340;&#21151;&#33021;&#22914;&#19979;&#25152;&#31034;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#25429;&#33719;&#21407;&#22987;&#25968;&#25454;&#21253;&#65292;&#26080;&#35770;&#23427;&#26159;&#21457;&#24448;&#26576;&#21488;&#26426;&#22120;&#30340;&#65292;&#36824;&#26159;&#22312;&#20854;&#20182;&#35774;&#22791;(&#20849;&#20139;&#23186;&#20171;)&#19978;&#36827;&#34892;&#20132;&#25442;&#30340;&#65307;</p>
</li><li class=" "><p   
>&#22312;&#25968;&#25454;&#21253;&#21457;&#36865;&#32473;&#26576;&#24212;&#29992;&#31243;&#24207;&#21069;&#65292;&#26681;&#25454;&#29992;&#25143;&#25351;&#23450;&#30340;&#35268;&#21017;&#36807;&#28388;&#25968;&#25454;&#21253;&#65307;</p>
</li><li class=" "><p   
>&#23558;&#21407;&#22987;&#25968;&#25454;&#21253;&#36890;&#36807;&#32593;&#32476;&#21457;&#36865;&#20986;&#21435;&#65307;</p>
</li><li class=" "><p   
>&#25910;&#38598;&#24182;&#32479;&#35745;&#32593;&#32476;&#27969;&#37327;&#20449;&#24687;&#12290;</p>
</li></ol>    </div>
    <div class="section section-3" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeS4i-i9veS4jumFjee9rg">
        <h3 class="heading "><span>&#19979;&#36733;&#19982;&#37197;&#32622;</span></h3>
<p   
>WinPcap&#24211;&#24182;&#19981;&#26159;Windows&#31995;&#32479;&#33258;&#24102;&#30340;&#65292;&#32780;&#26159;&#30001;&#22806;&#37096;&#24320;&#21457;&#32773;&#21435;&#32500;&#25252;&#30340;&#65292;&#25105;&#20204;&#21487;&#20197;&#20174;&#36825;&#20010;&#22320;&#22336;&#21435;&#19979;&#36733;&#65306;<a  class="external-link" href="https://www.winpcap.org/archive/4.0.1-WpdPack.zip">https://www.winpcap.org/archive/4.0.1-WpdPack.zip</a>&#65292;&#22914;&#26524;&#20320;&#26159;&#22522;&#20110;VC6&#21435;&#20351;&#29992;&#30340;&#35805;&#65292;&#36873;&#25321;&gt;=4.0.1&#30340;&#29256;&#26412;&#12290;</p>
<p   
>&#19979;&#36733;&#19979;&#26469;&#20043;&#21518;&#26159;&#19968;&#20010;&#21387;&#32553;&#21253;&#65292;&#20027;&#35201;&#30340;&#23601;&#26159;Lib&#21644;Include&#36825;&#20004;&#20010;&#25991;&#20214;&#22841;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-10_15-13-14.png" alt="images/download/attachments/1015818/image2021-8-10_15-13-14.png" width="600"  />
    </p>
<p   
>&#23558;&#36825;&#20004;&#20010;&#25991;&#20214;&#22841;&#23384;&#25918;&#22909;&#65292;&#22312;VC6&#20013;&#25171;&#24320;Tools-Options&#65292;&#22635;&#20837;&#20004;&#20010;&#25991;&#20214;&#22841;&#25152;&#22312;&#36335;&#24452;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-10_15-21-41.png" alt="images/download/attachments/1015818/image2021-8-10_15-21-41.png" width="600"  />
    </p>
    </div>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWunumZheS7o-eggee8luWGmS4y">
        <h2 class="heading "><span>&#23454;&#38469;&#20195;&#30721;&#32534;&#20889;</span></h2>
<p   
>&#25509;&#19979;&#26469;&#25105;&#20204;&#23601;&#35201;&#20351;&#29992;&#36825;&#20010;&#25193;&#23637;&#24211;&#21435;&#36941;&#21382;&#33719;&#21462;&#29289;&#29702;&#32593;&#21345;&#30340;&#30456;&#20851;&#20449;&#24687;&#65292;&#39318;&#20808;&#25105;&#20204;&#38656;&#35201;&#21253;&#21547;&#22836;&#25991;&#20214;&#21644;&#24211;&#25991;&#20214;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;WINSOCK2.H&gt;</code></div>
<div class="line"><code class="plain">#include &lt;pcap.h&gt;</code></div>
<div class="line"><code class="plain">#pragma comment(lib, </code><code class="string">"ws2_32.lib"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">#pragma comment(lib, </code><code class="string">"wpcap.lib"</code><code class="plain">)</code></div>
</div>
    </div>
<p   
>&#25509;&#30528;&#25105;&#20204;&#38656;&#35201;&#36890;&#36807;&#23553;&#35013;&#22909;&#30340;&#20989;&#25968;pcap_findalldevs&#21435;&#33719;&#21462;&#29289;&#29702;&#32593;&#21345;&#20449;&#24687;&#65292;&#20854;&#35821;&#27861;&#22914;&#19979;&#65288;&#21442;&#32771;&#23448;&#26041;&#25163;&#20876;&#65306;<a  class="external-link" href="https://www.winpcap.org/docs/docs_412/html/">https://www.winpcap.org/docs/docs_412/html/</a>&#65289;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> pcap_findalldevs (</code></div>
<div class="line"><code class="plain">    pcap_if_t ** alldevsp, </code><code class="comments">// 输出参数，这是一个二级指针，它实际上是一个链表</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> * errbuf </code><code class="comments">// 输出参数，执行失败的错误信息存放的缓冲区</code></div>
<div class="line"><code class="plain">); </code><code class="comments">// 执行成功返回0，失败返回-1</code></div>
</div>
    </div>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#23601;&#26159;&#36825;&#20010;&#32467;&#26500;&#20307;&#65292;&#25105;&#20204;&#21487;&#20197;&#30475;&#20986;&#65292;&#23454;&#38469;&#19978;&#20182;&#26159;&#26377;&#20457;&#20010;&#25104;&#21592;&#37117;&#26159;&#38142;&#34920;&#65292;&#19968;&#20010;&#26159;&#27599;&#20010;&#32593;&#21345;&#23545;&#24212;&#30340;next&#25104;&#21592;&#25351;&#38024;&#65292;&#19968;&#20010;&#26159;&#27599;&#20010;&#32593;&#21345;&#23545;&#24212;&#30340;addresses&#25104;&#21592;&#25351;&#38024;&#30340;next&#25104;&#21592;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-10_17-24-29.png" alt="images/download/attachments/1015818/image2021-8-10_17-24-29.png" width="600"  />
    </p>
<p   
>&#37027;&#20040;&#25105;&#20204;&#21487;&#20197;&#26681;&#25454;&#36825;&#20010;&#32467;&#26500;&#21435;&#33719;&#21462;&#32593;&#21345;&#30340;&#20449;&#24687;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> main(</code><code class="keyword">int</code><code class="plain"> argc, </code><code class="keyword">char</code><code class="plain">* argv[])</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    pcap_if_t* alldevsp = NULL;</code></div>
<div class="line"><code class="plain">    pcap_if_t* tmpdevsp = NULL;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> errbuf[PCAP_ERRBUF_SIZE] = {</code><code class="value">0</code><code class="plain">}; </code><code class="comments">// 错误信息</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> iRet = pcap_findalldevs(&amp;alldevsp, errbuf); </code><code class="comments">// 获取返回值</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (iRet == </code><code class="value">0</code><code class="plain">) { </code><code class="comments">// 判断是否为0</code></div>
<div class="line"><code class="plain">        tmpdevsp = alldevsp;</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// 遍历网卡</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">do</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"Name: %s\nDesc: %s\n"</code><code class="plain">, tmpdevsp-&gt;name, tmpdevsp-&gt;description);</code></div>
<div class="line"><code class="plain">            pcap_addr* tmpaddr = tmpdevsp-&gt;addresses;</code></div>
<div class="line"><code class="plain">            </code><code class="comments">// 遍历地址</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">do</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">                sockaddr_in* ipaddr = (sockaddr_in*)tmpaddr-&gt;addr;</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"IP: %s\n"</code><code class="plain">, inet_ntoa(ipaddr-&gt;sin_addr));</code></div>
<div class="line"><code class="plain">            } </code><code class="keyword">while</code><code class="plain"> (tmpaddr = tmpaddr-&gt;next);</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"===================================\n\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">        } </code><code class="keyword">while</code><code class="plain"> (tmpdevsp = tmpdevsp-&gt;next);</code></div>
<div class="line"><code class="plain">    } </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"pcap_findalldevs error: %s \n"</code><code class="plain">, errbuf);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    pcap_freealldevs(alldevsp); </code><code class="comments">// 释放资源</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWOn-Wni-aVsOaNruWMheeahOiOt-WPluS4juaJk-WNsA">
        <h1 class="heading "><span>&#21407;&#22987;&#25968;&#25454;&#21253;&#30340;&#33719;&#21462;&#19982;&#25171;&#21360;</span></h1>
<p   
>&#21407;&#22987;&#25968;&#25454;&#21253;&#23601;&#26159;&#36866;&#37197;&#22120;&#65288;&#29289;&#29702;&#32593;&#21345;&#12289;&#34394;&#25311;&#32593;&#21345;&#37117;&#21487;&#20197;&#31216;&#20026;&#36866;&#37197;&#22120;&#65289;&#25509;&#25910;&#21040;&#65292;&#27809;&#26377;&#32463;&#36807;&#20219;&#20309;&#22788;&#29702;&#30340;&#21253;&#12290;</p>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeiOt-WPlumAgumFjeWZqOS4iueahOaVsOaNruWMhQ">
        <h2 class="heading "><span>&#33719;&#21462;&#36866;&#37197;&#22120;&#19978;&#30340;&#25968;&#25454;&#21253;</span></h2>
<p   
>&#33719;&#21462;&#36866;&#37197;&#22120;&#19978;&#30340;&#25968;&#25454;&#21253;&#65292; &#19968;&#20849;&#26377;&#22914;&#19979;&#20960;&#20010;&#27493;&#39588;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="value">1</code><code class="plain">. 遍历适配器，找到需要捕获的适配器(pcap_findalldevs函数)</code></div>
<div class="line"><code class="value">2</code><code class="plain">. 打开指定的适配器(pcap_open函数)</code></div>
<div class="line"><code class="value">3</code><code class="plain">. 关闭适配器，释放资源(pcap_freealldevs函数)</code></div>
<div class="line"><code class="value">4</code><code class="plain">. 设置回调函数开始捕获数据包(pcap_loop函数)</code></div>
<div class="line"><code class="value">5</code><code class="plain">. 编写回调函数进行数据的接收与处理</code></div>
</div>
    </div>
<p   
>pcap_open&#20989;&#25968;&#35821;&#27861;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">pcap_t* pcap_open(</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">const</code><code class="plain"> </code><code class="keyword">char</code><code class="plain"> *source, </code><code class="comments">// 要打开的适配器名字</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> snaplen, </code><code class="comments">// 捕获包的长度（TCP包的最大长度是1460字节，UDP包则是65535字节）</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> flags, </code><code class="comments">// 这里就是设置你的适配器模式，我们需要抓包的话就要设置成混合模式，写1或者true都可以</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> read_timeout, </code><code class="comments">// 读取超时时间，这里可以直接写NULL，不管它</code></div>
<div class="line"><code class="plain">    struct pcap_rmtauth *auth, </code><code class="comments">// 认证，pcap_open</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> *errbuf </code><code class="comments">// 错误信息</code></div>
<div class="line"><code class="plain">);</code></div>
</div>
    </div>
<p   
>pcap_loop&#20989;&#25968;&#35821;&#27861;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain">    pcap_loop(</code></div>
<div class="line"><code class="plain">    pcap_t *, </code><code class="comments">// pcap_open返回的指针</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain">, </code><code class="comments">// 填0</code></div>
<div class="line"><code class="plain">    pcap_handler, </code><code class="comments">// 回调函数</code></div>
<div class="line"><code class="plain">    u_char * </code><code class="comments">// 填NULL</code></div>
<div class="line"><code class="plain">);</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> pcap_loop (</code></div>
<div class="line"><code class="plain">    pcap_t * p, </code><code class="comments">// pcap_open返回的指针</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> cnt, </code><code class="comments">// 填0</code></div>
<div class="line"><code class="plain">    pcap_handler callback, </code><code class="comments">// 回调函数</code></div>
<div class="line"><code class="plain">    u_char * user </code><code class="comments">// 用户自定义内容</code></div>
<div class="line"><code class="plain">);     </code></div>
</div>
    </div>
<p   
>&#22238;&#35843;&#20989;&#25968;&#21407;&#22411;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">typedef </code><code class="keyword">void</code><code class="plain">(* pcap_handler)(u_char *user, </code><code class="keyword">const</code><code class="plain"> struct pcap_pkthdr *pkt_header, </code><code class="keyword">const</code><code class="plain"> u_char *pkt_data)</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> pcap_handler(</code></div>
<div class="line"><code class="plain">    u_char *user, </code><code class="comments">// 用户定义的参数，包含了捕获会话的状态，它对应于 pcap_dispatch 和 pcap_loop 函数的user参数</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">const</code><code class="plain"> struct pcap_pkthdr *pkt_header, </code><code class="comments">// 结构体指针，捕获驱动与数据包相关联的头（不是协议头）</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">const</code><code class="plain"> u_char *pkt_data </code><code class="comments">// 指针，指向数据包的数据，包括协议头。</code></div>
<div class="line"><code class="plain">);</code></div>
</div>
    </div>
<p   
>&#36825;&#37324;&#38754;&#26377;&#19968;&#20010;&#32467;&#26500;&#20307;&#65292;&#25105;&#20204;&#38656;&#35201;&#35201;&#30475;&#19968;&#19979;&#23427;&#30340;&#25104;&#21592;&#20998;&#21035;&#26159;&#20160;&#20040;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">struct pcap_pkthdr {</code></div>
<div class="line"><code class="plain">    struct timeval ts;    </code><code class="comments">// 数据包捕获的时间戳</code></div>
<div class="line"><code class="plain">    bpf_u_int32 caplen;    </code><code class="comments">// 捕获到包的长度</code></div>
<div class="line"><code class="plain">    bpf_u_int32 len;    </code><code class="comments">// 这个包的长度</code></div>
<div class="line"><code class="plain">};</code></div>
</div>
    </div>
<p   
>&#31532;&#19968;&#20010;&#25104;&#21592;&#26159;&#19968;&#20010;&#32467;&#26500;&#20307;timeval&#65292;&#33258;&#34892;&#20102;&#35299;&#65292;&#36825;&#37324;&#19981;&#20877;&#36184;&#36848;&#65292;&#31532;&#20108;&#19982;&#31532;&#19977;&#20010;&#25104;&#21592;&#65292;&#29702;&#35770;&#24212;&#35813;&#26159;&#19968;&#26679;&#30340;&#22823;&#23567;&#65292;&#20294;&#26377;&#21487;&#33021;&#25429;&#33719;&#21040;&#25968;&#25454;&#21253;&#30340;&#38271;&#24230;&#19982;&#23454;&#38469;&#30340;&#38271;&#24230;&#26377;&#20986;&#20837;&#65288;&#25968;&#25454;&#20002;&#22833;&#65289;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLemAgumFjeWZqOeahOa3t-WQiOaooeW8jw">
        <h2 class="heading "><span>&#36866;&#37197;&#22120;&#30340;&#28151;&#21512;&#27169;&#24335;</span></h2>
<p   
>&#36890;&#24120;&#65292;&#36866;&#37197;&#22120;(&#29289;&#29702;&#32593;&#21345;)&#26377;&#22810;&#31181;&#24037;&#20316;&#27169;&#24335;&#65292;&#35774;&#32622;&#20026;&#28151;&#21512;&#27169;&#24335;&#20043;&#21518;&#65292;&#21487;&#20197;&#25509;&#25910;&#25152;&#26377;&#27969;&#32463;&#24403;&#21069;&#32593;&#21345;&#30340;&#25968;&#25454;&#21253;&#65292;&#21363;&#20351;&#19981;&#26159;&#21457;&#32473;&#33258;&#24049;&#30340;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWunumZheS7o-eggee8luWGmS4z">
        <h2 class="heading "><span>&#23454;&#38469;&#20195;&#30721;&#32534;&#20889;</span></h2>
<p   
>&#22312;&#23454;&#38469;&#32534;&#20889;&#20195;&#30721;&#20043;&#21069;&#65292;&#25105;&#20204;&#26159;&#35201;&#22312;&#21253;&#21547;pcap.h&#22836;&#25991;&#20214;&#20043;&#21069;&#23450;&#19968;&#20010;&#23439;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#define HAVE_REMOTE</code></div>
<div class="line"><code class="plain">#include &lt;WINSOCK2.H&gt;</code></div>
<div class="line"><code class="plain">#include &lt;pcap.h&gt;</code></div>
<div class="line"><code class="plain">#pragma comment(lib, </code><code class="string">"ws2_32.lib"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">#pragma comment(lib, </code><code class="string">"wpcap.lib"</code><code class="plain">)</code></div>
</div>
    </div>
<p   
>&#36825;&#26159;&#22240;&#20026;&#25105;&#20204;&#21363;&#23558;&#35201;&#20351;&#29992;&#21040;pcap_open&#36825;&#20010;&#20989;&#25968;&#65292;&#21482;&#26377;&#23450;&#20041;&#20102;&#36825;&#20010;&#23439;&#65292;&#25165;&#33021;&#21253;&#21547;&#23450;&#20041;&#20102;&#36825;&#20010;&#20989;&#25968;&#30340;&#22836;&#25991;&#20214;&#65292;&#36825;&#20010;&#25105;&#20204;&#21487;&#20197;&#20174;pcap.h&#22836;&#25991;&#20214;&#20013;&#30475;&#21040;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-10_20-25-8.png" alt="images/download/attachments/1015818/image2021-8-10_20-25-8.png" width="600"  />
    </p>
<p   
>&#25509;&#30528;&#65292;&#25105;&#20204;&#23601;&#25353;&#29031;&#39034;&#24207;&#36880;&#27493;&#21435;&#32534;&#20889;&#20195;&#30721;&#21363;&#21487;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">void</code><code class="plain"> Mypcap_handler(u_char *user, </code><code class="keyword">const</code><code class="plain"> struct pcap_pkthdr *pkt_header, </code><code class="keyword">const</code><code class="plain"> u_char *pkt_data);</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> main(</code><code class="keyword">int</code><code class="plain"> argc, </code><code class="keyword">char</code><code class="plain">* argv[])</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    pcap_if_t* alldevsp = NULL;</code></div>
<div class="line"><code class="plain">    pcap_if_t* tmpdevsp = NULL;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> errbuf[PCAP_ERRBUF_SIZE] = {</code><code class="value">0</code><code class="plain">}; </code><code class="comments">// 错误信息</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 1. 遍历适配器</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> iRet = pcap_findalldevs(&amp;alldevsp, errbuf); </code><code class="comments">// 获取返回值</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (iRet != </code><code class="value">0</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"pcap_findalldevs error: %s \n"</code><code class="plain">, errbuf);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    tmpdevsp = alldevsp;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">do</code><code class="plain"> </code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"Name: %s \nDesc: %s \n================\n\n"</code><code class="plain">, tmpdevsp-&gt;name, tmpdevsp-&gt;description);</code></div>
<div class="line"><code class="plain">    } </code><code class="keyword">while</code><code class="plain"> (tmpdevsp = tmpdevsp-&gt;next);</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 2. 打开指定的适配器</code></div>
<div class="line"><code class="plain">    pcap_t* pcap = pcap_open(</code><code class="string">"\\Device\\NPF_{C7C05FAA-6043-4EB3-9059-329655AC6FB0}"</code><code class="plain">, </code><code class="value">65535</code><code class="plain">, </code><code class="value">1</code><code class="plain">, NULL, NULL, errbuf);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (!pcap) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"pcap_open error: %s \n"</code><code class="plain">, errbuf);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="comments">// 3. 关闭适配器</code></div>
<div class="line"><code class="plain">    pcap_freealldevs(alldevsp);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="comments">// 4. 捕获数据包</code></div>
<div class="line"><code class="plain">    pcap_loop(pcap, </code><code class="value">0</code><code class="plain">, Mypcap_handler, NULL);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> Mypcap_handler(u_char *user, </code><code class="keyword">const</code><code class="plain"> struct pcap_pkthdr *pkt_header, </code><code class="keyword">const</code><code class="plain"> u_char *pkt_data) {</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 5. 编写回调函数</code></div>
<div class="line"><code class="plain">    struct tm *ltime;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> timestr[</code><code class="value">16</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    time_t local_tv_sec;</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 将时间戳转换成可识别的格式</code></div>
<div class="line"><code class="plain">    local_tv_sec = pkt_header-&gt;ts.tv_sec;</code></div>
<div class="line"><code class="plain">    ltime = localtime(&amp;local_tv_sec);</code></div>
<div class="line"><code class="plain">    strftime(timestr, sizeof timestr, </code><code class="string">"%H:%M:%S"</code><code class="plain">, ltime);</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"Time: %s, Caplen: %d, Len: %d \n"</code><code class="plain">, timestr, pkt_header-&gt;caplen, pkt_header-&gt;len);</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 根据分析，我们发现数据包的前六个字节为目地的MAC地址，第七个字节到第12个字节则为源的MAC地址，所以在这里输出</code></div>
<div class="line"><code class="plain">    u_char dstMac[</code><code class="value">6</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">for</code><code class="plain">(</code><code class="keyword">int</code><code class="plain"> i = </code><code class="value">0</code><code class="plain">; i &lt; </code><code class="value">6</code><code class="plain">; i++) {</code></div>
<div class="line"><code class="plain">        dstMac[i] = *(pkt_data+i+</code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"Dst Mac: %02x:%02x:%02x:%02x:%02x:%02x \n"</code><code class="plain">, dstMac[</code><code class="value">0</code><code class="plain">], dstMac[</code><code class="value">1</code><code class="plain">], dstMac[</code><code class="value">2</code><code class="plain">], dstMac[</code><code class="value">3</code><code class="plain">], dstMac[</code><code class="value">4</code><code class="plain">], dstMac[</code><code class="value">5</code><code class="plain">]);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    u_char srcMac[</code><code class="value">6</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">for</code><code class="plain">(i = </code><code class="value">0</code><code class="plain">; i &lt; </code><code class="value">6</code><code class="plain">; i++) {</code></div>
<div class="line"><code class="plain">        srcMac[i] = *(pkt_data+i+</code><code class="value">6</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"Src Mac: %02x:%02x:%02x:%02x:%02x:%02x \n"</code><code class="plain">, srcMac[</code><code class="value">0</code><code class="plain">], srcMac[</code><code class="value">1</code><code class="plain">], srcMac[</code><code class="value">2</code><code class="plain">], srcMac[</code><code class="value">3</code><code class="plain">], srcMac[</code><code class="value">4</code><code class="plain">], srcMac[</code><code class="value">5</code><code class="plain">]);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="comments">// pkt_data 给的是存储数据的内存首地址，我们根据实际捕获的长度去遍历即可获取完整数据</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"\nData:\n------------------------\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">for</code><code class="plain">(i = </code><code class="value">0</code><code class="plain">; i &lt; pkt_header-&gt;caplen; i++) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"%x"</code><code class="plain">, pkt_data[i]);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"\n------------------------\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-10_21-50-3.png" alt="images/download/attachments/1015818/image2021-8-10_21-50-3.png" width="600"  />
    </p>
    </div>
    </div>
    <div class="section section-1" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLU1BQ-W4p-e7k-aehOS4jk1BQ-WMheeahOino-aekA">
        <h1 class="heading "><span>MAC&#24103;&#32467;&#26500;&#19982;MAC&#21253;&#30340;&#35299;&#26512;</span></h1>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLU1BQ-W4p-e7k-aehA">
        <h2 class="heading "><span>MAC&#24103;&#32467;&#26500;</span></h2>
<p   
>&#22312;&#19978;&#19968;&#31456;&#20013;&#65292;&#25105;&#20204;&#29992;&#20195;&#30721;&#20998;&#21035;&#36755;&#20986;&#20102;&#21407;&#22987;&#25968;&#25454;&#21253;&#20013;&#30340;&#30446;&#26631;&#20027;&#26426;&#30340;MAC&#22320;&#22336;&#21644;&#28304;&#20027;&#26426;&#30340;MAC&#22320;&#22336;&#65292;&#36825;&#20998;&#21035;&#21344;6&#23383;&#33410;&#65292;&#36824;&#26377;2&#23383;&#33410;&#34920;&#31034;&#31867;&#22411;&#65292;&#21152;&#36215;&#26469;&#23601;&#26159;14&#23383;&#33410;&#65292;&#25105;&#20204;&#31216;&#20043;&#20026;MAC&#24103;&#32467;&#26500;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-11_11-1-23.png" alt="images/download/attachments/1015818/image2021-8-11_11-1-23.png" width="600"  />
    </p>
<p   
>MAC&#23618;&#26159;&#25968;&#25454;&#38142;&#36335;&#23618;&#30340;&#20004;&#20010;&#23376;&#23618;&#20043;&#19968;&#65292;&#22914;&#19978;&#22270;&#20013;&#30340;&#36825;2&#20010;&#23383;&#33410;&#21017;&#34920;&#31034;&#24403;&#21069;&#25968;&#25454;&#21253;&#23646;&#20110;&#21738;&#19968;&#31181;&#32593;&#32476;&#23618;&#21327;&#35758;&#30340;&#31867;&#22411;&#65288;&#20363;&#22914;&#65306;IP&#12289;ARP&#65289;&#12290;</p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;&#33719;&#21462;&#36866;&#37197;&#22120;&#19978;&#30340;&#21407;&#22987;&#25968;&#25454;&#21253;&#65292;&#22312;&#26368;&#24320;&#22987;&#30340;&#20301;&#32622;&#25214;&#21040;MAC&#24103;&#32467;&#26500;&#65292;&#36825;&#26159;&#22240;&#20026;&#25105;&#20204;&#21487;&#20197;&#30452;&#25509;&#20174;&#32593;&#32476;&#27169;&#22411;&#30475;&#20986;&#32593;&#32476;&#21327;&#35758;&#30340;&#23618;&#32423;&#65292;&#36825;&#31181;&#25968;&#25454;&#21253;&#24212;&#35813;&#26159;&#25353;&#29031;&#23618;&#32423;&#19968;&#23618;&#19968;&#23618;&#30340;&#36861;&#21152;&#30340;&#65292;&#25152;&#20197;MAC&#24103;&#32467;&#26500;&#24212;&#35813;&#22312;&#26368;&#24320;&#22987;&#30340;&#20301;&#32622;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVdpcmVzaGFya-aKk-WMheino-aekA">
        <h2 class="heading "><span>Wireshark&#25235;&#21253;&#35299;&#26512;</span></h2>
<p   
>&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;Wireshark&#21435;&#25235;&#21253;&#65292;&#38543;&#20415;&#36873;&#25321;&#19968;&#20010;&#21253;&#23637;&#24320;&#23601;&#21487;&#20197;&#30475;&#21040;&#36825;&#26679;&#30340;&#19968;&#20010;&#32467;&#26500;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-11_11-9-57.png" alt="images/download/attachments/1015818/image2021-8-11_11-9-57.png" width="600"  />
    </p>
    </div>
    </div>
    <div class="section section-1" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLUlQ5bin57uT5p6E5LiOSVDljIXnmoTop6PmnpA">
        <h1 class="heading "><span>IP&#24103;&#32467;&#26500;&#19982;IP&#21253;&#30340;&#35299;&#26512;</span></h1>
<p   
>&#25509;&#19979;&#26469;&#25105;&#20204;&#38656;&#35201;&#23450;&#20301;IP&#24103;&#32467;&#26500;&#65292; &#32780;&#25105;&#20204;&#24819;&#23450;&#20301;&#36825;&#20010;&#32467;&#26500;&#30340;&#35805;&#65292;&#25353;&#29031;&#32593;&#32476;&#21327;&#35758;&#30340;&#23618;&#32423;&#24212;&#35813;&#20808;&#20174;MAC&#24103;&#35828;&#36215;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-11_11-40-26.png" alt="images/download/attachments/1015818/image2021-8-11_11-40-26.png" width="600"  />
    </p>
<p   
>&#22914;&#19978;&#22270;&#25152;&#31034;&#65292;&#25105;&#20204;&#30340;IP&#24103;&#23601;&#22312;&#20854;&#20182;&#25968;&#25454;&#20013;&#65292;&#25105;&#20204;&#26681;&#25454;MAC&#24103;&#30340;&#26368;&#21518;2&#23383;&#33410;&#25512;&#26029;&#20986;&#20854;&#20182;&#25968;&#25454;&#20013;&#30340;&#24103;&#23545;&#24212;&#20160;&#20040;&#24103;&#12290;</p>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLUlQ5bin57uT5p6E">
        <h2 class="heading "><span>IP&#24103;&#32467;&#26500;</span></h2>
<p   
>&#22914;&#19979;&#22270;&#23601;&#26159;IP&#24103;&#32467;&#26500;&#65292;&#22270;&#20013;&#22810;&#27425;&#20986;&#29616;&#30340;&#20301;&#65292;&#34920;&#31034;&#30340;&#26159;BIT&#20301;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-11_12-31-23.png" alt="images/download/attachments/1015818/image2021-8-11_12-31-23.png" width="600"  />
    </p>
<p   
>&#20854;&#20998;&#21035;&#34920;&#31034;&#22914;&#19979;&#65306;</p>
<ol class=" "><li class=" "><p   
><strong class=" ">&#29256;&#26412;</strong>&#65306;&#29256;&#26412;&#21344;&#20102;4&#20301;&#65292;&#29992;&#26469;&#34920;&#31034;&#35813;&#21327;&#35758;&#37319;&#29992;&#30340;&#26159;&#37027;&#19968;&#20010;&#29256;&#26412;&#30340;IP&#65292;&#30456;&#21516;&#29256;&#26412;&#30340;IP&#25165;&#33021;&#36827;&#34892;&#36890;&#20449;&#65292;&#19968;&#33324;&#27492;&#22788;&#30340;&#20540;&#20026;4&#65292;&#34920;&#31034;IPv4&#65307;</p>
</li><li class=" "><p   
><strong class=" ">&#39318;&#37096;&#22836;&#38271;&#24230;</strong>&#65306;&#35813;&#23383;&#27573;&#29992;&#22235;&#20301;&#34920;&#31034;&#65292;&#34920;&#31034;&#25972;&#20010;IP&#25253;&#25991;&#30340;&#22836;&#30340;&#38271;&#24230;&#65292;&#36825;&#37324;&#30340;&#38271;&#24230;&#34920;&#31034;&#26377;&#22810;&#23569;&#20010;&#21333;&#20301;&#65292;1&#20010;&#21333;&#20301;&#26159;4&#23383;&#33410;&#65292;&#22914;&#38271;&#24230;&#20026;1&#21017;&#34920;&#31034;&#35813;IP&#25253;&#25991;&#30340;&#22836;&#22823;&#23567;&#20026;4&#23383;&#33410;&#65307;&#23427;&#24471;&#33539;&#22260;&#21363;&#20108;&#36827;&#21046;&#25968;0000-1111&#65288;&#21313;&#36827;&#21046;&#25968;0-15&#65289;&#65292;&#20854;&#20013;&#19968;&#20010;&#26368;&#23567;&#38271;&#24230;&#20026;0&#23383;&#33410;&#65292;&#26368;&#22823;&#38271;&#24230;&#20026;60&#23383;&#33410;&#65292;&#19968;&#33324;&#26469;&#35828;&#27492;&#22788;&#30340;&#20540;&#20026;0101&#65292;&#34920;&#31034;&#22836;&#38271;&#24230;&#20026;20&#23383;&#33410;&#65307;</p>
</li><li class=" "><p   
><strong class=" ">&#26381;&#21153;&#31867;&#22411;&#65288;TOS&#65289;</strong>&#65306;&#35813;&#23383;&#27573;&#29992;8&#20301;&#34920;&#31034;&#65292;&#35813;&#23383;&#27573;&#19968;&#33324;&#24773;&#20917;&#19979;&#19981;&#20351;&#29992;&#65307;</p>
</li><li class=" "><p   
><strong class=" ">&#24635;&#38271;&#24230;&#23383;&#33410;&#25968;</strong>&#65306;&#35813;&#23383;&#27573;&#34920;&#31034;&#25972;&#20010;IP&#25253;&#25991;&#30340;&#38271;&#24230;&#65292;&#36825;&#37324;&#30340;&#38271;&#24230;&#20063;&#34920;&#31034;&#26377;&#22810;&#23569;&#20010;&#21333;&#20301;&#65292;1&#20010;&#21333;&#20301;&#26159;1&#23383;&#33410;&#65292;&#33021;&#34920;&#31034;&#30340;&#26368;&#22823;&#23383;&#33410;&#20026;2^16-1=65535&#23383;&#33410;&#65292;&#19981;&#36807;&#30001;&#20110;&#38142;&#36335;&#23618;&#30340;MTU&#38480;&#21046;&#65292;&#36229;&#36807;1480&#23383;&#33410;&#21518;&#23601;&#20250;&#34987;&#20998;&#27573;&#65288;&#20197;&#22826;&#24103;MTU&#20026;1500&#30340;&#24773;&#20917;&#19979;&#65292;&#38500;&#21435;20&#23383;&#33410;&#30340;&#21253;&#22836;&#65289;&#65307;</p>
</li><li class=" "><p   
><strong class=" ">&#26631;&#35782;</strong>&#65306;&#35813;&#23383;&#27573;&#26159;IP&#36719;&#20214;&#23454;&#29616;&#30340;&#26102;&#20505;&#33258;&#21160;&#20135;&#29983;&#30340;&#65292;&#35813;&#23383;&#27573;&#30340;&#30446;&#30340;&#19981;&#26159;&#20026;&#20102;&#25509;&#21463;&#26041;&#30340;&#25353;&#24207;&#25509;&#21463;&#32780;&#35774;&#32622;&#30340;&#65292;&#32780;&#26159;&#22312;IP&#20998;&#27573;&#20197;&#21518;&#65292;&#29992;&#26469;&#26631;&#35782;&#21516;&#19968;&#27573;&#20998;&#27573;&#30340;&#65292;&#26041;&#20415;IP&#20998;&#27573;&#30340;&#37325;&#32452;&#65307;</p>
</li><li class=" "><p   
><strong class=" ">&#26631;&#24535;</strong>&#65306;&#35813;&#23383;&#27573;&#26159;&#19982;IP&#20998;&#27573;&#26377;&#20851;&#30340;&#65292;&#20854;&#20013;&#26377;&#19977;&#20301;&#65292;&#20294;&#21482;&#26377;&#20004;&#20301;&#26159;&#26377;&#25928;&#30340;&#65292;&#20998;&#21035;&#20026;MF&#12289;DF&#12289;MF&#65307;MF&#34920;&#31034;&#21518;&#38754;&#26159;&#21542;&#36824;&#26377;&#20998;&#27573;&#65292;&#20026;1&#26102;&#65292;&#34920;&#31034;&#21518;&#38754;&#36824;&#26377;&#20998;&#27573;&#65307;DF&#34920;&#31034;&#26159;&#21542;&#33021;&#20998;&#27573;&#65292;&#20026;0&#34920;&#31034;&#21487;&#20197;&#20998;&#27573;&#65307;</p>
</li><li class=" "><p   
><strong class=" ">&#27573;&#20559;&#31227;</strong>&#65306;&#35813;&#23383;&#27573;&#26159;&#19982;IP&#20998;&#27573;&#21518;&#65292;&#30456;&#24212;&#30340;IP&#27573;&#22312;&#24635;&#30340;IP&#27573;&#30340;&#20301;&#32622;&#65307;</p>
</li><li class=" "><p   
><strong class=" ">&#29983;&#23384;&#26102;&#38388;&#65288;TTL&#65289;</strong>&#65306;&#35813;&#23383;&#27573;&#34920;&#31034;&#29983;&#23384;&#21608;&#26399;&#65292;&#35813;&#20540;&#21344;8&#20301;&#65292;IP&#20998;&#27573;&#27599;&#32463;&#36807;&#19968;&#20010;&#36335;&#30001;&#22120;&#35813;&#20540;&#20943;&#19968;&#65292;&#23427;&#30340;&#20986;&#29616;&#26159;&#20026;&#20102;&#38450;&#27490;&#36335;&#30001;&#29615;&#36335;&#65292;&#28010;&#36153;&#24102;&#23485;&#30340;&#38382;&#39064;&#65292;Window&#31995;&#32479;&#40664;&#35748;&#20026;128&#65307;</p>
</li><li class=" "><p   
><strong class=" ">&#21327;&#35758;</strong>&#65306;&#35813;&#20540;&#34920;&#31034;&#19978;&#23618;&#30340;&#21327;&#35758;&#65292;&#21344;8&#20301;&#65292;&#20854;&#20013;1&#34920;&#31034;ICMP&#12289;2&#34920;&#31034;IGMP&#12289;6&#34920;&#31034;TCP&#12289;17&#34920;&#31034;UDP&#12289;89&#34920;&#31034;OSPF&#65307;</p>
</li><li class=" "><p   
><strong class=" ">&#39318;&#37096;&#26657;&#39564;&#21644;</strong>&#65306;&#35813;&#20540;&#26159;&#23545;&#25972;&#20010;&#25968;&#25454;&#21253;&#30340;&#21253;&#22836;&#36827;&#34892;&#30340;&#26657;&#39564;&#65292;&#21344;16&#20301;&#65307;</p>
</li><li class=" "><p   
><strong class=" ">&#28304;&#22320;&#22336;&#21644;&#30446;&#30340;&#22320;&#22336;</strong>&#65306;&#34920;&#31034;&#21457;&#36865;IP&#27573;&#30340;&#28304;&#21644;&#30446;&#30340;IP&#65292;&#20998;&#21035;&#21344;32&#20301;&#65307;</p>
</li><li class=" "><p   
><strong class=" ">&#21487;&#36873;&#30340;&#37096;&#20998;</strong>&#65306;&#19968;&#20123;&#29305;&#27530;&#30340;&#35201;&#27714;&#20250;&#21152;&#22312;&#36825;&#20010;&#37096;&#20998;&#65292;&#19968;&#33324;&#24773;&#20917;&#19979;&#26159;&#19981;&#20250;&#26377;&#36825;&#20010;&#23383;&#27573;&#30340;&#65307;</p>
</li><li class=" "><p   
>&#25968;&#25454;&#12290;</p>
</li></ol><p   
>&#22823;&#27010;&#20102;&#35299;&#19968;&#19979;&#21363;&#21487;&#65292;&#25105;&#20204;&#20027;&#35201;&#20851;&#27880;&#20960;&#20010;&#37325;&#35201;&#23383;&#27573;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#29256;&#26412;</p>
</li><li class=" "><p   
>&#39318;&#37096;&#38271;&#24230;</p>
</li><li class=" "><p   
>&#24635;&#38271;&#24230;</p>
</li><li class=" "><p   
>&#21327;&#35758;</p>
</li><li class=" "><p   
>&#28304;IP</p>
</li><li class=" "><p   
>&#30446;&#30340;IP</p>
</li></ol><p   
><strong class=" ">&#27880;&#24847;</strong>&#65306;&#32593;&#32476;&#20256;&#36755;&#30340;&#23383;&#33410;&#24207;&#21644;&#20320;&#20027;&#26426;&#26412;&#36523;&#30340;&#23383;&#33410;&#24207;&#26159;&#19981;&#19968;&#26679;&#30340;&#65292;&#25152;&#20197;&#22312;&#36716;&#25442;&#30340;&#26102;&#20505;&#38656;&#35201;&#27880;&#24847;&#19968;&#19979;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVdpcmVzaGFya-aKk-WMheino-aekC4x">
        <h2 class="heading "><span>Wireshark&#25235;&#21253;&#35299;&#26512;</span></h2>
<p   
>&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;Wireshark&#21435;&#25235;&#21253;&#65292;&#38543;&#20415;&#36873;&#25321;&#19968;&#20010;&#21253;&#23637;&#24320;&#23601;&#21487;&#20197;&#30475;&#21040;&#36825;&#26679;&#30340;&#19968;&#20010;&#32467;&#26500; &#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-11_13-26-17.png" alt="images/download/attachments/1015818/image2021-8-11_13-26-17.png" width="600"  />
    </p>
<p   
>&#21516;&#26679;&#65292;&#25105;&#20204;&#21487;&#20197;&#26681;&#25454;&#23545;&#24212;&#30340;&#20301;&#65292;&#32534;&#20889;&#31243;&#24207;&#21435;&#35299;&#26512;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWunumZheS7o-eggee8luWGmS40">
        <h2 class="heading "><span>&#23454;&#38469;&#20195;&#30721;&#32534;&#20889;</span></h2>
<p   
>&#23454;&#38469;&#32534;&#20889;&#20195;&#30721;&#22914;&#19979;&#65292;&#22312;&#32534;&#20889;&#20195;&#30721;&#30340;&#36807;&#31243;&#20013;&#19981;&#35201;&#24536;&#35760;&#20559;&#31227;&#37327;+14&#20877;&#33719;&#21462;IP&#25253;&#25991;&#30340;&#20449;&#24687;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">void</code><code class="plain"> Mypcap_handler(u_char *user, </code><code class="keyword">const</code><code class="plain"> struct pcap_pkthdr *pkt_header, </code><code class="keyword">const</code><code class="plain"> u_char *pkt_data);</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">int</code><code class="plain"> main(</code><code class="keyword">int</code><code class="plain"> argc, </code><code class="keyword">char</code><code class="plain">* argv[])</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    pcap_if_t* alldevsp = NULL;</code></div>
<div class="line"><code class="plain">    pcap_if_t* tmpdevsp = NULL;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> errbuf[PCAP_ERRBUF_SIZE] = {</code><code class="value">0</code><code class="plain">}; </code><code class="comments">// 错误信息</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 1. 遍历适配器</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> iRet = pcap_findalldevs(&amp;alldevsp, errbuf); </code><code class="comments">// 获取返回值</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (iRet != </code><code class="value">0</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"pcap_findalldevs error: %s \n"</code><code class="plain">, errbuf);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    tmpdevsp = alldevsp;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">do</code><code class="plain"> </code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"Name: %s \nDesc: %s \n================\n\n"</code><code class="plain">, tmpdevsp-&gt;name, tmpdevsp-&gt;description);</code></div>
<div class="line"><code class="plain">    } </code><code class="keyword">while</code><code class="plain"> (tmpdevsp = tmpdevsp-&gt;next);</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 2. 打开指定的适配器</code></div>
<div class="line"><code class="plain">    pcap_t* pcap = pcap_open(</code><code class="string">"\\Device\\NPF_{C7C05FAA-6043-4EB3-9059-329655AC6FB0}"</code><code class="plain">, </code><code class="value">65535</code><code class="plain">, </code><code class="value">1</code><code class="plain">, NULL, NULL, errbuf);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (!pcap) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"pcap_open error: %s \n"</code><code class="plain">, errbuf);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="comments">// 3. 关闭适配器</code></div>
<div class="line"><code class="plain">    pcap_freealldevs(alldevsp);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="comments">// 4. 捕获数据包</code></div>
<div class="line"><code class="plain">    pcap_loop(pcap, </code><code class="value">0</code><code class="plain">, Mypcap_handler, NULL);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">char</code><code class="plain">* MyStrCpy(</code><code class="keyword">char</code><code class="plain">* oStr, </code><code class="keyword">int</code><code class="plain"> index, </code><code class="keyword">int</code><code class="plain"> number) {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain">* tmpStr = oStr;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain">* resStr = (</code><code class="keyword">char</code><code class="plain">*)malloc(number);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">for</code><code class="plain"> (</code><code class="keyword">int</code><code class="plain"> i = </code><code class="value">0</code><code class="plain">; i &lt; number; i++) {</code></div>
<div class="line"><code class="plain">        *(resStr+i) = *(tmpStr+(index+i));</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> resStr;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> Mypcap_handler(u_char *user, </code><code class="keyword">const</code><code class="plain"> struct pcap_pkthdr *pkt_header, </code><code class="keyword">const</code><code class="plain"> u_char *pkt_data) {</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 5. 编写回调函数</code></div>
<div class="line"><code class="plain">    struct tm *ltime;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> timestr[</code><code class="value">16</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    time_t local_tv_sec;</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 将时间戳转换成可识别的格式</code></div>
<div class="line"><code class="plain">    local_tv_sec = pkt_header-&gt;ts.tv_sec;</code></div>
<div class="line"><code class="plain">    ltime = localtime(&amp;local_tv_sec);</code></div>
<div class="line"><code class="plain">    strftime(timestr, sizeof timestr, </code><code class="string">"%H:%M:%S"</code><code class="plain">, ltime);</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"Time: %s, Caplen: %d, Len: %d \n"</code><code class="plain">, timestr, pkt_header-&gt;caplen, pkt_header-&gt;len);</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"================MAC================\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    u_char dstMac[</code><code class="value">6</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">for</code><code class="plain">(</code><code class="keyword">int</code><code class="plain"> i = </code><code class="value">0</code><code class="plain">; i &lt; </code><code class="value">6</code><code class="plain">; i++) {</code></div>
<div class="line"><code class="plain">        dstMac[i] = *(pkt_data+i+</code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"Dst Mac: %02x:%02x:%02x:%02x:%02x:%02x \n"</code><code class="plain">, dstMac[</code><code class="value">0</code><code class="plain">], dstMac[</code><code class="value">1</code><code class="plain">], dstMac[</code><code class="value">2</code><code class="plain">], dstMac[</code><code class="value">3</code><code class="plain">], dstMac[</code><code class="value">4</code><code class="plain">], dstMac[</code><code class="value">5</code><code class="plain">]);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    u_char srcMac[</code><code class="value">6</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">for</code><code class="plain">(i = </code><code class="value">0</code><code class="plain">; i &lt; </code><code class="value">6</code><code class="plain">; i++) {</code></div>
<div class="line"><code class="plain">        srcMac[i] = *(pkt_data+i+</code><code class="value">6</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"Src Mac: %02x:%02x:%02x:%02x:%02x:%02x \n"</code><code class="plain">, srcMac[</code><code class="value">0</code><code class="plain">], srcMac[</code><code class="value">1</code><code class="plain">], srcMac[</code><code class="value">2</code><code class="plain">], srcMac[</code><code class="value">3</code><code class="plain">], srcMac[</code><code class="value">4</code><code class="plain">], srcMac[</code><code class="value">5</code><code class="plain">]);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    u_char type[</code><code class="value">2</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">for</code><code class="plain">(i = </code><code class="value">0</code><code class="plain">; i &lt; </code><code class="value">2</code><code class="plain">; i++) {</code></div>
<div class="line"><code class="plain">        type[i] = *(pkt_data+i+</code><code class="value">12</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"Type: "</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (type[</code><code class="value">0</code><code class="plain">] == </code><code class="value">0x08</code><code class="plain">) {    </code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (type[</code><code class="value">1</code><code class="plain">] == </code><code class="value">0x00</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"IPv4\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"\n================IP================\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            u_char versionAndHeaderLen = *(pkt_data+</code><code class="value">14</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            u_char version = versionAndHeaderLen &gt;&gt; </code><code class="value">4</code><code class="plain">; </code><code class="comments">// 版本</code></div>
<div class="line"><code class="plain">            u_char headerLen = versionAndHeaderLen &lt;&lt; </code><code class="value">4</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            headerLen = headerLen &gt;&gt; </code><code class="value">4</code><code class="plain">; </code><code class="comments">// 首部长度</code></div>
<div class="line"><code class="plain">            u_char realHeaderLen = headerLen * </code><code class="value">4</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            </code></div>
<div class="line"><code class="plain">            </code><code class="keyword">if</code><code class="plain"> (version == </code><code class="value">0x04</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"Version: IPv4 \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"HeaderLen: %d(%d Byte) \n"</code><code class="plain">, headerLen, realHeaderLen);</code></div>
<div class="line"><code class="plain">            </code></div>
<div class="line"><code class="plain">            u_char allLen[</code><code class="value">2</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">for</code><code class="plain"> (i = </code><code class="value">0</code><code class="plain">; i &lt; </code><code class="value">2</code><code class="plain">; i++) {</code></div>
<div class="line"><code class="plain">                allLen[i] = *(pkt_data+i+</code><code class="value">14</code><code class="plain">+</code><code class="value">2</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">            </code><code class="comments">// 手动字节序的转换</code></div>
<div class="line"><code class="plain">            u_short resLen = </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            u_char* tmpLen = (u_char*)&amp;resLen;</code></div>
<div class="line"><code class="plain">            tmpLen[</code><code class="value">0</code><code class="plain">] = allLen[</code><code class="value">1</code><code class="plain">];</code></div>
<div class="line"><code class="plain">            tmpLen[</code><code class="value">1</code><code class="plain">] = allLen[</code><code class="value">0</code><code class="plain">];</code></div>
<div class="line"><code class="plain">            </code><code class="comments">// 基于函数转换</code></div>
<div class="line"><code class="plain">            </code><code class="comments">// u_short resLen = ntohs(*((u_short*)allLen));</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"AllLen: %d Byte \n"</code><code class="plain">, resLen);</code></div>
<div class="line"><code class="plain">            </code></div>
<div class="line"><code class="plain">            u_char protocol = *(pkt_data+</code><code class="value">14</code><code class="plain">+</code><code class="value">9</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">switch</code><code class="plain"> (protocol) {</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">case</code><code class="plain"> </code><code class="value">1</code><code class="plain">:</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"Protocol: ICMP \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">case</code><code class="plain"> </code><code class="value">2</code><code class="plain">:</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"Protocol: IGMP \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">case</code><code class="plain"> </code><code class="value">6</code><code class="plain">:</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"Protocol: TCP \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">case</code><code class="plain"> </code><code class="value">17</code><code class="plain">:</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"Protocol: UDP \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">case</code><code class="plain"> </code><code class="value">89</code><code class="plain">:</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"Protocol: OSPF \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">            </code></div>
<div class="line"><code class="plain">            u_char srcIP[</code><code class="value">4</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">for</code><code class="plain"> (i = </code><code class="value">0</code><code class="plain">; i &lt; </code><code class="value">4</code><code class="plain">; i++) {</code></div>
<div class="line"><code class="plain">                srcIP[i] = *(pkt_data+i+</code><code class="value">14</code><code class="plain">+</code><code class="value">12</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"Src IP: %d.%d.%d.%d\n"</code><code class="plain">, srcIP[</code><code class="value">0</code><code class="plain">], srcIP[</code><code class="value">1</code><code class="plain">], srcIP[</code><code class="value">2</code><code class="plain">], srcIP[</code><code class="value">3</code><code class="plain">]);</code></div>
<div class="line"><code class="plain">            u_char dstIP[</code><code class="value">4</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">for</code><code class="plain"> (i = </code><code class="value">0</code><code class="plain">; i &lt; </code><code class="value">4</code><code class="plain">; i++) {</code></div>
<div class="line"><code class="plain">                dstIP[i] = *(pkt_data+i+</code><code class="value">14</code><code class="plain">+</code><code class="value">16</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"Dst IP: %d.%d.%d.%d \n"</code><code class="plain">, dstIP[</code><code class="value">0</code><code class="plain">], dstIP[</code><code class="value">1</code><code class="plain">], dstIP[</code><code class="value">2</code><code class="plain">], dstIP[</code><code class="value">3</code><code class="plain">]);</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"\n================IP================\n\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">        } </code><code class="keyword">else</code><code class="plain"> </code><code class="keyword">if</code><code class="plain"> (type[</code><code class="value">1</code><code class="plain">] == </code><code class="value">0x06</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"ARP\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-11_18-53-13.png" alt="images/download/attachments/1015818/image2021-8-11_18-53-13.png" width="600"  />
    </p>
    </div>
    </div>
    <div class="section section-1" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVRDUOW4p-e7k-aehOS4jlRDUOWMheeahOino-aekA">
        <h1 class="heading "><span>TCP&#24103;&#32467;&#26500;&#19982;TCP&#21253;&#30340;&#35299;&#26512;</span></h1>
<p   
>&#25105;&#20204;&#21435;&#20102;&#35299;IP&#21253;&#30340;&#26102;&#20505;&#65292;&#26159;&#20174;MAC&#21253;&#20986;&#21457;&#30340;&#65292;&#37027;&#20040;&#21516;&#26679;&#25105;&#20204;&#20102;&#35299;TCP&#21253;&#20063;&#38656;&#35201;&#21435;&#20174;IP&#21253;&#20986;&#21457;&#65292;&#39318;&#20808;&#25105;&#20204;&#30693;&#36947;&#25972;&#20010;&#25972;&#20010;IP&#21253;&#21253;&#21547;&#30340;&#25968;&#25454;&#20013;&#23601;&#26377;TCP/UDP&#21253;&#65292;&#24819;&#30693;&#36947;&#36825;&#20010;&#25968;&#25454;&#26159;&#23646;&#20110;&#20160;&#20040;&#21327;&#35758;&#65292;&#23601;&#35201;&#36890;&#36807;IP&#24103;&#32467;&#26500;&#30340;&#21327;&#35758;&#23383;&#27573;&#65292;&#24819;&#35201;&#30693;&#36947;TCP/UDP&#21253;&#25968;&#25454;&#30340;&#22823;&#23567;&#65292;&#23601;&#35201;&#36890;&#36807;&#24635;&#38271;&#24230;&#20943;&#21435;&#39318;&#37096;&#38271;&#24230;&#33719;&#21462;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-11_18-25-22.png" alt="images/download/attachments/1015818/image2021-8-11_18-25-22.png" width="600"  />
    </p>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVRDUOW4p-e7k-aehA">
        <h2 class="heading "><span>TCP&#24103;&#32467;&#26500;</span></h2>
<p   
>TCP&#24103;&#32467;&#26500;&#22914;&#19979;&#22270;&#25152;&#31034;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-11_18-57-46.png" alt="images/download/attachments/1015818/image2021-8-11_18-57-46.png" width="600"  />
    </p>
<p   
>&#36825;&#37324;&#20986;&#29616;&#20102;&#24456;&#22810;&#65292;&#25105;&#20204;&#27809;&#26377;&#35265;&#36807;&#30340;&#35789;&#65292;&#25105;&#20204;&#26469;&#20102;&#35299;&#19968;&#19979;&#20960;&#20010;&#24120;&#29992;&#30340;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#28304;&#31471;&#21475;&#65306;&#21457;&#36865;&#26041;&#24212;&#29992;&#31243;&#24207;&#23545;&#24212;&#30340;&#31471;&#21475;&#65307;</p>
</li><li class=" "><p   
>&#30446;&#30340;&#31471;&#21475;&#65306;&#25509;&#25910;&#26041;&#24212;&#29992;&#31243;&#24207;&#23545;&#24212;&#30340;&#31471;&#21475;&#65307;</p>
</li><li class=" "><p   
>&#24207;&#21015;&#21495;&#65306; &#36825;&#20010;&#25105;&#20204;&#24050;&#32463;&#22312;&#20043;&#21069;&#20102;&#35299;&#36807;&#20102;&#65292;&#23601;&#26159;&#25105;&#20204;&#25152;&#35828;&#30340;seq&#65307;</p>
</li><li class=" "><p   
>&#30830;&#35748;&#21495;&#65306; &#36825;&#20010;&#25105;&#20204;&#20063;&#20102;&#35299;&#36807;&#20102;&#65292;&#23601;&#26159;&#25105;&#20204;&#25152;&#35828;&#30340;ack&#65307;</p>
</li><li class=" "><p   
>&#20559;&#31227;&#65306;&#36825;&#20010;&#23601;&#31867;&#20284;&#20110;&#25105;&#20204;IP&#24103;&#32467;&#26500;&#20013;&#30340;&#39318;&#37096;&#38271;&#24230;&#65292;1&#20010;&#21333;&#20301;4&#23383;&#33410;&#65307;</p>
</li><li class=" "><p   
>&#31383;&#21475;&#65306;&#25509;&#25910;&#31383;&#21475;&#30340;&#22823;&#23567;&#65292;&#34920;&#31034;&#25509;&#25910;&#31471;&#24076;&#26395;&#25509;&#21463;&#30340;&#23383;&#33410;&#25968;&#12290;</p>
</li></ol><p   
>&#23545;&#25235;&#21253;&#26469;&#35828;&#27604;&#36739;&#37325;&#35201;&#30340;&#23383;&#27573;&#22914;&#19979;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#28304;&#31471;&#21475;</p>
</li><li class=" "><p   
>&#30446;&#30340;&#31471;&#21475;</p>
</li><li class=" "><p   
>&#20559;&#31227;</p>
</li></ol>    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVdpcmVzaGFya-aKk-WMheWIhuaekA">
        <h2 class="heading "><span>Wireshark&#25235;&#21253;&#20998;&#26512;</span></h2>
<p   
>&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;Wireshark&#21435;&#25235;&#21253;&#65292;&#38543;&#20415;&#36873;&#25321;&#19968;&#20010;&#21253;&#23637;&#24320;&#23601;&#21487;&#20197;&#30475;&#21040;&#36825;&#26679;&#30340;&#19968;&#20010;&#32467;&#26500; &#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-11_20-55-34.png" alt="images/download/attachments/1015818/image2021-8-11_20-55-34.png" width="600"  />
    </p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWunumZheS7o-eggee8luWGmS41">
        <h2 class="heading "><span>&#23454;&#38469;&#20195;&#30721;&#32534;&#20889;</span></h2>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> main(</code><code class="keyword">int</code><code class="plain"> argc, </code><code class="keyword">char</code><code class="plain">* argv[])</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    pcap_if_t* alldevsp = NULL;</code></div>
<div class="line"><code class="plain">    pcap_if_t* tmpdevsp = NULL;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> errbuf[PCAP_ERRBUF_SIZE] = {</code><code class="value">0</code><code class="plain">}; </code><code class="comments">// 错误信息</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 1. 遍历适配器</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> iRet = pcap_findalldevs(&amp;alldevsp, errbuf); </code><code class="comments">// 获取返回值</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (iRet != </code><code class="value">0</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"pcap_findalldevs error: %s \n"</code><code class="plain">, errbuf);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    tmpdevsp = alldevsp;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">do</code><code class="plain"> </code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"Name: %s \nDesc: %s \n================\n\n"</code><code class="plain">, tmpdevsp-&gt;name, tmpdevsp-&gt;description);</code></div>
<div class="line"><code class="plain">    } </code><code class="keyword">while</code><code class="plain"> (tmpdevsp = tmpdevsp-&gt;next);</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 2. 打开指定的适配器</code></div>
<div class="line"><code class="plain">    pcap_t* pcap = pcap_open(</code><code class="string">"\\Device\\NPF_{C7C05FAA-6043-4EB3-9059-329655AC6FB0}"</code><code class="plain">, </code><code class="value">65535</code><code class="plain">, </code><code class="value">1</code><code class="plain">, NULL, NULL, errbuf);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (!pcap) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"pcap_open error: %s \n"</code><code class="plain">, errbuf);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="comments">// 3. 关闭适配器</code></div>
<div class="line"><code class="plain">    pcap_freealldevs(alldevsp);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="comments">// 4. 捕获数据包</code></div>
<div class="line"><code class="plain">    pcap_loop(pcap, </code><code class="value">0</code><code class="plain">, Mypcap_handler, NULL);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">char</code><code class="plain">* MyStrCpy(</code><code class="keyword">char</code><code class="plain">* oStr, </code><code class="keyword">int</code><code class="plain"> index, </code><code class="keyword">int</code><code class="plain"> number) {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain">* tmpStr = oStr;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain">* resStr = (</code><code class="keyword">char</code><code class="plain">*)malloc(number);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">for</code><code class="plain"> (</code><code class="keyword">int</code><code class="plain"> i = </code><code class="value">0</code><code class="plain">; i &lt; number; i++) {</code></div>
<div class="line"><code class="plain">        *(resStr+i) = *(tmpStr+(index+i));</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> resStr;</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">void</code><code class="plain"> Mypcap_handler(u_char *user, </code><code class="keyword">const</code><code class="plain"> struct pcap_pkthdr *pkt_header, </code><code class="keyword">const</code><code class="plain"> u_char *pkt_data) {</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 5. 编写回调函数</code></div>
<div class="line"><code class="plain">    struct tm *ltime;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">char</code><code class="plain"> timestr[</code><code class="value">16</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    time_t local_tv_sec;</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 将时间戳转换成可识别的格式</code></div>
<div class="line"><code class="plain">    local_tv_sec = pkt_header-&gt;ts.tv_sec;</code></div>
<div class="line"><code class="plain">    ltime = localtime(&amp;local_tv_sec);</code></div>
<div class="line"><code class="plain">    strftime(timestr, sizeof timestr, </code><code class="string">"%H:%M:%S"</code><code class="plain">, ltime);</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"Time: %s, Caplen: %d, Len: %d \n"</code><code class="plain">, timestr, pkt_header-&gt;caplen, pkt_header-&gt;len);</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"================MAC================\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    u_char dstMac[</code><code class="value">6</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">for</code><code class="plain">(</code><code class="keyword">int</code><code class="plain"> i = </code><code class="value">0</code><code class="plain">; i &lt; </code><code class="value">6</code><code class="plain">; i++) {</code></div>
<div class="line"><code class="plain">        dstMac[i] = *(pkt_data+i+</code><code class="value">0</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"Dst Mac: %02x:%02x:%02x:%02x:%02x:%02x \n"</code><code class="plain">, dstMac[</code><code class="value">0</code><code class="plain">], dstMac[</code><code class="value">1</code><code class="plain">], dstMac[</code><code class="value">2</code><code class="plain">], dstMac[</code><code class="value">3</code><code class="plain">], dstMac[</code><code class="value">4</code><code class="plain">], dstMac[</code><code class="value">5</code><code class="plain">]);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    u_char srcMac[</code><code class="value">6</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">for</code><code class="plain">(i = </code><code class="value">0</code><code class="plain">; i &lt; </code><code class="value">6</code><code class="plain">; i++) {</code></div>
<div class="line"><code class="plain">        srcMac[i] = *(pkt_data+i+</code><code class="value">6</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"Src Mac: %02x:%02x:%02x:%02x:%02x:%02x \n"</code><code class="plain">, srcMac[</code><code class="value">0</code><code class="plain">], srcMac[</code><code class="value">1</code><code class="plain">], srcMac[</code><code class="value">2</code><code class="plain">], srcMac[</code><code class="value">3</code><code class="plain">], srcMac[</code><code class="value">4</code><code class="plain">], srcMac[</code><code class="value">5</code><code class="plain">]);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    u_char type[</code><code class="value">2</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">for</code><code class="plain">(i = </code><code class="value">0</code><code class="plain">; i &lt; </code><code class="value">2</code><code class="plain">; i++) {</code></div>
<div class="line"><code class="plain">        type[i] = *(pkt_data+i+</code><code class="value">12</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">    printf(</code><code class="string">"Type: "</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (type[</code><code class="value">0</code><code class="plain">] == </code><code class="value">0x08</code><code class="plain">) {    </code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (type[</code><code class="value">1</code><code class="plain">] == </code><code class="value">0x00</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"IPv4\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"\n================IP================\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            u_char versionAndHeaderLen = *(pkt_data+</code><code class="value">14</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            u_char version = versionAndHeaderLen &gt;&gt; </code><code class="value">4</code><code class="plain">; </code><code class="comments">// 版本</code></div>
<div class="line"><code class="plain">            u_char headerLen = versionAndHeaderLen &lt;&lt; </code><code class="value">4</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            headerLen = headerLen &gt;&gt; </code><code class="value">4</code><code class="plain">; </code><code class="comments">// 首部长度</code></div>
<div class="line"><code class="plain">            u_char realHeaderLen = headerLen * </code><code class="value">4</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            </code></div>
<div class="line"><code class="plain">            </code><code class="keyword">if</code><code class="plain"> (version == </code><code class="value">0x04</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"Version: IPv4 \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"HeaderLen: %d(%d Byte) \n"</code><code class="plain">, headerLen, realHeaderLen);</code></div>
<div class="line"><code class="plain">            </code></div>
<div class="line"> </div>
<div class="line"><code class="plain">            u_char allLen[</code><code class="value">2</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">for</code><code class="plain"> (i = </code><code class="value">0</code><code class="plain">; i &lt; </code><code class="value">2</code><code class="plain">; i++) {</code></div>
<div class="line"><code class="plain">                allLen[i] = *(pkt_data+i+</code><code class="value">14</code><code class="plain">+</code><code class="value">2</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">            u_short resLen = ntohs(*((u_short*)allLen));</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">            printf(</code><code class="string">"AllLen: %d Byte \n"</code><code class="plain">, resLen);</code></div>
<div class="line"><code class="plain">            </code></div>
<div class="line"><code class="plain">            u_char protocol = *(pkt_data+</code><code class="value">14</code><code class="plain">+</code><code class="value">9</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">switch</code><code class="plain"> (protocol) {</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">case</code><code class="plain"> </code><code class="value">1</code><code class="plain">:</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"Protocol: ICMP \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">case</code><code class="plain"> </code><code class="value">2</code><code class="plain">:</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"Protocol: IGMP \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">case</code><code class="plain"> </code><code class="value">6</code><code class="plain">:</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"Protocol: TCP \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">case</code><code class="plain"> </code><code class="value">17</code><code class="plain">:</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"Protocol: UDP \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">case</code><code class="plain"> </code><code class="value">89</code><code class="plain">:</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"Protocol: OSPF \n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">            </code></div>
<div class="line"><code class="plain">            u_char srcIP[</code><code class="value">4</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">for</code><code class="plain"> (i = </code><code class="value">0</code><code class="plain">; i &lt; </code><code class="value">4</code><code class="plain">; i++) {</code></div>
<div class="line"><code class="plain">                srcIP[i] = *(pkt_data+i+</code><code class="value">14</code><code class="plain">+</code><code class="value">12</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"Src IP: %d.%d.%d.%d\n"</code><code class="plain">, srcIP[</code><code class="value">0</code><code class="plain">], srcIP[</code><code class="value">1</code><code class="plain">], srcIP[</code><code class="value">2</code><code class="plain">], srcIP[</code><code class="value">3</code><code class="plain">]);</code></div>
<div class="line"><code class="plain">            u_char dstIP[</code><code class="value">4</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">for</code><code class="plain"> (i = </code><code class="value">0</code><code class="plain">; i &lt; </code><code class="value">4</code><code class="plain">; i++) {</code></div>
<div class="line"><code class="plain">                dstIP[i] = *(pkt_data+i+</code><code class="value">14</code><code class="plain">+</code><code class="value">16</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"Dst IP: %d.%d.%d.%d \n"</code><code class="plain">, dstIP[</code><code class="value">0</code><code class="plain">], dstIP[</code><code class="value">1</code><code class="plain">], dstIP[</code><code class="value">2</code><code class="plain">], dstIP[</code><code class="value">3</code><code class="plain">]);</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"\n================IP================\n\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            </code></div>
<div class="line"><code class="plain">            </code><code class="keyword">if</code><code class="plain"> (protocol == </code><code class="value">6</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"================TCP================\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">                u_char srcPort[</code><code class="value">2</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">for</code><code class="plain"> (</code><code class="keyword">int</code><code class="plain"> x = </code><code class="value">0</code><code class="plain">; x &lt; </code><code class="value">2</code><code class="plain">; x++) {</code></div>
<div class="line"><code class="plain">                    srcPort[x] = *(pkt_data+</code><code class="value">14</code><code class="plain">+realHeaderLen+x);</code></div>
<div class="line"><code class="plain">                }</code></div>
<div class="line"><code class="plain">                u_short resSrcPort = ntohs(*(u_short*)srcPort);</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"Src Port: %d \n"</code><code class="plain">, resSrcPort);</code></div>
<div class="line"><code class="plain">                u_char dstPort[</code><code class="value">2</code><code class="plain">] = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">for</code><code class="plain"> (x = </code><code class="value">0</code><code class="plain">; x &lt; </code><code class="value">2</code><code class="plain">; x++) {</code></div>
<div class="line"><code class="plain">                    dstPort[x] = *(pkt_data+</code><code class="value">14</code><code class="plain">+realHeaderLen+x);</code></div>
<div class="line"><code class="plain">                }</code></div>
<div class="line"><code class="plain">                u_short resDstPort = ntohs(*(u_short*)dstPort);</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"Dst Port: %d \n"</code><code class="plain">, resDstPort);</code></div>
<div class="line"><code class="plain">                u_char offsetAndReserved = *(pkt_data+</code><code class="value">14</code><code class="plain">+realHeaderLen+</code><code class="value">12</code><code class="plain">);</code></div>
<div class="line"><code class="plain">                u_char offset = offsetAndReserved &gt;&gt; </code><code class="value">4</code><code class="plain">;</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"Offset: %d\n"</code><code class="plain">, offset);</code></div>
<div class="line"><code class="plain">                printf(</code><code class="string">"================TCP================\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><code class="plain">        } </code><code class="keyword">else</code><code class="plain"> </code><code class="keyword">if</code><code class="plain"> (type[</code><code class="value">1</code><code class="plain">] == </code><code class="value">0x06</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">            printf(</code><code class="string">"ARP\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-11_22-7-47.png" alt="images/download/attachments/1015818/image2021-8-11_22-7-47.png" width="600"  />
    </p>
    </div>
    </div>
    <div class="section section-1" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeaooeS7vzM2MC9RUeeuoeWutuiOt-WPlue9kemAnw">
        <h1 class="heading "><span>&#27169;&#20223;360/QQ&#31649;&#23478;&#33719;&#21462;&#32593;&#36895;</span></h1>
<p   
>&#25105;&#20204;&#37117;&#29992;&#36807;360&#25110;&#32773;QQ&#31649;&#23478;&#65292;&#23427;&#19968;&#33324;&#20250;&#26377;&#20010;&#24748;&#28014;&#30340;&#31383;&#21475;&#65292;&#28982;&#21518;&#23454;&#26102;&#30340;&#26174;&#31034;&#24403;&#21069;&#30340;&#19978;&#19979;&#34892;&#32593;&#36895;&#65292;&#25105;&#20204;&#23601;&#36890;&#36807;&#23398;&#20064;&#30340;&#30693;&#35782;&#26469;&#23454;&#29616;&#36825;&#20010;&#21151;&#33021;&#12290;</p>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLee9kemAn-eahOWumuS5iQ">
        <h2 class="heading "><span>&#32593;&#36895;&#30340;&#23450;&#20041;</span></h2>
<p   
>&#19968;&#27573;&#26102;&#38388;&#20869;&#19979;&#36733;&#25968;&#25454;&#30340;&#22823;&#23567;&#38500;&#20197;&#25345;&#32493;&#26102;&#38271;&#23601;&#26159;&#32593;&#36895;&#65306;speed = len / time</p>
<p   
>&#37027;&#20040;&#22914;&#19978;&#20844;&#24335;&#20013;&#30340;&#19979;&#36733;&#25968;&#25454;&#30340;&#22823;&#23567;&#21644;&#25345;&#32493;&#26102;&#38271;&#22914;&#20309;&#33719;&#21462;&#21602;&#65311;&#37027;&#23601;&#26159;&#36890;&#36807;&#20043;&#21069;&#25152;&#23398;&#20064;&#30340;&#22238;&#35843;&#20989;&#25968;&#30340;pcap_pkthdr&#32467;&#26500;&#20307;&#26469;&#33719;&#21462;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWunumZheS7o-eggee8luWGmS42">
        <h2 class="heading "><span>&#23454;&#38469;&#20195;&#30721;&#32534;&#20889;</span></h2>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">void</code><code class="plain"> Mypcap_handler(u_char *user, </code><code class="keyword">const</code><code class="plain"> struct pcap_pkthdr *pkt_header, </code><code class="keyword">const</code><code class="plain"> u_char *pkt_data) {</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 5. 编写回调函数</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 初始化开始时间和结束时间</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 这里使用static关键词是为了避免重复初始化</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">static</code><code class="plain"> timeval tBegin, tEnd = {</code><code class="value">0</code><code class="plain">};</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 初始化数据长度</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">static</code><code class="plain"> DWORD dataLen = </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 结束时间为抓包时间</code></div>
<div class="line"><code class="plain">    tEnd = pkt_header-&gt;ts;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 数据长度递增</code></div>
<div class="line"><code class="plain">    dataLen += pkt_header-&gt;caplen;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 计算得出开始时间减去结束时间</code></div>
<div class="line"><code class="plain">    DWORD fTime = tEnd.tv_sec - tBegin.tv_sec + (tEnd.tv_usec - tBegin.tv_usec) / </code><code class="value">1000000</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 当时间大于1秒时，计算网速</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (fTime &gt; </code><code class="value">1</code><code class="plain">){</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">float</code><code class="plain"> speed = dataLen / fTime;</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"Speed: %f K/S \n"</code><code class="plain">, speed/</code><code class="value">1024</code><code class="plain">);</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// 将开始时间移到结束时间，提供下一次计算</code></div>
<div class="line"><code class="plain">        tBegin = tEnd;</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// 初始化数据</code></div>
<div class="line"><code class="plain">        dataLen = </code><code class="value">0</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-11_22-43-16.png" alt="images/download/attachments/1015818/image2021-8-11_22-43-16.png" width="600"  />
    </p>
    </div>
    </div>
    <div class="section section-1" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVJTQeWKoOWvhueahOWfuuacrOWOn-eQhg">
        <h1 class="heading "><span>RSA&#21152;&#23494;&#30340;&#22522;&#26412;&#21407;&#29702;</span></h1>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeS4uuS7gOS5iOmcgOimgeWKoOWvhg">
        <h2 class="heading "><span>&#20026;&#20160;&#20040;&#38656;&#35201;&#21152;&#23494;</span></h2>
<p   
>&#32593;&#32476;&#19978;&#20256;&#36755;&#30340;&#25968;&#25454;&#24456;&#23481;&#26131;&#34987;&#25235;&#21253;&#65292;&#22914;&#26524;&#19981;&#21152;&#23494;&#65292;&#32593;&#32476;&#25968;&#25454;&#23601;&#24456;&#23481;&#26131;&#31363;&#21462;&#65292;&#35832;&#22914;&#29992;&#25143;&#21517;&#12289;&#23494;&#30721;&#36825;&#20123;&#25935;&#24863;&#30340;&#20449;&#24687;&#19968;&#26086;&#20002;&#22833;&#65292;&#23558;&#20250;&#36896;&#25104;&#24040;&#22823;&#30340;&#25439;&#22833;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeW4uOeUqOeahOWKoOWvhuaWueW8jw">
        <h2 class="heading "><span>&#24120;&#29992;&#30340;&#21152;&#23494;&#26041;&#24335;</span></h2>
<ol class=" "><li class=" "><p   
><strong class=" ">&#23545;&#31216;&#21152;&#23494;</strong>&#65306;&#21152;&#23494;&#26041;&#21644;&#35299;&#23494;&#26041;&#20351;&#29992;&#21516;&#19968;&#20010;&#23494;&#38053;&#65307;<strong class=" ">&#20248;&#28857;</strong>&#65306;&#21152;&#23494;&#35299;&#23494;&#36807;&#31243;&#31616;&#21333;&#65292;&#39640;&#25928;&#65307;<strong class=" ">&#32570;&#28857;</strong>&#65306;&#26377;&#19968;&#26041;&#27844;&#23494;&#20102;&#65292;&#21017;&#25972;&#20010;&#21152;&#23494;&#23601;&#22833;&#21435;&#20102;&#24847;&#20041;&#12290;</p>
</li><li class=" "><p   
><strong class=" ">&#38750;&#23545;&#31216;&#21152;&#23494;</strong>&#65306;&#21152;&#23494;&#26041;&#21644;&#35299;&#23494;&#26041;&#20351;&#29992;&#19981;&#21516;&#30340;&#23494;&#38053;&#65307;<strong class=" ">&#20248;&#28857;</strong>&#65306;&#35299;&#23494;&#30340;&#31192;&#38053;&#26080;&#27861;&#29992;&#21152;&#23494;&#30340;&#23494;&#38053;&#26469;&#35299;&#23494;&#65292;&#21363;&#20351;&#21152;&#23494;&#26041;&#26292;&#38706;&#20986;&#20102;&#23494;&#38053;&#20063;&#27809;&#20107;&#65292;&#22240;&#20026;&#36825;&#20010;&#23494;&#38053;&#21482;&#33021;&#21152;&#23494;&#65292;&#32780;&#26080;&#27861;&#35299;&#23494;&#65292;&#25152;&#20197;&#23601;&#25552;&#39640;&#20102;&#23433;&#20840;&#24615;&#65307;<strong class=" ">&#32570;&#28857;</strong>&#65306;&#25928;&#29575;&#27604;&#36739;&#20302;&#19979;&#65292;&#36807;&#31243;&#27604;&#36739;&#32321;&#29712;&#12290;</p>
</li></ol><p   
><strong class=" ">RSA</strong>&#23601;&#23646;&#20110;&#38750;&#23545;&#31216;&#21152;&#23494;&#65292;&#20063;&#23601;&#26159;&#25105;&#20204;&#26412;&#31456;&#33410;&#25152;&#23398;&#30340;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLei-heWKqeamguW_tQ">
        <h2 class="heading "><span>&#36741;&#21161;&#27010;&#24565;</span></h2>
<ol class=" "><li class=" "><p   
><strong class=" ">&#36136;&#25968;</strong>&#65306;&#26159;&#25351;&#22312;&#22823;&#20110;1&#30340;&#33258;&#28982;&#25968;&#20013;&#65292;&#38500;&#20102;1&#21644;&#23427;&#26412;&#36523;&#20197;&#22806;&#19981;&#20877;&#26377;&#20854;&#20182;&#22240;&#25968;&#30340;&#33258;&#28982;&#25968;&#12290;</p>
</li><li class=" "><p   
><strong class=" ">&#20114;&#20026;&#36136;&#25968;</strong>&#65306;&#19968;&#33324;&#25351;&#20114;&#36136;&#25968;&#65292;&#20114;&#36136;&#25968;&#20026;&#25968;&#23398;&#20013;&#30340;&#19968;&#31181;&#27010;&#24565;&#65292;&#21363;&#20004;&#20010;&#25110;&#22810;&#20010;&#25972;&#25968;&#30340;&#20844;&#22240;&#25968;&#21482;&#26377;1&#30340;&#38750;&#38646;&#33258;&#28982;&#25968;&#12290;&#20844;&#22240;&#25968;&#21482;&#26377;1&#30340;&#20004;&#20010;&#38750;&#38646;&#33258;&#28982;&#25968;&#65292;&#21483;&#20570;&#20114;&#36136;&#25968;&#12290;</p>
</li></ol>    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVJTQeWKoOWvhuWvhumSpeeahOiOt-WPlg">
        <h2 class="heading "><span>RSA&#21152;&#23494;&#23494;&#38053;&#30340;&#33719;&#21462;</span></h2>
<p   
>RSA&#21152;&#23494;&#23494;&#38053;&#33719;&#21462;&#27493;&#39588;&#22914;&#19979;&#25152;&#31034;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#38543;&#26426;&#36873;&#21462;&#20004;&#20010;&#25968;p&#12289;q&#65288;&#28385;&#36275;&#20114;&#36136;&#25968;&#26465;&#20214;&#65289;&#65307;</p>
</li><li class=" "><p   
>&#25353;&#29031;&#20844;&#24335;&#33719;&#21462;&#20844;&#24320;&#27169;&#25968;&#65306;<u class=" "><strong class=" ">n = p * q</strong></u>&#65292;&#23427;&#30340;&#20108;&#36827;&#21046;&#20301;&#23601;&#26159;&#23494;&#38053;&#38271;&#24230;&#65307;</p>
</li><li class=" "><p   
>&#25353;&#29031;&#20844;&#24335;&#33719;&#21462;&#65306;<u class=" "><strong class=" ">g = f(p,q) = (p-1)*(q-1)</strong></u>&#65307;</p>
</li><li class=" "><p   
>&#22312;1&#21644;g&#20043;&#38388;&#20219;&#24847;&#19968;&#20010;&#38543;&#26426;&#25972;&#25968;e&#65288;&#20844;&#24320;&#25351;&#25968;&#65292;&#28385;&#36275;1&lt;e&lt;g&#65289;&#65307;</p>
</li><li class=" "><p   
>&#30001; <u class=" "><strong class=" ">e*d mod g = 1</strong></u> &#20851;&#31995;&#24335;&#25512;&#23548;&#20986;&#26469;d&#65288;&#31169;&#26377;&#25351;&#25968;&#65289;</p>
</li><li class=" "><p   
>&#20844;&#24320;&#23494;&#38053; = (e, n) &#29992;&#26469;&#21152;&#23494;</p>
</li><li class=" "><p   
>&#31169;&#26377;&#23494;&#38053; = (d, n) &#29992;&#26469;&#35299;&#23494;</p>
</li></ol>    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVJTQeWKoOWvhuino-Wvhueul-azlQ">
        <h2 class="heading "><span>RSA&#21152;&#23494;&#35299;&#23494;&#31639;&#27861;</span></h2>
<p   
>&#35774;M&#20026;&#38656;&#35201;&#21152;&#23494;&#30340;&#26126;&#25991;&#25968;&#25454;&#65292;&#21152;&#23494;&#31639;&#27861;&#20026;&#65306;<u class=" "><strong class=" ">Encrypt_Message = M^e mod n</strong></u></p>
<p   
>&#35774;D&#20026;&#38656;&#35201;&#35299;&#23494;&#30340;&#23494;&#25991;&#25968;&#25454;&#65292;&#35299;&#23494;&#31639;&#27861;&#20026;&#65306;<u class=" "><strong class=" ">Decrypt_Message = D^d mod n</strong></u></p>
<p   
>&#36807;&#31243;&#21487;&#20197;&#20511;&#21161;RSA-Tool&#21644;Big Integer Calculator&#24037;&#20855;&#12290;</p>
    </div>
    </div>
    <div class="section section-1" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVJTQeW6k-eahOS9v-eUqA">
        <h1 class="heading "><span>RSA&#24211;&#30340;&#20351;&#29992;</span></h1>
<p   
>&#25105;&#20204;&#38656;&#35201;&#20511;&#21161;RSA&#24211;&#22312;&#20195;&#30721;&#19978;&#23454;&#29616;&#21152;&#23494;&#19982;&#35299;&#23494;&#65292;&#36825;&#20010;&#24211;&#26159;OPENSSL&#12290;</p>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWuieijheS4jumFjee9rg">
        <h2 class="heading "><span>&#23433;&#35013;&#19982;&#37197;&#32622;</span></h2>
<p   
>&#22914;&#26524;&#20320;&#21435;&#23448;&#26041;&#19979;&#36733;&#30340;&#35805;&#26159;&#19979;&#36733;&#21040;&#30340;&#28304;&#30721;&#65292;&#38656;&#35201;&#33258;&#24049;&#21435;&#32534;&#35793;&#25171;&#21253;&#65292;&#21644;WinPcap&#24211;&#19968;&#26679;&#65292;&#23558;&#23545;&#24212;&#36335;&#24452;&#22635;&#20889;&#21040;VC6&#30340;&#37197;&#32622;&#20013;&#21435;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-11_23-49-59.png" alt="images/download/attachments/1015818/image2021-8-11_23-49-59.png" width="600"  />
    </p>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVJTQeW6k-S5i1JTQee7k-aehOS9k-WPikFQSQ">
        <h2 class="heading "><span>RSA&#24211;&#20043;RSA&#32467;&#26500;&#20307;&#21450;API</span></h2>
<p   
>RSA&#32467;&#26500;&#20307;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">struct RSA</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    BIGNUM *n;              </code><code class="comments">// public modulus</code></div>
<div class="line"><code class="plain">    BIGNUM *e;              </code><code class="comments">// public exponent</code></div>
<div class="line"><code class="plain">    BIGNUM *d;              </code><code class="comments">// private exponent</code></div>
<div class="line"><code class="plain">    BIGNUM *p;              </code><code class="comments">// secret prime factor</code></div>
<div class="line"><code class="plain">    BIGNUM *q;              </code><code class="comments">// secret prime factor</code></div>
<div class="line"><code class="plain">    BIGNUM *dmp1;           </code><code class="comments">// d mod (p-1)</code></div>
<div class="line"><code class="plain">    BIGNUM *dmq1;           </code><code class="comments">// d mod (q-1)</code></div>
<div class="line"><code class="plain">    BIGNUM *iqmp;           </code><code class="comments">// q^-1 mod p</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// ...</code></div>
<div class="line"><code class="plain">};</code></div>
</div>
    </div>
<p   
>&#20854;&#23545;&#24212;&#30340;API&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="comments">// 初始化一个RSA结构</code></div>
<div class="line"><code class="plain">RSA * RSA_new(</code><code class="keyword">void</code><code class="plain">);</code></div>
<div class="line"><code class="plain">  </code></div>
<div class="line"><code class="comments">// 释放一个RSA结构</code></div>
<div class="line"><code class="keyword">void</code><code class="plain"> RSA_free(RSA *rsa);</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVJTQeW6k-S5i0JJR05VTeWPikFQSQ">
        <h2 class="heading "><span>RSA&#24211;&#20043;BIGNUM&#21450;API</span></h2>
<p   
>BIGNUM&#32467;&#26500;&#20307;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">typedef struct bignum_st BIGNUM;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">struct bignum_st</code></div>
<div class="line"><code class="plain"> {</code></div>
<div class="line"><code class="plain">    BN_ULONG *d;               </code><code class="comments">/* Pointer to an array of 'BN_BITS2' bit  chunks. */</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> top;                   </code><code class="comments">/* Index of last used d +1. */</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/* The next are internal book keeping for bn_expand. */</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> dmax;                  </code><code class="comments">/* Size of the d array. */</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> neg;                   </code><code class="comments">/* one if the number is negative */</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> flags;</code></div>
<div class="line"><code class="plain">};</code></div>
</div>
    </div>
<p   
>&#20854;&#23545;&#24212;&#30340;API&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="comments">// 新生成一个BIGNUM结构</code></div>
<div class="line"><code class="plain">BIGNUM *BN_new(</code><code class="keyword">void</code><code class="plain">);</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="comments">// 释放一个BIGNUM结构</code></div>
<div class="line"><code class="keyword">void</code><code class="plain"> BN_free(BIGNUM *a);</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 将16进制字符串转成大数</code></div>
<div class="line"><code class="keyword">int</code><code class="plain"> BN_hex2bn(BIGNUM **a, </code><code class="keyword">const</code><code class="plain"> </code><code class="keyword">char</code><code class="plain"> *str);</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLVJTQeW6k-S5i-WKoOWvhuino-WvhuWHveaVsA">
        <h2 class="heading "><span>RSA&#24211;&#20043;&#21152;&#23494;&#35299;&#23494;&#20989;&#25968;</span></h2>
    <div class="section section-3" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWFrOmSpeWKoOWvhuWHveaVsA">
        <h3 class="heading "><span>&#20844;&#38053;&#21152;&#23494;&#20989;&#25968;</span></h3>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> RSA_public_encrypt(</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> flen, </code><code class="comments">// 要加密信息长度</code></div>
<div class="line"><code class="plain">    unsigned </code><code class="keyword">char</code><code class="plain"> *from, </code><code class="comments">// 要加密信息</code></div>
<div class="line"><code class="plain">    unsigned </code><code class="keyword">char</code><code class="plain"> *to, </code><code class="comments">// 输出参数，加密后的信息</code></div>
<div class="line"><code class="plain">    RSA *rsa,</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> padding </code><code class="comments">// 采取的加密方案, 分为: RSA_PKCS1_PADDING、RSA_PKCS1_OAEP_PADDING、RSA_SSLV23_PADDING、RSA_NO_PADDING</code></div>
<div class="line"><code class="plain"> );</code></div>
</div>
    </div>
    </div>
    <div class="section section-3" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeengemSpeino-WvhuWHveaVsA">
        <h3 class="heading "><span>&#31169;&#38053;&#35299;&#23494;&#20989;&#25968;</span></h3>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">int</code><code class="plain"> RSA_private_decrypt(</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> flen, </code><code class="comments">// 要解密的信息长度</code></div>
<div class="line"><code class="plain">    unsigned </code><code class="keyword">char</code><code class="plain"> *from, </code><code class="comments">// 要解密的信息</code></div>
<div class="line"><code class="plain">    unsigned </code><code class="keyword">char</code><code class="plain"> *to, </code><code class="comments">// 输出参数，解密后的信息</code></div>
<div class="line"><code class="plain">    RSA *rsa,</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> padding </code><code class="comments">// 采取的解密方案，分为：RSA_PKCS1_PADDING、RSA_PKCS1_OAEP_PADDING、RSA_SSLV23_PADDING、RSA_NO_PADDING</code></div>
<div class="line"><code class="plain">);</code></div>
</div>
    </div>
    </div>
    </div>
    <div class="section section-2" id="src-1015818_safe-id-aWQt572R57uc57yW56iLLeWunumZheS7o-eggee8luWGmS43">
        <h2 class="heading "><span>&#23454;&#38469;&#20195;&#30721;&#32534;&#20889;</span></h2>
<p   
>&#39318;&#20808;&#25105;&#20204;&#38656;&#35201;&#21253;&#21547;&#19968;&#20010;&#22836;&#25991;&#20214;&#21644;&#20004;&#20010;&#24211;&#25991;&#20214;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#include &lt;openssl/rsa.h&gt;</code></div>
<div class="line"><code class="plain">#pragma comment(lib, </code><code class="string">"libeay32.lib"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">#pragma comment(lib, </code><code class="string">"ssleay32.lib"</code><code class="plain">)</code></div>
</div>
    </div>
<p   
>&#28982;&#21518;&#23601;&#26159;&#23450;&#20041;E&#12289;D&#12289;N&#65292;&#36825;&#20010;&#25105;&#20204;&#26681;&#25454;RSA-Tool&#29983;&#25104;&#30340;&#22635;&#20889;&#36827;&#21435;&#21363;&#21487;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1015818/image2021-8-12_0-30-19.png" alt="images/download/attachments/1015818/image2021-8-12_0-30-19.png" width="600"  />
    </p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">#define E </code><code class="string">"10001"</code></div>
<div class="line"><code class="plain">#define D </code><code class="string">"8008AA4D"</code></div>
<div class="line"><code class="plain">#define N </code><code class="string">"B83FD1C1"</code></div>
</div>
    </div>
<p   
>&#25509;&#30528;&#23601;&#26159;&#20889;&#33258;&#24049;&#30340;&#21152;&#23494;&#20989;&#25968;&#65292;&#35299;&#23494;&#20989;&#25968;&#21516;&#29702;&#21487;&#24471;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="keyword">void</code><code class="plain"> MyRSAEncrypt(</code><code class="keyword">const</code><code class="plain"> unsigned </code><code class="keyword">char</code><code class="plain">* pOrgData, </code><code class="keyword">int</code><code class="plain"> dataLen, unsigned </code><code class="keyword">char</code><code class="plain">* pEncryptBuf) {</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 初始化一个RSA结构</code></div>
<div class="line"><code class="plain">    RSA *pRsa = RSA_new();</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 初始化BIGNUM结构</code></div>
<div class="line"><code class="plain">    BIGNUM* pbn_e = BN_new();</code></div>
<div class="line"><code class="plain">    BIGNUM* pbn_n = BN_new();</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 将16进制字符串转成大数</code></div>
<div class="line"><code class="plain">    BN_hex2bn(&amp;pbn_e, E);</code></div>
<div class="line"><code class="plain">    BN_hex2bn(&amp;pbn_n, N);</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// RSA结构成员赋值</code></div>
<div class="line"><code class="plain">    pRsa-&gt;e = pbn_e;</code></div>
<div class="line"><code class="plain">    pRsa-&gt;n = pbn_n;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="comments">// 公钥加密函数</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">int</code><code class="plain"> iRet = RSA_public_encrypt(dataLen, pOrgData, pEncryptBuf, pRsa, RSA_NO_PADDING);</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (iRet == -</code><code class="value">1</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">        printf(</code><code class="string">"RSA_public_encrypt Error!\n"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="comments">// 释放BIGNUM结构</code></div>
<div class="line"><code class="plain">    BN_free(pbn_e);</code></div>
<div class="line"><code class="plain">    BN_free(pbn_n);</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// 释放RSA结构</code></div>
<div class="line"><code class="plain">    RSA_free(pRsa);</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p   
><br/></p>
    </div>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="MFC.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>MFC</span>
        </a>
                <a href="%E6%95%B0%E6%8D%AE%E5%BA%93.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>&#25968;&#25454;&#24211;</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
