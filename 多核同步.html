<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>&#22810;&#26680;&#21516;&#27493; - &#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="1015827">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">BinaryLearning</span>
                    <img class="space-logo" src="global.logo" />
                </h1>
                <a href="Binary-Learning.html" class="ht-space-link">
                    <h2>&#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</h2>
                </a>
                <p><br><a href="https://github.com/gh0stkey/Binary-Learning" target="_blank">ᴀᴜᴛʜᴏʀ: ᴋᴇʏ</a><br><br>不积跬步，无以至千里；<br>不积小流，无以成江海。</p>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=1933380"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Binary-Learning.html">&#28404;&#27700;&#36870;&#21521;&#35838;&#31243;&#31508;&#35760;</a></li>
                                                                                     <li><a href="%E4%B8%AD%E7%BA%A7%E7%AF%87.html">&#20013;&#32423;&#31687;</a></li>
                                                            </ul>
</div>            <h1 id="src-1933380"> <span>&#22810;&#26680;&#21516;&#27493;</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<p   
>&#25105;&#20204;&#22312;&#20351;&#29992;Inline Hook&#25216;&#26415;&#26102;&#65292;&#22914;&#26524;&#20320;&#30340;&#31995;&#32479;&#29615;&#22659;&#26159;&#22810;&#26680;&#26102;&#23601;&#21487;&#33021;&#20250;&#20986;&#29616;&#19968;&#20123;&#24773;&#20917;&#23548;&#33268;&#31995;&#32479;&#34013;&#23631;&#65292;&#22914;&#26524;&#35201;&#20102;&#35299;&#36825;&#20010;&#21407;&#22240;&#65292;&#25105;&#20204;&#23601;&#38656;&#35201;&#20102;&#35299;&#22810;&#26680;&#21516;&#27493;&#12290;</p>
    <div class="section section-1" id="src-1933380_safe-id-aWQt5aSa5qC45ZCM5q2lLeS4tOeVjOWMug">
        <h1 class="heading "><span>&#20020;&#30028;&#21306;</span></h1>
    <div class="section section-2" id="src-1933380_safe-id-aWQt5aSa5qC45ZCM5q2lLeW5tuWPkeS4juWQjOatpQ">
        <h2 class="heading "><span>&#24182;&#21457;&#19982;&#21516;&#27493;</span></h2>
<p   
>&#22312;&#20102;&#35299;&#20020;&#30028;&#21306;&#20043;&#21069;&#25105;&#20204;&#38656;&#35201;&#34917;&#20805;&#19968;&#20123;&#21069;&#32622;&#30693;&#35782;&#65292;&#20197;&#27492;&#20316;&#20026;&#38138;&#22443;&#20877;&#36827;&#34892;&#23398;&#20064;&#12290;&#25105;&#20204;&#38656;&#35201;&#20102;&#35299;&#24182;&#21457;&#19982;&#21516;&#27493;&#30340;&#27010;&#24565;&#65306;&#24182;&#21457;&#26159;&#25351;&#22810;&#20010;&#32447;&#31243;&#21516;&#26102;&#25191;&#34892;&#65292;&#22312;<strong class=" ">&#21333;&#26680;&#30340;&#24773;&#20917;&#19979;&#24182;&#19981;&#26159;&#30495;&#27491;&#30340;&#21516;&#26102;&#25191;&#34892;&#32780;&#26159;&#20998;&#26102;&#25191;&#34892;</strong>&#65292;&#22810;&#26680;&#30340;&#24773;&#20917;&#19979;&#23601;&#21487;&#20197;&#22312;&#26576;&#19968;&#20010;&#26102;&#21051;&#21516;&#26102;&#22810;&#20010;&#32447;&#31243;&#25191;&#34892;&#12290;<strong class=" ">&#21516;&#27493;&#21017;&#26159;&#20445;&#35777;&#22312;&#24182;&#21457;&#25191;&#34892;&#30340;&#29615;&#22659;&#20013;&#21508;&#20010;&#32447;&#31243;&#21487;&#20197;&#26377;&#24207;&#30340;&#25191;&#34892;</strong>&#65292;&#26080;&#35770;&#26159;&#21333;&#26680;&#25110;&#22810;&#26680;&#30340;&#29615;&#22659;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1933380_safe-id-aWQt5aSa5qC45ZCM5q2lLeWNleihjOaMh-S7pOWQjOatpQ">
        <h2 class="heading "><span>&#21333;&#34892;&#25351;&#20196;&#21516;&#27493;</span></h2>
<p   
>&#22914;&#19979;&#25152;&#31034;&#20195;&#30721;&#65292;&#26377;&#19968;&#20010;&#20840;&#23616;&#21464;&#37327;dwVal&#65292;&#22312;&#32447;&#31243;&#20013;&#25191;&#34892;&#30340;&#20195;&#30721;&#26159;&#23545;dwVal&#30340;&#33258;&#22686;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">DWORD dwVal = </code><code class="value">0</code><code class="plain">; </code><code class="comments">// 全局变量</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// 线程执行的代码</code></div>
<div class="line"><code class="plain">dwVal++;</code></div>
</div>
    </div>
<p   
>&#20197;C++&#30340;&#35282;&#24230;&#26469;&#30475;&#65292;&#19978;&#38754;&#30340;&#20195;&#30721;dwVal&#30340;&#33258;&#22686;&#21482;&#26377;&#19968;&#34892;&#25351;&#20196;&#65292;&#25152;&#20197;&#22810;&#20010;&#32447;&#31243;&#21435;&#35843;&#29992;&#19981;&#20250;&#23384;&#22312;&#38382;&#39064;&#65292;<strong class=" ">&#20294;&#23454;&#38469;&#24182;&#19981;&#26159;&#36825;&#26679;&#30340;</strong>&#65292;&#22240;&#20026;&#31243;&#24207;&#30340;&#25191;&#34892;&#26159;&#20197;&#27719;&#32534;&#25351;&#20196;&#20986;&#21457;&#30340;&#65292;&#33258;&#22686;&#30340;&#27719;&#32534;&#20195;&#30721;&#22914;&#19979;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">mov eax, [</code><code class="value">0x12345678</code><code class="plain">]</code></div>
<div class="line"><code class="plain">add eax, </code><code class="value">1</code></div>
<div class="line"><code class="plain">mov [</code><code class="value">0x12345678</code><code class="plain">], eax</code></div>
</div>
    </div>
<p   
>&#25152;&#20197;&#25105;&#20204;&#35797;&#24819;&#19968;&#19979;&#24403;A&#32447;&#31243;&#21435;&#25191;&#34892;&#33258;&#22686;&#20195;&#30721;&#26102;&#65292;&#36208;&#21040;&#20102;ADD&#25351;&#20196;&#65292;&#36825;&#26102;&#20505;&#21457;&#29983;&#20102;&#32447;&#31243;&#30340;&#20999;&#25442;&#65292;B&#32447;&#31243;&#25191;&#34892;&#23436;&#33258;&#22686;&#20195;&#30721;&#65292;&#27492;&#26102;dwVal&#30340;&#20540;&#23601;&#26159;1&#65292;&#32447;&#31243;&#22312;&#20999;&#25442;&#22238;A&#65292;A&#32447;&#31243;&#23558;&#20540;&#22635;&#36807;&#21435;&#65292;dwVal&#30340;&#20540;&#20173;&#28982;&#26159;1&#65292;<strong class=" ">&#20294;&#20174;&#20195;&#30721;&#23454;&#29616;&#30340;&#26412;&#24847;&#19978;&#26469;&#30475;&#65292;&#33258;&#22686;&#25191;&#34892;&#20102;&#20004;&#27425;&#37027;dwVal&#30340;&#20540;&#23601;&#24212;&#35813;&#26159;2</strong>&#12290;</p>
<p   
>&#26082;&#28982;&#21333;&#34892;&#20195;&#30721;&#20250;&#23384;&#22312;&#38382;&#39064;&#65292;&#37027;&#20040;&#25105;&#20204;&#23581;&#35797;&#23558;&#20854;&#21464;&#25104;&#21333;&#34892;&#27719;&#32534;&#25351;&#20196;&#26159;&#21542;&#23601;&#21487;&#20197;&#36991;&#20813;&#36825;&#20010;&#38382;&#39064;&#21602;&#65311;&#22914;&#19979;&#27719;&#32534;&#25152;&#31034;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">INC DWORD PTR DS:[</code><code class="value">0x12345678</code><code class="plain">]</code></div>
</div>
    </div>
<p   
>&#36825;&#26465;&#27719;&#32534;&#25351;&#20196;&#21482;&#26377;&#19968;&#34892;&#65292;&#21363;&#20351;&#20986;&#29616;&#32447;&#31243;&#20999;&#25442;&#20063;&#19981;&#20250;&#36896;&#25104;&#19978;&#36848;&#30340;&#24773;&#20917;&#65292;&#20294;&#20063;&#19981;&#33021;&#23436;&#20840;&#36991;&#20813;&#12290;<strong class=" ">&#22240;&#20026;&#22312;&#21333;&#26680;&#30340;&#24773;&#20917;&#19979;&#26159;&#20998;&#26102;&#25191;&#34892;&#65292;&#25152;&#20197;&#36825;&#26465;&#25351;&#20196;&#26159;&#27809;&#38382;&#39064;&#30340;&#65292;&#20294;&#26159;&#22312;&#22810;&#26680;&#30340;&#24773;&#20917;&#19979;&#21487;&#20197;&#22312;&#26576;&#19968;&#20010;&#26102;&#21051;&#21516;&#26102;&#22810;&#20010;&#32447;&#31243;&#25191;&#34892;&#65292;&#22240;&#27492;&#20063;&#20250;&#20986;&#29616;&#19981;&#21516;&#32447;&#31243;&#21516;&#26102;&#25191;&#34892;&#36825;&#26465;&#25351;&#20196;&#30340;&#24773;&#20917;&#65292;&#20063;&#20250;&#20135;&#29983;&#19978;&#36848;&#30340;&#38382;&#39064;</strong>&#12290;</p>
<p   
>&#25105;&#20204;&#24819;&#35201;&#30495;&#27491;&#30340;&#35299;&#20915;&#36825;&#31867;&#38382;&#39064;&#65292;&#23601;&#38656;&#35201;&#20351;&#29992;LOCK&#25351;&#20196;&#65292;&#22914;&#19979;&#25152;&#31034;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">LOCK INC DWORD PTR DS:[</code><code class="value">0x12345678</code><code class="plain">]</code></div>
</div>
    </div>
<p   
>&#20174;LOCK&#25351;&#20196;&#23383;&#38754;&#24847;&#24605;&#26469;&#30475;&#65292;&#25105;&#20204;&#23601;&#30693;&#36947;&#23427;&#26159;&#19968;&#20010;&#38145;&#65292;&#23427;&#38145;&#30340;&#19981;&#26159;CPU&#32780;&#26159;&#20869;&#23384;&#65292;&#21487;&#20197;&#38145;&#23450;&#24403;&#21069;&#25351;&#20196;&#25191;&#34892;&#26102;&#32447;&#31243;&#25152;&#35775;&#38382;&#30340;&#20869;&#23384;&#12290;&#22914;&#19978;&#25152;&#31034;&#20195;&#30721;&#25191;&#34892;&#26102;&#65292;&#20250;&#23545;0x12345678&#22320;&#22336;&#22788;&#30340;&#20540;&#36827;&#34892;&#20462;&#25913;&#65292;&#22312;LOCK&#25351;&#20196;&#30340;&#38480;&#21046;&#19979;&#65292;&#20854;&#23427;&#32447;&#31243;&#26159;&#19981;&#33021;&#35775;&#38382;&#25110;&#20462;&#25913;0x12345678&#22320;&#22336;&#22788;&#30340;&#20540;&#30340;&#65292;<strong class=" ">&#21482;&#26377;&#22312;&#36825;&#26465;&#25351;&#20196;&#25191;&#34892;&#23436;&#21518;&#65292;&#20854;&#20182;&#32447;&#31243;&#25165;&#21487;&#20197;&#23545;&#27492;&#22320;&#22336;&#30340;&#20540;&#36827;&#34892;&#35775;&#38382;&#25110;&#32773;&#20462;&#25913;</strong>&#12290;</p>
<p   
>&#36825;&#31867;&#19981;&#21487;&#34987;&#20013;&#26029;&#30340;&#25805;&#20316;&#21483;&#20570;&#21407;&#23376;&#25805;&#20316;&#65292;Windows&#39029;&#25552;&#20379;&#20102;&#19968;&#37096;&#20998;API&#20379;&#29992;&#25143;&#20351;&#29992;&#26469;&#20445;&#35777;&#22312;&#22810;&#26680;&#24773;&#20917;&#19979;&#30340;&#32447;&#31243;&#21516;&#27493;&#12290;&#65288;&#20027;&#35201;&#20301;&#20110;Kernel32.dll&#21644;Ntdll.dll&#65289;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1933380/image2023-3-2_21-57-3.png" alt="images/download/attachments/1933380/image2023-3-2_21-57-3.png" width="600"  />
    </p>
<p   
>&#25509;&#19979;&#26469;&#25105;&#20204;&#20998;&#26512;Windows&#25552;&#20379;&#30340;&#21407;&#23376;&#20989;&#25968;InterlockedIncrement&#65292;&#26469;&#29702;&#35299;&#19968;&#19979;Windows&#26159;&#22914;&#20309;&#23454;&#29616;&#22810;&#26680;&#21516;&#27493;&#30340;&#65292;&#36890;&#36807;IDA&#25171;&#24320;Kernel32.dll&#65292;&#30452;&#25509;&#22312;&#20989;&#25968;&#21015;&#34920;&#25628;&#32034;InterlockedIncrement&#21363;&#21487;&#25214;&#21040;&#65306;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1933380/image2023-3-2_22-26-22.png" alt="images/download/attachments/1933380/image2023-3-2_22-26-22.png" width="600"  />
    </p>
<p   
>&#22914;&#19978;&#22270;&#25152;&#31034;&#25105;&#20204;&#21487;&#20197;&#30475;&#35265;&#35813;&#20989;&#25968;&#30340;&#23454;&#29616;&#24456;&#31616;&#21333;&#65292;&#19968;&#20849;&#21482;&#26377;5&#34892;&#27719;&#32534;&#25351;&#20196;&#65292;&#25105;&#20204;&#36880;&#34892;&#26469;&#20998;&#26512;&#19968;&#19979;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#25226;&#35201;&#25805;&#20316;&#30340;&#20840;&#23616;&#21464;&#37327;&#30340;&#22320;&#22336;&#21462;&#20986;&#65292;&#32473;&#21040;ECX&#65292;&#21518;&#32493;&#23601;&#21487;&#20197;&#36890;&#36807;[ECX]&#26469;&#35775;&#38382;&#20840;&#23616;&#21464;&#37327;&#30340;&#20540;&#65307;</p>
</li><li class=" "><p   
>&#23558;EAX&#30340;&#20540;&#35774;&#20026;1&#65307;</p>
</li><li class=" "><p   
>&#38500;&#20102;LOCK&#25351;&#20196;&#30340;&#21407;&#23376;&#25805;&#20316;&#22806;&#65292;&#31532;&#19977;&#34892;&#25351;&#20196;&#36824;&#29992;&#20102;XADD&#65292;&#35813;&#25351;&#20196;&#30340;&#24847;&#24605;&#23601;&#26159;&#20132;&#25442;&#30456;&#21152;&#65292;&#20063;&#23601;&#34920;&#31034;&#36825;&#37324;&#20250;&#23558;EAX&#30340;&#20540;&#23384;&#20837;&#21040;[ECX]&#20013;&#65292;&#28982;&#21518;&#23558;[ECX]&#30340;&#20540;&#23384;&#20837;&#21040;EAX&#20013;&#65292; &#25509;&#30528;&#20877;&#25191;&#34892;&#21152;&#27861;&#65307;</p>
</li><li class=" "><p   
>EAX&#30340;&#20540;&#21152;1&#65292;&#27492;&#26102;EAX&#30340;&#20540;&#23601;&#19982;[ECX]&#30340;&#20540;&#19968;&#33268;&#20102;&#65292;&#23427;&#30340;&#20316;&#29992;&#23601;&#26159;&#29992;&#20110;&#20989;&#25968;&#36820;&#22238;&#20540;&#65307;</p>
</li><li class=" "><p   
>&#24179;&#34913;&#22534;&#26632;&#36820;&#22238;&#12290;</p>
</li></ol><p   
>&#20174;&#26412;&#36136;&#19978;&#26469;&#30475;&#23601;&#26159;&#29992;LOCK&#25351;&#20196;&#23436;&#25104;&#19968;&#20010;&#21407;&#23376;&#25805;&#20316;&#20197;&#20445;&#35777;&#22810;&#26680;&#29366;&#24577;&#19979;&#30340;&#32447;&#31243;&#21516;&#27493;&#12290;</p>
    </div>
    <div class="section section-2" id="src-1933380_safe-id-aWQt5aSa5qC45ZCM5q2lLeWkmuihjOaMh-S7pOWQjOatpQ">
        <h2 class="heading "><span>&#22810;&#34892;&#25351;&#20196;&#21516;&#27493;</span></h2>
<p   
>&#25105;&#20204;&#19978;&#36848;&#25152;&#23398;&#20064;&#30340;&#26159;&#21333;&#34892;&#25351;&#20196;&#19979;&#36890;&#36807;LOCK&#26469;&#38145;&#23450;&#20869;&#23384;&#65292;<strong class=" ">&#20294;&#26159;&#22312;&#22810;&#34892;&#25351;&#20196;&#30340;&#24773;&#20917;&#19979;&#24182;&#19981;&#33021;&#27599;&#34892;&#37117;&#20351;&#29992;&#36825;&#20010;&#25351;&#20196;</strong>&#65292;&#25105;&#20204;&#26469;&#30475;&#19968;&#19979;&#22914;&#19979;&#30340;&#22810;&#34892;&#25351;&#20196;&#65306;</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="plain">LOCK INC DWORD PTR DS:[</code><code class="value">0x12345678</code><code class="plain">]</code></div>
<div class="line"><code class="plain">LOCK INC DWORD PTR DS:[</code><code class="value">0x23456789</code><code class="plain">]</code></div>
<div class="line"><code class="plain">LOCK INC DWORD PTR DS:[</code><code class="value">0x34567890</code><code class="plain">]</code></div>
</div>
    </div>
<p   
>&#25191;&#34892;&#36825;&#20010;&#22810;&#34892;&#25351;&#20196;&#65292;&#32447;&#31243;A&#22312;&#23545;0x12345678&#22320;&#22336;&#19978;&#30340;&#20540;&#36827;&#34892;&#20462;&#25913;&#26102;&#65292;&#21457;&#29983;&#20102;&#32447;&#31243;&#20999;&#25442;&#65292;&#20999;&#25442;&#21040;&#20102;&#32447;&#31243;B&#65292;&#34429;&#28982;&#32447;&#31243;B&#19981;&#33021;&#23545;0x12345678&#19978;&#30340;&#20540;&#36827;&#34892;&#20462;&#25913;&#65292;&#20294;&#26159;&#32447;&#31243;B&#21487;&#20197;&#23545;0x23456789&#22320;&#22336;&#19978;&#30340;&#20540;&#36827;&#34892;&#20462;&#25913;&#65292;&#22914;&#26524;&#20462;&#25913;&#26102;&#12289;&#21448;&#21457;&#29983;&#32447;&#31243;&#20999;&#25442;&#65292;&#20999;&#22238;&#32447;&#31243;A&#65292;&#32447;&#31243;B&#23601;&#38145;&#20303;&#20102;0x23456789&#22320;&#22336;&#65292;&#19981;&#35753;&#32447;&#31243;A&#21435;&#20462;&#25913;0x23456789&#22320;&#22336;&#22788;&#30340;&#20540;&#65292;&#37027;&#20040;&#36825;&#26679;&#23601;&#36824;&#26159;&#27809;&#26377;&#21150;&#27861;&#20445;&#35777;&#22810;&#34892;&#25351;&#20196;&#30340;&#21516;&#27493;&#65292;&#22240;&#27492;&#25105;&#20204;&#23601;&#38656;&#35201;&#23398;&#20064;&#19968;&#20010;&#26032;&#30340;&#27010;&#24565;&#65306;&#20020;&#30028;&#21306;&#12290;</p>
<p   
>&#20020;&#30028;&#21306;&#26159;&#19968;&#20010;&#27010;&#24565;&#65292;<strong class=" ">&#21363;&#36825;&#20010;&#21306;&#22495;&#19968;&#27425;&#21482;&#20801;&#35768;&#19968;&#20010;&#32447;&#31243;&#36827;&#20837;&#65292;&#30452;&#33267;&#32447;&#31243;&#31163;&#24320;&#25165;&#20801;&#35768;&#19979;&#19968;&#20010;&#32447;&#31243;&#36827;&#20837;</strong>&#65292;&#34429;&#28982;Windows&#20063;&#25552;&#20379;&#20102;&#20020;&#30028;&#21306;&#65292;&#20294;&#20063;&#19981;&#24433;&#21709;&#25105;&#20204;&#33258;&#24049;&#25353;&#29031;&#36825;&#20010;&#27010;&#24565;&#21435;&#23454;&#29616;&#33258;&#24049;&#30340;&#20020;&#30028;&#21306;&#12290;</p>
<p   
>&#20020;&#30028;&#21306;&#23454;&#29616;&#36215;&#26469;&#24456;&#31616;&#21333;&#65292;&#26412;&#36136;&#19978;&#23601;&#26159;&#21152;&#19968;&#20010;&#38145;&#65292;&#20363;&#22914;&#25105;&#20204;&#21487;&#20197;&#35774;&#32622;&#19968;&#20010;&#20840;&#23616;&#21464;&#37327;&#65292;&#24403;&#32447;&#31243;&#36827;&#20837;&#26102;&#35774;&#20026;1&#65292;&#24403;&#32447;&#31243;&#31163;&#24320;&#26102;&#35774;&#20026;0&#65292;&#24403;&#35813;&#20840;&#23616;&#21464;&#37327;&#20026;0&#26102;&#25165;&#20801;&#35768;&#36827;&#20837;&#65292;&#22312;&#20020;&#30028;&#21306;&#20869;&#30340;&#25351;&#20196;&#23601;&#26159;&#21407;&#23376;&#25805;&#20316;&#65292;&#21542;&#21017;&#19981;&#20801;&#35768;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1933380/image2023-3-2_22-51-52.png" alt="images/download/attachments/1933380/image2023-3-2_22-51-52.png" width="400"  />
    </p>
<p   
>&#20294;&#36825;&#26679;&#30475;&#20284;&#35299;&#20915;&#20102;&#22810;&#34892;&#25351;&#20196;&#30340;&#21516;&#27493;&#38382;&#39064;&#65292;&#20294;&#23454;&#38469;&#21448;&#20986;&#20102;&#19968;&#20010;&#26032;&#30340;&#38382;&#39064;&#65292;<strong class=" ">&#21363;&#22312;dwFlag&#30340;&#20540;&#35774;&#20026;1&#20043;&#21069;&#21457;&#29983;&#20102;&#32447;&#31243;&#20999;&#25442;&#65292;&#20854;&#20182;&#30340;&#32447;&#31243;&#20173;&#28982;&#21487;&#20197;&#36890;&#36807;&#21028;&#26029;&#36827;&#20837;&#20020;&#30028;&#21306;</strong>&#65292;&#36825;&#26679;&#20020;&#30028;&#21306;&#30340;&#20316;&#29992;&#23601;&#22833;&#25928;&#20102;&#12290;&#37027;&#20040;&#36825;&#37324;&#30340;&#38382;&#39064;&#23601;&#24456;&#26126;&#26174;&#26159;&#21457;&#29983;&#22312;&#20102;&#19978;&#38145;&#30340;&#39034;&#24207;&#19978;&#65292;&#25152;&#20197;&#25105;&#20204;&#21487;&#20197;&#25442;&#19968;&#31181;&#26041;&#24335;&#65292;&#20808;&#20462;&#25913;&#38145;&#30340;&#20540;&#65292;&#28982;&#21518;&#20877;&#21028;&#26029;&#36827;&#20837;&#20020;&#30028;&#21306;&#12290;</p>
<p   
>&#22914;&#19979;&#22270;&#25152;&#31034;&#30340;&#20266;&#20195;&#30721;&#65292;&#39318;&#20808;&#36171;&#20104;EAX&#20026;1&#65292;&#25509;&#30528;&#36890;&#36807;&#20132;&#25442;&#30456;&#21152;&#30340;&#26041;&#24335;&#65292;&#23558;&#20840;&#23616;&#21464;&#37327;&#30340;&#20540;&#21152;1&#65292;&#23558;&#21407;&#20840;&#23616;&#21464;&#37327;&#30340;&#20540;0&#32473;&#21040;EAX&#65292;&#32780;&#21518;&#21028;&#26029;EAX&#30340;&#20540;&#26159;&#21542;&#20026;0&#65306;&#22914;&#26524;&#26159;0&#21017;&#21487;&#20197;&#36827;&#20837;&#20020;&#30028;&#21306;&#65292;&#25191;&#34892;&#23436;&#21407;&#23376;&#25805;&#20316;&#20043;&#21518;&#65292;&#31163;&#24320;&#20020;&#30028;&#21306;&#23558;&#20840;&#23616;&#21464;&#37327;&#30340;&#20540;&#20943;1&#65307;&#22914;&#26524;&#19981;&#26159;&#21017;&#23558;&#20840;&#23616;&#21464;&#37327;&#30340;&#20540;&#20943;1&#65292;&#35843;&#29992;sleep&#20989;&#25968;&#36827;&#20837;&#32447;&#31243;&#31561;&#24453;&#65292;&#19968;&#27573;&#26102;&#38388;&#21518;&#65292;&#22312;&#36339;&#22238;&#36827;&#20837;&#20020;&#30028;&#21306;&#30340;&#22320;&#26041;&#37325;&#26032;&#21028;&#26029;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1933380/image2023-3-2_23-10-0.png" alt="images/download/attachments/1933380/image2023-3-2_23-10-0.png" width="400"  />
    </p>
    </div>
    </div>
    <div class="section section-1" id="src-1933380_safe-id-aWQt5aSa5qC45ZCM5q2lLeiHquaXi-mUgQ">
        <h1 class="heading "><span>&#33258;&#26059;&#38145;</span></h1>
<p   
>&#22312;&#19978;&#19968;&#31456;&#33410;&#20013;&#65292;&#25105;&#20204;&#20102;&#35299;&#20102;&#22810;&#34892;&#25351;&#20196;&#36890;&#36807;&#20020;&#30028;&#21306;&#30340;&#26041;&#24335;&#22312;&#22810;&#26680;&#29615;&#22659;&#19979;&#36827;&#34892;&#32447;&#31243;&#21516;&#27493;&#65292;&#20294;&#37027;&#21482;&#26159;&#31616;&#21333;&#20102;&#35299;&#65292;&#26412;&#31456;&#33410;&#25105;&#20204;&#38656;&#35201;&#20102;&#35299;&#22312;Windows&#19979;&#23454;&#29616;&#22810;&#26680;&#21516;&#27493;&#30340;&#26426;&#21046;&#65306;&#33258;&#26059;&#38145;&#12290;</p>
<p   
>&#25105;&#20204;&#35201;&#20102;&#35299;&#33258;&#26059;&#38145;&#38656;&#35201;&#26681;&#25454;&#20869;&#26680;&#25991;&#20214;&#21435;&#20998;&#26512;&#65292;&#22312;Windows&#25805;&#20316;&#31995;&#32479;&#19979;&#19981;&#21516;&#29256;&#26412;&#26377;&#30528;&#19981;&#21516;&#30340;&#20869;&#26680;&#25991;&#20214;&#12290;</p>
<p   
><img  class="confluence-embedded-image confluence-thumbnail"  src="images/download/thumbnails/1933380/image2023-4-5_19-52-19.png" alt="images/download/thumbnails/1933380/image2023-4-5_19-52-19.png" width="300"  />
    </p>
<p   
>&#31995;&#32479;&#22312;&#23433;&#35013;&#26102;&#20250;&#26681;&#25454;&#20320;&#30340;&#30828;&#20214;&#29615;&#22659;&#65292;&#22914;Intel&#30340;&#22810;&#26680;CPU&#65292;&#31995;&#32479;&#23601;&#20250;&#23558;ntkrnlmp.exe&#25335;&#36125;&#25104;ntoskrnl.exe&#65292;&#34429;&#28982;&#19982;&#21333;&#26680;&#26102;&#30340;&#21517;&#23383;&#26159;&#19968;&#26679;&#30340;&#65292;&#20294;&#30495;&#27491;&#30340;&#28304;&#25991;&#20214;&#19981;&#21516;&#12290;</p>
<p   
>&#25105;&#20204;&#30446;&#21069;&#34394;&#25311;&#26426;&#26159;&#21333;&#26680;&#37197;&#32622;&#65292;&#24819;&#35201;&#33719;&#21462;&#22810;&#26680;&#24773;&#20917;&#19979;&#20869;&#26680;&#25991;&#20214;&#65292;&#23601;&#38656;&#35201;&#37325;&#26032;&#35774;&#32622;&#34394;&#25311;&#26426;&#30340;&#22788;&#29702;&#22120;&#26680;&#30340;&#25968;&#37327;&#65292;&#36890;&#36807;VMWare&#36827;&#34892;&#37197;&#32622;&#21363;&#21487;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1933380/image2023-4-5_20-1-49.png" alt="images/download/attachments/1933380/image2023-4-5_20-1-49.png" width="400"  />
    </p>
<p   
>&#28982;&#21518;&#36827;&#20837;&#34394;&#25311;&#26426;&#65292;&#25335;&#36125;&#20986;&#26469;ntoskrnl.exe&#37325;&#21629;&#21517;&#20026;ntkrnlmp.exe&#65292;&#20877;&#36890;&#36807;IDA&#25171;&#24320;&#65292;&#27492;&#26102;IDA&#23601;&#20250;&#21435;&#35843;&#29992;ntkrnlmp.exe&#30340;&#31526;&#21495;&#25991;&#20214;&#26469;&#35299;&#26512;&#12290;</p>
<p   
>&#36890;&#36807;IDA&#25105;&#20204;&#21487;&#20197;&#30475;&#35265;&#22312;&#32447;&#31243;&#20999;&#25442;&#30340;&#20851;&#38190;&#20989;&#25968;SwapContext&#20013;&#65292;&#22810;&#26680;&#27169;&#24335;&#19979;&#22312;&#20989;&#25968;&#24320;&#22836;&#22810;&#20102;&#20004;&#20010;&#20989;&#25968;&#30340;&#20351;&#29992;&#65292;&#21363;&#65306;KeAcquireQueuedSpinLockAtDpcLevel&#19982;KeReleaseQueuedSpinLockFromDpcLevel&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1933380/image2023-4-5_20-15-38.png" alt="images/download/attachments/1933380/image2023-4-5_20-15-38.png" width="600"  />
    </p>
<p   
>&#20102;&#35299;Windows&#33258;&#26059;&#38145;&#65292;&#25105;&#20204;&#21487;&#20197;&#26469;&#30475;&#36825;&#20010;&#20989;&#25968;&#65306;KeAcquire<strong class=" ">SpinLock</strong>AtDpcLevel&#65292;&#22312;&#20989;&#25968;&#21517;&#20013;&#24102;&#26377;Spinlock&#30340;&#37117;&#19982;&#33258;&#26059;&#38145;&#26377;&#20851;&#12290;</p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;IDA&#30475;&#35265;&#65292;&#22312;KeAcquire<strong class=" ">SpinLock</strong>AtDpcLevel&#20989;&#25968;&#20869;&#30340;&#25351;&#20196;&#24456;&#31616;&#21333;&#65306;</p>
<ol class=" "><li class=" "><p   
>&#33719;&#21462;&#20256;&#36882;&#36807;&#26469;&#30340;&#21442;&#25968;&#65292;&#20808;&#36827;&#34892;LOCK&#21407;&#23376;&#25805;&#20316;&#65292;&#28982;&#21518;BTS&#25351;&#20196;&#20250;&#20808;&#21028;&#26029;[ecx]&#20540;&#26159;&#21542;&#20026;0&#65292;&#20026;0&#21017;&#23558;CF&#20301;&#35774;&#20026;1&#65292;&#20026;1&#21017;CF&#20301;&#35774;&#20026;0&#65292;&#25509;&#30528;&#23558;[ecx]&#20013;&#19979;&#26631;&#20026;0&#30340;&#20301;&#32622;&#20540;&#35774;1&#65307;</p>
</li><li class=" "><p   
>&#24403;CF&#20301;&#20026;0&#65288;[ecx]&#20026;1&#65289;&#21017;&#36339;&#36716;&#65292;&#24403;CF&#20301;&#20026;1&#65288;[ecx]&#20026;0&#65289;&#21017;&#36820;&#22238;&#65307;</p>
</li><li class=" "><p   
>&#21028;&#26029;[ecx]&#20540;&#26159;&#21542;&#20026;1&#65292;&#19981;&#20026;1&#21017;ZF&#20301;&#20026;1&#65292;&#20026;1&#21017;ZF&#20301;&#20026;0&#65307;</p>
</li><li class=" "><p   
>&#24403;ZF&#20301;&#20026;1&#65288;[ecx]&#20026;0&#65289;&#21017;&#36339;&#36716;&#65292;ZF&#20301;&#20026;0&#65288;[ecx]&#20026;1&#65289;&#21017;&#20351;&#29992;&#38477;&#28201;&#25351;&#20196;&#65288;PAUSE&#65289;&#65292;&#30701;&#26102;&#38388;&#20869;&#35753;CPU&#21151;&#29575;&#38477;&#20302;&#12290;</p>
</li></ol><p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1933380/image2023-4-5_20-42-19.png" alt="images/download/attachments/1933380/image2023-4-5_20-42-19.png" width="600"  />
    </p>
<p   
>&#25105;&#20204;&#21487;&#20197;&#30475;&#35265;&#24403;&#22810;&#26680;&#27169;&#24335;&#19979;&#65292;A&#32447;&#31243;&#65288;1&#26680;&#65289;&#25191;&#34892;&#35813;&#20989;&#25968;&#20043;&#21518;&#33719;&#24471;&#20102;&#33258;&#26059;&#38145;&#65292;&#27492;&#26102;B&#32447;&#31243;&#65288;2&#26680;&#65289;&#21152;&#20837;&#25191;&#34892;&#65292;&#37027;&#20040;B&#32447;&#31243;&#23601;&#38656;&#35201;&#21407;&#22320;&#31561;&#24453;&#22312;&#37027;&#36716;&#19968;&#20250;&#65292;&#31561;&#24453;&#33258;&#26059;&#38145;&#34987;&#37322;&#25918;&#65292;&#20063;&#23601;&#26159;&#20026;&#31354;&#38386;&#29366;&#24577;&#12290;&#22240;&#27492;&#65292;&#33258;&#26059;&#38145;&#21482;&#23545;&#22810;&#26680;&#26377;&#24847;&#20041;&#65292;&#33258;&#26059;&#38145;&#19982;&#20020;&#30028;&#21306;&#12289;&#20107;&#20214;&#12289;&#20114;&#26021;&#20307;&#19968;&#26679;&#65292;&#37117;&#26159;&#19968;&#31181;&#21516;&#27493;&#26426;&#21046;&#65292;&#37117;&#21487;&#20197;&#35753;&#24403;&#21069;&#32447;&#31243;&#22788;&#20110;&#31561;&#24453;&#29366;&#24577;&#65292;<strong class=" ">&#21306;&#21035;&#22312;&#20110;&#33258;&#26059;&#38145;&#19981;&#29992;&#20999;&#25442;&#32447;&#31243;&#65292;&#26356;&#21152;&#36731;&#37327;</strong>&#12290;</p>
    </div>
    <div class="section section-1" id="src-1933380_safe-id-aWQt5aSa5qC45ZCM5q2lLemHjei9veWGheaguA">
        <h1 class="heading "><span>&#37325;&#36733;&#20869;&#26680;</span></h1>
<p   
>&#20869;&#26680;&#20013;&#20250;&#26377;&#24456;&#22810;&#30340;&#20989;&#25968;&#34987;&#23618;&#23618;Hook&#65292;&#35201;&#24819;&#32469;&#36807;Hook&#25105;&#20204;&#23601;&#21487;&#20197;&#20351;&#29992;&#37325;&#36733;&#20869;&#26680;&#30340;&#26041;&#24335;&#12290;&#37325;&#36733;&#20869;&#26680;&#36319;&#26435;&#38480;&#65288;R3&#12289;R0&#65289;&#21644;&#20869;&#26680;&#27809;&#20851;&#31995;&#65292;&#37325;&#36733;&#20869;&#26680;&#30340;&#26412;&#36136;&#23601;&#26159;&#23558;&#20869;&#26680;&#25991;&#20214;&#65288;PE&#25991;&#20214;&#65289;&#33258;&#24049;&#25343;&#36807;&#26469;&#22312;&#25353;&#20869;&#23384;&#26684;&#24335;&#35201;&#27714;&#65288;<strong class=" ">&#25353;PE&#22836;&#25104;&#21592;SectionAlignment&#30340;&#20540;&#22312;&#20869;&#23384;&#20013;&#36827;&#34892;&#23545;&#40784;</strong>&#65289;&#25918;&#20837;&#20869;&#23384;&#65292;&#28982;&#21518;&#33258;&#24049;&#20351;&#29992;&#12290;</p>
<p   
>&#20294;&#23454;&#38469;&#25805;&#20316;&#24182;&#27809;&#26377;&#36825;&#20040;&#31616;&#21333;&#65292;&#25105;&#20204;&#38656;&#35201;&#32771;&#34385;&#24403;&#20869;&#26680;&#25991;&#20214;&#21152;&#36733;&#36827;&#26469;&#20043;&#21518;&#23427;&#30003;&#35831;&#21040;&#30340;&#20869;&#23384;&#22522;&#22336;&#26159;&#21542;&#19982;ImageBase&#19968;&#33268;&#65292;&#22914;&#26524;&#19981;&#19968;&#33268;&#30340;&#24773;&#20917;&#19979;&#65292;&#25105;&#20204;&#23601;&#38656;&#35201;&#21435;&#20462;&#25913;&#37325;&#23450;&#20301;&#34920;&#65292;&#36825;&#26679;&#25165;&#21487;&#20197;&#27491;&#30830;&#30340;&#20351;&#29992;&#20840;&#23616;&#21464;&#37327;&#65307;&#38500;&#27492;&#20197;&#22806;&#65292;&#25105;&#20204;&#36824;&#38656;&#35201;&#21435;&#20462;&#22797;IAT&#34920;&#65292;&#22914;&#19979;&#20004;&#24352;&#22270;&#25152;&#31034;&#65292;&#26159;Windows&#22312;PE&#25991;&#20214;&#21152;&#36733;&#21069;&#21518;IAT&#34920;&#23384;&#20648;&#20869;&#23481;&#30340;&#21464;&#21270;&#65292;<strong class=" ">&#22914;&#26524;&#25105;&#20204;&#19981;&#21435;&#20462;&#22797;IAT&#34920;&#20351;&#24471;&#20854;&#23384;&#20648;&#30340;&#20869;&#23481;&#25191;&#21521;&#30495;&#27491;&#30340;&#20989;&#25968;&#22320;&#22336;&#65292;&#37027;&#20040;&#24403;&#25105;&#20204;&#20351;&#29992;&#26576;&#20010;&#20989;&#25968;&#26102;&#23601;&#20250;&#20986;&#38169;</strong>&#65292;&#22240;&#20026;&#23427;&#25351;&#21521;&#30340;&#26159;&#19968;&#20010;IMAGE_THUNK_DATA&#32467;&#26500;&#20307;&#12290;</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1933380/image2023-4-6_14-40-59.png" alt="images/download/attachments/1933380/image2023-4-6_14-40-59.png" width="600"  />
    </p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/1933380/image2023-4-6_14-41-31.png" alt="images/download/attachments/1933380/image2023-4-6_14-41-31.png" width="600"  />
    </p>
<p   
>&#37325;&#36733;&#23436;&#25104;&#20043;&#21518;&#25105;&#20204;&#26159;&#21542;&#23601;&#21487;&#20197;&#20351;&#29992;&#20102;&#21602;&#65292;&#23454;&#38469;&#19978;&#24182;&#19981;&#33021;&#65292;&#25105;&#20204;&#22312;&#31995;&#32479;&#35843;&#29992;&#31456;&#33410;&#23398;&#20064;&#26102;&#20102;&#35299;&#21040;3&#29615;API&#26412;&#36136;&#19978;&#23601;&#26159;&#31995;&#32479;&#35843;&#29992;&#65292;&#36827;&#20837;0&#29615;&#20043;&#21518;&#25191;&#34892;&#30340;&#26159;    <span style="color: #172b4d;">
KiFastCallEntry&#65292;&#35813;&#20989;&#25968;&#26159;&#38656;&#35201;&#26681;&#25454;&#31995;&#32479;&#35843;&#29992;&#21495;&#22312;&#31995;&#32479;&#26381;&#21153;&#34920;&#20013;&#25214;&#21040;&#20989;&#25968;&#22320;&#22336;&#65292;&#22240;&#27492;&#25105;&#20204;&#24819;&#35201;&#33021;&#22815;&#30495;&#27491;&#30340;&#20351;&#29992;&#37325;&#36733;&#21518;&#30340;&#20869;&#23384;&#65292;&#20063;&#38656;&#35201;&#33258;&#24049;&#21435;&#23665;&#23528;&#19968;&#20221;&#31995;&#32479;&#26381;&#21153;&#34920;&#65292;&#23558;&#37324;&#38754;&#30340;&#20989;&#25968;&#22320;&#22336;&#25351;&#21521;&#25105;&#20204;&#26032;&#30340;&#20869;&#26680;&#23545;&#24212;&#22320;&#22336;&#12290;    </span>
</p>
<p   
>    <span style="color: #172b4d;">
&#25509;&#30528;&#25105;&#20204;&#36824;&#38656;&#35201;&#21435;Hook KiFastCallEntry&#65292;&#20351;&#24471;&#25191;&#34892;&#35813;&#20989;&#25968;&#26102;&#23427;&#25152;&#21435;&#23547;&#25214;&#30340;&#31995;&#32479;&#26381;&#21153;&#34920;&#26159;&#25105;&#20204;&#23665;&#23528;&#30340;&#37027;&#19968;&#20221;&#65292;&#36825;&#26679;&#25105;&#20204;&#25165;&#21487;&#20197;&#20351;&#29992;&#37325;&#36733;&#21518;&#30340;&#20869;&#26680;&#12290;    </span>
</p>
    <div class="section section-2" id="src-1933380_safe-id-aWQt5aSa5qC45ZCM5q2lLeaAu-e7kw">
        <h2 class="heading "><span>&#24635;&#32467;</span></h2>
<p   
>&#20174;&#26412;&#36136;&#19978;&#26469;&#35828;&#24182;&#19981;&#38656;&#35201;&#25152;&#35859;&#30340;&ldquo;&#37325;&#36733;&#20869;&#26680;&rdquo;&#65292;&#21482;&#35201;&#20102;&#35299;PE&#22522;&#30784;&#65292;<strong class=" ">&#23545;&#20110;&#25105;&#20204;&#26469;&#35828;&#19968;&#20999;&#37117;&#26159;&ldquo;&#37325;&#36733;&#27169;&#22359;&rdquo;&#65292;&#25105;&#20204;&#38656;&#35201;&#23601;&#26159;&#36890;&#36807;&#33258;&#24049;&#30340;&#20195;&#30721;&#26469;&#23454;&#29616;Windows&#21152;&#36733;&#27169;&#22359;&#30340;&#36807;&#31243;</strong>&#12290;</p>
<p   
>&#34429;&#28982;&#36890;&#36807;&#37325;&#36733;&#20869;&#26680;&#25105;&#20204;&#21487;&#20197;&#32469;&#36807;&#20869;&#26680;&#19978;&#30340;Hook&#65292;&#20294;&#25913;&#21160;&#22826;&#22823;&#65292;&#21363;&#20351;&#25273;&#21435;PE&#25351;&#32441;&#20063;&#26080;&#27861;&#23436;&#20840;&#38544;&#24418;&#65292;<strong class=" ">&#26368;&#22909;&#30340;&#21150;&#27861;&#19981;&#26159;&#37325;&#36733;&#20869;&#26680;&#65292;&#32780;&#26159;&#38656;&#35201;&#20160;&#20040;&#20989;&#25968;&#33258;&#24049;&#26469;&#23454;&#29616;</strong>&#12290;</p>
    </div>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="%E5%8F%A5%E6%9F%84%E8%A1%A8.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>&#21477;&#26564;&#34920;</span>
        </a>
                <a href="APC%E6%9C%BA%E5%88%B6.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>APC&#26426;&#21046;</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
